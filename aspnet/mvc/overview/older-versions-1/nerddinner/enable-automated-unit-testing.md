---
uid: mvc/overview/older-versions-1/nerddinner/enable-automated-unit-testing
title: Aktivieren von automatisierten Komponententests | Microsoft-Dokumentation
author: microsoft
description: Schritt 12 zeigt, wie eine Suite von automatisierten Komponententests entwickeln, zu überprüfen, ob unsere NerdDinner-Funktionen und die wir erhalten der Zuversicht, Änderungen vornehmen...
ms.author: riande
ms.date: 07/27/2010
ms.assetid: a19ff2ce-3f7e-4358-9a51-a1403da9c63e
msc.legacyurl: /mvc/overview/older-versions-1/nerddinner/enable-automated-unit-testing
msc.type: authoredcontent
ms.openlocfilehash: 74abf391bb4aab3ff0d5079e0a24ba20287e18fb
ms.sourcegitcommit: 45ac74e400f9f2b7dbded66297730f6f14a4eb25
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/16/2018
ms.locfileid: "41832784"
---
<a name="enable-automated-unit-testing"></a><span data-ttu-id="571e2-103">Aktivieren von automatisierten Komponententests</span><span class="sxs-lookup"><span data-stu-id="571e2-103">Enable Automated Unit Testing</span></span>
====================
<span data-ttu-id="571e2-104">durch [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="571e2-104">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="571e2-105">PDF herunterladen</span><span class="sxs-lookup"><span data-stu-id="571e2-105">Download PDF</span></span>](http://aspnetmvcbook.s3.amazonaws.com/aspnetmvc-nerdinner_v1.pdf)

> <span data-ttu-id="571e2-106">Dies ist Schritt 12, der ein kostenloses ["NerdDinner"-webanwendungstutorial](introducing-the-nerddinner-tutorial.md) , die führt – Exemplarische Vorgehensweise erstellen eine kleine, jedoch abgeschlossen haben, Web-Anwendung mithilfe von ASP.NET MVC-1.</span><span class="sxs-lookup"><span data-stu-id="571e2-106">This is step 12 of a free ["NerdDinner" application tutorial](introducing-the-nerddinner-tutorial.md) that walks-through how to build a small, but complete, web application using ASP.NET MVC 1.</span></span>
> 
> <span data-ttu-id="571e2-107">Schritt 12 zeigt, wie Sie eine Suite von automatisierten Komponententests entwickeln, zu überprüfen, ob unsere NerdDinner-Funktionen, und die wird uns der Zuversicht, Änderungen und Verbesserungen für die Anwendung in der Zukunft zu gestalten.</span><span class="sxs-lookup"><span data-stu-id="571e2-107">Step 12 shows how to develop a suite of automated unit tests that verify our NerdDinner functionality, and which will give us the confidence to make changes and improvements to the application in the future.</span></span>
> 
> <span data-ttu-id="571e2-108">Wenn Sie ASP.NET MVC 3 verwenden, sollten Sie Sie folgen den [erste Schritte mit MVC 3](../../older-versions/getting-started-with-aspnet-mvc3/cs/intro-to-aspnet-mvc-3.md) oder [MVC Music Store](../../older-versions/mvc-music-store/mvc-music-store-part-1.md) Tutorials.</span><span class="sxs-lookup"><span data-stu-id="571e2-108">If you are using ASP.NET MVC 3, we recommend you follow the [Getting Started With MVC 3](../../older-versions/getting-started-with-aspnet-mvc3/cs/intro-to-aspnet-mvc-3.md) or [MVC Music Store](../../older-versions/mvc-music-store/mvc-music-store-part-1.md) tutorials.</span></span>


## <a name="nerddinner-step-12-unit-testing"></a><span data-ttu-id="571e2-109">NerdDinner Schritt 12: Komponententests</span><span class="sxs-lookup"><span data-stu-id="571e2-109">NerdDinner Step 12: Unit Testing</span></span>

<span data-ttu-id="571e2-110">Wir entwickeln eine Suite von automatisierten Komponententests zu überprüfen, ob unsere NerdDinner-Funktionen, und die wird uns der Zuversicht, Änderungen und Verbesserungen für die Anwendung in der Zukunft zu gestalten.</span><span class="sxs-lookup"><span data-stu-id="571e2-110">Let's develop a suite of automated unit tests that verify our NerdDinner functionality, and which will give us the confidence to make changes and improvements to the application in the future.</span></span>

### <a name="why-unit-test"></a><span data-ttu-id="571e2-111">Warum Komponententest?</span><span class="sxs-lookup"><span data-stu-id="571e2-111">Why Unit Test?</span></span>

<span data-ttu-id="571e2-112">Auf dem Laufwerk in die Arbeit eines morgens ins Büro haben Sie eine plötzliche Flash Inspiration zu einer Anwendung, die, der Sie gerade arbeiten.</span><span class="sxs-lookup"><span data-stu-id="571e2-112">On the drive into work one morning you have a sudden flash of inspiration about an application you are working on.</span></span> <span data-ttu-id="571e2-113">Sie stellen fest, dass eine Änderung, die Sie implementieren können, die die Anwendung erheblich besser machen können.</span><span class="sxs-lookup"><span data-stu-id="571e2-113">You realize there is a change you can implement that will make the application dramatically better.</span></span> <span data-ttu-id="571e2-114">Es kann sein, ein refactoring, die den Code bereinigt, fügt ein neues Feature oder ein Fehler behoben.</span><span class="sxs-lookup"><span data-stu-id="571e2-114">It might be a refactoring that cleans up the code, adds a new feature, or fixes a bug.</span></span>

<span data-ttu-id="571e2-115">Die Frage, die Sie confronts, wenn Sie auf dem Computer eintreffen ist: "wie safe ist es, diese Verbesserung machen?"</span><span class="sxs-lookup"><span data-stu-id="571e2-115">The question that confronts you when you arrive at your computer is – "how safe is it to make this improvement?"</span></span> <span data-ttu-id="571e2-116">Was geschieht, wenn der Änderung, besitzt Nebenwirkungen oder unterbricht etwas?</span><span class="sxs-lookup"><span data-stu-id="571e2-116">What if making the change has side effects or breaks something?</span></span> <span data-ttu-id="571e2-117">Die Änderung kann einfach sein, und nehmen nur einige Minuten, bis zu implementieren, aber was geschieht, wenn es sich um Stunden, bis Sie manuell alle die Anwendungsszenarien testen dauert?</span><span class="sxs-lookup"><span data-stu-id="571e2-117">The change might be simple and only take a few minutes to implement, but what if it takes hours to manually test out all of the application scenarios?</span></span> <span data-ttu-id="571e2-118">Was geschieht, wenn vergessen Sie, ein Szenario, und wechselt eine fehlerhafte Anwendung, die in die produktionsumgebung?</span><span class="sxs-lookup"><span data-stu-id="571e2-118">What if you forget to cover a scenario and a broken application goes into production?</span></span> <span data-ttu-id="571e2-119">Ist diese Verbesserung der Mühe Wert wirklich vornehmen?</span><span class="sxs-lookup"><span data-stu-id="571e2-119">Is making this improvement really worth all the effort?</span></span>

<span data-ttu-id="571e2-120">Automatisierte Komponententests ermöglichen ein Sicherheitsnetz bereitstellen, die Sie Ihre Anwendungen kontinuierlich verbessern können, und verhindern, dass die Aufrüstung des Codes, den Sie gerade arbeiten.</span><span class="sxs-lookup"><span data-stu-id="571e2-120">Automated unit tests can provide a safety net that enables you to continually enhance your applications, and avoid being afraid of the code you are working on.</span></span> <span data-ttu-id="571e2-121">Dies müssen von automatisierten Tests, die schnell zu überprüfen, dass die Funktionalität ermöglicht es Ihnen, du programmierst sattelfest – und dabei, nehmen Sie Verbesserungen, die Sie andernfalls nicht vertraut sind der Ansicht verfügen können.</span><span class="sxs-lookup"><span data-stu-id="571e2-121">Having automated tests that quickly verify functionality enables you to code with confidence – and empower you to make improvements you might otherwise not have felt comfortable doing.</span></span> <span data-ttu-id="571e2-122">Sie dienen zum Erstellen von Lösungen, die besser verwaltbar sind und eine längere Lebensdauer – Dies führt zu einer viel höheren Rendite zurückgegeben haben.</span><span class="sxs-lookup"><span data-stu-id="571e2-122">They also help create solutions that are more maintainable and have a longer lifetime - which leads to a much higher return on investment.</span></span>

<span data-ttu-id="571e2-123">Das ASP.NET MVC-Framework ist es einfach und natürlich auf Unit Test Anwendungsfunktionen.</span><span class="sxs-lookup"><span data-stu-id="571e2-123">The ASP.NET MVC Framework makes it easy and natural to unit test application functionality.</span></span> <span data-ttu-id="571e2-124">Darüber hinaus können einen Test Driven Development (TDD)-Workflow, der Test-First-Basis-Entwicklung ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="571e2-124">It also enables a Test Driven Development (TDD) workflow that enables test-first based development.</span></span>

### <a name="nerddinnertests-project"></a><span data-ttu-id="571e2-125">NerdDinner.Tests-Projekt</span><span class="sxs-lookup"><span data-stu-id="571e2-125">NerdDinner.Tests Project</span></span>

<span data-ttu-id="571e2-126">Wenn wir unsere NerdDinner-Anwendung zu Beginn dieses Tutorials erstellt haben, wurden wir aufgefordert, ein Dialogfeld gefragt, ob wir wollten ein Komponententestprojekt zusammen mit dem Application-Projekt zu erstellen:</span><span class="sxs-lookup"><span data-stu-id="571e2-126">When we created our NerdDinner application at the beginning of this tutorial, we were prompted with a dialog asking whether we wanted to create a unit test project to go along with the application project:</span></span>

![](enable-automated-unit-testing/_static/image1.png)

<span data-ttu-id="571e2-127">Wir bleiben die "Ja, Komponententestprojekt erstellen" Optionsfeld ausgewählt – was in einem Projekt auf unserer Projektmappe hinzugefügt wird "NerdDinner.Tests" geführt hat:</span><span class="sxs-lookup"><span data-stu-id="571e2-127">We kept the "Yes, create a unit test project" radio button selected – which resulted in a "NerdDinner.Tests" project being added to our solution:</span></span>

![](enable-automated-unit-testing/_static/image2.png)

<span data-ttu-id="571e2-128">Das NerdDinner.Tests-Projekt verweist auf die Projektassembly des NerdDinner-Anwendung, und es uns ermöglicht, fügen Sie einfach automatisierte Tests hinzu, die die Funktion der Anwendung zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="571e2-128">The NerdDinner.Tests project references the NerdDinner application project assembly, and enables us to easily add automated tests to it that verify the application functionality.</span></span>

### <a name="creating-unit-tests-for-our-dinner-model-class"></a><span data-ttu-id="571e2-129">Erstellen von Komponententests für unseren Dinner-Model-Klasse</span><span class="sxs-lookup"><span data-stu-id="571e2-129">Creating Unit Tests for our Dinner Model Class</span></span>

<span data-ttu-id="571e2-130">Fügen Sie einige Tests unsere NerdDinner.Tests-Projekt, das die Dinner-Klasse zu überprüfen, die wir erstellt haben, wenn wir unsere Modellschicht erstellt.</span><span class="sxs-lookup"><span data-stu-id="571e2-130">Let's add some tests to our NerdDinner.Tests project that verify the Dinner class we created when we built our model layer.</span></span>

<span data-ttu-id="571e2-131">Wir beginnen, erstellen Sie einen neuen Ordner in unserem Testprojekt namens "Models", in dem wir unsere-modellbezogenes Tests hinzufügen möchten.</span><span class="sxs-lookup"><span data-stu-id="571e2-131">We'll start by creating a new folder within our test project called "Models" where we'll place our model-related tests.</span></span> <span data-ttu-id="571e2-132">Wir klicken Sie dann mit der rechten Maustaste auf den Ordner und wählen Sie die **Add-&gt;neuen Test** Menübefehl.</span><span class="sxs-lookup"><span data-stu-id="571e2-132">We'll then right-click on the folder and choose the **Add-&gt;New Test** menu command.</span></span> <span data-ttu-id="571e2-133">Hierdurch wird das Dialogfeld "Neuen Test hinzufügen" angezeigt.</span><span class="sxs-lookup"><span data-stu-id="571e2-133">This will bring up the "Add New Test" dialog.</span></span>

<span data-ttu-id="571e2-134">Wählen wir zum Erstellen von "Unit Test", und nennen Sie es mit "DinnerTest.cs":</span><span class="sxs-lookup"><span data-stu-id="571e2-134">We'll choose to create a "Unit Test" and name it "DinnerTest.cs":</span></span>

![](enable-automated-unit-testing/_static/image3.png)

<span data-ttu-id="571e2-135">Beim Klicken auf die Schaltfläche "ok" Visual Studio hinzufügen (eine DinnerTest.cs-Datei zum Projekt und öffnen):</span><span class="sxs-lookup"><span data-stu-id="571e2-135">When we click the "ok" button Visual Studio will add (and open) a DinnerTest.cs file to the project:</span></span>

![](enable-automated-unit-testing/_static/image4.png)

<span data-ttu-id="571e2-136">Die standardmäßige Visual Studio-Komponententestvorlage verfügt über eine Reihe von partitionierungsaufgaben darin, die ich Webbrowsing finden.</span><span class="sxs-lookup"><span data-stu-id="571e2-136">The default Visual Studio unit test template has a bunch of boiler-plate code within it that I find a little messy.</span></span> <span data-ttu-id="571e2-137">Lassen Sie uns bereinigen sie Sie einfach den folgenden Code enthalten:</span><span class="sxs-lookup"><span data-stu-id="571e2-137">Let's clean it up to just contain the code below:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample1.cs)]

<span data-ttu-id="571e2-138">Die [TestClass]-Attribut auf die oben gezeigte Klasse DinnerTest identifiziert sie als eine Klasse, die Tests als auch optionale testinitialisierung und Beendigungscode enthalten soll.</span><span class="sxs-lookup"><span data-stu-id="571e2-138">The [TestClass] attribute on the DinnerTest class above identifies it as a class that will contain tests, as well as optional test initialization and teardown code.</span></span> <span data-ttu-id="571e2-139">Wir können die Tests in diesem definieren, durch das Hinzufügen von öffentlicher Methoden, die eine [TestMethod]-Attribut verfügen.</span><span class="sxs-lookup"><span data-stu-id="571e2-139">We can define tests within it by adding public methods that have a [TestMethod] attribute on them.</span></span>

<span data-ttu-id="571e2-140">Im folgenden finden Sie die erste von zwei Tests, die wir hinzufügen, die unsere Dinner-Klasse ausführen.</span><span class="sxs-lookup"><span data-stu-id="571e2-140">Below are the first of two tests we'll add that exercise our Dinner class.</span></span> <span data-ttu-id="571e2-141">Der erste Test überprüft, dass unsere Dinner ungültig ist, wenn eine neue Dinner erstellt wird, ohne alle Eigenschaften richtig festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="571e2-141">The first test verifies that our Dinner is invalid if a new Dinner is created without all properties being set correctly.</span></span> <span data-ttu-id="571e2-142">Der zweite Test stellt sicher, dass unsere Dinner gültig ist, wenn es sich bei eine Dinner alle Eigenschaften mit gültigen Werten festgelegt wurde:</span><span class="sxs-lookup"><span data-stu-id="571e2-142">The second test verifies that our Dinner is valid when a Dinner has all properties set with valid values:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample2.cs)]

<span data-ttu-id="571e2-143">Sie sehen oben, dass unsere Testnamen sehr deutlich (und ein wenig ausführlich) sind.</span><span class="sxs-lookup"><span data-stu-id="571e2-143">You'll notice above that our test names are very explicit (and somewhat verbose).</span></span> <span data-ttu-id="571e2-144">Wir sind dabei, da erstellen, Hunderte oder Tausende von Tests kleiner kann am Ende und zu vereinfachen, können Sie schnell feststellen, die Absicht und das Verhalten der einzelnen von ihnen (insbesondere, wenn wir über eine Liste von Fehlern in einem Test Runner betrachten) werden sollten.</span><span class="sxs-lookup"><span data-stu-id="571e2-144">We are doing this because we might end up creating hundreds or thousands of small tests, and we want to make it easy to quickly determine the intent and behavior of each of them (especially when we are looking through a list of failures in a test runner).</span></span> <span data-ttu-id="571e2-145">Nach der die Funktionalität, die sie testen möchten, sollten die Testnamen benannt werden.</span><span class="sxs-lookup"><span data-stu-id="571e2-145">The test names should be named after the functionality they are testing.</span></span> <span data-ttu-id="571e2-146">Oben verwenden wir ein "Nomen\_sollten\_Verb" Benennungsschema folgen.</span><span class="sxs-lookup"><span data-stu-id="571e2-146">Above we are using a "Noun\_Should\_Verb" naming pattern.</span></span>

<span data-ttu-id="571e2-147">Wir werden die Tests mit dem Muster – das steht für "Arrange, Act, Assert" testen "AAA" strukturieren:</span><span class="sxs-lookup"><span data-stu-id="571e2-147">We are structuring the tests using the "AAA" testing pattern – which stands for "Arrange, Act, Assert":</span></span>

- <span data-ttu-id="571e2-148">Anordnen: Einrichten der Komponententests</span><span class="sxs-lookup"><span data-stu-id="571e2-148">Arrange: Setup the unit being tested</span></span>
- <span data-ttu-id="571e2-149">: Führen Sie die Komponenten unter testbedingungen und erfassen Ergebnisse zu</span><span class="sxs-lookup"><span data-stu-id="571e2-149">Act: Exercise the unit under test and capture results</span></span>
- <span data-ttu-id="571e2-150">Assert-: Das Verhalten überprüfen</span><span class="sxs-lookup"><span data-stu-id="571e2-150">Assert: Verify the behavior</span></span>

<span data-ttu-id="571e2-151">Beim Schreiben wir führen zu viele Tests zu vermeiden, dass die einzelnen Tests werden soll.</span><span class="sxs-lookup"><span data-stu-id="571e2-151">When we write tests we want to avoid having the individual tests do too much.</span></span> <span data-ttu-id="571e2-152">Stattdessen sollte jeder Test nur ein einzelnes Konzept überprüfen (wodurch sie viel einfacher, die Ursache der Fehler ermitteln wird).</span><span class="sxs-lookup"><span data-stu-id="571e2-152">Instead each test should verify only a single concept (which will make it much easier to pinpoint the cause of failures).</span></span> <span data-ttu-id="571e2-153">Ein guter Anhaltspunkt ist nur ein einzelnes assert-Anweisung für jeden Test haben.</span><span class="sxs-lookup"><span data-stu-id="571e2-153">A good guideline is to try and only have a single assert statement for each test.</span></span> <span data-ttu-id="571e2-154">Wenn Sie mehr als eine assert-Anweisung in einer Testmethode haben, stellen Sie sicher, dass sie alle verwendet werden, um das gleiche Konzept zu testen.</span><span class="sxs-lookup"><span data-stu-id="571e2-154">If you have more than one assert statement in a test method, make sure they are all being used to test the same concept.</span></span> <span data-ttu-id="571e2-155">Stellen Sie im Zweifelsfall einen anderen Test ein.</span><span class="sxs-lookup"><span data-stu-id="571e2-155">When in doubt, make another test.</span></span>

### <a name="running-tests"></a><span data-ttu-id="571e2-156">Tests werden ausgeführt</span><span class="sxs-lookup"><span data-stu-id="571e2-156">Running Tests</span></span>

<span data-ttu-id="571e2-157">Visual Studio 2008 Professional (und höheren Versionen) umfasst eine integrierte Testprogramm, das zum Ausführen von Visual Studio-Komponententest-Projekten in der IDE verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="571e2-157">Visual Studio 2008 Professional (and higher editions) includes a built-in test runner that can be used to run Visual Studio Unit Test projects within the IDE.</span></span> <span data-ttu-id="571e2-158">Ausgewählt werden können die **Test-&gt;ausführen -&gt;alle Tests in der Projektmappe** Menü Befehlsklasse (oder drücken Sie STRG-R, A) um alle unsere Komponententests auszuführen.</span><span class="sxs-lookup"><span data-stu-id="571e2-158">We can select the **Test-&gt;Run-&gt;All Tests in Solution** menu command (or type Ctrl R, A) to run all of our unit tests.</span></span> <span data-ttu-id="571e2-159">Oder Alternativ können wir unsere Cursor innerhalb einer bestimmten Klasse oder Test Testmethode zu positionieren und Verwenden der **Test-&gt;ausführen -&gt;Tests im aktuellen Kontext** Menübefehl (oder drücken Sie STRG-R, T) eine Teilmenge der Komponententests auszuführen.</span><span class="sxs-lookup"><span data-stu-id="571e2-159">Or alternatively we can position our cursor within a specific test class or test method and use the **Test-&gt;Run-&gt;Tests in Current Context** menu command (or type Ctrl R, T) to run a subset of the unit tests.</span></span>

<span data-ttu-id="571e2-160">Lassen Sie uns position der Cursor innerhalb der DinnerTest-Klasse, und geben Sie "STRG-R, T", führen Sie die beiden Tests, die soeben definiert.</span><span class="sxs-lookup"><span data-stu-id="571e2-160">Let's position our cursor within the DinnerTest class and type "Ctrl R, T" to run the two tests we just defined.</span></span> <span data-ttu-id="571e2-161">Wenn wir ein Fenster "Testergebnisse" dazu in Visual Studio angezeigt werden, und wir sehen die Ergebnisse des Testlaufs darin aufgeführten:</span><span class="sxs-lookup"><span data-stu-id="571e2-161">When we do this a "Test Results" window will appear within Visual Studio and we'll see the results of our test run listed within it:</span></span>

![](enable-automated-unit-testing/_static/image5.png)

<span data-ttu-id="571e2-162">*Hinweis: Visual Studio im Testergebnisfenster wird nicht die Class Name-Spalte wird standardmäßig angezeigt. Sie können dies hinzufügen, indem Sie mit der rechten Maustaste im Fenster Testergebnisse und des Menübefehls für die Spalten hinzufügen/entfernen.*</span><span class="sxs-lookup"><span data-stu-id="571e2-162">*Note: The VS test results window does not show the Class Name column by default. You can add this by right-clicking within the Test Results window and using the Add/Remove Columns menu command.*</span></span>

<span data-ttu-id="571e2-163">Unsere zwei Tests dauerten nur einen Bruchteil einer Sekunde ausgeführt – und finden beide übergeben.</span><span class="sxs-lookup"><span data-stu-id="571e2-163">Our two tests took only a fraction of a second to run – and as you can see they both passed.</span></span> <span data-ttu-id="571e2-164">Wir können jetzt auf und erweitern diese, indem Sie zusätzliche Tests, die spezielle Regel Überprüfungen zu überprüfen, und behandelt die zwei Hilfsmethoden - IsUserHost() und IsUserRegisterd() –, die wir hinzugefügt, dass die Dinner-Klasse zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="571e2-164">We can now go on and augment them by creating additional tests that verify specific rule validations, as well as cover the two helper methods - IsUserHost() and IsUserRegisterd() – that we added to the Dinner class.</span></span> <span data-ttu-id="571e2-165">Wenn alle diese Tests vorhanden, für die Dinner-Klasse wird es viel einfacher und sicherer zu neue Geschäftsregeln und Validierungen in der Zukunft hinzufügen machen.</span><span class="sxs-lookup"><span data-stu-id="571e2-165">Having all these tests in place for the Dinner class will make it much easier and safer to add new business rules and validations to it in the future.</span></span> <span data-ttu-id="571e2-166">Wir können Dinner unsere neue Regellogik hinzu, und Sie können innerhalb von Sekunden stellen Sie sicher, dass sie eine der vorherigen Logik Funktionalität beeinträchtigt noch nicht.</span><span class="sxs-lookup"><span data-stu-id="571e2-166">We can add our new rule logic to Dinner, and then within seconds verify that it hasn't broken any of our previous logic functionality.</span></span>

<span data-ttu-id="571e2-167">Beachten Sie, wie mit einer beschreibenden Testnamen erleichtert Ihnen schnell verstehen, was jeder Test wird überprüft wird.</span><span class="sxs-lookup"><span data-stu-id="571e2-167">Notice how using a descriptive test name makes it easy to quickly understand what each test is verifying.</span></span> <span data-ttu-id="571e2-168">Ich empfehle die Verwendung der **Tools -&gt;Optionen** Menübefehl, öffnen den Test Tools -&gt;Test Execution-Konfigurationsbildschirm, und überprüfen den "durch Doppelklicken auf eine fehlerhafte oder nicht eindeutig Komponententestergebnis zeigt Zeitpunkt des Fehlers im Test"-Kontrollkästchen.</span><span class="sxs-lookup"><span data-stu-id="571e2-168">I recommend using the **Tools-&gt;Options** menu command, opening the Test Tools-&gt;Test Execution configuration screen, and checking the "Double-clicking a failed or inconclusive unit test result displays the point of failure in the test" checkbox.</span></span> <span data-ttu-id="571e2-169">Dadurch können Sie doppelklicken auf einen Fehler im Testergebnisfenster, und fahren Sie direkt mit der Assertionsfehler.</span><span class="sxs-lookup"><span data-stu-id="571e2-169">This will allow you to double-click on a failure in the test results window and jump immediately to the assert failure.</span></span>

### <a name="creating-dinnerscontroller-unit-tests"></a><span data-ttu-id="571e2-170">Erstellen von Komponententests mit "dinnerscontroller"</span><span class="sxs-lookup"><span data-stu-id="571e2-170">Creating DinnersController Unit Tests</span></span>

<span data-ttu-id="571e2-171">Jetzt erstellen wir einige Komponententests, die unsere "dinnerscontroller"-Funktionalität zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="571e2-171">Let's now create some unit tests that verify our DinnersController functionality.</span></span> <span data-ttu-id="571e2-172">Wir beginnen mit der rechten Maustaste auf den Ordner "Controllers" in unserem Test-Projekt und wählen Sie dann die **Add-&gt;neuen Test** Menübefehl.</span><span class="sxs-lookup"><span data-stu-id="571e2-172">We'll start by right-clicking on the "Controllers" folder within our Test project and then choose the **Add-&gt;New Test** menu command.</span></span> <span data-ttu-id="571e2-173">Wir erstellen eine "Unit Test" und nennen Sie es mit "DinnersControllerTest.cs".</span><span class="sxs-lookup"><span data-stu-id="571e2-173">We'll create a "Unit Test" and name it "DinnersControllerTest.cs".</span></span>

<span data-ttu-id="571e2-174">Wir erstellen zwei Testmethoden, die die Aktionsmethode Details(), auf die "dinnerscontroller" zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="571e2-174">We'll create two test methods that verify the Details() action method on the DinnersController.</span></span> <span data-ttu-id="571e2-175">Die erste überprüft, dass eine Sicht zurückgegeben wird, wenn eine vorhandene Dinner angefordert wird.</span><span class="sxs-lookup"><span data-stu-id="571e2-175">The first will verify that a View is returned when an existing Dinner is requested.</span></span> <span data-ttu-id="571e2-176">Die zweite gewährleistet, dass es sich bei eine Ansicht "NotFound" zurückgegeben wird, wenn eine nicht existierende Dinner angefordert wird:</span><span class="sxs-lookup"><span data-stu-id="571e2-176">The second will verify that a "NotFound" view is returned when a non-existent Dinner is requested:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample3.cs)]

<span data-ttu-id="571e2-177">Der obige Code kompiliert bereinigen.</span><span class="sxs-lookup"><span data-stu-id="571e2-177">The above code compiles clean.</span></span> <span data-ttu-id="571e2-178">Wenn die Tests ausgeführt wird, Fehler jedoch beide:</span><span class="sxs-lookup"><span data-stu-id="571e2-178">When we run the tests, though, they both fail:</span></span>

![](enable-automated-unit-testing/_static/image6.png)

<span data-ttu-id="571e2-179">Wenn Sie die Fehlermeldungen betrachten, sehen wir, dass der Grund, der die Tests sind fehlgeschlagen ist, da unsere DinnersRepository-Klasse mit einer Datenbank herstellen konnte.</span><span class="sxs-lookup"><span data-stu-id="571e2-179">If we look at the error messages, we'll see that the reason the tests failed was because our DinnersRepository class was unable to connect to a database.</span></span> <span data-ttu-id="571e2-180">Die NerdDinner-Anwendung verwendet eine Verbindungszeichenfolge in einer lokalen SQL Server Express-Datei die unter der \App lebt\_Datenverzeichnis das Projekt für die NerdDinner-Anwendung.</span><span class="sxs-lookup"><span data-stu-id="571e2-180">Our NerdDinner application is using a connection-string to a local SQL Server Express file which lives under the \App\_Data directory of the NerdDinner application project.</span></span> <span data-ttu-id="571e2-181">Der relativen Pfad-Speicherort, der die Verbindungszeichenfolge ist falsch, da unser NerdDinner.Tests Projekt kompiliert und dann in einem anderen Verzeichnis das Anwendungsprojekt führt.</span><span class="sxs-lookup"><span data-stu-id="571e2-181">Because our NerdDinner.Tests project compiles and runs in a different directory then the application project, the relative path location of our connection-string is incorrect.</span></span>

<span data-ttu-id="571e2-182">Wir *konnte* dies beheben, indem Sie die SQL Express-Datenbankdatei in unserem Testprojekt kopiert, und fügen Sie eine entsprechende Test-Verbindungszeichenfolge hinzu, in der Datei App.config für unser Testprojekt.</span><span class="sxs-lookup"><span data-stu-id="571e2-182">We *could* fix this by copying the SQL Express database file to our test project, and then add an appropriate test connection-string to it in the App.config of our test project.</span></span> <span data-ttu-id="571e2-183">Dadurch erhalten die vorgenannten Tests aufgehoben, und der ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="571e2-183">This would get the above tests unblocked and running.</span></span>

<span data-ttu-id="571e2-184">Komponententests für Code mit einer echten Datenbank enthält jedoch eine Reihe von Herausforderungen.</span><span class="sxs-lookup"><span data-stu-id="571e2-184">Unit testing code using a real database, though, brings with it a number of challenges.</span></span> <span data-ttu-id="571e2-185">Dies gilt insbesondere in folgenden Fällen:</span><span class="sxs-lookup"><span data-stu-id="571e2-185">Specifically:</span></span>

- <span data-ttu-id="571e2-186">Sie verlangsamt erheblich die Ausführungszeit von Komponententests.</span><span class="sxs-lookup"><span data-stu-id="571e2-186">It significantly slows down the execution time of unit tests.</span></span> <span data-ttu-id="571e2-187">Je länger dauert es zum Ausführen von Tests, desto weniger wahrscheinlich sind Sie auf die sie häufig ausführen.</span><span class="sxs-lookup"><span data-stu-id="571e2-187">The longer it takes to run tests, the less likely you are to execute them frequently.</span></span> <span data-ttu-id="571e2-188">Im Idealfall sollten Sie die Komponententests in der Lage, die in Sekunden – ausgeführt werden und werden dies ist als auf natürliche Weise als beim Kompilieren des Projekts.</span><span class="sxs-lookup"><span data-stu-id="571e2-188">Ideally you want your unit tests to be able to be run in seconds – and have it be something you do as naturally as compiling the project.</span></span>
- <span data-ttu-id="571e2-189">Es erschwert die Setup- und Bereinigungsskripts Logik in Tests.</span><span class="sxs-lookup"><span data-stu-id="571e2-189">It complicates the setup and cleanup logic within tests.</span></span> <span data-ttu-id="571e2-190">Jeder Komponententest isoliert und unabhängig von anderen (mit keine Nebenwirkungen oder Abhängigkeiten) werden soll.</span><span class="sxs-lookup"><span data-stu-id="571e2-190">You want each unit test to be isolated and independent of others (with no side effects or dependencies).</span></span> <span data-ttu-id="571e2-191">Beim Arbeiten mit einer echten Datenbank müssen Sie achten Sie darauf, dass Sie Status, und es zwischen Tests zurücksetzen.</span><span class="sxs-lookup"><span data-stu-id="571e2-191">When working against a real database you have to be mindful of state and reset it between tests.</span></span>

<span data-ttu-id="571e2-192">Wir sehen uns ein Entwurfsmuster namens "Dependency Injection", mit denen wir diese Probleme umgehen, und vermeiden, dass eine echte Datenbank mit unseren Tests verwenden kann.</span><span class="sxs-lookup"><span data-stu-id="571e2-192">Let's look at a design pattern called "dependency injection" that can help us work around these issues and avoid the need to use a real database with our tests.</span></span>

### <a name="dependency-injection"></a><span data-ttu-id="571e2-193">Dependency Injection</span><span class="sxs-lookup"><span data-stu-id="571e2-193">Dependency Injection</span></span>

<span data-ttu-id="571e2-194">Zurzeit ist "dinnerscontroller"eng "der Klasse" dinnerrepository "verbunden".</span><span class="sxs-lookup"><span data-stu-id="571e2-194">Right now DinnersController is tightly "coupled" to the DinnerRepository class.</span></span> <span data-ttu-id="571e2-195">"Koppeln" bezieht sich auf eine Situation, in dem eine Klasse explizit in einer anderen Klasse benötigt, um arbeiten:</span><span class="sxs-lookup"><span data-stu-id="571e2-195">"Coupling" refers to a situation where a class explicitly relies on another class in order to work:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample4.cs)]

<span data-ttu-id="571e2-196">Da die Klasse "dinnerrepository" Zugriff auf eine Datenbank erforderlich ist, hat die Verarbeitung eng gekoppelter Abhängigkeit die Klasse "dinnerscontroller" auf "dinnerrepository" Schluss müssen wir eine Datenbank in der Reihenfolge für die Aktionsmethoden "dinnerscontroller" getestet werden.</span><span class="sxs-lookup"><span data-stu-id="571e2-196">Because the DinnerRepository class requires access to a database, the tightly coupled dependency the DinnersController class has on the DinnerRepository ends up requiring us to have a database in order for the DinnersController action methods to be tested.</span></span>

<span data-ttu-id="571e2-197">Wir können Umgehung dieses Problems durch den Einsatz von ein Entwurfsmuster namens "Dependency Injection" – das ist ein Ansatz, in denen Abhängigkeiten (z. B. die Repositoryklassen, die den Datenzugriff zu ermöglichen) nicht mehr implizit in Klassen erstellt werden, die diese verwenden.</span><span class="sxs-lookup"><span data-stu-id="571e2-197">We can get around this by employing a design pattern called "dependency injection" – which is an approach where dependencies (like repository classes that provide data access) are no longer implicitly created within classes that use them.</span></span> <span data-ttu-id="571e2-198">Stattdessen Abhängigkeiten übergeben werden können explizit auf die Klasse, die sie verwendet Konstruktorargumenten verwenden.</span><span class="sxs-lookup"><span data-stu-id="571e2-198">Instead, dependencies can be explicitly passed to the class that uses them using constructor arguments.</span></span> <span data-ttu-id="571e2-199">Wenn die Abhängigkeiten über Schnittstellen definiert sind, haben wir dann die Flexibilität, die in "gefälschtes" Dependency-Implementierungen für Testszenarien Einheit zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="571e2-199">If the dependencies are defined using interfaces, we then have the flexibility to pass in "fake" dependency implementations for unit test scenarios.</span></span> <span data-ttu-id="571e2-200">Dadurch können wir zum Erstellen von Test-spezifischen Abhängigkeit Implementierungen, die eigentlich keinen Zugriff auf eine Datenbank erfordern.</span><span class="sxs-lookup"><span data-stu-id="571e2-200">This enables us to create test-specific dependency implementations that do not actually require access to a database.</span></span>

<span data-ttu-id="571e2-201">Um dies in Aktion zu sehen, implementieren Sie Abhängigkeitsinjektion mit unserer "dinnerscontroller".</span><span class="sxs-lookup"><span data-stu-id="571e2-201">To see this in action, let's implement dependency injection with our DinnersController.</span></span>

#### <a name="extracting-an-idinnerrepository-interface"></a><span data-ttu-id="571e2-202">Extrahieren einer Schnittstelle "idinnerrepository"</span><span class="sxs-lookup"><span data-stu-id="571e2-202">Extracting an IDinnerRepository interface</span></span>

<span data-ttu-id="571e2-203">Im ersten Schritt wird eine neue Schnittstelle für "idinnerrepository" zu erstellen, die den Vertrag Repository, die, den unsere-Controller zu benötigen kapselt, abrufen und Aktualisieren von Dinner, sein.</span><span class="sxs-lookup"><span data-stu-id="571e2-203">Our first step will be to create a new IDinnerRepository interface that encapsulates the repository contract our controllers require to retrieve and update Dinners.</span></span>

<span data-ttu-id="571e2-204">Wir können diese Schnittstellenvertrag manuell definieren, indem mit der rechten Maustaste auf den Ordner "\Models" auswählen und dann die **Add-&gt;neues Element** Menübefehl und eine neue Schnittstelle namens IDinnerRepository.cs erstellen.</span><span class="sxs-lookup"><span data-stu-id="571e2-204">We can define this interface contract manually by right-clicking on the \Models folder, and then choosing the **Add-&gt;New Item** menu command and creating a new interface named IDinnerRepository.cs.</span></span>

<span data-ttu-id="571e2-205">Alternativ können wir verwenden die Umgestaltung Tools integriert in Visual Studio Professional (und höhere Editionen) mit automatisch extrahieren und erstellen Sie eine Schnittstelle für uns von unseren vorhandenen "dinnerrepository"-Klasse.</span><span class="sxs-lookup"><span data-stu-id="571e2-205">Alternatively we can use the refactoring tools built-into Visual Studio Professional (and higher editions) to automatically extract and create an interface for us from our existing DinnerRepository class.</span></span> <span data-ttu-id="571e2-206">Um diese Schnittstelle, die mithilfe von Visual Studio zu extrahieren, einfach positionieren des Cursors im Text-Editor in der Klasse "dinnerrepository", und klicken Sie dann mit der rechten Maustaste und wählen Sie die **Umgestalten -&gt;Schnittstelle extrahieren** Menübefehl:</span><span class="sxs-lookup"><span data-stu-id="571e2-206">To extract this interface using VS, simply position the cursor in the text editor on the DinnerRepository class, and then right-click and choose the **Refactor-&gt;Extract Interface** menu command:</span></span>

![](enable-automated-unit-testing/_static/image7.png)

<span data-ttu-id="571e2-207">Das Dialogfeld "Schnittstelle extrahieren" Öffnen wird und uns für den Namen der Schnittstelle zum Erstellen auffordern.</span><span class="sxs-lookup"><span data-stu-id="571e2-207">This will launch the "Extract Interface" dialog and prompt us for the name of the interface to create.</span></span> <span data-ttu-id="571e2-208">Es wird standardmäßig auf "idinnerrepository", und wählen Sie automatisch alle öffentliche Methoden für die vorhandene "dinnerrepository"-Klasse, die Schnittstelle hinzu:</span><span class="sxs-lookup"><span data-stu-id="571e2-208">It will default to IDinnerRepository and automatically select all public methods on the existing DinnerRepository class to add to the interface:</span></span>

![](enable-automated-unit-testing/_static/image8.png)

<span data-ttu-id="571e2-209">Wenn wir auf die Schaltfläche "ok" klicken, wird Visual Studio eine neue Schnittstelle für "idinnerrepository" der Anwendung hinzugefügt:</span><span class="sxs-lookup"><span data-stu-id="571e2-209">When we click the "ok" button, Visual Studio will add a new IDinnerRepository interface to our application:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample5.cs)]

<span data-ttu-id="571e2-210">Und unsere vorhandenen "dinnerrepository"-Klasse aktualisiert werden, sodass sie die Schnittstelle implementiert:</span><span class="sxs-lookup"><span data-stu-id="571e2-210">And our existing DinnerRepository class will be updated so that it implements the interface:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample6.cs)]

#### <a name="updating-dinnerscontroller-to-support-constructor-injection"></a><span data-ttu-id="571e2-211">Aktualisieren von "dinnerscontroller" zur Unterstützung der Konstruktorinjektion</span><span class="sxs-lookup"><span data-stu-id="571e2-211">Updating DinnersController to support constructor injection</span></span>

<span data-ttu-id="571e2-212">Wir führen nun die DinnersController-Klasse, um die neue Schnittstelle verwenden.</span><span class="sxs-lookup"><span data-stu-id="571e2-212">We'll now update the DinnersController class to use the new interface.</span></span>

<span data-ttu-id="571e2-213">Derzeit "dinnerscontroller" hartcodiert, das Feld "DinnerRepository" immer eine DinnerRepository-Klasse ist:</span><span class="sxs-lookup"><span data-stu-id="571e2-213">Currently DinnersController is hard-coded such that its "dinnerRepository" field is always a DinnerRepository class:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample7.cs)]

<span data-ttu-id="571e2-214">Wir werden es so, dass das Feld "DinnerRepository" vom Typ "idinnerrepository" anstelle von "dinnerrepository" ändern.</span><span class="sxs-lookup"><span data-stu-id="571e2-214">We'll change it so that the "dinnerRepository" field is of type IDinnerRepository instead of DinnerRepository.</span></span> <span data-ttu-id="571e2-215">Wir werden dann zwei öffentliche Konstruktoren von "dinnerscontroller" hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="571e2-215">We'll then add two public DinnersController constructors.</span></span> <span data-ttu-id="571e2-216">Einer der Konstruktoren kann es sich um ein "idinnerrepository" als Argument übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="571e2-216">One of the constructors allows an IDinnerRepository to be passed as an argument.</span></span> <span data-ttu-id="571e2-217">Die andere ist eine Standard-Konstruktor, der die vorhandene Implementierung von "dinnerrepository" verwendet:</span><span class="sxs-lookup"><span data-stu-id="571e2-217">The other is a default constructor that uses our existing DinnerRepository implementation:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample8.cs)]

<span data-ttu-id="571e2-218">Da ASP.NET MVC standardmäßig die Controller-Klassen mit Standardkonstruktoren erstellt, unsere "dinnerscontroller" zur Laufzeit die Klasse "dinnerrepository" verwenden weiterhin auf Daten zugreift.</span><span class="sxs-lookup"><span data-stu-id="571e2-218">Because ASP.NET MVC by default creates controller classes using default constructors, our DinnersController at runtime will continue to use the DinnerRepository class to perform data access.</span></span>

<span data-ttu-id="571e2-219">Wir können unsere Komponententests, allerdings jetzt aktualisieren, um ein "gefälschtes" Dinner-Repository-Implementierung, die mit dem parameterkonstruktor übergeben.</span><span class="sxs-lookup"><span data-stu-id="571e2-219">We can now update our unit tests, though, to pass in a "fake" dinner repository implementation using the parameter constructor.</span></span> <span data-ttu-id="571e2-220">Dieses Repository "gefälschtes" Dinner muss nicht den Zugriff auf eine echte Datenbank, und verwenden stattdessen Beispiel zu in-Memory-Daten.</span><span class="sxs-lookup"><span data-stu-id="571e2-220">This "fake" dinner repository will not require access to a real database, and instead will use in-memory sample data.</span></span>

#### <a name="creating-the-fakedinnerrepository-class"></a><span data-ttu-id="571e2-221">Erstellen der FakeDinnerRepository-Klasse</span><span class="sxs-lookup"><span data-stu-id="571e2-221">Creating the FakeDinnerRepository class</span></span>

<span data-ttu-id="571e2-222">Wir erstellen eine FakeDinnerRepository-Klasse.</span><span class="sxs-lookup"><span data-stu-id="571e2-222">Let's create a FakeDinnerRepository class.</span></span>

<span data-ttu-id="571e2-223">Wir beginnen mit dem Erstellen eines "Fakes"-Verzeichnisses, in unserem NerdDinner.Tests-Projekt und klicken Sie dann eine neue FakeDinnerRepository-Klasse hinzugefügt (mit der rechten Maustaste auf den Ordner, und wählen Sie **Add-&gt;neue Klasse**):</span><span class="sxs-lookup"><span data-stu-id="571e2-223">We'll begin by creating a "Fakes" directory within our NerdDinner.Tests project and then add a new FakeDinnerRepository class to it (right-click on the folder and choose **Add-&gt;New Class**):</span></span>

![](enable-automated-unit-testing/_static/image9.png)

<span data-ttu-id="571e2-224">Wir aktualisieren den Code, damit die FakeDinnerRepository-Klasse, die "idinnerrepository"-Schnittstelle implementiert.</span><span class="sxs-lookup"><span data-stu-id="571e2-224">We'll update the code so that the FakeDinnerRepository class implements the IDinnerRepository interface.</span></span> <span data-ttu-id="571e2-225">Wir können dann mit der rechten Maustaste darauf und wählen Sie den Befehl im Kontextmenü "Schnittstelle implementieren" idinnerrepository"":</span><span class="sxs-lookup"><span data-stu-id="571e2-225">We can then right-click on it and choose the "Implement interface IDinnerRepository" context menu command:</span></span>

![](enable-automated-unit-testing/_static/image10.png)

<span data-ttu-id="571e2-226">Dies bewirkt, dass Visual Studio automatisch alle den Schnittstellenmember "idinnerrepository" unserer Klasse FakeDinnerRepository mit standardimplementierungen "Abriss" hinzuzufügen:</span><span class="sxs-lookup"><span data-stu-id="571e2-226">This will cause Visual Studio to automatically add all of the IDinnerRepository interface members to our FakeDinnerRepository class with default "stub out" implementations:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample9.cs)]

<span data-ttu-id="571e2-227">Wir können dann die FakeDinnerRepository-Implementierung funktioniert nicht in einer in-Memory-Liste aktualisieren&lt;Dinner&gt; Auflistung als Konstruktorargument übergeben:</span><span class="sxs-lookup"><span data-stu-id="571e2-227">We can then update the FakeDinnerRepository implementation to work off of an in-memory List&lt;Dinner&gt; collection passed to it as a constructor argument:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample10.cs)]

<span data-ttu-id="571e2-228">Wir haben jetzt eine Fakeimplementierung "idinnerrepository", die eine Datenbank ist nicht erforderlich, und stattdessen aus einer in-Memory-Liste von Dinner-Objekten arbeiten kann.</span><span class="sxs-lookup"><span data-stu-id="571e2-228">We now have a fake IDinnerRepository implementation that does not require a database, and can instead work off an in-memory list of Dinner objects.</span></span>

#### <a name="using-the-fakedinnerrepository-with-unit-tests"></a><span data-ttu-id="571e2-229">Verwenden die FakeDinnerRepository mit Komponententests</span><span class="sxs-lookup"><span data-stu-id="571e2-229">Using the FakeDinnerRepository with Unit Tests</span></span>

<span data-ttu-id="571e2-230">Kehren wir zurück zu "dinnerscontroller" Komponententests, die zuvor aufgrund die Datenbank nicht verfügbar war.</span><span class="sxs-lookup"><span data-stu-id="571e2-230">Let's return to the DinnersController unit tests that failed earlier because the database wasn't available.</span></span> <span data-ttu-id="571e2-231">Wir können die Testmethoden, die Verwendung einer FakeDinnerRepository mit Beispieldaten im Arbeitsspeicher Dinner, die anhand des folgenden Codes "dinnerscontroller" aufgefüllt aktualisieren:</span><span class="sxs-lookup"><span data-stu-id="571e2-231">We can update the test methods to use a FakeDinnerRepository populated with sample in-memory Dinner data to the DinnersController using the code below:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample11.cs)]

<span data-ttu-id="571e2-232">Und nun, wenn wir diese Tests werden ausgeführt, die beide übergeben:</span><span class="sxs-lookup"><span data-stu-id="571e2-232">And now when we run these tests they both pass:</span></span>

![](enable-automated-unit-testing/_static/image11.png)

<span data-ttu-id="571e2-233">Das beste daran, sie nur einen Bruchteil einer Sekunde ausgeführt werden und komplexe Einrichtung/Bereinigungslogik ist nicht erforderlich.</span><span class="sxs-lookup"><span data-stu-id="571e2-233">Best of all, they take only a fraction of a second to run, and do not require any complicated setup/cleanup logic.</span></span> <span data-ttu-id="571e2-234">Wir können nun alle unsere "dinnerscontroller"-Methodencode für die Aktion (einschließlich auflisten, Paginierung, Informationen zu erstellen, aktualisieren und löschen) bei Komponententests ohne jemals eine Verbindung mit einer echten Datenbank herstellen.</span><span class="sxs-lookup"><span data-stu-id="571e2-234">We can now unit test all of our DinnersController action method code (including listing, paging, details, create, update and delete) without ever needing to connect to a real database.</span></span>

| <span data-ttu-id="571e2-235">**Seite Thema: Abhängigkeitsinjektionsframeworks**</span><span class="sxs-lookup"><span data-stu-id="571e2-235">**Side Topic: Dependency Injection Frameworks**</span></span> |
| --- |
| <span data-ttu-id="571e2-236">Ausführen von manuellen Abhängigkeitsinjektion (wie wir oben) funktioniert, jedoch wird schwieriger zu verwalten als die Anzahl der Abhängigkeiten, und Komponenten in einer Anwendung steigt.</span><span class="sxs-lookup"><span data-stu-id="571e2-236">Performing manual dependency injection (like we are above) works fine, but does become harder to maintain as the number of dependencies and components in an application increases.</span></span> <span data-ttu-id="571e2-237">Mehrere abhängigkeitsinjektionsframeworks sind für .NET, die bieten größere Flexibilität bei der Verwaltung von Abhängigkeiten vorhanden.</span><span class="sxs-lookup"><span data-stu-id="571e2-237">Several dependency injection frameworks exist for .NET that can help provide even more dependency management flexibility.</span></span> <span data-ttu-id="571e2-238">Diesen Frameworks können die manchmal auch genannt "Inversion of Control" (IoC) Container, bieten Mechanismen, die eine zusätzliche Ebene der Unterstützung für angeben, und übergeben Abhängigkeiten für Objekte zur Laufzeit (mit den meisten Fällen Konstruktorinjektion die Konfiguration zu aktivieren. ).</span><span class="sxs-lookup"><span data-stu-id="571e2-238">These frameworks, also sometimes called "Inversion of Control" (IoC) containers, provide mechanisms that enable an additional level of configuration support for specifying and passing dependencies to objects at runtime (most often using constructor injection).</span></span> <span data-ttu-id="571e2-239">Einige der gängigen OSS Dependency Injection / IOC-Frameworks in .NET include: AutoFac, Ninject, Spring.NET, StructureMap und Windsor.</span><span class="sxs-lookup"><span data-stu-id="571e2-239">Some of the more popular OSS Dependency Injection / IOC frameworks in .NET include: AutoFac, Ninject, Spring.NET, StructureMap, and Windsor.</span></span> <span data-ttu-id="571e2-240">ASP.NET MVC macht Erweiterbarkeits-APIs, mit denen Entwickler zur Teilnahme an der Auflösung und Instanziierung von Controllern und dem Dependency Injection ermöglicht / IoC-Frameworks, die innerhalb dieses Prozesses ordnungsgemäß integriert werden.</span><span class="sxs-lookup"><span data-stu-id="571e2-240">ASP.NET MVC exposes extensibility APIs that enable developers to participate in the resolution and instantiation of controllers, and which enables Dependency Injection / IoC frameworks to be cleanly integrated within this process.</span></span> <span data-ttu-id="571e2-241">Mit einem DI/IOC-Framework würde auch können wir den Standardkonstruktor aus unserer "dinnerscontroller" – zu entfernen, wodurch die Kopplung zwischen ihnen und dem DinnerRepositorys vollständig zu entfernen, würde.</span><span class="sxs-lookup"><span data-stu-id="571e2-241">Using a DI/IOC framework would also enable us to remove the default constructor from our DinnersController – which would completely remove the coupling between it and the DinnerRepositorys.</span></span> <span data-ttu-id="571e2-242">Wir verwenden nicht die eine Abhängigkeitsinjektion / IOC-Framework mit unserer NerdDinner-Anwendung.</span><span class="sxs-lookup"><span data-stu-id="571e2-242">We won't be using a dependency injection / IOC framework with our NerdDinner application.</span></span> <span data-ttu-id="571e2-243">Aber es ist etwas, das wir für die Zukunft verwenden können, wenn die NerdDinner-Codebasis und Funktionen vergrößert wurde.</span><span class="sxs-lookup"><span data-stu-id="571e2-243">But it is something we could consider for the future if the NerdDinner code-base and capabilities grew.</span></span> |

### <a name="creating-edit-action-unit-tests"></a><span data-ttu-id="571e2-244">Erstellen von Komponententests für Edit-Aktion</span><span class="sxs-lookup"><span data-stu-id="571e2-244">Creating Edit Action Unit Tests</span></span>

<span data-ttu-id="571e2-245">Jetzt erstellen wir einige Komponententests, die die Funktionalität Bearbeiten der "dinnerscontroller" zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="571e2-245">Let's now create some unit tests that verify the Edit functionality of the DinnersController.</span></span> <span data-ttu-id="571e2-246">Wir beginnen mit die HTTP-GET-Version von unserem Bearbeitungsaktion testen:</span><span class="sxs-lookup"><span data-stu-id="571e2-246">We'll start by testing the HTTP-GET version of our Edit action:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample12.cs)]

<span data-ttu-id="571e2-247">Wir erstellen einen Test, der überprüft, ob eine Ansicht unterstützt, die von einem Objekt DinnerFormViewModel gerendert wird, zurück, wenn Sie eine gültige Dinner angefordert wird:</span><span class="sxs-lookup"><span data-stu-id="571e2-247">We'll create a test that verifies that a View backed by a DinnerFormViewModel object is rendered back when a valid dinner is requested:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample13.cs)]

<span data-ttu-id="571e2-248">Wenn den Test ausgeführt wird, jedoch feststellen wir, dass es schlägt fehl, weil eine null-Verweis-Ausnahme ausgelöst wird, wenn Edit-Methode die Eigenschaft "User.Identity.Name" zum Ausführen der Dinner.IsHostedBy() zugreift.</span><span class="sxs-lookup"><span data-stu-id="571e2-248">When we run the test, though, we'll find that it fails because a null reference exception is thrown when the Edit method accesses the User.Identity.Name property to perform the Dinner.IsHostedBy() check.</span></span>

<span data-ttu-id="571e2-249">Die User-Objekt, auf der Basis-Controllerklasse kapselt Informationen über den angemeldeten Benutzer, und wird von ASP.NET MVC aufgefüllt, wenn es sich bei den Controller zur Laufzeit erstellt.</span><span class="sxs-lookup"><span data-stu-id="571e2-249">The User object on the Controller base class encapsulates details about the logged-in user, and is populated by ASP.NET MVC when it creates the controller at runtime.</span></span> <span data-ttu-id="571e2-250">Da wir den "dinnerscontroller" außerhalb einer Web-Server-Umgebung testen, das Benutzerobjekt nicht festgelegt (daher der nullverweisausnahme auftreten).</span><span class="sxs-lookup"><span data-stu-id="571e2-250">Because we are testing the DinnersController outside of a web-server environment, the User object isn't set (hence the null reference exception).</span></span>

### <a name="mocking-the-useridentityname-property"></a><span data-ttu-id="571e2-251">Simulieren der User.Identity.Name-Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="571e2-251">Mocking the User.Identity.Name property</span></span>

<span data-ttu-id="571e2-252">Mockframeworks erleichtern des Testens durch Aktivieren der falsche Versionen abhängiger Objekte dynamisch zu erstellen, die unseren Tests zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="571e2-252">Mocking frameworks make testing easier by enabling us to dynamically create fake versions of dependent objects that support our tests.</span></span> <span data-ttu-id="571e2-253">Beispielsweise können wir ein Mockframework im Test-Aktion Bearbeiten verwenden, um dynamisch ein Benutzerobjekt zu erstellen, die unsere "dinnerscontroller" verwenden können, um eine simulierte Benutzername suchen.</span><span class="sxs-lookup"><span data-stu-id="571e2-253">For example, we can use a mocking framework in our Edit action test to dynamically create a User object that our DinnersController can use to lookup a simulated username.</span></span> <span data-ttu-id="571e2-254">Dadurch wird vermieden, dass einen null-Verweis ausgelöst wird, wenn wir unseren Test ausführen.</span><span class="sxs-lookup"><span data-stu-id="571e2-254">This will avoid a null reference from being thrown when we run our test.</span></span>

<span data-ttu-id="571e2-255">Es gibt viele .NET mocking-Frameworks, die mit ASP.NET MVC verwendet werden können (Sie finden eine Liste von ihnen hier: [ http://www.mockframeworks.com/ ](http://www.mockframeworks.com/)).</span><span class="sxs-lookup"><span data-stu-id="571e2-255">There are many .NET mocking frameworks that can be used with ASP.NET MVC (you can see a list of them here: [http://www.mockframeworks.com/](http://www.mockframeworks.com/)).</span></span> <span data-ttu-id="571e2-256">Zum Testen unserer verwenden wir eine open Source-Framework namens "Moq" mocking NerdDinner-Anwendung, die heruntergeladen werden kann kostenlos von [ http://www.mockframeworks.com/moq ](http://www.mockframeworks.com/moq).</span><span class="sxs-lookup"><span data-stu-id="571e2-256">For testing our NerdDinner application we'll use an open source mocking framework called "Moq", which can be downloaded for free from [http://www.mockframeworks.com/moq](http://www.mockframeworks.com/moq).</span></span>

<span data-ttu-id="571e2-257">Nach dem Herunterladen, fügen einen Verweis in unserem NerdDinner.Tests-Projekt auf die Assembly Moq.dll wir:</span><span class="sxs-lookup"><span data-stu-id="571e2-257">Once downloaded, we'll add a reference in our NerdDinner.Tests project to the Moq.dll assembly:</span></span>

![](enable-automated-unit-testing/_static/image12.png)

<span data-ttu-id="571e2-258">Wir fügen klicken Sie dann eine Hilfsmethode "CreateDinnersControllerAs(username)" für unseren Testklasse, die einen Benutzernamen als Parameter an, und die verwendet werden. anschließend "mocks" die Eigenschaft "User.Identity.Name" auf der Instanz von "dinnerscontroller":</span><span class="sxs-lookup"><span data-stu-id="571e2-258">We'll then add a "CreateDinnersControllerAs(username)" helper method to our test class that takes a username as a parameter, and which then "mocks" the User.Identity.Name property on the DinnersController instance:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample14.cs)]

<span data-ttu-id="571e2-259">Oben verwenden wir Moq, um ein Mock-Objekt zu erstellen, die fakes-ein ControllerContext-Objekt (das ist was ASP.NET MVC zu Controllerklassen Common Language Runtime-Objekte, z. B. Benutzer, Anforderung, Antwort und -Sitzung verfügbar zu machen übergibt).</span><span class="sxs-lookup"><span data-stu-id="571e2-259">Above we are using Moq to create a Mock object that fakes a ControllerContext object (which is what ASP.NET MVC passes to Controller classes to expose runtime objects like User, Request, Response, and Session).</span></span> <span data-ttu-id="571e2-260">Wir sind Aufrufen der Methode "SetupGet" für das Mock, um anzugeben, dass die Eigenschaft HttpContext.User.Identity.Name ControllerContext die Benutzernamen-Zeichenfolge zurückgeben soll, die wir an die Hilfsmethode übergeben.</span><span class="sxs-lookup"><span data-stu-id="571e2-260">We are calling the "SetupGet" method on the Mock to indicate that the HttpContext.User.Identity.Name property on ControllerContext should return the username string we passed to the helper method.</span></span>

<span data-ttu-id="571e2-261">Wir können eine beliebige Anzahl von ControllerContext Eigenschaften und Methoden simulieren.</span><span class="sxs-lookup"><span data-stu-id="571e2-261">We can mock any number of ControllerContext properties and methods.</span></span> <span data-ttu-id="571e2-262">Um dies zu veranschaulichen habe ich auch hinzugefügt einen SetupGet()-Aufruf für die Request.IsAuthenticated-Eigenschaft (die nicht tatsächlich benötigt für die folgenden – Tests aber wodurch veranschaulichen, wie Sie die Anforderungseigenschaften simulieren können).</span><span class="sxs-lookup"><span data-stu-id="571e2-262">To illustrate this I've also added a SetupGet() call for the Request.IsAuthenticated property (which isn't actually needed for the tests below – but which helps illustrate how you can mock Request properties).</span></span> <span data-ttu-id="571e2-263">Wenn wir fertig sind fügen wir die gibt die Hilfsmethode "dinnerscontroller" eine Instanz des Mock ControllerContext zuweisen.</span><span class="sxs-lookup"><span data-stu-id="571e2-263">When we are done we assign an instance of the ControllerContext mock to the DinnersController our helper method returns.</span></span>

<span data-ttu-id="571e2-264">Wir können nun die Komponententests schreiben, die diese Hilfsmethode verwenden, um bearbeiten-Szenarios, die im Zusammenhang mit anderen Benutzern zu testen:</span><span class="sxs-lookup"><span data-stu-id="571e2-264">We can now write unit tests that use this helper method to test Edit scenarios involving different users:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample15.cs)]

<span data-ttu-id="571e2-265">Und wenn wir die Tests ausführen jetzt übertragen:</span><span class="sxs-lookup"><span data-stu-id="571e2-265">And now when we run the tests they pass:</span></span>

![](enable-automated-unit-testing/_static/image13.png)

### <a name="testing-updatemodel-scenarios"></a><span data-ttu-id="571e2-266">UpdateModel() Testszenarien</span><span class="sxs-lookup"><span data-stu-id="571e2-266">Testing UpdateModel() scenarios</span></span>

<span data-ttu-id="571e2-267">Wir haben die Tests erstellt, die die HTTP-GET-Version, der die Bearbeitungsaktion abdecken.</span><span class="sxs-lookup"><span data-stu-id="571e2-267">We've created tests that cover the HTTP-GET version of the Edit action.</span></span> <span data-ttu-id="571e2-268">Als Nächstes erstellen wir einige Tests, die die HTTP-POST-Version von der Aktion "Bearbeiten" zu überprüfen:</span><span class="sxs-lookup"><span data-stu-id="571e2-268">Let's now create some tests that verify the HTTP-POST version of the Edit action:</span></span>

[!code-csharp[Main](enable-automated-unit-testing/samples/sample16.cs)]

<span data-ttu-id="571e2-269">Das interessante neue Tests Szenario für die Unterstützung von mit dieser Aktionsmethode ist die Nutzung der UpdateModel() Hilfsmethode für die Controller-Basisklasse.</span><span class="sxs-lookup"><span data-stu-id="571e2-269">The interesting new testing scenario for us to support with this action method is its usage of the UpdateModel() helper method on the Controller base class.</span></span> <span data-ttu-id="571e2-270">Wir werden diese Hilfsmethode verwenden, um die Formular-Post-Werte an unsere Dinner Objekt zu binden.</span><span class="sxs-lookup"><span data-stu-id="571e2-270">We are using this helper method to bind form-post values to our Dinner object instance.</span></span>

<span data-ttu-id="571e2-271">Im folgenden finden Sie zwei Tests, die zeigt, wie wir Formular bereitgestellt Werte für die UpdateModel()-Hilfsmethode verwendet bereitstellen können.</span><span class="sxs-lookup"><span data-stu-id="571e2-271">Below are two tests that demonstrates how we can supply form posted values for the UpdateModel() helper method to use.</span></span> <span data-ttu-id="571e2-272">Wir zu diesem Zweck erstellen und Auffüllen einer FormCollection-Objekt, und klicken Sie dann die Eigenschaft "ValueProvider" auf dem Controller zuweisen.</span><span class="sxs-lookup"><span data-stu-id="571e2-272">We'll do this by creating and populating a FormCollection object, and then assign it to the "ValueProvider" property on the Controller.</span></span>

<span data-ttu-id="571e2-273">Der erste Test überprüft, dass auf einen erfolgreichen Speichervorgang der Browser, um die Details-Aktion umgeleitet wird.</span><span class="sxs-lookup"><span data-stu-id="571e2-273">The first test verifies that on a successful save the browser is redirected to the details action.</span></span> <span data-ttu-id="571e2-274">Im zweite Test wird überprüft, wenn ungültige Eingabe gepostet wird die Aktion die Bearbeitungsansicht erneut mit einer Fehlermeldung erneut angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="571e2-274">The second test verifies that when invalid input is posted the action redisplays the edit view again with an error message.</span></span>


[!code-csharp[Main](enable-automated-unit-testing/samples/sample17.cs)]

### <a name="testing-wrap-up"></a><span data-ttu-id="571e2-275">Testen die Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="571e2-275">Testing Wrap-Up</span></span>

<span data-ttu-id="571e2-276">Wir haben die grundlegenden Konzepte Unit Test Controller-Klassen beteiligt behandelt.</span><span class="sxs-lookup"><span data-stu-id="571e2-276">We've covered the core concepts involved in unit testing controller classes.</span></span> <span data-ttu-id="571e2-277">Wir können diese Techniken verwenden, auf einfache Weise auf Hunderte von einfachen Tests erstellen, die das Verhalten der Anwendung zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="571e2-277">We can use these techniques to easily create hundreds of simple tests that verify the behavior of our application.</span></span>

<span data-ttu-id="571e2-278">Da es sich bei unseren Controller und den Modell-Tests nicht über eine echte Datenbank benötigen, sind sie sehr schnell und einfach ausführen.</span><span class="sxs-lookup"><span data-stu-id="571e2-278">Because our controller and model tests do not require a real database, they are extremely fast and easy to run.</span></span> <span data-ttu-id="571e2-279">Wir werden Hunderte von automatisierten Tests in Sekunden ausgeführt und erhalten Sie unmittelbar Feedback, etwas unterbrochen, ob eine Änderung, die wir vorgenommen wurde.</span><span class="sxs-lookup"><span data-stu-id="571e2-279">We'll be able to execute hundreds of automated tests in seconds, and immediately get feedback as to whether a change we made broke something.</span></span> <span data-ttu-id="571e2-280">Dies hilft uns die Gewissheit kontinuierlich zu verbessern, Umgestaltung und verfeinern die Anwendung bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="571e2-280">This will help provide us the confidence to continually improve, refactor, and refine our application.</span></span>

<span data-ttu-id="571e2-281">Wir betroffenen Tests als im letzten Thema in diesem Kapitel – aber nicht, da das Testen etwas ist tun Sie am Ende einen Entwicklungsprozess!</span><span class="sxs-lookup"><span data-stu-id="571e2-281">We covered testing as the last topic in this chapter – but not because testing is something you should do at the end of a development process!</span></span> <span data-ttu-id="571e2-282">Im Gegenteil, sollten Sie die automatisierten Tests in Ihren Entwicklungsprozess so früh wie möglich schreiben.</span><span class="sxs-lookup"><span data-stu-id="571e2-282">On the contrary, you should write automated tests as early as possible in your development process.</span></span> <span data-ttu-id="571e2-283">Dies ermöglicht daher unmittelbares Feedback erhalten, wie Sie entwickelt haben, können Sie die anwendungsfallszenarien für Ihre Anwendung so zuvorkommend denken, und führt Sie zum Entwerfen Ihrer Anwendung mit die saubere Schichten und denken Sie daran gekoppelt.</span><span class="sxs-lookup"><span data-stu-id="571e2-283">Doing so enables you to get immediate feedback as you develop, helps you think thoughtfully about your application's use case scenarios, and guides you to design your application with clean layering and coupling in mind.</span></span>

<span data-ttu-id="571e2-284">Eine der folgenden Kapitel in dem Buch besprechen (Test Driven Development, TDD), und wie sie mit ASP.NET MVC zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="571e2-284">A later chapter in the book will discuss Test Driven Development (TDD), and how to use it with ASP.NET MVC.</span></span> <span data-ttu-id="571e2-285">Testgesteuerte Entwicklung ist eine iterative Programmierstil, Schreiben Sie zuerst die Tests, die sich ergebende Code erfüllt.</span><span class="sxs-lookup"><span data-stu-id="571e2-285">TDD is an iterative coding practice where you first write the tests that your resulting code will satisfy.</span></span> <span data-ttu-id="571e2-286">Mit TDD zunächst erstellen Sie jede Funktion einen Test, der die Funktionalität wird, die Sie überprüft nun zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="571e2-286">With TDD you begin each feature by creating a test that verifies the functionality you are about to implement.</span></span> <span data-ttu-id="571e2-287">Schreiben der Einheit Test zuerst trägt dazu bei, dass Sie eindeutig verstehen, die Funktion und wie sie funktionieren soll.</span><span class="sxs-lookup"><span data-stu-id="571e2-287">Writing the unit test first helps ensure that you clearly understand the feature and how it is supposed to work.</span></span> <span data-ttu-id="571e2-288">Nur, nachdem der Test wird geschrieben (und Sie überprüft haben, dass ein Fehler auftritt) führen Sie dann implementieren Sie die eigentliche Funktionalität, die der Test überprüft.</span><span class="sxs-lookup"><span data-stu-id="571e2-288">Only after the test is written (and you have verified that it fails) do you then implement the actual functionality the test verifies.</span></span> <span data-ttu-id="571e2-289">Da Sie bereits gearbeitet, haben Zeit Gedanken über den Anwendungsfall wie das Feature funktionieren soll, müssen Sie ein besseres Verständnis der Anforderungen und ihre Implementierung wie am besten.</span><span class="sxs-lookup"><span data-stu-id="571e2-289">Because you've already spent time thinking about the use case of how the feature is supposed to work, you will have a better understanding of the requirements and how best to implement them.</span></span> <span data-ttu-id="571e2-290">Wenn Sie mit der Implementierung fertig sind, Sie führen Sie die Tests erneut aus, und erhalten unmittelbar Feedback zu können, ob das Feature ordnungsgemäß funktioniert.</span><span class="sxs-lookup"><span data-stu-id="571e2-290">When you are done with the implementation you can re-run the test – and get immediate feedback as to whether the feature works correctly.</span></span> <span data-ttu-id="571e2-291">Genau darum TDD in Kapitel 10.</span><span class="sxs-lookup"><span data-stu-id="571e2-291">We'll cover TDD more in Chapter 10.</span></span>

### <a name="next-step"></a><span data-ttu-id="571e2-292">Nächster Schritt</span><span class="sxs-lookup"><span data-stu-id="571e2-292">Next Step</span></span>

<span data-ttu-id="571e2-293">Einige abschließende Wrap von Kommentaren.</span><span class="sxs-lookup"><span data-stu-id="571e2-293">Some final wrap up comments.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="571e2-294">[Zurück](use-ajax-to-implement-mapping-scenarios.md)
> [Weiter](nerddinner-wrap-up.md)</span><span class="sxs-lookup"><span data-stu-id="571e2-294">[Previous](use-ajax-to-implement-mapping-scenarios.md)
[Next](nerddinner-wrap-up.md)</span></span>
