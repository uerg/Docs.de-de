---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb
title: Überprüfen von Ereignissen im Zusammenhang mit einfügen, aktualisieren und löschen (VB) | Microsoft-Dokumentation
author: rick-anderson
description: In diesem Tutorial untersuchen wir werden mit den Ereignissen, die vor, während und nach einer Einfügung auftreten, aktualisieren oder Löschen von ASP.NET-Daten in einem Web-Steuerelement. W...
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/17/2006
ms.topic: article
ms.assetid: c9bd10a7-eff8-4d8c-bec9-963c2aef2d6e
ms.technology: dotnet-webforms
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb
msc.type: authoredcontent
ms.openlocfilehash: 483ff296bb6fcda14c224c085fc87209bb548700
ms.sourcegitcommit: 953ff9ea4369f154d6fd0239599279ddd3280009
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 07/03/2018
ms.locfileid: "37387909"
---
<a name="examining-the-events-associated-with-inserting-updating-and-deleting-vb"></a><span data-ttu-id="b5492-104">Untersuchen von Ereignissen im Zusammenhang mit einfügen, aktualisieren und löschen (VB)</span><span class="sxs-lookup"><span data-stu-id="b5492-104">Examining the Events Associated with Inserting, Updating, and Deleting (VB)</span></span>
====================
<span data-ttu-id="b5492-105">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="b5492-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="b5492-106">[Beispiel-App herunter](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_17_VB.exe) oder [PDF-Datei herunterladen](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/datatutorial17vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="b5492-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_17_VB.exe) or [Download PDF](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/datatutorial17vb1.pdf)</span></span>

> <span data-ttu-id="b5492-107">In diesem Tutorial untersuchen wir werden mit den Ereignissen, die vor, während und nach einer Einfügung auftreten, aktualisieren oder Löschen von ASP.NET-Daten in einem Web-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="b5492-107">In this tutorial we'll examine using the events that occur before, during, and after an insert, update, or delete operation of an ASP.NET data Web control.</span></span> <span data-ttu-id="b5492-108">Wir sehen auch die Bearbeitung-Schnittstelle, um nur eine Teilmenge der Felder Product aktualisieren anpassen.</span><span class="sxs-lookup"><span data-stu-id="b5492-108">We'll also see how to customize the editing interface to only update a subset of the product fields.</span></span>


## <a name="introduction"></a><span data-ttu-id="b5492-109">Einführung</span><span class="sxs-lookup"><span data-stu-id="b5492-109">Introduction</span></span>

<span data-ttu-id="b5492-110">Wenn Sie die integrierten einfügen, bearbeiten oder löschen die Features der GridView, DetailsView oder FormView-Steuerelemente verwenden, die eine Vielzahl von Schritten eintritt, nach Abschluss des Prozesses einen neuen Datensatz hinzufügen, aktualisieren oder Löschen eines vorhandenen Datensatzes durch den Endbenutzer.</span><span class="sxs-lookup"><span data-stu-id="b5492-110">When using the built-in inserting, editing, or deleting features of the GridView, DetailsView, or FormView controls, a variety of steps transpire when the end user completes the process of adding a new record or updating or deleting an existing record.</span></span> <span data-ttu-id="b5492-111">Wie wir unter den [vorherigen Tutorial](an-overview-of-inserting-updating-and-deleting-data-vb.md), wenn eine Zeile in der GridView-Ansicht die Schaltfläche "Bearbeiten bearbeitet wird" wird ersetzt durch Schaltflächen "Update" und "Abbrechen", und die BoundFields aktivieren in Textfelder ein.</span><span class="sxs-lookup"><span data-stu-id="b5492-111">As we discussed in the [previous tutorial](an-overview-of-inserting-updating-and-deleting-data-vb.md), when a row is edited in the GridView the Edit button is replaced by Update and Cancel buttons and the BoundFields turn into TextBoxes.</span></span> <span data-ttu-id="b5492-112">Nachdem der Endbenutzer die Daten aktualisiert und Update klickt, werden die folgenden Schritte beim Postback ausgeführt:</span><span class="sxs-lookup"><span data-stu-id="b5492-112">After the end user updates the data and clicks Update, the following steps are performed on postback:</span></span>

1. <span data-ttu-id="b5492-113">Das GridView füllt die "ObjectDataSource" `UpdateParameters` mit den geänderten Datensatz eindeutig identifizierenden Felder (über die `DataKeyNames` Eigenschaft) zusammen mit den Werten, die vom Benutzer eingegebene</span><span class="sxs-lookup"><span data-stu-id="b5492-113">The GridView populates its ObjectDataSource's `UpdateParameters` with the edited record's unique identifying field(s) (via the `DataKeyNames` property) along with the values entered by the user</span></span>
2. <span data-ttu-id="b5492-114">GridView ruft seine "ObjectDataSource" `Update()` -Methode, die wiederum die entsprechende Methode des zugrunde liegenden Objekts aufruft (`ProductsDAL.UpdateProduct`, in unserem vorherigen Lernprogramm)</span><span class="sxs-lookup"><span data-stu-id="b5492-114">The GridView invokes its ObjectDataSource's `Update()` method, which in turn invokes the appropriate method in the underlying object (`ProductsDAL.UpdateProduct`, in our previous tutorial)</span></span>
3. <span data-ttu-id="b5492-115">Die zugrunde liegenden Daten, die nun den aktualisierten Änderungen enthält, werden erneut an die GridView gebunden.</span><span class="sxs-lookup"><span data-stu-id="b5492-115">The underlying data, which now includes the updated changes, is rebound to the GridView</span></span>

<span data-ttu-id="b5492-116">Während dieser Sequenz von Schritten wird eine Anzahl von Ereignissen ausgelöst werden, sodass-Ereignishandler, um das Hinzufügen benutzerdefinierter Logik zu erstellen, falls erforderlich.</span><span class="sxs-lookup"><span data-stu-id="b5492-116">During this sequence of steps, a number of events fire, enabling us to create event handlers to add custom logic where needed.</span></span> <span data-ttu-id="b5492-117">Z. B. vor Schritt 1, der GridView `RowUpdating` -Ereignis ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="b5492-117">For example, prior to Step 1, the GridView's `RowUpdating` event fires.</span></span> <span data-ttu-id="b5492-118">An diesem Punkt können wir die aktualisierungsanforderung Abbrechen, wenn einige Überprüfungsfehler vorliegt.</span><span class="sxs-lookup"><span data-stu-id="b5492-118">We can, at this point, cancel the update request if there is some validation error.</span></span> <span data-ttu-id="b5492-119">Wenn die `Update()` Methode wird aufgerufen, dem ObjectDataSource-Steuerelement `Updating` Ereignis wird ausgelöst, so hinzufügen, oder passen Sie die Werte aller der `UpdateParameters`.</span><span class="sxs-lookup"><span data-stu-id="b5492-119">When the `Update()` method is invoked, the ObjectDataSource's `Updating` event fires, providing an opportunity to add or customize the values of any of the `UpdateParameters`.</span></span> <span data-ttu-id="b5492-120">Nach dem ObjectDataSource-Steuerelement zugrunde liegende-Methode des Objekts wurde ausgeführt, das "ObjectDataSource" `Updated` Ereignis wird ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="b5492-120">After the ObjectDataSource's underlying object's method has completed executing, the ObjectDataSource's `Updated` event is raised.</span></span> <span data-ttu-id="b5492-121">Ein Ereignishandler für die `Updated` untersuchen Ereignisses kann die Details über den Updatevorgang, z. B. wie viele Zeilen betroffen sind und ob eine Ausnahme aufgetreten ist.</span><span class="sxs-lookup"><span data-stu-id="b5492-121">An event handler for the `Updated` event can inspect the details about the update operation, such as how many rows were affected and whether or not an exception occurred.</span></span> <span data-ttu-id="b5492-122">Nach Schritt2 der GridView `RowUpdated` Ereignis wird ausgelöst, einen Ereignishandler für dieses Ereignis kann, überprüfen Sie weitere Informationen zu den Updatevorgang nur ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="b5492-122">Finally, after Step 2, the GridView's `RowUpdated` event fires; an event handler for this event can examine additional information about the update operation just performed.</span></span>

<span data-ttu-id="b5492-123">Abbildung 1 zeigt diese Reihe von Ereignissen und Schritte bei der Aktualisierung einer GridView-Ansicht.</span><span class="sxs-lookup"><span data-stu-id="b5492-123">Figure 1 depicts this series of events and steps when updating a GridView.</span></span> <span data-ttu-id="b5492-124">Das Ereignismuster in Abbildung 1 ist nicht eindeutig, zum Aktualisieren von mit einer GridView-Ansicht.</span><span class="sxs-lookup"><span data-stu-id="b5492-124">The event pattern in Figure 1 is not unique to updating with a GridView.</span></span> <span data-ttu-id="b5492-125">Einfügen, aktualisieren oder Löschen von Daten aus der GridView, precipitates DetailsView oder FormView-Steuerelement die gleiche Sequenz von vorab und nachträglich auf Ereignisse für das Web-Steuerelement und dem ObjectDataSource-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="b5492-125">Inserting, updating, or deleting data from the GridView, DetailsView, or FormView precipitates the same sequence of pre- and post-level events for both the data Web control and the ObjectDataSource.</span></span>


<span data-ttu-id="b5492-126">[![Eine Reihe von vor und nach der Ereignisse auslösen, beim Aktualisieren von Daten in einer GridView-Ansicht](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image2.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="b5492-126">[![A Series of Pre- and Post-Events Fire When Updating Data in a GridView](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image2.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image1.png)</span></span>

<span data-ttu-id="b5492-127">**Abbildung 1**: eine Reihe von vor und nach der Ereignisse auslösen beim Aktualisieren von Daten in einer GridView-Ansicht ([klicken Sie, um das Bild in voller Größe anzeigen](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="b5492-127">**Figure 1**: A Series of Pre- and Post-Events Fire When Updating Data in a GridView ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image3.png))</span></span>


<span data-ttu-id="b5492-128">Steuert, in diesem Tutorial wir diese Ereignisse verwenden untersuchen werden, erweitern Sie die integrierten einfügen, aktualisieren und löschen die Funktionen des ausgewählten ASP.NET Web.</span><span class="sxs-lookup"><span data-stu-id="b5492-128">In this tutorial we'll examine using these events to extend the built-in inserting, updating, and deleting capabilities of the ASP.NET data Web controls.</span></span> <span data-ttu-id="b5492-129">Wir sehen auch die Bearbeitung-Schnittstelle, um nur eine Teilmenge der Felder Product aktualisieren anpassen.</span><span class="sxs-lookup"><span data-stu-id="b5492-129">We'll also see how to customize the editing interface to only update a subset of the product fields.</span></span>

## <a name="step-1-updating-a-productsproductnameandunitpricefields"></a><span data-ttu-id="b5492-130">Schritt 1: Aktualisieren eines Produkts`ProductName`und`UnitPrice`Felder</span><span class="sxs-lookup"><span data-stu-id="b5492-130">Step 1: Updating a Product's`ProductName`and`UnitPrice`Fields</span></span>

<span data-ttu-id="b5492-131">In den Bearbeitungsmodus Schnittstellen aus dem vorherigen Lernprogramm *alle* Product-Felder, die nicht schreibgeschützt waren, musste der enthalten sein.</span><span class="sxs-lookup"><span data-stu-id="b5492-131">In the editing interfaces from the previous tutorial *all* product fields that were not read-only had to be included.</span></span> <span data-ttu-id="b5492-132">Angenommen, wenn wir zum Entfernen eines Felds aus der GridView waren - `QuantityPerUnit` – beim Aktualisieren der Daten das Websteuerelement Daten nicht dem ObjectDataSource-Steuerelement festgelegt wäre `QuantityPerUnit` `UpdateParameters` Wert.</span><span class="sxs-lookup"><span data-stu-id="b5492-132">If we were to remove a field from the GridView - say `QuantityPerUnit` - when updating the data the data Web control would not set the ObjectDataSource's `QuantityPerUnit` `UpdateParameters` value.</span></span> <span data-ttu-id="b5492-133">Dem ObjectDataSource-Steuerelement klicken Sie dann einen Wert von übergeben `Nothing` in die `UpdateProduct` Geschäftslogikschicht (Business Logic Layer, BLL)-Methode, die des bearbeiteten Datenbankdatensatzes ändern würde `QuantityPerUnit` Spalte eine `NULL` Wert.</span><span class="sxs-lookup"><span data-stu-id="b5492-133">The ObjectDataSource would then pass in a value of `Nothing` into the `UpdateProduct` Business Logic Layer (BLL) method, which would change the edited database record's `QuantityPerUnit` column to a `NULL` value.</span></span> <span data-ttu-id="b5492-134">Auf ähnliche Weise, wenn ein erforderliches Feld, z. B. `ProductName`, entfernt von der Bearbeitung-Schnittstelle, schlägt das Update mit einer "*Spaltenname 'ProductName' lässt keine NULL-Werte*" Ausnahme.</span><span class="sxs-lookup"><span data-stu-id="b5492-134">Similarly, if a required field, such as `ProductName`, is removed from the editing interface, the update will fail with a "*Column 'ProductName' does not allow nulls*" exception.</span></span> <span data-ttu-id="b5492-135">Der Grund für dieses Verhalten wurde, da dem ObjectDataSource-Steuerelement, zum Aufrufen konfiguriert wurde der `ProductsBLL` Klasse `UpdateProduct` -Methode, die Eingabeparameter für jedes der Felder Product erwartet.</span><span class="sxs-lookup"><span data-stu-id="b5492-135">The reason for this behavior was because the ObjectDataSource was configured to call the `ProductsBLL` class's `UpdateProduct` method, which expected an input parameter for each of the product fields.</span></span> <span data-ttu-id="b5492-136">Aus diesem Grund der ObjectDataSource `UpdateParameters` enthält einen Parameter für jede der Methode Eingabeparameter des.</span><span class="sxs-lookup"><span data-stu-id="b5492-136">Therefore, the ObjectDataSource's `UpdateParameters` collection contained a parameter for each of the method's input parameters.</span></span>

<span data-ttu-id="b5492-137">Wenn ein Daten-Websteuerelement bereit, die dem Benutzer nur eine Teilmenge der Felder aktualisieren können soll, müssen wir entweder programmgesteuert die fehlende festlegen `UpdateParameters` Werte in dem ObjectDataSource-Steuerelement `Updating` -Ereignishandler oder erstellen und Aufrufen eine Methode BLL, erwartet, dass nur eine Teilmenge der Felder.</span><span class="sxs-lookup"><span data-stu-id="b5492-137">If we want to provide a data Web control that allows the end user to only update a subset of fields, then we need to either programmatically set the missing `UpdateParameters` values in the ObjectDataSource's `Updating` event handler or create and call a BLL method that expects only a subset of the fields.</span></span> <span data-ttu-id="b5492-138">Sehen wir uns dieser zweite Ansatz.</span><span class="sxs-lookup"><span data-stu-id="b5492-138">Let's explore this latter approach.</span></span>

<span data-ttu-id="b5492-139">Insbesondere erstellen wir eine Seite, die zeigt nur die `ProductName` und `UnitPrice` Felder in einem bearbeitbaren GridView-Ansicht.</span><span class="sxs-lookup"><span data-stu-id="b5492-139">Specifically, let's create a page that displays just the `ProductName` and `UnitPrice` fields in an editable GridView.</span></span> <span data-ttu-id="b5492-140">Dieser GridView Bearbeitungsoberfläche lässt sich nur auf den Benutzer, die zwei angezeigten Felder aktualisieren `ProductName` und `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="b5492-140">This GridView's editing interface will only allow the user to update the two displayed fields, `ProductName` and `UnitPrice`.</span></span> <span data-ttu-id="b5492-141">Da diese Bearbeitung Schnittstelle nur eine Teilmenge von Feldern für ein Produkt des bereitstellt, wir müssen entweder ein ObjectDataSource-Steuerelement zu erstellen, die der vorhandenen Geschäftslogikschicht verwendet `UpdateProduct` Methode und die fehlenden Werte der Product-Feld festgelegt programmgesteuert in die `Updating` Ereignis Handler, oder wir müssen eine neue BLL-Methode erstellen, die nur die Teilmenge der Felder in den GridView-Ansicht definiert erwartet.</span><span class="sxs-lookup"><span data-stu-id="b5492-141">Since this editing interface only provides a subset of a product's fields, we either need to create an ObjectDataSource that uses the existing BLL's `UpdateProduct` method and has the missing product field values set programmatically in its `Updating` event handler, or we need to create a new BLL method that expects only the subset of fields defined in the GridView.</span></span> <span data-ttu-id="b5492-142">Für dieses Tutorial lassen Sie uns die zweite Option verwenden und erstellen Sie eine Überladung von der `UpdateProduct` -Methode, eine, die in nur drei Parameter akzeptiert: `productName`, `unitPrice`, und `productID`:</span><span class="sxs-lookup"><span data-stu-id="b5492-142">For this tutorial, let's use the latter option and create an overload of the `UpdateProduct` method, one that takes in just three input parameters: `productName`, `unitPrice`, and `productID`:</span></span>


[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample1.vb)]

<span data-ttu-id="b5492-143">Wie die ursprüngliche `UpdateProduct` Methode diese Überladung wird gestartet, indem überprüft wird, festzustellen, ob ein Produkt in der Datenbank mit dem angegebenen `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="b5492-143">Like the original `UpdateProduct` method, this overload starts by checking to see if there is a product in the database with the specified `ProductID`.</span></span> <span data-ttu-id="b5492-144">Wenn nicht der Fall, gibt `False`, informiert, dass die Fehler bei der Anforderung zum Aktualisieren der Produktinformationen.</span><span class="sxs-lookup"><span data-stu-id="b5492-144">If not, it returns `False`, indicating that the request to update the product information failed.</span></span> <span data-ttu-id="b5492-145">Andernfalls aktualisiert die vorhandene Produktdatensatz `ProductName` und `UnitPrice` Felder entsprechend, und führt einen Commit für die Aktualisierung durch Aufrufen der TableAdpater des `Update()` Methode und übergeben die `ProductsRow` Instanz.</span><span class="sxs-lookup"><span data-stu-id="b5492-145">Otherwise it updates the existing product record's `ProductName` and `UnitPrice` fields accordingly and commits the update by calling the TableAdpater's `Update()` method, passing in the `ProductsRow` instance.</span></span>

<span data-ttu-id="b5492-146">Mit dieser Ergänzung unserer `ProductsBLL` -Klasse, sind wir bereit, die vereinfachte GridView-Schnittstelle zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="b5492-146">With this addition to our `ProductsBLL` class, we're ready to create the simplified GridView interface.</span></span> <span data-ttu-id="b5492-147">Öffnen der `DataModificationEvents.aspx` in die `EditInsertDelete` Ordner und Hinzufügen einer GridView-Ansicht auf der Seite.</span><span class="sxs-lookup"><span data-stu-id="b5492-147">Open the `DataModificationEvents.aspx` in the `EditInsertDelete` folder and add a GridView to the page.</span></span> <span data-ttu-id="b5492-148">Erstellen Sie eine neue "ObjectDataSource", und konfigurieren Sie ihn zur Verwendung der `ProductsBLL` -Klasse mit der `Select()` Mapping-Methode, um `GetProducts` und die zugehörige `Update()` Mapping-Methode, um die `UpdateProduct` Überladung, die nur in der `productName`, `unitPrice`, und `productID` Eingabeparameter.</span><span class="sxs-lookup"><span data-stu-id="b5492-148">Create a new ObjectDataSource and configure it to use the `ProductsBLL` class with its `Select()` method mapping to `GetProducts` and its `Update()` method mapping to the `UpdateProduct` overload that takes in only the `productName`, `unitPrice`, and `productID` input parameters.</span></span> <span data-ttu-id="b5492-149">Abbildung 2 zeigt den Assistent zum Erstellen der Datenquelle aus, bei der Zuordnung von dem ObjectDataSource-Steuerelement `Update()` Methode, um die `ProductsBLL` Klasse der neuen `UpdateProduct` -methodenüberladung.</span><span class="sxs-lookup"><span data-stu-id="b5492-149">Figure 2 shows the Create Data Source wizard when mapping the ObjectDataSource's `Update()` method to the `ProductsBLL` class's new `UpdateProduct` method overload.</span></span>


<span data-ttu-id="b5492-150">[![Map-Methode für das ObjectDataSource-Steuerelement-Update() an die neue UpdateProduct-Überladung](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image5.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="b5492-150">[![Map the ObjectDataSource's Update() Method to the New UpdateProduct Overload](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image5.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image4.png)</span></span>

<span data-ttu-id="b5492-151">**Abbildung 2**: Ordnen Sie dem ObjectDataSource-Steuerelement `Update()` Methode, um neue `UpdateProduct` überladen ([klicken Sie, um das Bild in voller Größe anzeigen](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="b5492-151">**Figure 2**: Map the ObjectDataSource's `Update()` Method to the New `UpdateProduct` Overload ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image6.png))</span></span>


<span data-ttu-id="b5492-152">Da es sich bei unserem Beispiel zunächst nur die Möglichkeit zum Bearbeiten von Daten, aber nicht zum Einfügen oder Löschen von Datensätzen benötigt, können Sie explizit angeben, dass das "ObjectDataSource" `Insert()` und `Delete()` Methoden sollten nicht zugeordnet werden, auf die `ProductsBLL` die Klasse, Methoden die INSERT- und DELETE-Registerkarten und (keine) aus der Dropdown-Liste auswählen.</span><span class="sxs-lookup"><span data-stu-id="b5492-152">Since our example will initially just need the ability to edit data, but not to insert or delete records, take a moment to explicitly indicate that the ObjectDataSource's `Insert()` and `Delete()` methods shouldn't be mapped to any of the `ProductsBLL` class's methods by going to the INSERT and DELETE tabs and choosing (None) from the drop-down list.</span></span>


<span data-ttu-id="b5492-153">[![Wählen Sie aus der Dropdown-Liste für die INSERT- und DELETE-Registerkarten (keine)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image8.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="b5492-153">[![Choose (None) From the Drop-Down List for the INSERT and DELETE Tabs](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image8.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image7.png)</span></span>

<span data-ttu-id="b5492-154">**Abbildung 3**: Wählen Sie (keine) aus der Dropdown-Liste für die einfügen und Löschen von Registerkarten ([klicken Sie, um das Bild in voller Größe anzeigen](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="b5492-154">**Figure 3**: Choose (None) From the Drop-Down List for the INSERT and DELETE Tabs ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image9.png))</span></span>


<span data-ttu-id="b5492-155">Nach Abschluss dieses Assistenten das Kontrollkästchen Sie bearbeiten Aktivieren von GridView Smarttag.</span><span class="sxs-lookup"><span data-stu-id="b5492-155">After completing this wizard check the Enable Editing checkbox from the GridView's smart tag.</span></span>

<span data-ttu-id="b5492-156">Mit dem Abschluss des Assistenten Create Data Source "und", die an die GridView zu binden hat Visual Studio die deklarative Syntax für beide Steuerelemente erstellt.</span><span class="sxs-lookup"><span data-stu-id="b5492-156">With the completion of the Create Data Source wizard and binding that to the GridView, Visual Studio has created the declarative syntax for both controls.</span></span> <span data-ttu-id="b5492-157">Wechseln Sie zur Quellansicht, deklarative Markup dem ObjectDataSource-Steuerelement, überprüfen Sie die folgenden ist:</span><span class="sxs-lookup"><span data-stu-id="b5492-157">Go to the Source view to inspect the ObjectDataSource's declarative markup, which is shown below:</span></span>


[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample2.aspx)]

<span data-ttu-id="b5492-158">Da es sich um keine Zuordnungen für das "ObjectDataSource" `Insert()` und `Delete()` Methoden gibt es keine `InsertParameters` oder `DeleteParameters` Abschnitte.</span><span class="sxs-lookup"><span data-stu-id="b5492-158">Since there are no mappings for the ObjectDataSource's `Insert()` and `Delete()` methods, there are no `InsertParameters` or `DeleteParameters` sections.</span></span> <span data-ttu-id="b5492-159">Darüber hinaus, da die `Update()` Methode zugeordnet ist die `UpdateProduct` methodenüberladung, die nur drei Eingabeparameter akzeptiert die `UpdateParameters` Abschnitt verfügt über nur drei `Parameter` Instanzen.</span><span class="sxs-lookup"><span data-stu-id="b5492-159">Furthermore, since the `Update()` method is mapped to the `UpdateProduct` method overload that only accepts three input parameters, the `UpdateParameters` section has just three `Parameter` instances.</span></span>

<span data-ttu-id="b5492-160">Beachten Sie, dass das "ObjectDataSource" `OldValuesParameterFormatString` -Eigenschaftensatz auf `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="b5492-160">Note that the ObjectDataSource's `OldValuesParameterFormatString` property is set to `original_{0}`.</span></span> <span data-ttu-id="b5492-161">Diese Eigenschaft wird von Visual Studio automatisch festgelegt, mit dem Konfigurieren von Datenquellen-Assistenten.</span><span class="sxs-lookup"><span data-stu-id="b5492-161">This property is set automatically by Visual Studio when using the Configure Data Source wizard.</span></span> <span data-ttu-id="b5492-162">Aber da unsere Methoden der Geschäftslogikschicht erwarten, dass die ursprüngliche nicht `ProductID` Wert übergeben werden, das Entfernen dieser Eigenschaft die Zuweisung aus dem ObjectDataSource-Steuerelements deklarative Syntax.</span><span class="sxs-lookup"><span data-stu-id="b5492-162">However, since our BLL methods don't expect the original `ProductID` value to be passed in, remove this property assignment altogether from the ObjectDataSource's declarative syntax.</span></span>

> [!NOTE]
> <span data-ttu-id="b5492-163">Wenn Sie einfach löschen, die `OldValuesParameterFormatString` Eigenschaftswert im Eigenschaftenfenster in der Entwurfsansicht, die Eigenschaft in der deklarativen Syntax auch weiterhin vorhanden, jedoch wird auf eine leere Zeichenfolge festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="b5492-163">If you simply clear out the `OldValuesParameterFormatString` property value from the Properties window in the Design view, the property will still exist in the declarative syntax, but will be set to an empty string.</span></span> <span data-ttu-id="b5492-164">Entfernen Sie entweder die Eigenschaft vollständig aus der deklarativen Syntax oder, im Eigenschaftenfenster den Wert auf den Standardwert festgelegt, `{0}`.</span><span class="sxs-lookup"><span data-stu-id="b5492-164">Either remove the property altogether from the declarative syntax or, from the Properties window, set the value to the default, `{0}`.</span></span>


<span data-ttu-id="b5492-165">Während dem ObjectDataSource-Steuerelement nur hat `UpdateParameters` des Produkts Name, Preis und ID, Visual Studio wurde hinzugefügt eine BoundField- oder CheckBoxField in den GridView-Ansicht für jedes der Felder des Produkts.</span><span class="sxs-lookup"><span data-stu-id="b5492-165">While the ObjectDataSource only has `UpdateParameters` for the product's name, price, and ID, Visual Studio has added a BoundField or CheckBoxField in the GridView for each of the product's fields.</span></span>


<span data-ttu-id="b5492-166">[![GridView enthält eine BoundField- oder CheckBoxField für jedes der Felder für den Produktanforderungen](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image11.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="b5492-166">[![The GridView Contains a BoundField or CheckBoxField for Each of the Product's Fields](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image11.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image10.png)</span></span>

<span data-ttu-id="b5492-167">**Abbildung 4**: GridView enthält eine BoundField- oder CheckBoxField für jedes der Felder des Produkts ([klicken Sie, um das Bild in voller Größe anzeigen](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="b5492-167">**Figure 4**: The GridView Contains a BoundField or CheckBoxField for Each of the Product's Fields ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image12.png))</span></span>


<span data-ttu-id="b5492-168">Wenn der Endbenutzer ein Produkts bearbeitet und klickt auf die Schaltfläche "Aktualisieren", listet die GridView Felder, die nicht schreibgeschützt sind.</span><span class="sxs-lookup"><span data-stu-id="b5492-168">When the end user edits a product and clicks its Update button, the GridView enumerates those fields that were not read-only.</span></span> <span data-ttu-id="b5492-169">Dann wird den Wert des entsprechenden Parameters in der "ObjectDataSource" `UpdateParameters` -Auflistung, um den Wert, der vom Benutzer eingegeben werden.</span><span class="sxs-lookup"><span data-stu-id="b5492-169">It then sets the value of the corresponding parameter in the ObjectDataSource's `UpdateParameters` collection to the value entered by the user.</span></span> <span data-ttu-id="b5492-170">Wenn kein entsprechender Parameter vorhanden ist, fügt der Auflistung von GridView hinzu.</span><span class="sxs-lookup"><span data-stu-id="b5492-170">If there is not a corresponding parameter, the GridView adds one to the collection.</span></span> <span data-ttu-id="b5492-171">Aus diesem Grund enthält unsere GridView BoundFields und CheckBoxFields für alle Felder des Produkts, dem ObjectDataSource-Steuerelement wird am Ende Aufrufen der `UpdateProduct` Überladung, die in alle diese Parameter, trotz der Tatsache akzeptiert, die dem ObjectDataSource-Steuerelement deklaratives Markup gibt nur drei Parameter (siehe Abbildung 5).</span><span class="sxs-lookup"><span data-stu-id="b5492-171">Therefore, if our GridView contains BoundFields and CheckBoxFields for all of the product's fields, the ObjectDataSource will end up invoking the `UpdateProduct` overload that takes in all of these parameters, despite the fact that the ObjectDataSource's declarative markup specifies only three input parameters (see Figure 5).</span></span> <span data-ttu-id="b5492-172">Auf ähnliche Weise, es ist eine Kombination nicht schreibgeschützten Produkt Felder in den GridView-Ansicht, die die Eingabeparameter für entsprechen nicht, eine `UpdateProduct` überladen, eine Ausnahme ausgelöst, wenn der Versuch, zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="b5492-172">Similarly, if there is some combination of non-read-only product fields in the GridView that doesn't correspond to the input parameters for a `UpdateProduct` overload, an exception will be raised when attempting to update.</span></span>


<span data-ttu-id="b5492-173">[![Das GridView-wird dem ObjectDataSource-Steuerelement UpdateParameters Auflistung Parameter hinzufügen](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image14.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="b5492-173">[![The GridView Will Add Parameters to the ObjectDataSource's UpdateParameters Collection](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image14.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image13.png)</span></span>

<span data-ttu-id="b5492-174">**Abbildung 5**: die GridView wird Hinzufügen von Parametern zu dem ObjectDataSource-Steuerelement `UpdateParameters` Auflistung ([klicken Sie, um das Bild in voller Größe anzeigen](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="b5492-174">**Figure 5**: The GridView Will Add Parameters to the ObjectDataSource's `UpdateParameters` Collection ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image15.png))</span></span>


<span data-ttu-id="b5492-175">Um sicherzustellen, dass es sich bei dem ObjectDataSource-Steuerelement ruft die `UpdateProduct` -Überladung mit nur des produktanforderungen den Namen, Preis und-ID, müssen wir die GridView zu beschränken, mit dem editierbaren Felder für nur den `ProductName` und `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="b5492-175">To ensure that the ObjectDataSource invokes the `UpdateProduct` overload that takes in just the product's name, price, and ID, we need to restrict the GridView to having editable fields for just the `ProductName` and `UnitPrice`.</span></span> <span data-ttu-id="b5492-176">Dies kann erreicht werden, durch das Entfernen von den anderen BoundFields und CheckBoxFields, durch Festlegen von den anderen Feldern `ReadOnly` Eigenschaft `True`, oder durch eine Kombination aus beidem.</span><span class="sxs-lookup"><span data-stu-id="b5492-176">This can be accomplished by removing the other BoundFields and CheckBoxFields, by setting those other fields' `ReadOnly` property to `True`, or by some combination of the two.</span></span> <span data-ttu-id="b5492-177">Für dieses Tutorial lassen Sie uns einfach entfernen Sie alle GridView Felder mit Ausnahme der `ProductName` und `UnitPrice` BoundFields, nach der GridView deklarative Markup wird wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="b5492-177">For this tutorial let's simply remove all GridView fields except the `ProductName` and `UnitPrice` BoundFields, after which the GridView's declarative markup will look like:</span></span>


[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample3.aspx)]

<span data-ttu-id="b5492-178">Obwohl die `UpdateProduct` Überladung erwartet drei Parameter lassen wir nur zwei BoundFields in unserer GridView-Ansicht.</span><span class="sxs-lookup"><span data-stu-id="b5492-178">Even though the `UpdateProduct` overload expects three input parameters, we only have two BoundFields in our GridView.</span></span> <span data-ttu-id="b5492-179">Grund hierfür ist die `productID` Eingabeparameter den Wert eines Primärschlüssels und über den Wert des übergebenen der `DataKeyNames` -Eigenschaft für die bearbeitete Zeile.</span><span class="sxs-lookup"><span data-stu-id="b5492-179">This is because the `productID` input parameter is a primary key value and passed in through the value of the `DataKeyNames` property for the edited row.</span></span>

<span data-ttu-id="b5492-180">Unsere GridView, zusammen mit den `UpdateProduct` überladen, ermöglicht es einem Benutzer nur der Name und der Preis eines Produkts zu bearbeiten, ohne die anderen Felder des Produkts verloren.</span><span class="sxs-lookup"><span data-stu-id="b5492-180">Our GridView, along with the `UpdateProduct` overload, allows a user to edit just the name and price of a product without losing any of the other product fields.</span></span>


<span data-ttu-id="b5492-181">[![Die Schnittstelle ermöglicht das Bearbeiten von nur des Produkts Name und Preis](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image17.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="b5492-181">[![The Interface Allows Editing Just the Product's Name and Price](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image17.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image16.png)</span></span>

<span data-ttu-id="b5492-182">**Abbildung 6**: die Schnittstelle ermöglicht es, Bearbeiten nur des Produktanforderungen Name und Preis ([klicken Sie, um das Bild in voller Größe anzeigen](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="b5492-182">**Figure 6**: The Interface Allows Editing Just the Product's Name and Price ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image18.png))</span></span>


> [!NOTE]
> <span data-ttu-id="b5492-183">Wie im vorherigen Tutorial erwähnt, ist es äußerst wichtig, dass die GridView Ansichtszustand s werden (Standardverhalten) aktiviert.</span><span class="sxs-lookup"><span data-stu-id="b5492-183">As discussed in the previous tutorial, it is vitally important that the GridView s view state be enabled (the default behavior).</span></span> <span data-ttu-id="b5492-184">Setzen Sie das GridView-s `EnableViewState` Eigenschaft `false`, führen Sie das Risiko gleichzeitiger Benutzer versehentlich löschen oder zu bearbeiten zeichnet.</span><span class="sxs-lookup"><span data-stu-id="b5492-184">If you set the GridView s `EnableViewState` property to `false`, you run the risk of having concurrent users unintentionally deleting or editing records.</span></span> <span data-ttu-id="b5492-185">Finden Sie unter [Warnung: Problem der Parallelität mit ASP.NET 2.0 GridViews/DetailsView/FormViews diese Unterstützung zu bearbeiten bzw. löschen und, deren Ansichtszustand deaktiviert ist](http://scottonwriting.net/sowblog/posts/10054.aspx) für Weitere Informationen.</span><span class="sxs-lookup"><span data-stu-id="b5492-185">See [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/posts/10054.aspx) for more information.</span></span>


## <a name="improving-theunitpriceformatting"></a><span data-ttu-id="b5492-186">Verbessern der`UnitPrice`Formatierung</span><span class="sxs-lookup"><span data-stu-id="b5492-186">Improving the`UnitPrice`Formatting</span></span>

<span data-ttu-id="b5492-187">Das GridView-Beispiel in Abbildung 6 funktioniert, während die `UnitPrice` Feld überhaupt nicht formatiert wird, im Preis anzuzeigen, die alle Währung verfügt nicht über die Symbole und verfügt über vier Dezimalstellen.</span><span class="sxs-lookup"><span data-stu-id="b5492-187">While the GridView example shown in Figure 6 works, the `UnitPrice` field is not formatted at all, resulting in a price display that lacks any currency symbols and has four decimal places.</span></span> <span data-ttu-id="b5492-188">Um eine währungsformatierung für die Zeilen nicht bearbeitbare anzuwenden, legen Sie einfach die `UnitPrice` BoundFields `DataFormatString` Eigenschaft `{0:c}` und die zugehörige `HtmlEncode` Eigenschaft `False`.</span><span class="sxs-lookup"><span data-stu-id="b5492-188">To apply a currency formatting for the non-editable rows, simply set the `UnitPrice` BoundField's `DataFormatString` property to `{0:c}` and its `HtmlEncode` property to `False`.</span></span>


<span data-ttu-id="b5492-189">[![Festlegen Sie die UnitPrice DataFormatString und das "HTMLEncode"-Eigenschaften entsprechend](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image20.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="b5492-189">[![Set the UnitPrice's DataFormatString and HtmlEncode Properties Accordingly](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image20.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image19.png)</span></span>

<span data-ttu-id="b5492-190">**Abbildung 7**: Legen Sie die `UnitPrice`des `DataFormatString` und `HtmlEncode` Eigenschaften entsprechend ([klicken Sie, um das Bild in voller Größe anzeigen](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="b5492-190">**Figure 7**: Set the `UnitPrice`'s `DataFormatString` and `HtmlEncode` Properties Accordingly ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image21.png))</span></span>


<span data-ttu-id="b5492-191">Durch diese Änderung formatieren die nicht-bearbeitbaren Zeilen den Preis als Währung; die bearbeitete Zeile wird jedoch immer noch den Wert ohne das Währungssymbol und mit vier Dezimalstellen.</span><span class="sxs-lookup"><span data-stu-id="b5492-191">With this change, the non-editable rows format the price as a currency; the edited row, however, still displays the value without the currency symbol and with four decimal places.</span></span>


<span data-ttu-id="b5492-192">[![Die nicht bearbeitet werden Zeilen sind jetzt formatiert, als Currency-Werte](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image23.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="b5492-192">[![The Non-Editable Rows are Now Formatted as Currency Values](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image23.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image22.png)</span></span>

<span data-ttu-id="b5492-193">**Abbildung 8**: die nicht-bearbeitbaren Rows sind jetzt als Währungswerte formatiert ([klicken Sie, um das Bild in voller Größe anzeigen](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="b5492-193">**Figure 8**: The Non-Editable Rows are Now Formatted as Currency Values ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image24.png))</span></span>


<span data-ttu-id="b5492-194">Die formatierungsanweisungen, angegeben der `DataFormatString` Eigenschaft kann auf die Bearbeitungsschnittstelle angewendet werden, durch Festlegen der BoundField des `ApplyFormatInEditMode` Eigenschaft `True` (der Standardwert ist `False`).</span><span class="sxs-lookup"><span data-stu-id="b5492-194">The formatting instructions specified in the `DataFormatString` property can be applied to the editing interface by setting the BoundField's `ApplyFormatInEditMode` property to `True` (the default is `False`).</span></span> <span data-ttu-id="b5492-195">Können Sie diese Eigenschaft auf festgelegt `True`.</span><span class="sxs-lookup"><span data-stu-id="b5492-195">Take a moment to set this property to `True`.</span></span>


<span data-ttu-id="b5492-196">[![Legen Sie die UnitPrice BoundFields ApplyFormatInEditMode-Eigenschaft auf "true"](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image26.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="b5492-196">[![Set the UnitPrice BoundField's ApplyFormatInEditMode property to True](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image26.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image25.png)</span></span>

<span data-ttu-id="b5492-197">**Abbildung 9**: Legen Sie die `UnitPrice` BoundFields `ApplyFormatInEditMode` Eigenschaft `True` ([klicken Sie, um das Bild in voller Größe anzeigen](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="b5492-197">**Figure 9**: Set the `UnitPrice` BoundField's `ApplyFormatInEditMode` property to `True` ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image27.png))</span></span>


<span data-ttu-id="b5492-198">Mit dieser Änderung wird der Wert, der die `UnitPrice` angezeigt, in der bearbeiteten Zeile wird auch als Währung formatiert.</span><span class="sxs-lookup"><span data-stu-id="b5492-198">With this change, the value of the `UnitPrice` displayed in the edited row is also formatted as a currency.</span></span>


<span data-ttu-id="b5492-199">[![Bearbeiteter der Wert der Zeile UnitPrice ist jetzt formatiert, als Währung](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image29.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="b5492-199">[![The Edited Row's UnitPrice Value is Now Formatted as a Currency](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image29.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image28.png)</span></span>

<span data-ttu-id="b5492-200">**Abbildung 10**: The bearbeitet Zeile `UnitPrice` Wert ist jetzt als Währung formatiert ([klicken Sie, um das Bild in voller Größe anzeigen](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="b5492-200">**Figure 10**: The Edited Row's `UnitPrice` Value is Now Formatted as a Currency ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image30.png))</span></span>


<span data-ttu-id="b5492-201">Ein Produkt jedoch mit dem Währungssymbol im Textfeld für die zu aktualisieren, wie z. B. $19.00 löst eine `FormatException`.</span><span class="sxs-lookup"><span data-stu-id="b5492-201">However, updating a product with the currency symbol in the textbox such as $19.00 throws a `FormatException`.</span></span> <span data-ttu-id="b5492-202">Wenn die GridView versucht, dem ObjectDataSource-Steuerelement die vom Benutzer angegebenen Werte zuweisen `UpdateParameters` Auflistung kann nicht konvertiert werden kann die `UnitPrice` "$19.00" in eine Zeichenfolge der `Decimal` erforderlich, durch den Parameter (siehe Abbildung 11).</span><span class="sxs-lookup"><span data-stu-id="b5492-202">When the GridView attempts to assign the user-supplied values to the ObjectDataSource's `UpdateParameters` collection it is unable to convert the `UnitPrice` string "$19.00" into the `Decimal` required by the parameter (see Figure 11).</span></span> <span data-ttu-id="b5492-203">Zur Umgehung des Problems erstellen wir einen Ereignishandler für der GridView `RowUpdating` Ereignis und den vom Benutzer bereitgestellten analysieren `UnitPrice` als eine Währung formatierten `Decimal`.</span><span class="sxs-lookup"><span data-stu-id="b5492-203">To remedy this we can create an event handler for the GridView's `RowUpdating` event and have it parse the user-supplied `UnitPrice` as a currency-formatted `Decimal`.</span></span>

<span data-ttu-id="b5492-204">GridView `RowUpdating` Ereignis akzeptiert als zweiten Parameter ein Objekt vom Typ [GridViewUpdateEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewupdateeventargs(VS.80).aspx), wozu ein `NewValues` Wörterbuch als eine seiner Eigenschaften, die die benutzerdefinierten Werte werden enthält. dem ObjectDataSource-Steuerelement zugewiesen `UpdateParameters` Auflistung.</span><span class="sxs-lookup"><span data-stu-id="b5492-204">The GridView's `RowUpdating` event accepts as its second parameter an object of type [GridViewUpdateEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewupdateeventargs(VS.80).aspx), which includes a `NewValues` dictionary as one of its properties that holds the user-supplied values ready to be assigned to the ObjectDataSource's `UpdateParameters` collection.</span></span> <span data-ttu-id="b5492-205">Wir können die vorhandenen überschreiben `UnitPrice` Wert in der `NewValues` Auflistung mit einem Dezimalwert analysiert die folgenden Codezeilen in das Währungsformat mit der `RowUpdating` -Ereignishandler:</span><span class="sxs-lookup"><span data-stu-id="b5492-205">We can overwrite the existing `UnitPrice` value in the `NewValues` collection with a decimal value parsed using the currency format with the following lines of code in the `RowUpdating` event handler:</span></span>


[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample4.vb)]

<span data-ttu-id="b5492-206">Wenn der Benutzer angegeben hat eine `UnitPrice` Wert (z. B. "$19.00"), wird dieser Wert mit der decimal-Wert berechnet, indem überschrieben [Decimal.Parse](https://msdn.microsoft.com/library/system.decimal.parse(VS.80).aspx), analysieren den Wert als Währung.</span><span class="sxs-lookup"><span data-stu-id="b5492-206">If the user has supplied a `UnitPrice` value (such as "$19.00"), this value is overwritten with the decimal value computed by [Decimal.Parse](https://msdn.microsoft.com/library/system.decimal.parse(VS.80).aspx), parsing the value as a currency.</span></span> <span data-ttu-id="b5492-207">Dieser Dezimaltrennzeichen ordnungsgemäß analysiert wird, im Falle alle Währungssymbole, Kommas, Dezimalstellen und So weiter, und verwendet die [NumberStyles-Enumeration](https://msdn.microsoft.com/library/system.globalization.numberstyles(VS.80).aspx) in die [System.Globalization](https://msdn.microsoft.com/library/abeh092z(VS.80).aspx) Namespace.</span><span class="sxs-lookup"><span data-stu-id="b5492-207">This will correctly parse the decimal in the event of any currency symbols, commas, decimal points, and so on, and uses the [NumberStyles enumeration](https://msdn.microsoft.com/library/system.globalization.numberstyles(VS.80).aspx) in the [System.Globalization](https://msdn.microsoft.com/library/abeh092z(VS.80).aspx) namespace.</span></span>

<span data-ttu-id="b5492-208">Abbildung 11 zeigt sowohl das Problem zurückzuführen Währungssymbole in den vom Benutzer bereitgestellten `UnitPrice`, sowie wie GridView `RowUpdating` -Ereignishandler kann verwendet werden, um derartige Eingabe ordnungsgemäß zu analysieren.</span><span class="sxs-lookup"><span data-stu-id="b5492-208">Figure 11 shows both the problem caused by currency symbols in the user-supplied `UnitPrice`, along with how the GridView's `RowUpdating` event handler can be utilized to correctly parse such input.</span></span>


<span data-ttu-id="b5492-209">[![Bearbeiteter der Wert der Zeile UnitPrice ist jetzt formatiert, als Währung](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image32.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="b5492-209">[![The Edited Row's UnitPrice Value is Now Formatted as a Currency](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image32.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image31.png)</span></span>

<span data-ttu-id="b5492-210">**Abbildung 11**: The bearbeitet Zeile `UnitPrice` Wert ist jetzt als Währung formatiert ([klicken Sie, um das Bild in voller Größe anzeigen](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="b5492-210">**Figure 11**: The Edited Row's `UnitPrice` Value is Now Formatted as a Currency ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image33.png))</span></span>


## <a name="step-2-prohibitingnull-unitprices"></a><span data-ttu-id="b5492-211">Schritt 2: Verbot`NULL UnitPrices`</span><span class="sxs-lookup"><span data-stu-id="b5492-211">Step 2: Prohibiting`NULL UnitPrices`</span></span>

<span data-ttu-id="b5492-212">Während die Datenbank konfiguriert ist, um zu ermöglichen `NULL` Werte in der `Products` Tabelle `UnitPrice` Spalte, wir könnten verhindern, dass Benutzer, die Zugriff auf diese Seite von der Angabe einer `NULL` `UnitPrice` Wert.</span><span class="sxs-lookup"><span data-stu-id="b5492-212">While the database is configured to allow `NULL` values in the `Products` table's `UnitPrice` column, we may want to prevent users visiting this particular page from specifying a `NULL` `UnitPrice` value.</span></span> <span data-ttu-id="b5492-213">D. h. wenn ein Benutzer nicht zur Eingabe einer `UnitPrice` Wert, wenn eine Produktzeile bearbeiten, anstatt Sie zu speichern der Ergebnisse in der Datenbank, die wir eine Nachricht, die den Benutzer darüber informiert, dass bearbeitete Produkte über diese Seite, einen Preis angegeben benötigen angezeigt werden soll.</span><span class="sxs-lookup"><span data-stu-id="b5492-213">That is, if a user fails to enter a `UnitPrice` value when editing a product row, rather than save the results to the database we want to display a message informing the user that, through this page, any edited products must have a price specified.</span></span>

<span data-ttu-id="b5492-214">Die `GridViewUpdateEventArgs` -Objekt übergeben, in des GridView `RowUpdating` Ereignishandler enthält eine `Cancel` Eigenschaft, wenn auf festgelegt `True`, beendet den Prozess aktualisierten.</span><span class="sxs-lookup"><span data-stu-id="b5492-214">The `GridViewUpdateEventArgs` object passed into the GridView's `RowUpdating` event handler contains a `Cancel` property that, if set to `True`, terminates the updating process.</span></span> <span data-ttu-id="b5492-215">Jetzt erweitern wir die `RowUpdating` Ereignishandler festlegen `e.Cancel` zu `True` und zeigt eine Meldung, die Erklärung, wenn die `UnitPrice` Wert in der `NewValues` Auflistung hat den Wert `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="b5492-215">Let's extend the `RowUpdating` event handler to set `e.Cancel` to `True` and display a message explaining why if the `UnitPrice` value in the `NewValues` collection has a value of `Nothing`.</span></span>

<span data-ttu-id="b5492-216">Starten, indem ein Label-Steuerelement hinzufügen, um die Seite mit dem Namen `MustProvideUnitPriceMessage`.</span><span class="sxs-lookup"><span data-stu-id="b5492-216">Start by adding a Label Web control to the page named `MustProvideUnitPriceMessage`.</span></span> <span data-ttu-id="b5492-217">Diesen Label-Steuerelement wird angezeigt, wenn der Benutzer nicht an eine `UnitPrice` Wert, wenn ein Produkt aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="b5492-217">This Label control will be displayed if the user fails to specify a `UnitPrice` value when updating a product.</span></span> <span data-ttu-id="b5492-218">Legen Sie die Bezeichnung des `Text` Eigenschaft auf "müssen Sie einen Preis für das Produkt bereitstellen."</span><span class="sxs-lookup"><span data-stu-id="b5492-218">Set the Label's `Text` property to "You must provide a price for the product."</span></span> <span data-ttu-id="b5492-219">Ich habe auch eine neue CSS-Klasse im erstellt `Styles.css` mit dem Namen `Warning` mit folgender Definition:</span><span class="sxs-lookup"><span data-stu-id="b5492-219">I've also created a new CSS class in `Styles.css` named `Warning` with the following definition:</span></span>


[!code-css[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample5.css)]

<span data-ttu-id="b5492-220">Legen Sie schließlich die Bezeichnung des `CssClass` Eigenschaft `Warning`.</span><span class="sxs-lookup"><span data-stu-id="b5492-220">Finally, set the Label's `CssClass` property to `Warning`.</span></span> <span data-ttu-id="b5492-221">An diesem Punkt sollte der Designer angezeigt werden wie in Abbildung 12 dargestellt die Warnmeldung in einem roten, fett, kursiv, sehr große Schriftgrad über GridView.</span><span class="sxs-lookup"><span data-stu-id="b5492-221">At this point the Designer should show the warning message in a red, bold, italic, extra large font size above the GridView, as shown in Figure 12.</span></span>


<span data-ttu-id="b5492-222">[![Eine Bezeichnung wurde hinzugefügt, über die GridView](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image35.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="b5492-222">[![A Label Has Been Added Above the GridView](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image35.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image34.png)</span></span>

<span data-ttu-id="b5492-223">**Abbildung 12**: eine Bezeichnung wurde wurde hinzugefügt über die GridView ([klicken Sie, um das Bild in voller Größe anzeigen](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="b5492-223">**Figure 12**: A Label Has Been Added Above the GridView ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image36.png))</span></span>


<span data-ttu-id="b5492-224">Standardmäßig diesen Label ausgeblendet werden soll, legen Sie daher die `Visible` Eigenschaft `False` in die `Page_Load` -Ereignishandler:</span><span class="sxs-lookup"><span data-stu-id="b5492-224">By default, this Label should be hidden, so set its `Visible` property to `False` in the `Page_Load` event handler:</span></span>


[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample6.vb)]

<span data-ttu-id="b5492-225">Wenn der Benutzer versucht, ein Produkt zu aktualisieren, ohne die `UnitPrice`, wir möchten die Aktualisierung abzubrechen und zeigen Sie den Text der Warnung.</span><span class="sxs-lookup"><span data-stu-id="b5492-225">If the user attempts to update a product without specifying the `UnitPrice`, we want to cancel the update and display the warning label.</span></span> <span data-ttu-id="b5492-226">Erweitern Sie des GridView `RowUpdating` Ereignishandler wie folgt:</span><span class="sxs-lookup"><span data-stu-id="b5492-226">Augment the GridView's `RowUpdating` event handler as follows:</span></span>


[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample7.vb)]

<span data-ttu-id="b5492-227">Wenn ein Benutzer versucht, ein Produkt zu speichern, ohne einen Preis, das Update wird abgebrochen, und eine hilfreiche Meldung wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="b5492-227">If a user attempts to save a product without specifying a price, the update is cancelled and a helpful message is displayed.</span></span> <span data-ttu-id="b5492-228">Während die Datenbank (und die Geschäftslogik) ermöglicht die `NULL` `UnitPrice` s, diese bestimmte ASP.NET-Seite hingegen nicht.</span><span class="sxs-lookup"><span data-stu-id="b5492-228">While the database (and business logic) allows for `NULL` `UnitPrice` s, this particular ASP.NET page does not.</span></span>


<span data-ttu-id="b5492-229">[![Ein Benutzer kann nicht UnitPrice leer lassen.](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image38.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="b5492-229">[![A User Cannot Leave UnitPrice Blank](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image38.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image37.png)</span></span>

<span data-ttu-id="b5492-230">**Abbildung 13**: ein Benutzer kann nicht verlassen `UnitPrice` leer ([klicken Sie, um das Bild in voller Größe anzeigen](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="b5492-230">**Figure 13**: A User Cannot Leave `UnitPrice` Blank ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image39.png))</span></span>


<span data-ttu-id="b5492-231">Bisher haben wir gesehen, wie mit GridView `RowUpdating` Ereignis, um die Werte der Parameter zugewiesen werden, auf dem ObjectDataSource-Steuerelement programmgesteuert ändern `UpdateParameters` Auflistung sowie zum Abbrechen die Aktualisierung vollständig verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="b5492-231">So far we have seen how to use the GridView's `RowUpdating` event to programmatically alter the parameter values assigned to the ObjectDataSource's `UpdateParameters` collection as well as how to cancel the updating process altogether.</span></span> <span data-ttu-id="b5492-232">Diese Konzepte werden dabei auf die DetailsView und FormView-Steuerelemente und gelten auch für das Einfügen und Löschen von.</span><span class="sxs-lookup"><span data-stu-id="b5492-232">These concepts carry over to the DetailsView and FormView controls and also apply to inserting and deleting.</span></span>

<span data-ttu-id="b5492-233">Diese Aufgaben können auch ausgeführt werden, auf der Ebene "ObjectDataSource" über den Ereignishandler für die `Inserting`, `Updating`, und `Deleting` Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="b5492-233">These tasks can also be done at the ObjectDataSource level through event handlers for its `Inserting`, `Updating`, and `Deleting` events.</span></span> <span data-ttu-id="b5492-234">Diese Ereignisse ausgelöst werden, bevor die zugeordnete Methode des zugrunde liegenden Objekts aufgerufen wird, und geben Sie eine letzte Gelegenheit-Gelegenheit, um die Auflistung der Eingabeparameter zu ändern, oder brechen Sie den Vorgang 30-tägiges.</span><span class="sxs-lookup"><span data-stu-id="b5492-234">These events fire before the associated method of the underlying object is invoked and provide a last-chance opportunity to modify the input parameters collection or cancel the operation outright.</span></span> <span data-ttu-id="b5492-235">Die Ereignishandler für diese drei Ereignisse sind ein Objekt des Typs übergeben [ObjectDataSourceMethodEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs(VS.80).aspx) , die zwei wichtige Eigenschaften hat:</span><span class="sxs-lookup"><span data-stu-id="b5492-235">The event handlers for these three events are passed an object of type [ObjectDataSourceMethodEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs(VS.80).aspx) that has two properties of interest:</span></span>

- <span data-ttu-id="b5492-236">[Abbrechen](https://msdn.microsoft.com/library/system.componentmodel.canceleventargs.cancel(VS.80).aspx), die, wenn auf festgelegt `True`, bricht den Vorgang</span><span class="sxs-lookup"><span data-stu-id="b5492-236">[Cancel](https://msdn.microsoft.com/library/system.componentmodel.canceleventargs.cancel(VS.80).aspx), which, if set to `True`, cancels the operation being performed</span></span>
- <span data-ttu-id="b5492-237">[InputParameters](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs.inputparameters(VS.80).aspx), d.h., dass die Auflistung der `InsertParameters`, `UpdateParameters`, oder `DeleteParameters`, abhängig davon, ob der Ereignishandler wird die `Inserting`, `Updating`, oder `Deleting` Ereignis</span><span class="sxs-lookup"><span data-stu-id="b5492-237">[InputParameters](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs.inputparameters(VS.80).aspx), which is the collection of `InsertParameters`, `UpdateParameters`, or `DeleteParameters`, depending on whether the event handler is for the `Inserting`, `Updating`, or `Deleting` event</span></span>

<span data-ttu-id="b5492-238">Zum Arbeiten mit den Parameterwerten auf der Ebene "ObjectDataSource" zu veranschaulichen, enthalten Sie eine DetailsView lassen Sie uns auf unserer Seite, die dem Benutzer ein neues Produkt hinzufügen können.</span><span class="sxs-lookup"><span data-stu-id="b5492-238">To illustrate working with the parameter values at the ObjectDataSource level, let's include a DetailsView in our page that allows the users to add a new product.</span></span> <span data-ttu-id="b5492-239">Bereitstellen eine Schnittstelle zum schnellen Hinzufügen ein neues Produkt in der Datenbank, wird dieser DetailsView verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="b5492-239">This DetailsView will be used to provide an interface for quickly adding a new product to the database.</span></span> <span data-ttu-id="b5492-240">Eine einheitliche Benutzeroberfläche zu, wenn wir kein neues Produkt hinzugefügt, kann der Benutzer nur die Werte für geben die `ProductName` und `UnitPrice` Felder.</span><span class="sxs-lookup"><span data-stu-id="b5492-240">To keep a consistent user interface when adding a new product let's allow the user to only enter values for the `ProductName` and `UnitPrice` fields.</span></span> <span data-ttu-id="b5492-241">Standardmäßig werden die Werte, die in DetailsViews-einfügen-Schnittstelle angegeben sind nicht festgelegt werden eine `NULL` Datenbank-Wert.</span><span class="sxs-lookup"><span data-stu-id="b5492-241">By default, those values that aren't supplied in the DetailsView's inserting interface will be set to a `NULL` database value.</span></span> <span data-ttu-id="b5492-242">Wir können jedoch dem ObjectDataSource-Steuerelement `Inserting` Ereignis, um unterschiedliche Standardwerte aufweisen, einfügen, wie wir gleich sehen werden.</span><span class="sxs-lookup"><span data-stu-id="b5492-242">However, we can use the ObjectDataSource's `Inserting` event to inject different default values, as we'll see shortly.</span></span>

## <a name="step-3-providing-an-interface-to-add-new-products"></a><span data-ttu-id="b5492-243">Schritt 3: Bereitstellen einer Schnittstelle zum Hinzufügen neuer Produkte</span><span class="sxs-lookup"><span data-stu-id="b5492-243">Step 3: Providing an Interface to Add New Products</span></span>

<span data-ttu-id="b5492-244">Ziehen Sie eine DetailsView aus der Toolbox in den Designer über die GridView, löschen Sie die `Height` und `Width` Eigenschaften und Bindung, die es dem ObjectDataSource-Steuerelement auf der Seite bereits vorhanden.</span><span class="sxs-lookup"><span data-stu-id="b5492-244">Drag a DetailsView from the Toolbox onto the Designer above the GridView, clear out its `Height` and `Width` properties, and bind it to the ObjectDataSource already present on the page.</span></span> <span data-ttu-id="b5492-245">Dadurch wird eine BoundField- oder CheckBoxField für jedes der Felder des Produkts hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="b5492-245">This will add a BoundField or CheckBoxField for each of the product's fields.</span></span> <span data-ttu-id="b5492-246">Da wir diese DetailsView zu verwenden, um die neuen Produkte hinzufügen möchten, müssen wir überprüfen Sie die Option "Einfügen aktivieren" das Smarttag; ist jedoch keine Option dieser Art vorhanden, da das "ObjectDataSource" `Insert()` Methode ist nicht zugeordnet, auf eine Methode in der `ProductsBLL` Klasse (Beachten Sie, dass wir diese Zuordnung (keine) festgelegt, wenn die Konfiguration der Datenquelle finden Sie unter Abbildung 3).</span><span class="sxs-lookup"><span data-stu-id="b5492-246">Since we want to use this DetailsView to add new products, we need to check the Enable Inserting option from the smart tag; however, there's no such option because the ObjectDataSource's `Insert()` method is not mapped to a method in the `ProductsBLL` class (recall that we set this mapping to (None) when configuring the data source see Figure 3).</span></span>

<span data-ttu-id="b5492-247">Um dem ObjectDataSource-Steuerelement konfigurieren zu können, wählen Sie die Datenquelle konfigurieren-Verknüpfung von sein Smarttag, den Assistenten zu starten.</span><span class="sxs-lookup"><span data-stu-id="b5492-247">To configure the ObjectDataSource, select the Configure Data Source link from its smart tag, launching the wizard.</span></span> <span data-ttu-id="b5492-248">Im erste Bildschirm können Sie das zugrunde liegende Objekt zu ändern, an dem ObjectDataSource-Steuerelement gebunden ist; Lassen sie die Option `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="b5492-248">The first screen allows you to change the underlying object the ObjectDataSource is bound to; leave it set to `ProductsBLL`.</span></span> <span data-ttu-id="b5492-249">Der nächste Bildschirm enthält die Zuordnungen von Methoden mit dem ObjectDataSource-Steuerelement auf die zugrunde liegende Objekt.</span><span class="sxs-lookup"><span data-stu-id="b5492-249">The next screen lists the mappings from the ObjectDataSource's methods to the underlying object's.</span></span> <span data-ttu-id="b5492-250">Obwohl wir explizit, die angegeben die `Insert()` und `Delete()` Methoden sollten nicht auf alle Methoden zugeordnet werden, wenn man den INSERT- und DELETE-Registerkarten sehen Sie, dass eine Zuordnung vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="b5492-250">Even though we explicitly indicated that the `Insert()` and `Delete()` methods should not be mapped to any methods, if you go to the INSERT and DELETE tabs you'll see that a mapping is there.</span></span> <span data-ttu-id="b5492-251">Grund hierfür ist die `ProductsBLL`des `AddProduct` und `DeleteProduct` Methoden verwenden die `DataObjectMethodAttribute` Attribut, um anzugeben, dass sie die Standardmethoden für sind `Insert()` und `Delete()`bzw.</span><span class="sxs-lookup"><span data-stu-id="b5492-251">This is because the `ProductsBLL`'s `AddProduct` and `DeleteProduct` methods use the `DataObjectMethodAttribute` attribute to indicate that they are the default methods for `Insert()` and `Delete()`, respectively.</span></span> <span data-ttu-id="b5492-252">Daher wählt der Assistent "ObjectDataSource" diese jedes Mal, wenn Sie den Assistenten ausführen, es sei denn, es einen anderen Wert explizit angegeben gibt.</span><span class="sxs-lookup"><span data-stu-id="b5492-252">Hence, the ObjectDataSource wizard selects these each time you run the wizard unless there's some other value explicitly specified.</span></span>

<span data-ttu-id="b5492-253">Lassen Sie die `Insert()` Methode, die auf die `AddProduct` -Methode, aber erneut die löschen-Registerkarte Dropdown-Liste auf (keine) festgelegt.</span><span class="sxs-lookup"><span data-stu-id="b5492-253">Leave the `Insert()` method pointing to the `AddProduct` method, but again set the DELETE tab's drop-down list to (None).</span></span>


<span data-ttu-id="b5492-254">[![Legen Sie die Registerkarte "Einfügen" des Dropdown-Liste auf die AddProduct-Methode](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image41.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="b5492-254">[![Set the INSERT Tab's Drop-Down List to the AddProduct Method](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image41.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image40.png)</span></span>

<span data-ttu-id="b5492-255">**Abbildung 14**: Legen Sie die Registerkarte "Einfügen" des Dropdown-Listenfeld auf der `AddProduct` Methode ([klicken Sie, um das Bild in voller Größe anzeigen](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="b5492-255">**Figure 14**: Set the INSERT Tab's Drop-Down List to the `AddProduct` Method ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image42.png))</span></span>


<span data-ttu-id="b5492-256">[![Legen Sie die DELETE-Registerkarte Dropdown-Liste auf (keine)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image44.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="b5492-256">[![Set the DELETE Tab's Drop-Down List to (None)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image44.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image43.png)</span></span>

<span data-ttu-id="b5492-257">**Abbildung 15**: die löschen-Registerkarte Dropdown-Liste (keine) festgelegt ([klicken Sie, um das Bild in voller Größe anzeigen](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="b5492-257">**Figure 15**: Set the DELETE Tab's Drop-Down List to (None) ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image45.png))</span></span>


<span data-ttu-id="b5492-258">Nach diesen Änderungen durchführen, deklarative Syntax des dem ObjectDataSource-Steuerelement wird um erweitert werden ein `InsertParameters` -Auflistung, wie unten dargestellt:</span><span class="sxs-lookup"><span data-stu-id="b5492-258">After making these changes, the ObjectDataSource's declarative syntax will be expanded to include an `InsertParameters` collection, as shown below:</span></span>


[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample8.aspx)]

<span data-ttu-id="b5492-259">Erneutes Ausführen des Assistenten, dem erneuten Hinzufügen der der `OldValuesParameterFormatString` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="b5492-259">Rerunning the wizard added back the `OldValuesParameterFormatString` property.</span></span> <span data-ttu-id="b5492-260">Können Sie diese Eigenschaft zu löschen, indem Sie sie auf den Standardwert festlegen (`{0}`) oder entfernen Sie sie vollständig aus der deklarativen Syntax.</span><span class="sxs-lookup"><span data-stu-id="b5492-260">Take a moment to clear this property by setting it to the default value (`{0}`) or removing it altogether from the declarative syntax.</span></span>

<span data-ttu-id="b5492-261">Mit dem ObjectDataSource-Steuerelement einfügen zur Verfügung stehen enthält DetailsViews-Smarttag jetzt das Kontrollkästchen einfügen aktivieren; Kehren Sie zum Designer zurück, und aktivieren Sie diese Option aus.</span><span class="sxs-lookup"><span data-stu-id="b5492-261">With the ObjectDataSource providing inserting capabilities, the DetailsView's smart tag will now include the Enable Inserting checkbox; return to the Designer and check this option.</span></span> <span data-ttu-id="b5492-262">Als Nächstes DetailsView kürzen, sodass sie nur zwei BoundFields - `ProductName` und `UnitPrice` - und die CommandField.</span><span class="sxs-lookup"><span data-stu-id="b5492-262">Next, pare down the DetailsView so that it only has two BoundFields - `ProductName` and `UnitPrice` - and the CommandField.</span></span> <span data-ttu-id="b5492-263">An diesem Punkt sollte die deklarative Syntax des DetailsView wie aussehen:</span><span class="sxs-lookup"><span data-stu-id="b5492-263">At this point the DetailsView's declarative syntax should look like:</span></span>


[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample9.aspx)]

<span data-ttu-id="b5492-264">Abbildung 16 zeigt diese Seite, wenn Sie über einen Browser an diesem Punkt angezeigt.</span><span class="sxs-lookup"><span data-stu-id="b5492-264">Figure 16 shows this page when viewed through a browser at this point.</span></span> <span data-ttu-id="b5492-265">Wie Sie sehen können, führt DetailsView, den Namen und den Preis für das erste Produkt (Chai entspricht).</span><span class="sxs-lookup"><span data-stu-id="b5492-265">As you can see, the DetailsView lists the name and price of the first product (Chai).</span></span> <span data-ttu-id="b5492-266">Wir möchten, ist jedoch eine einfügen-Schnittstelle, die eine Möglichkeit für den Benutzer der Datenbank schnell ein neues Produkt hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="b5492-266">What we want, however, is an inserting interface that provides a means for the user to quickly add a new product to the database.</span></span>


<span data-ttu-id="b5492-267">[![Die DetailsView ist zurzeit im schreibgeschützten Modus gerendert.](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image47.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="b5492-267">[![The DetailsView is Currently Rendered in Read-Only Mode](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image47.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image46.png)</span></span>

<span data-ttu-id="b5492-268">**Abbildung 16**: das DetailsView ist zurzeit im schreibgeschützten Modus gerendert ([klicken Sie, um das Bild in voller Größe anzeigen](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image48.png))</span><span class="sxs-lookup"><span data-stu-id="b5492-268">**Figure 16**: The DetailsView is Currently Rendered in Read-Only Mode ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image48.png))</span></span>


<span data-ttu-id="b5492-269">Um DetailsView in der Einfügemodus anzuzeigen, wir legen müssen, die `DefaultMode` Eigenschaft `Inserting`.</span><span class="sxs-lookup"><span data-stu-id="b5492-269">In order to show the DetailsView in its inserting mode we need to set the `DefaultMode` property to `Inserting`.</span></span> <span data-ttu-id="b5492-270">Dies DetailsView im Einfügemodus befindet, bei der ersten Anzeige gerendert und anschließend nach dem Einfügen eines neuen Datensatzes verfolgt.</span><span class="sxs-lookup"><span data-stu-id="b5492-270">This renders the DetailsView in insert mode when first visited and keeps it there after inserting a new record.</span></span> <span data-ttu-id="b5492-271">Wie in Abbildung 17 zeigt, bietet eine solche DetailsView eine schnelle Schnittstelle für einen neuen Datensatz hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="b5492-271">As Figure 17 shows, such a DetailsView provides a quick interface for adding a new record.</span></span>


<span data-ttu-id="b5492-272">[![Die DetailsView stellt eine Schnittstelle zum schnellen Hinzufügen ein neues Produkt bereit.](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image50.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="b5492-272">[![The DetailsView Provides an Interface for Quickly Adding a New Product](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image50.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image49.png)</span></span>

<span data-ttu-id="b5492-273">**Abbildung 17**: DetailsView stellt eine Schnittstelle zum schnellen Hinzufügen eines neuen Produkts ([klicken Sie, um das Bild in voller Größe anzeigen](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="b5492-273">**Figure 17**: The DetailsView Provides an Interface for Quickly Adding a New Product ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image51.png))</span></span>


<span data-ttu-id="b5492-274">Wenn der Benutzer einen Produktnamen und Preis (z. B. "Acme Kate" und 1,99, wie in Abbildung 17 gibt) und Insert klickt, erfolgt ein Postback und Einfügen von Workflows beginnt, einen neuen Produktdatensatz in der Datenbank hinzugefügt wird verbessert.</span><span class="sxs-lookup"><span data-stu-id="b5492-274">When the user enters a product name and price (such as "Acme Water" and 1.99, as in Figure 17) and clicks Insert, a postback ensues and the inserting workflow commences, culminating in a new product record being added to the database.</span></span> <span data-ttu-id="b5492-275">Die DetailsView verwaltet die einfügen-Schnittstelle und die GridView wird automatisch erneut gebunden mit der Datenquelle um das neue Produkt enthalten, wie in Abbildung 18 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="b5492-275">The DetailsView maintains its inserting interface and the GridView is automatically rebound to its data source in order to include the new product, as shown in Figure 18.</span></span>


![Das Produkt](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image52.png)

<span data-ttu-id="b5492-277">**Abbildung 18**: das Produkt "Acme Kate" in der Datenbank hinzugefügt wurde</span><span class="sxs-lookup"><span data-stu-id="b5492-277">**Figure 18**: The Product "Acme Water" Has Been Added to the Database</span></span>


<span data-ttu-id="b5492-278">Während die GridView in Abbildung 18, die Produkt-Felder fehlen, für die von der DetailsView-Schnittstelle nicht angezeigt wird `CategoryID`, `SupplierID`, `QuantityPerUnit`usw. zugewiesen `NULL` Datenbank Werte.</span><span class="sxs-lookup"><span data-stu-id="b5492-278">While the GridView in Figure 18 doesn't show it, the product fields lacking from the DetailsView interface `CategoryID`, `SupplierID`, `QuantityPerUnit`, and so on are assigned `NULL` database values.</span></span> <span data-ttu-id="b5492-279">Sie können dies sehen, indem Sie die folgenden Schritte ausführen:</span><span class="sxs-lookup"><span data-stu-id="b5492-279">You can see this by performing the following steps:</span></span>

1. <span data-ttu-id="b5492-280">Wechseln Sie zu dem Server-Explorer in Visual Studio</span><span class="sxs-lookup"><span data-stu-id="b5492-280">Go to the Server Explorer in Visual Studio</span></span>
2. <span data-ttu-id="b5492-281">Erweitern der `NORTHWND.MDF` Datenbankknoten</span><span class="sxs-lookup"><span data-stu-id="b5492-281">Expanding the `NORTHWND.MDF` database node</span></span>
3. <span data-ttu-id="b5492-282">Mit der rechten Maustaste auf die `Products` Knoten der Datenbank-Tabelle</span><span class="sxs-lookup"><span data-stu-id="b5492-282">Right-click on the `Products` database table node</span></span>
4. <span data-ttu-id="b5492-283">Wählen Sie die Tabellendaten anzeigen</span><span class="sxs-lookup"><span data-stu-id="b5492-283">Select Show Table Data</span></span>

<span data-ttu-id="b5492-284">Dadurch werden aufgelistet, alle Datensätze in der `Products` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="b5492-284">This will list all of the records in the `Products` table.</span></span> <span data-ttu-id="b5492-285">Wie in Abbildung 19 gezeigt, alle Spalten für unser neues Produkt außer `ProductID`, `ProductName`, und `UnitPrice` haben `NULL` Werte.</span><span class="sxs-lookup"><span data-stu-id="b5492-285">As Figure 19 shows, all of our new product's columns other than `ProductID`, `ProductName`, and `UnitPrice` have `NULL` values.</span></span>


<span data-ttu-id="b5492-286">[![Das Produkt Felder nicht in bereitgestellten DetailsView werden NULL-Werte zugewiesen](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image54.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image53.png)</span><span class="sxs-lookup"><span data-stu-id="b5492-286">[![The Product Fields Not Provided in the DetailsView are Assigned NULL Values](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image54.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image53.png)</span></span>

<span data-ttu-id="b5492-287">**Abbildung 19**: das Produkt Felder nicht in bereitgestellten DetailsView zugewiesen `NULL` Werte ([klicken Sie, um das Bild in voller Größe anzeigen](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image55.png))</span><span class="sxs-lookup"><span data-stu-id="b5492-287">**Figure 19**: The Product Fields Not Provided in the DetailsView are Assigned `NULL` Values ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image55.png))</span></span>


<span data-ttu-id="b5492-288">Wir möchten einen Standardwert angeben, außer `NULL` für eine oder mehrere der folgenden Spalte fest, entweder weil `NULL` ist nicht die beste Standardoption oder da die Datenbankspalte selbst nicht zugelassen wird `NULL` s.</span><span class="sxs-lookup"><span data-stu-id="b5492-288">We may want to provide a default value other than `NULL` for one or more of these column values, either because `NULL` isn't the best default option or because the database column itself doesn't allow `NULL` s.</span></span> <span data-ttu-id="b5492-289">Um dies zu erreichen wir die Werte der Parameter für die DetailsView programmgesteuert festlegen können `InputParameters` Auflistung.</span><span class="sxs-lookup"><span data-stu-id="b5492-289">To accomplish this we can programmatically set the values of the parameters of the DetailsView's `InputParameters` collection.</span></span> <span data-ttu-id="b5492-290">Diese Zuweisung erfolgt entweder im Handler für die DetailsView `ItemInserting` Ereignis oder dem ObjectDataSource-Steuerelement `Inserting` Ereignis.</span><span class="sxs-lookup"><span data-stu-id="b5492-290">This assignment can be done either in the event handler for the DetailsView's `ItemInserting` event or the ObjectDataSource's `Inserting` event.</span></span> <span data-ttu-id="b5492-291">Da wir bereits angesehen haben die Ereignisse vor und nach der Ebene auf die Web-Daten mit steuern Sie, sehen Sie wir uns mit dem ObjectDataSource-Steuerelement-Ereignisse dieses Mal.</span><span class="sxs-lookup"><span data-stu-id="b5492-291">Since we've already looked at using the pre- and post-level events at the data Web control level, let's explore using the ObjectDataSource's events this time.</span></span>

## <a name="step-4-assigning-values-to-thecategoryidandsupplieridparameters"></a><span data-ttu-id="b5492-292">Schritt 4: Zuweisen von Werten zu den`CategoryID`und`SupplierID`Parameter</span><span class="sxs-lookup"><span data-stu-id="b5492-292">Step 4: Assigning Values to the`CategoryID`and`SupplierID`Parameters</span></span>

<span data-ttu-id="b5492-293">Für dieses Tutorial nehmen wir, dass für die Anwendung, die beim Hinzufügen eines neuen Produkts über diese Schnittstelle die zugewiesen werden soll eine `CategoryID` und `SupplierID` Wert 1.</span><span class="sxs-lookup"><span data-stu-id="b5492-293">For this tutorial let's imagine that for our application when adding a new product through this interface it should be assigned a `CategoryID` and `SupplierID` value of 1.</span></span> <span data-ttu-id="b5492-294">Wie bereits erwähnt, verfügt über dem ObjectDataSource-Steuerelement ein Paar von vorab und nachträglich auf Ereignissen, Feuer während des Änderungsvorgangs Daten.</span><span class="sxs-lookup"><span data-stu-id="b5492-294">As mentioned earlier, the ObjectDataSource has a pair of pre- and post-level events that fire during the data modification process.</span></span> <span data-ttu-id="b5492-295">Bei der `Insert()` Methode aufgerufen wird, löst Sie zunächst dem ObjectDataSource-Steuerelement seine `Inserting` Ereignis ruft dann die Methode, die die `Insert()` -Methode zugeordnet wurde, und schließlich löst die `Inserted` Ereignis.</span><span class="sxs-lookup"><span data-stu-id="b5492-295">When its `Insert()` method is invoked, the ObjectDataSource first raises its `Inserting` event, then calls the method that its `Insert()` method has been mapped to, and finally raises the `Inserted` event.</span></span> <span data-ttu-id="b5492-296">Die `Inserting` -Ereignishandler bietet uns eine letzte Gelegenheit, um die Eingabeparameter optimieren oder 30-tägiges abzubrechen.</span><span class="sxs-lookup"><span data-stu-id="b5492-296">The `Inserting` event handler affords us one last opportunity to tweak the input parameters or cancel the operation outright.</span></span>

> [!NOTE]
> <span data-ttu-id="b5492-297">In einer echten Anwendung möchten Sie wahrscheinlich jedoch, ob Sie mit der Benutzer geben die Kategorie und Lieferanten, oder wählen Sie diesen Wert würden für diese Grundlage einiger Kriterien oder Business Logic (und nicht blind Auswählen einer ID von 1).</span><span class="sxs-lookup"><span data-stu-id="b5492-297">In a real-world application you would likely want to either let the user specify the category and supplier or would pick this value for them based on some criteria or business logic (rather than blindly selecting an ID of 1).</span></span> <span data-ttu-id="b5492-298">Das Beispiel veranschaulicht unabhängig davon, wie den Wert eines Eingabeparameters programmgesteuert aus vorab auf dem ObjectDataSource-Steuerelement-Ereignis festgelegt.</span><span class="sxs-lookup"><span data-stu-id="b5492-298">Regardless, the example illustrates how to programmatically set the value of an input parameter from the ObjectDataSource's pre-level event.</span></span>


<span data-ttu-id="b5492-299">Erstellen Sie einen Ereignishandler für das ObjectDataSource-Steuerelement in Ruhe `Inserting` Ereignis.</span><span class="sxs-lookup"><span data-stu-id="b5492-299">Take a moment to create an event handler for the ObjectDataSource's `Inserting` event.</span></span> <span data-ttu-id="b5492-300">Beachten Sie, dass der zweite Eingabeparameter für den Ereignishandler ein Objekt des Typs ist `ObjectDataSourceMethodEventArgs`, das hat es sich um eine Eigenschaft auf die Parameters-Auflistung (`InputParameters`) und eine Eigenschaft, um den Vorgang abzubrechen (`Cancel`).</span><span class="sxs-lookup"><span data-stu-id="b5492-300">Notice that the event handler's second input parameter is an object of type `ObjectDataSourceMethodEventArgs`, which has a property to access the parameters collection (`InputParameters`) and a property to cancel the operation (`Cancel`).</span></span>


[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample10.vb)]

<span data-ttu-id="b5492-301">An diesem Punkt die `InputParameters` Eigenschaft enthält die "ObjectDataSource" `InsertParameters` Auflistung mit den Werten aus der DetailsView zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="b5492-301">At this point, the `InputParameters` property contains the ObjectDataSource's `InsertParameters` collection with the values assigned from the DetailsView.</span></span> <span data-ttu-id="b5492-302">Um den Wert von einer der folgenden Parameter zu ändern, verwenden Sie einfach: `e.InputParameters("paramName") = value`.</span><span class="sxs-lookup"><span data-stu-id="b5492-302">To change the value of one of these parameters, simply use: `e.InputParameters("paramName") = value`.</span></span> <span data-ttu-id="b5492-303">Aus diesem Grund Festlegen der `CategoryID` und `SupplierID` anpassen, um die Werte von 1, die `Inserting` Ereignishandler wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="b5492-303">Therefore, to set the `CategoryID` and `SupplierID` to values of 1, adjust the `Inserting` event handler to look like the following:</span></span>


[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample11.vb)]

<span data-ttu-id="b5492-304">Diese Zeit beim Hinzufügen eines neuen Produkts (z. B. Acme Soda), die `CategoryID` und `SupplierID` für Spalten des neuen Produkts werden auf 1 festgelegt (siehe Abbildung 20).</span><span class="sxs-lookup"><span data-stu-id="b5492-304">This time when adding a new product (such as Acme Soda), the `CategoryID` and `SupplierID` columns of the new product are set to 1 (see Figure 20).</span></span>


<span data-ttu-id="b5492-305">[![Neue Produkte können die CategoryID und SupplierID Werte von Reihe 1](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image57.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image56.png)</span><span class="sxs-lookup"><span data-stu-id="b5492-305">[![New Products Now Have Their CategoryID and SupplierID Values Set to 1](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image57.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image56.png)</span></span>

<span data-ttu-id="b5492-306">**Abbildung 20**: neue Produkte jetzt haben deren `CategoryID` und `SupplierID` Werte auf 1 festgelegt ([klicken Sie, um das Bild in voller Größe anzeigen](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image58.png))</span><span class="sxs-lookup"><span data-stu-id="b5492-306">**Figure 20**: New Products Now Have Their `CategoryID` and `SupplierID` Values Set to 1 ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image58.png))</span></span>


## <a name="summary"></a><span data-ttu-id="b5492-307">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="b5492-307">Summary</span></span>

<span data-ttu-id="b5492-308">Während der bearbeiten, einfügen und Löschen von Prozess fortgesetzt werden sowohl das Datensteuerelement für das Web als auch dem ObjectDataSource-Steuerelement durch eine Reihe von vorab und nachträglich auf Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="b5492-308">During the editing, inserting, and deleting process, both the data Web control and the ObjectDataSource proceed through a number of pre- and post-level events.</span></span> <span data-ttu-id="b5492-309">In diesem Tutorial haben wir untersucht, die bereits auf Ereignisse und gesehen, wie verwenden Sie diese zum Anpassen der Eingabeparameter oder zum Abbrechen der datenänderungsvorgang vollständig sowohl aus dem Datensteuerelement für das Web und ObjectDataSource-Ereignissen.</span><span class="sxs-lookup"><span data-stu-id="b5492-309">In this tutorial we examined the pre-level events and saw how to use these to customize the input parameters or cancel the data modification operation altogether both from the data Web control and ObjectDataSource's events.</span></span> <span data-ttu-id="b5492-310">Betrachten wir im nächsten Tutorial erstellen und Verwenden von Ereignishandlern für die Ereignisse nach der Ebene.</span><span class="sxs-lookup"><span data-stu-id="b5492-310">In the next tutorial we'll look at creating and using event handlers for the post-level events.</span></span>

<span data-ttu-id="b5492-311">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="b5492-311">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="b5492-312">Der Autor</span><span class="sxs-lookup"><span data-stu-id="b5492-312">About the Author</span></span>

<span data-ttu-id="b5492-313">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben Büchern zu ASP/ASP.NET und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), arbeitet mit Microsoft-Web-Technologien seit 1998.</span><span class="sxs-lookup"><span data-stu-id="b5492-313">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="b5492-314">Er ist als ein unabhängiger Berater, Schulungsleiter und Autor.</span><span class="sxs-lookup"><span data-stu-id="b5492-314">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="b5492-315">Sein neueste Buch wird [*Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="b5492-315">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="b5492-316">Er ist unter [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="b5492-316">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="b5492-317">oder über seinen Blog finden Sie unter [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="b5492-317">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="b5492-318">Besonderen Dank an</span><span class="sxs-lookup"><span data-stu-id="b5492-318">Special Thanks To</span></span>

<span data-ttu-id="b5492-319">Diese tutorialreihe wurde durch viele hilfreiche Reviewer überprüft.</span><span class="sxs-lookup"><span data-stu-id="b5492-319">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="b5492-320">Führendes Prüfer für dieses Tutorial wurden Jackie Goor und Liz Shulok.</span><span class="sxs-lookup"><span data-stu-id="b5492-320">Lead reviewers for this tutorial were Jackie Goor and Liz Shulok.</span></span> <span data-ttu-id="b5492-321">Meine zukünftigen MSDN-Artikeln überprüfen möchten?</span><span class="sxs-lookup"><span data-stu-id="b5492-321">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="b5492-322">Wenn dies der Fall ist, löschen Sie mir eine Linie an [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="b5492-322">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="b5492-323">[Zurück](an-overview-of-inserting-updating-and-deleting-data-vb.md)
> [Weiter](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md)</span><span class="sxs-lookup"><span data-stu-id="b5492-323">[Previous](an-overview-of-inserting-updating-and-deleting-data-vb.md)
[Next](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md)</span></span>
