---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb
title: Verwenden von vorhandenen gespeicherten Prozeduren für TableAdapter-Steuerelemente des typisierten DataSet (VB) | Microsoft-Dokumentation
author: rick-anderson
description: Im vorherigen Tutorial haben wir wie den TableAdapter-Assistenten verwenden, um neue gespeicherte Prozeduren zu generieren. In diesem Tutorial erfahren Sie, wie demselben TableAdapter...
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/18/2007
ms.topic: article
ms.assetid: 2da25f6a-757e-4e7b-a812-1575288d8f7a
ms.technology: dotnet-webforms
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb
msc.type: authoredcontent
ms.openlocfilehash: a478b52387a6bbf726872978a0ad4a83c22c9911
ms.sourcegitcommit: 953ff9ea4369f154d6fd0239599279ddd3280009
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 07/03/2018
ms.locfileid: "37382895"
---
<a name="using-existing-stored-procedures-for-the-typed-datasets-tableadapters-vb"></a><span data-ttu-id="89c9a-104">Verwenden von vorhandenen gespeicherten Prozeduren für TableAdapter-Steuerelemente des typisierten DataSet (VB)</span><span class="sxs-lookup"><span data-stu-id="89c9a-104">Using Existing Stored Procedures for the Typed DataSet's TableAdapters (VB)</span></span>
====================
<span data-ttu-id="89c9a-105">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="89c9a-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="89c9a-106">[Code herunterladen](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_68_VB.zip) oder [PDF-Datei herunterladen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/datatutorial68vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="89c9a-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_68_VB.zip) or [Download PDF](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/datatutorial68vb1.pdf)</span></span>

> <span data-ttu-id="89c9a-107">Im vorherigen Tutorial haben wir wie den TableAdapter-Assistenten verwenden, um neue gespeicherte Prozeduren zu generieren.</span><span class="sxs-lookup"><span data-stu-id="89c9a-107">In the previous tutorial we learned how to use the TableAdapter Wizard to generate new stored procedures.</span></span> <span data-ttu-id="89c9a-108">In diesem Lernprogramm erfahren wir, wie die denselben Assistenten für TableAdapter mit gespeicherten Prozeduren arbeiten können.</span><span class="sxs-lookup"><span data-stu-id="89c9a-108">In this tutorial we learn how the same TableAdapter Wizard can work with existing stored procedures.</span></span> <span data-ttu-id="89c9a-109">Wir erfahren Sie, wie unsere Datenbank neue gespeicherte Prozeduren manuell hinzugefügt werden kann.</span><span class="sxs-lookup"><span data-stu-id="89c9a-109">We also learn how to manually add new stored procedures to our database.</span></span>


## <a name="introduction"></a><span data-ttu-id="89c9a-110">Einführung</span><span class="sxs-lookup"><span data-stu-id="89c9a-110">Introduction</span></span>

<span data-ttu-id="89c9a-111">In der [vorherigen Lernprogramm](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) erläutert, wie das typisierte DataSet-s TableAdapters konfiguriert werden konnte, um gespeicherte Prozeduren für den Zugriff Daten anstelle von Ad-hoc-SQL-Anweisungen verwenden.</span><span class="sxs-lookup"><span data-stu-id="89c9a-111">In the [preceding tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) we saw how the Typed DataSet s TableAdapters could be configured to use stored procedures to access data rather than ad-hoc SQL statements.</span></span> <span data-ttu-id="89c9a-112">Insbesondere untersucht wir, wie Sie den TableAdapter-Assistenten, die diese gespeicherten Prozeduren automatisch zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="89c9a-112">In particular, we examined how to have the TableAdapter wizard automatically create these stored procedures.</span></span> <span data-ttu-id="89c9a-113">Bei der Portierung von einer älteren Anwendung zu ASP.NET 2.0 oder eine ASP.NET 2.0-Website, um ein vorhandenes Datenmodell zu erstellen, ist es wahrscheinlich, dass die Datenbank enthält bereits die gespeicherten Prozeduren, die wir benötigen.</span><span class="sxs-lookup"><span data-stu-id="89c9a-113">When porting a legacy application to ASP.NET 2.0 or when building an ASP.NET 2.0 website around an existing data model, chances are that the database already contains the stored procedures we need.</span></span> <span data-ttu-id="89c9a-114">Sie können auch empfiehlt es sich um die gespeicherten Prozeduren zu erstellen, manuell oder über ein Tool als dem TableAdapter-Assistenten, der die gespeicherten Prozeduren automatisch generiert.</span><span class="sxs-lookup"><span data-stu-id="89c9a-114">Alternatively, you may prefer to create your stored procedures by hand or through some tool other than the TableAdapter wizard that auto-generates your stored procedures.</span></span>

<span data-ttu-id="89c9a-115">In diesem Tutorial werden wir konfigurieren den TableAdapter um vorhandene gespeicherte Prozeduren verwenden betrachten.</span><span class="sxs-lookup"><span data-stu-id="89c9a-115">In this tutorial we will look at how to configure the TableAdapter to use existing stored procedures.</span></span> <span data-ttu-id="89c9a-116">Da die Northwind-Datenbank nur eine kleine Gruppe von integrierten gespeicherten Prozeduren verfügt, werden wir auch die erforderlichen Schritte zum neue gespeicherte Prozeduren der Datenbank über Visual Studio-Umgebung manuell hinzufügen ansehen.</span><span class="sxs-lookup"><span data-stu-id="89c9a-116">Since the Northwind database only has a small set of built-in stored procedures, we will also look at the steps needed to manually add new stored procedures to the database through the Visual Studio environment.</span></span> <span data-ttu-id="89c9a-117">Lassen Sie s beginnen!</span><span class="sxs-lookup"><span data-stu-id="89c9a-117">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="89c9a-118">In der [Umschließen von Datenbankänderungen innerhalb einer Transaktion](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) Tutorial wir Methoden hinzugefügt, dem TableAdapter zum Unterstützen von Transaktionen (`BeginTransaction`, `CommitTransaction`und so weiter).</span><span class="sxs-lookup"><span data-stu-id="89c9a-118">In the [Wrapping Database Modifications within a Transaction](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial we added methods to the TableAdapter to support transactions (`BeginTransaction`, `CommitTransaction`, and so on).</span></span> <span data-ttu-id="89c9a-119">Alternativ können Transaktionen vollständig innerhalb einer gespeicherten Prozedur erfordert keine Änderungen am Code der Datenzugriffsebene verwaltet werden.</span><span class="sxs-lookup"><span data-stu-id="89c9a-119">Alternatively, transactions can be managed entirely within a stored procedure, which requires no modifications to the Data Access Layer code.</span></span> <span data-ttu-id="89c9a-120">In diesem Lernprogramm lernen wir die T-SQL-Befehle verwendet, um eine gespeicherte Prozedur s-Anweisungen innerhalb des Bereichs einer Transaktion auszuführen.</span><span class="sxs-lookup"><span data-stu-id="89c9a-120">In this tutorial we'll explore the T-SQL commands used to execute a stored procedure s statements within the scope of a transaction.</span></span>


## <a name="step-1-adding-stored-procedures-to-the-northwind-database"></a><span data-ttu-id="89c9a-121">Schritt 1: Hinzufügen von gespeicherten Prozeduren mit der Datenbank Northwind</span><span class="sxs-lookup"><span data-stu-id="89c9a-121">Step 1: Adding Stored Procedures to the Northwind Database</span></span>

<span data-ttu-id="89c9a-122">Visual Studio erleichtert das Hinzufügen von neuen gespeicherten Prozeduren in einer Datenbank.</span><span class="sxs-lookup"><span data-stu-id="89c9a-122">Visual Studio makes it easy to add new stored procedures to a database.</span></span> <span data-ttu-id="89c9a-123">Let s hinzufügen eine neue gespeicherte Prozedur zur Northwind-Datenbank, die alle Spalten zurückgibt. die `Products` mit einer bestimmten Tabelle `CategoryID` Wert.</span><span class="sxs-lookup"><span data-stu-id="89c9a-123">Let s add a new stored procedure to the Northwind database that returns all columns from the `Products` table for those that have a particular `CategoryID` value.</span></span> <span data-ttu-id="89c9a-124">Erweitern Sie im Server-Explorer-Fenster die Northwind-Datenbank ein, sodass die Ordner - Datenbankdiagramme, Tabellen, Ansichten und So weiter – angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="89c9a-124">From the Server Explorer window, expand the Northwind database so that its folders - Database Diagrams, Tables, Views, and so forth - are displayed.</span></span> <span data-ttu-id="89c9a-125">Wie wir im vorherigen Tutorial gesehen haben, enthält der Ordner für gespeicherte Prozeduren der Datenbank s vorhandene gespeicherte Prozeduren.</span><span class="sxs-lookup"><span data-stu-id="89c9a-125">As we saw in the preceding tutorial, the Stored Procedures folder contains the database s existing stored procedures.</span></span> <span data-ttu-id="89c9a-126">Um eine neue gespeicherte Prozedur hinzuzufügen, mit der rechten Maustaste in des Ordners gespeicherte Prozeduren und wählen Sie im Kontextmenü die Option neue gespeicherte Prozedur hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="89c9a-126">To add a new stored procedure, simply right-click the Stored Procedures folder and choose the Add New Stored Procedure option from the context menu.</span></span>


<span data-ttu-id="89c9a-127">[![Mit der rechten Maustaste in des Ordners gespeicherte Prozeduren, und fügen Sie eine neue gespeicherte Prozedur hinzu.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image2.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="89c9a-127">[![Right-Click the Stored Procedures Folder and Add a New Stored Procedure](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image2.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image1.png)</span></span>

<span data-ttu-id="89c9a-128">**Abbildung 1**: mit der rechten Maustaste in den Ordner für gespeicherte Prozeduren und Hinzufügen einer neuen gespeicherten Prozedur ([klicken Sie, um das Bild in voller Größe anzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="89c9a-128">**Figure 1**: Right-Click the Stored Procedures Folder and Add a New Stored Procedure ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image3.png))</span></span>


<span data-ttu-id="89c9a-129">Wie in Abbildung 1 gezeigt, die neue gespeicherte Prozedur hinzufügen-Option wird ein Skriptfenster geöffnet in Visual Studio mit der Gliederung des SQL-Skripts zum Erstellen der gespeicherten Prozedur erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="89c9a-129">As Figure 1 shows, selecting the Add New Stored Procedure option opens a script window in Visual Studio with the outline of the SQL script needed to create the stored procedure.</span></span> <span data-ttu-id="89c9a-130">Es ist unsere Aufgabe Ausarbeitung dieses Skript aus, und führen Sie es, die an diesem Punkt der Datenbank die gespeicherte Prozedur hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="89c9a-130">It is our job to flesh out this script and execute it, at which point the stored procedure will be added to the database.</span></span>

<span data-ttu-id="89c9a-131">Geben Sie das folgende Skript aus:</span><span class="sxs-lookup"><span data-stu-id="89c9a-131">Enter the following script:</span></span>


[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample1.sql)]

<span data-ttu-id="89c9a-132">Dieses Skript, bei der Ausführung wird eine neue gespeicherte Prozedur hinzuzufügen, mit der Northwind-Datenbank, die mit dem Namen `Products_SelectByCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="89c9a-132">This script, when executed, will add a new stored procedure to the Northwind database named `Products_SelectByCategoryID`.</span></span> <span data-ttu-id="89c9a-133">Diese gespeicherte Prozedur nimmt einen einzelnen Eingabeparameter (`@CategoryID`, des Typs `int`) und alle Felder für diese Produkte mit einem entsprechenden `CategoryID` Wert.</span><span class="sxs-lookup"><span data-stu-id="89c9a-133">This stored procedure accepts a single input parameter (`@CategoryID`, of type `int`) and it returns all of the fields for those products with a matching `CategoryID` value.</span></span>

<span data-ttu-id="89c9a-134">Zum Ausführen dieser `CREATE PROCEDURE` Skript und fügen Sie die gespeicherte Prozedur in der Datenbank, klicken Sie auf das Symbol "Speichern" in der Symbolleiste oder STRG + S drücken.</span><span class="sxs-lookup"><span data-stu-id="89c9a-134">To execute this `CREATE PROCEDURE` script and add the stored procedure to the database, click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="89c9a-135">Zeigt die neu erstellte nach dem dies der Fall, die gespeicherten Prozeduren Ordner aktualisiert, gespeicherte Prozedur aus.</span><span class="sxs-lookup"><span data-stu-id="89c9a-135">After doing so, the Stored Procedures folder refreshes, showing the newly created stored procedure.</span></span> <span data-ttu-id="89c9a-136">Darüber hinaus ändert das Skript im Fenster Besonderheit aus `CREATE PROCEDURE dbo.Products_SelectProductByCategoryID` zu `ALTER PROCEDURE` `dbo.Products_SelectProductByCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="89c9a-136">Also, the script in the window will change subtlety from `CREATE PROCEDURE dbo.Products_SelectProductByCategoryID` to `ALTER PROCEDURE` `dbo.Products_SelectProductByCategoryID`.</span></span> <span data-ttu-id="89c9a-137">`CREATE PROCEDURE` Fügt eine neue gespeicherte Prozedur in der Datenbank während `ALTER PROCEDURE` aktualisiert eine bereits vorhandene.</span><span class="sxs-lookup"><span data-stu-id="89c9a-137">`CREATE PROCEDURE` adds a new stored procedure to the database, while `ALTER PROCEDURE` updates an existing one.</span></span> <span data-ttu-id="89c9a-138">Seit dem Start des Skripts geändert hat `ALTER PROCEDURE`, ändern die gespeicherten Prozeduren eingeben, Parameter oder SQL-Anweisungen, und klicken Sie auf das Symbol "Speichern", wird die gespeicherte Prozedur mit diesen Änderungen aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="89c9a-138">Since the start of the script has changed to `ALTER PROCEDURE`, changing the stored procedures input parameters or SQL statements and clicking the Save icon will update the stored procedure with these changes.</span></span>

<span data-ttu-id="89c9a-139">Abbildung 2 zeigt Visual Studio, nachdem die `Products_SelectByCategoryID` gespeicherte Prozedur wurde gespeichert.</span><span class="sxs-lookup"><span data-stu-id="89c9a-139">Figure 2 shows Visual Studio after the `Products_SelectByCategoryID` stored procedure has been saved.</span></span>


<span data-ttu-id="89c9a-140">[![Die gespeicherte Prozedur Products_SelectByCategoryID wurde in der Datenbank hinzugefügt](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image5.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="89c9a-140">[![The Stored Procedure Products_SelectByCategoryID Has Been Added to the Database](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image5.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image4.png)</span></span>

<span data-ttu-id="89c9a-141">**Abbildung 2**: die gespeicherte Prozedur `Products_SelectByCategoryID` wurde in der Datenbank hinzugefügt wurden ([klicken Sie, um das Bild in voller Größe anzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="89c9a-141">**Figure 2**: The Stored Procedure `Products_SelectByCategoryID` Has Been Added to the Database ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image6.png))</span></span>


## <a name="step-2-configuring-the-tableadapter-to-use-an-existing-stored-procedure"></a><span data-ttu-id="89c9a-142">Schritt 2: Konfigurieren den TableAdapter um eine vorhandene gespeicherte Prozedur zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="89c9a-142">Step 2: Configuring the TableAdapter to Use an Existing Stored Procedure</span></span>

<span data-ttu-id="89c9a-143">Nachdem die `Products_SelectByCategoryID` gespeicherte Prozedur wurde in der Datenbank konfigurieren wir unsere Data Access Layer, um diese gespeicherte Prozedur zu verwenden, wenn eine ihrer Methoden aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="89c9a-143">Now that the `Products_SelectByCategoryID` stored procedure has been added to the database, we can configure our Data Access Layer to use this stored procedure when one of its methods is invoked.</span></span> <span data-ttu-id="89c9a-144">Insbesondere fügen wir eine `GetProducstByCategoryID(<_i22_>categoryID)<!--_i22_-->` Methode, um die `ProductsTableAdapter` in die `NorthwindWithSprocs` typisierte DataSet, die aufruft, die `Products_SelectByCategoryID` gespeicherte Prozedur, die wir gerade erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="89c9a-144">In particular, we will add a `GetProducstByCategoryID(<_i22_>categoryID)<!--_i22_-->` method to the `ProductsTableAdapter` in the `NorthwindWithSprocs` Typed DataSet that calls the `Products_SelectByCategoryID` stored procedure we just created.</span></span>

<span data-ttu-id="89c9a-145">Öffnen Sie zunächst die `NorthwindWithSprocs` DataSet.</span><span class="sxs-lookup"><span data-stu-id="89c9a-145">Start by opening the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="89c9a-146">Mit der rechten Maustaste auf die `ProductsTableAdapter` , und wählen Sie die Abfrage hinzufügen, um den TableAdapter-Abfrage-Konfigurations-Assistenten zu starten.</span><span class="sxs-lookup"><span data-stu-id="89c9a-146">Right-click on the `ProductsTableAdapter` and choose Add Query to launch the TableAdapter Query Configuration wizard.</span></span> <span data-ttu-id="89c9a-147">In der [vorherigen Lernprogramm](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) ausgewählt, um den TableAdapter, erstellen Sie eine neue gespeicherte Prozedur für uns zu haben.</span><span class="sxs-lookup"><span data-stu-id="89c9a-147">In the [preceding tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) we opted to have the TableAdapter create a new stored procedure for us.</span></span> <span data-ttu-id="89c9a-148">In diesem Tutorial allerdings möchten wir, die neue Methode des TableAdapter zu verknüpfen, mit dem vorhandenen `Products_SelectByCategoryID` gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="89c9a-148">For this tutorial, however, we want to wire the new TableAdapter method to the existing `Products_SelectByCategoryID` stored procedure.</span></span> <span data-ttu-id="89c9a-149">Daher wählen Sie die Option vorhandene gespeicherte Prozedur verwenden, aus dem ersten Schritt des Assistenten-s, und klicken Sie dann auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="89c9a-149">Therefore, choose the Use existing stored procedure option from the wizard s first step and then click Next.</span></span>


<span data-ttu-id="89c9a-150">[![Wählen Sie die vorhandene gespeicherte Prozedur-Option verwenden](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image8.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="89c9a-150">[![Choose the Use existing stored procedure Option](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image8.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image7.png)</span></span>

<span data-ttu-id="89c9a-151">**Abbildung 3**: Wählen Sie die vorhandene gespeicherte Prozedur Option ([klicken Sie, um das Bild in voller Größe anzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="89c9a-151">**Figure 3**: Choose the Use existing stored procedure Option ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image9.png))</span></span>


<span data-ttu-id="89c9a-152">Der folgende Bildschirm bietet eine Dropdown-Liste mit der s-Datenbank gespeicherte Prozeduren aufgefüllt.</span><span class="sxs-lookup"><span data-stu-id="89c9a-152">The following screen provides a drop-down list populated with the database s stored procedures.</span></span> <span data-ttu-id="89c9a-153">Eine gespeicherte Prozedur auswählen, sind seine Eingabeparameter auf der linken Seite und die Datenfelder zurückgegeben (sofern vorhanden) auf der rechten Seite aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="89c9a-153">Selecting a stored procedure lists its input parameters on the left and the data fields returned (if any) on the right.</span></span> <span data-ttu-id="89c9a-154">Wählen Sie die `Products_SelectByCategoryID` gespeicherte Prozedur aus der Liste aus, und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="89c9a-154">Choose the `Products_SelectByCategoryID` stored procedure from the list and click Next.</span></span>


<span data-ttu-id="89c9a-155">[![Wählen Sie die Products_SelectByCategoryID gespeicherten Prozedur](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image11.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="89c9a-155">[![Pick the Products_SelectByCategoryID Stored Procedure](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image11.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image10.png)</span></span>

<span data-ttu-id="89c9a-156">**Abbildung 4**: Wählen Sie die `Products_SelectByCategoryID` Stored Procedure ([klicken Sie, um das Bild in voller Größe anzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="89c9a-156">**Figure 4**: Pick the `Products_SelectByCategoryID` Stored Procedure ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image12.png))</span></span>


<span data-ttu-id="89c9a-157">Im nächste Bildschirm werden wir gefragt, welche Art von Daten von der gespeicherten Prozedur zurückgegeben wird, und hier beantwortet bestimmt den Typ, der von der TableAdapter-s-Methode zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="89c9a-157">The next screen asks us what kind of data is returned by the stored procedure and our answer here determines the type returned by the TableAdapter s method.</span></span> <span data-ttu-id="89c9a-158">Angenommen, wir angeben, dass es sich bei tabellarischen Daten zurückgegeben werden, die Methode gibt eine `ProductsDataTable` Instanz, die mit den von der gespeicherten Prozedur zurückgegebenen Datensätzen aufgefüllt.</span><span class="sxs-lookup"><span data-stu-id="89c9a-158">For example, if we indicate that tabular data is returned, the method will return a `ProductsDataTable` instance populated with the records returned by the stored procedure.</span></span> <span data-ttu-id="89c9a-159">Im Gegensatz dazu Wenn, dass diese gespeicherte Prozedur einen einzelnen Wert zurückgibt, geben wir der TableAdapter zurück eine `Object` , die den Wert in der ersten Spalte der ersten von der gespeicherten Prozedur zurückgegebenen Datensatz zugewiesen ist.</span><span class="sxs-lookup"><span data-stu-id="89c9a-159">In contrast, if we indicate that this stored procedure returns a single value the TableAdapter will return an `Object` that is assigned the value in the first column of the first record returned by the stored procedure.</span></span>

<span data-ttu-id="89c9a-160">Da die `Products_SelectByCategoryID` gespeicherte Prozedur gibt alle Produkte, die einer bestimmten Kategorie gehören, wählen Sie die erste Antwort - Tabellendaten - aus, und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="89c9a-160">Since the `Products_SelectByCategoryID` stored procedure returns all products that belong to a particular category, choose the first answer - Tabular data - and click Next.</span></span>


<span data-ttu-id="89c9a-161">[![Anzugeben Sie, dass die gespeicherte Prozedur Tabellendaten zurück.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image14.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="89c9a-161">[![Indicate that the Stored Procedure Returns Tabular Data](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image14.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image13.png)</span></span>

<span data-ttu-id="89c9a-162">**Abbildung 5**: anzugeben, dass die gespeicherte Prozedur Tabellendaten zurückgibt ([klicken Sie, um das Bild in voller Größe anzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="89c9a-162">**Figure 5**: Indicate that the Stored Procedure Returns Tabular Data ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image15.png))</span></span>


<span data-ttu-id="89c9a-163">Übrig bleibt, um anzugeben, welche Methode-Muster verwenden die Namen für diese Methoden folgen.</span><span class="sxs-lookup"><span data-stu-id="89c9a-163">All that remains is to indicate what method patterns to use followed by the names for these methods.</span></span> <span data-ttu-id="89c9a-164">Lassen Sie eine DataTable und die Rückgabe, eine DataTable-Optionen aktiviert, aber benennen Sie die Methoden, die, beide der Füllung `FillByCategoryID` und `GetProductsByCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="89c9a-164">Leave both the Fill a DataTable and Return a DataTable options checked, but rename the methods to `FillByCategoryID` and `GetProductsByCategoryID`.</span></span> <span data-ttu-id="89c9a-165">Klicken Sie dann auf Weiter, um eine Zusammenfassung der Aufgaben zu überprüfen, die der Assistent ausführt.</span><span class="sxs-lookup"><span data-stu-id="89c9a-165">Then click Next to review a summary of the tasks the wizard will perform.</span></span> <span data-ttu-id="89c9a-166">Wenn alles korrekt aussieht, klicken Sie auf "Fertig stellen".</span><span class="sxs-lookup"><span data-stu-id="89c9a-166">If everything looks correct, click Finish.</span></span>


<span data-ttu-id="89c9a-167">[![Namen der Methoden FillByCategoryID und GetProductsByCategoryID](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image17.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="89c9a-167">[![Name the Methods FillByCategoryID and GetProductsByCategoryID](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image17.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image16.png)</span></span>

<span data-ttu-id="89c9a-168">**Abbildung 6**: Benennen Sie die Methoden `FillByCategoryID` und `GetProductsByCategoryID` ([klicken Sie, um das Bild in voller Größe anzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="89c9a-168">**Figure 6**: Name the Methods `FillByCategoryID` and `GetProductsByCategoryID` ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image18.png))</span></span>


> [!NOTE]
> <span data-ttu-id="89c9a-169">Die TableAdapter-Methoden, die wir gerade erstellt haben, `FillByCategoryID` und `GetProductsByCategoryID`, erwartet einen Eingabeparameter vom Typ `Integer`.</span><span class="sxs-lookup"><span data-stu-id="89c9a-169">The TableAdapter methods we just created, `FillByCategoryID` and `GetProductsByCategoryID`, expect an input parameter of type `Integer`.</span></span> <span data-ttu-id="89c9a-170">Dieser Eingabeparameter-Wert wird übergeben, in der gespeicherten Prozedur über seine `@CategoryID` Parameter.</span><span class="sxs-lookup"><span data-stu-id="89c9a-170">This input parameter value is passed into the stored procedure via its `@CategoryID` parameter.</span></span> <span data-ttu-id="89c9a-171">Wenn Sie ändern die `Products_SelectByCategory` Parameter der gespeicherten Prozedur s, müssen Sie auch die Parameter für diese TableAdapter-Methoden zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="89c9a-171">If you modify the `Products_SelectByCategory` stored procedure s parameters, you'll need to also update the parameters for these TableAdapter methods.</span></span> <span data-ttu-id="89c9a-172">Siehe die [vorherigen Tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md), dies in zwei Arten möglich: manuell hinzufügen oder Entfernen von Parametern aus der Parameterauflistung oder erneut den TableAdapter-Assistenten auszuführen.</span><span class="sxs-lookup"><span data-stu-id="89c9a-172">As discussed in the [previous tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md), this can be done in one of two ways: by manually adding or removing parameters from the parameters collection or by rerunning the TableAdapter wizard.</span></span>


## <a name="step-3-adding-agetproductsbycategoryidcategoryidmethod-to-the-bll"></a><span data-ttu-id="89c9a-173">Schritt 3: Hinzufügen einer`GetProductsByCategoryID(categoryID)`Methode, um die BLL</span><span class="sxs-lookup"><span data-stu-id="89c9a-173">Step 3: Adding a`GetProductsByCategoryID(categoryID)`Method to the BLL</span></span>

<span data-ttu-id="89c9a-174">Mit der `GetProductsByCategoryID` DAL-Methode abgeschlossen, der nächste Schritt besteht Zugriff auf diese Methode in der Geschäftslogikebene.</span><span class="sxs-lookup"><span data-stu-id="89c9a-174">With the `GetProductsByCategoryID` DAL method complete, the next step is to provide access to this method in the Business Logic Layer.</span></span> <span data-ttu-id="89c9a-175">Öffnen der `ProductsBLLWithSprocs` Klassendatei, und fügen Sie die folgende Methode hinzu:</span><span class="sxs-lookup"><span data-stu-id="89c9a-175">Open the `ProductsBLLWithSprocs` class file and add the following method:</span></span>


[!code-vb[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample2.vb)]

<span data-ttu-id="89c9a-176">Einfach diese Geschäftslogikschicht-Methode gibt zurück, die `ProductsDataTable` zurückgegeben, die von der `ProductsTableAdapter` s `GetProductsByCategoryID` Methode.</span><span class="sxs-lookup"><span data-stu-id="89c9a-176">This BLL method simply returns the `ProductsDataTable` returned from the `ProductsTableAdapter` s `GetProductsByCategoryID` method.</span></span> <span data-ttu-id="89c9a-177">Die `DataObjectMethodAttribute` Attribut enthält Metadaten, die von der "ObjectDataSource"-s-Konfigurieren von Datenquellen-Assistent verwendet.</span><span class="sxs-lookup"><span data-stu-id="89c9a-177">The `DataObjectMethodAttribute` attribute provides metadata used by the ObjectDataSource s Configure Data Source wizard.</span></span> <span data-ttu-id="89c9a-178">Diese Methode wird vor allem in der Registerkarte "SELECT" s Dropdown-Liste angezeigt.</span><span class="sxs-lookup"><span data-stu-id="89c9a-178">In particular, this method will appear in the SELECT tab s drop-down list.</span></span>

## <a name="step-4-displaying-products-by-category"></a><span data-ttu-id="89c9a-179">Schritt 4: Produkte nach Kategorie anzeigen</span><span class="sxs-lookup"><span data-stu-id="89c9a-179">Step 4: Displaying Products by Category</span></span>

<span data-ttu-id="89c9a-180">So testen Sie die neu hinzugefügte `Products_SelectByCategoryID` gespeicherte Prozedur und die entsprechenden DAL und BLL-Methoden können s eine ASP.NET-Seite erstellen, die einem DropDownList-Steuerelement und einer GridView-Ansicht enthält.</span><span class="sxs-lookup"><span data-stu-id="89c9a-180">To test the newly added `Products_SelectByCategoryID` stored procedure and the corresponding DAL and BLL methods, let s create an ASP.NET page that contains a DropDownList and a GridView.</span></span> <span data-ttu-id="89c9a-181">Der Dropdownliste werden alle Kategorien in der Datenbank aufgelistet, während die GridView, die Produkte der ausgewählten Kategorie angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="89c9a-181">The DropDownList will list all of the categories in the database while the GridView will display the products belonging to the selected category.</span></span>

> [!NOTE]
> <span data-ttu-id="89c9a-182">Wir haben erstellt Master-/Detailberichten Schnittstellen DropDownList-Steuerelementen in vorherigen Tutorials verwenden.</span><span class="sxs-lookup"><span data-stu-id="89c9a-182">We ve created master/detail interfaces using DropDownLists in previous tutorials.</span></span> <span data-ttu-id="89c9a-183">Ausführlichere Informationen zum Implementieren eines solchen Master/Detail-Berichts, finden Sie in der [Master/Detail-Filtern mit einer DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) Tutorial.</span><span class="sxs-lookup"><span data-stu-id="89c9a-183">For a more in-depth look at implementing such a master/detail report, refer to the [Master/Detail Filtering With a DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) tutorial.</span></span>


<span data-ttu-id="89c9a-184">Öffnen der `ExistingSprocs.aspx` auf der Seite die `AdvancedDAL` Ordner, und ziehen Sie einem DropDownList-Steuerelement aus der Toolbox in den Designer.</span><span class="sxs-lookup"><span data-stu-id="89c9a-184">Open the `ExistingSprocs.aspx` page in the `AdvancedDAL` folder and drag a DropDownList from the Toolbox onto the Designer.</span></span> <span data-ttu-id="89c9a-185">Legen Sie die DropDownList-Zuordnungsvorgänge `ID` Eigenschaft `Categories` und die zugehörige `AutoPostBack` Eigenschaft `True`.</span><span class="sxs-lookup"><span data-stu-id="89c9a-185">Set the DropDownList s `ID` property to `Categories` and its `AutoPostBack` property to `True`.</span></span> <span data-ttu-id="89c9a-186">Binden Sie als Nächstes aus sein Smarttag, DropDownList an eine neue, mit dem Namen "ObjectDataSource" `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="89c9a-186">Next, from its smart tag, bind the DropDownList to a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="89c9a-187">Dem ObjectDataSource-Steuerelement so konfigurieren, dass, die Daten aus der abgerufen die `CategoriesBLL` Klasse s `GetCategories` Methode.</span><span class="sxs-lookup"><span data-stu-id="89c9a-187">Configure the ObjectDataSource so that it retrieves its data from the `CategoriesBLL` class s `GetCategories` method.</span></span> <span data-ttu-id="89c9a-188">Legen Sie die Dropdownlisten in der Update-, INSERT-, und löschen Sie die Registerkarten auf (keine).</span><span class="sxs-lookup"><span data-stu-id="89c9a-188">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>


<span data-ttu-id="89c9a-189">[![Abrufen von Daten aus der CategoriesBLL Klasse s GetCategories-Methode](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image20.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="89c9a-189">[![Retrieve Data from the CategoriesBLL Class s GetCategories Method](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image20.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image19.png)</span></span>

<span data-ttu-id="89c9a-190">**Abbildung 7**: Abrufen von Daten aus der `CategoriesBLL` Klasse s `GetCategories` Methode ([klicken Sie, um das Bild in voller Größe anzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="89c9a-190">**Figure 7**: Retrieve Data from the `CategoriesBLL` Class s `GetCategories` Method ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image21.png))</span></span>


<span data-ttu-id="89c9a-191">[![Legen Sie die Dropdownlisten in der Update-, INSERT- und DELETE werden Registerkarten (keine)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image23.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="89c9a-191">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image23.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image22.png)</span></span>

<span data-ttu-id="89c9a-192">**Abbildung 8**: Legen Sie die Dropdownlisten in der Update-, INSERT- und Löschen von Registerkarten auf (keine) ([klicken Sie, um das Bild in voller Größe anzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="89c9a-192">**Figure 8**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image24.png))</span></span>


<span data-ttu-id="89c9a-193">Konfigurieren Sie nach Abschluss des Assistenten "ObjectDataSource" DropDownList zum Anzeigen der `CategoryName` Feld "Daten" und für die Verwendung der `CategoryID` als Feld der `Value` für jede `ListItem`.</span><span class="sxs-lookup"><span data-stu-id="89c9a-193">After completing the ObjectDataSource wizard, configure the DropDownList to display the `CategoryName` data field and to use the `CategoryID` field as the `Value` for each `ListItem`.</span></span>

<span data-ttu-id="89c9a-194">An diesem Punkt sollten die DropDownList und "ObjectDataSource" s deklarative Markup etwa wie folgt:</span><span class="sxs-lookup"><span data-stu-id="89c9a-194">At this point, the DropDownList and ObjectDataSource s declarative markup should similar to the following:</span></span>


[!code-aspx[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample3.aspx)]

<span data-ttu-id="89c9a-195">Ziehen Sie anschließend einer GridView-Ansicht auf den Designer, und platzieren es unterhalb der Dropdownliste aus.</span><span class="sxs-lookup"><span data-stu-id="89c9a-195">Next, drag a GridView onto the Designer, placing it beneath the DropDownList.</span></span> <span data-ttu-id="89c9a-196">Legen Sie die GridView s `ID` zu `ProductsByCategory` und von sein Smarttag, binden Sie es an eine neue, mit dem Namen "ObjectDataSource" `ProductsByCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="89c9a-196">Set the GridView s `ID` to `ProductsByCategory` and, from its smart tag, bind it to a new ObjectDataSource named `ProductsByCategoryDataSource`.</span></span> <span data-ttu-id="89c9a-197">Konfigurieren der `ProductsByCategoryDataSource` "ObjectDataSource" Verwenden der `ProductsBLLWithSprocs` -Klasse, dass rufen Sie die Daten mithilfe der `GetProductsByCategoryID(categoryID)` Methode.</span><span class="sxs-lookup"><span data-stu-id="89c9a-197">Configure the `ProductsByCategoryDataSource` ObjectDataSource to use the `ProductsBLLWithSprocs` class, having it retrieve its data using the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="89c9a-198">Da diese GridView nur zum Anzeigen von Daten verwendet werden wird, legen Sie die Dropdownlisten in der Update-, INSERT-, löschen Sie Registerkarten (keine) und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="89c9a-198">Since this GridView will only be used to display data, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) and click Next.</span></span>


<span data-ttu-id="89c9a-199">[![Konfigurieren von dem ObjectDataSource-Steuerelement zur Verwendung der ProductsBLLWithSprocs-Klasse](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image26.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="89c9a-199">[![Configure the ObjectDataSource to Use the ProductsBLLWithSprocs Class](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image26.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image25.png)</span></span>

<span data-ttu-id="89c9a-200">**Abbildung 9**: Konfigurieren von dem ObjectDataSource-Steuerelement verwenden die `ProductsBLLWithSprocs` Klasse ([klicken Sie, um das Bild in voller Größe anzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="89c9a-200">**Figure 9**: Configure the ObjectDataSource to Use the `ProductsBLLWithSprocs` Class ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image27.png))</span></span>


<span data-ttu-id="89c9a-201">[![Abrufen von Daten aus der GetProductsByCategoryID(categoryID)-Methode](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image29.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="89c9a-201">[![Retrieve Data from the GetProductsByCategoryID(categoryID) Method](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image29.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image28.png)</span></span>

<span data-ttu-id="89c9a-202">**Abbildung 10**: Abrufen von Daten aus der `GetProductsByCategoryID(categoryID)` Methode ([klicken Sie, um das Bild in voller Größe anzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="89c9a-202">**Figure 10**: Retrieve Data from the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image30.png))</span></span>


<span data-ttu-id="89c9a-203">Die Methode, die in der Registerkarte "SELECT" ausgewählt erwartet einen Parameter, damit der letzte Schritt des Assistenten uns für die Parameter-s-Quelle fordert.</span><span class="sxs-lookup"><span data-stu-id="89c9a-203">The method chosen in the SELECT tab expects a parameter, so the final step of the wizard prompts us for the parameter s source.</span></span> <span data-ttu-id="89c9a-204">Der Parameter-Quellliste Dropdown-Steuerelement festgelegt, und wählen Sie die `Categories` Steuerelement aus der ControlID Dropdown-Liste.</span><span class="sxs-lookup"><span data-stu-id="89c9a-204">Set the Parameter source drop-down list to Control and choose the `Categories` control from the ControlID drop-down list.</span></span> <span data-ttu-id="89c9a-205">Klicken Sie auf "Fertig stellen", um den Assistenten abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="89c9a-205">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="89c9a-206">[![Verwenden Sie die Categories DropDownList als Quelle für die CategoryID-Parameter](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image32.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="89c9a-206">[![Use the Categories DropDownList as the Source of the categoryID Parameter](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image32.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image31.png)</span></span>

<span data-ttu-id="89c9a-207">**Abbildung 11**: Verwenden der `Categories` DropDownList als Quelle für die `categoryID` Parameter ([klicken Sie, um das Bild in voller Größe anzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="89c9a-207">**Figure 11**: Use the `Categories` DropDownList as the Source of the `categoryID` Parameter ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image33.png))</span></span>


<span data-ttu-id="89c9a-208">Nach Abschluss des ObjectDataSource-Steuerelement-Assistenten, wird Visual Studio BoundFields und eine CheckBoxField für jedes Produkt Datenfelder hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="89c9a-208">Upon completing the ObjectDataSource wizard, Visual Studio will add BoundFields and a CheckBoxField for each of the product data fields.</span></span> <span data-ttu-id="89c9a-209">Können Sie diese Felder anpassen nach Bedarf.</span><span class="sxs-lookup"><span data-stu-id="89c9a-209">Feel free to customize these fields as you see fit.</span></span>

<span data-ttu-id="89c9a-210">Besuchen Sie die Seite über einen Browser ein.</span><span class="sxs-lookup"><span data-stu-id="89c9a-210">Visit the page through a browser.</span></span> <span data-ttu-id="89c9a-211">Beim Zugriff auf die Seite, die die Kategorie "Getränke" ausgewählt ist und die entsprechenden Produkte, die im Raster aufgelistet.</span><span class="sxs-lookup"><span data-stu-id="89c9a-211">When visiting the page the Beverages category is selected and the corresponding products listed in the grid.</span></span> <span data-ttu-id="89c9a-212">Ändern die Dropdown-Liste in eine andere Kategorie als Abbildung 12 zeigt ein Postback auslöst und lädt das Raster mit den Produkten, die neu ausgewählte Kategorie.</span><span class="sxs-lookup"><span data-stu-id="89c9a-212">Changing the drop-down list to an alternative category, as Figure 12 shows, causes a postback and reloads the grid with the products of the newly selected category.</span></span>


<span data-ttu-id="89c9a-213">[![Die Produkte in der Kategorie "erstellen" werden angezeigt.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image35.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="89c9a-213">[![The Products in the Produce Category are Displayed](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image35.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image34.png)</span></span>

<span data-ttu-id="89c9a-214">**Abbildung 12**: der Produkte in der Kategorie "erstellen" werden angezeigt ([klicken Sie, um das Bild in voller Größe anzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="89c9a-214">**Figure 12**: The Products in the Produce Category are Displayed ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image36.png))</span></span>


## <a name="step-5-wrapping-a-stored-procedure-s-statements-within-the-scope-of-a-transaction"></a><span data-ttu-id="89c9a-215">Schritt 5: Umschließen eine gespeicherte Prozedur-s-Anweisungen innerhalb des Bereichs einer Transaktion</span><span class="sxs-lookup"><span data-stu-id="89c9a-215">Step 5: Wrapping a Stored Procedure s Statements Within the Scope of a Transaction</span></span>

<span data-ttu-id="89c9a-216">In der [Umschließen von Datenbankänderungen innerhalb einer Transaktion](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-vb.md) Lernprogramm erläutert Techniken zum Ausführen einer Reihe von Datenbank-änderungsanweisungen innerhalb des Bereichs einer Transaktion.</span><span class="sxs-lookup"><span data-stu-id="89c9a-216">In the [Wrapping Database Modifications within a Transaction](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-vb.md) tutorial we discussed techniques for performing a series of database modification statements within the scope of a transaction.</span></span> <span data-ttu-id="89c9a-217">Rückruf, der die Änderungen, die unter dem Dach einer Transaktion ausgeführt wurde, entweder alle erfolgreich ausgeführt werden, oder alle Fehler, die Garantie der Unteilbarkeit.</span><span class="sxs-lookup"><span data-stu-id="89c9a-217">Recall that the modifications performed under the umbrella of a transaction either all succeed or all fail, guaranteeing atomicity.</span></span> <span data-ttu-id="89c9a-218">Methoden für die Verwendung von Transaktionen umfassen Folgendes:</span><span class="sxs-lookup"><span data-stu-id="89c9a-218">Techniques for using transactions include:</span></span>

- <span data-ttu-id="89c9a-219">Mithilfe der Klassen in der `System.Transactions` -Namespace</span><span class="sxs-lookup"><span data-stu-id="89c9a-219">Using the classes in the `System.Transactions` namespace,</span></span>
- <span data-ttu-id="89c9a-220">Verwenden Sie mit der Datenzugriffsebene ADO.NET-Klassen wie `SqlTransaction`, und</span><span class="sxs-lookup"><span data-stu-id="89c9a-220">Having the Data Access Layer use ADO.NET classes like `SqlTransaction`, and</span></span>
- <span data-ttu-id="89c9a-221">Hinzufügen der T-SQL-Transaktion-Befehle direkt in der gespeicherten Prozedur</span><span class="sxs-lookup"><span data-stu-id="89c9a-221">Adding the T-SQL transaction commands directly within the stored procedure</span></span>

<span data-ttu-id="89c9a-222">Die *Umschließen von Datenbankänderungen innerhalb einer Transaktion* Tutorial die ADO.NET-Klassen in der DAL verwendet.</span><span class="sxs-lookup"><span data-stu-id="89c9a-222">The *Wrapping Database Modifications within a Transaction* tutorial used the ADO.NET classes in the DAL.</span></span> <span data-ttu-id="89c9a-223">Der Rest dieses Tutorials wird untersucht, wie eine Transaktion, die mithilfe von T-SQL-Befehlen in einer gespeicherten Prozedur zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="89c9a-223">The remainder of this tutorial examines how to manage a transaction using T-SQL commands from within a stored procedure.</span></span>

<span data-ttu-id="89c9a-224">Die drei wichtigsten SQL-Befehle für manuell starten, Commit und Rollback einer Transaktion sind `BEGIN TRANSACTION`, `COMMIT TRANSACTION`, und `ROLLBACK TRANSACTION`bzw.</span><span class="sxs-lookup"><span data-stu-id="89c9a-224">The three key SQL commands for manually starting, committing, and rolling back a transaction are `BEGIN TRANSACTION`, `COMMIT TRANSACTION`, and `ROLLBACK TRANSACTION`, respectively.</span></span> <span data-ttu-id="89c9a-225">Wie Sie mit dem ADO.NET-Ansatz, nach der Verwendung von Transaktionen innerhalb einer gespeicherten Prozedur wir das folgende Muster anwenden müssen:</span><span class="sxs-lookup"><span data-stu-id="89c9a-225">Like with the ADO.NET approach, when using transactions from within a stored procedure we need to apply the following pattern:</span></span>

1. <span data-ttu-id="89c9a-226">Geben Sie an den Anfang einer Transaktion.</span><span class="sxs-lookup"><span data-stu-id="89c9a-226">Indicate the start of a transaction.</span></span>
2. <span data-ttu-id="89c9a-227">Führen Sie die SQL-Anweisungen, aus die die Transaktion besteht.</span><span class="sxs-lookup"><span data-stu-id="89c9a-227">Execute the SQL statements that comprise the transaction.</span></span>
3. <span data-ttu-id="89c9a-228">Wenn ein Fehler in einer der Anweisungen in Schritt2, Rollback der Transaktion vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="89c9a-228">If there is an error in any one of the statements from Step 2, rollback the transaction.</span></span>
4. <span data-ttu-id="89c9a-229">Wenn alle Anweisungen aus Schritt2 ohne Fehler abgeschlossen, committen Sie die Transaktion aus.</span><span class="sxs-lookup"><span data-stu-id="89c9a-229">If all of the statements from Step 2 complete without error, commit the transaction.</span></span>

<span data-ttu-id="89c9a-230">Dieses Muster kann implementiert werden, in der T-SQL-Syntax, die mithilfe der folgenden Vorlage:</span><span class="sxs-lookup"><span data-stu-id="89c9a-230">This pattern can be implemented in T-SQL syntax using the following template:</span></span>


[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample4.sql)]

<span data-ttu-id="89c9a-231">Die Vorlage beginnt mit dem Definieren einer `TRY...CATCH` blockieren, ein Konstrukt, das noch nicht mit SQL Server 2005.</span><span class="sxs-lookup"><span data-stu-id="89c9a-231">The template starts by defining a `TRY...CATCH` block, a construct new to SQL Server 2005.</span></span> <span data-ttu-id="89c9a-232">Wie beispielsweise `Try...Catch` , freigegebene Blöcke in Visual Basic SQL `TRY...CATCH` Block wird ausgeführt, die Anweisungen in der `TRY` Block.</span><span class="sxs-lookup"><span data-stu-id="89c9a-232">Like with `Try...Catch` blocks in Visual Basic, the SQL `TRY...CATCH` block executes the statements in the `TRY` block.</span></span> <span data-ttu-id="89c9a-233">Wenn eine Anweisung einen Fehler auslöst, wird die Steuerung sofort an die `CATCH` Block.</span><span class="sxs-lookup"><span data-stu-id="89c9a-233">If any statement raises an error, control is immediately transferred to the `CATCH` block.</span></span>

<span data-ttu-id="89c9a-234">Wenn keine Fehler auftreten, Zusammensetzung der Transaktion für die SQL-Anweisungen Ausführen der `COMMIT TRANSACTION` -Anweisung führt einen Commit der Änderungen und schließt die Transaktion.</span><span class="sxs-lookup"><span data-stu-id="89c9a-234">If there are no errors executing the SQL statements that makeup the transaction, the `COMMIT TRANSACTION` statement commits the changes and completes the transaction.</span></span> <span data-ttu-id="89c9a-235">Wenn Sie jedoch eine der Anweisungen führt zu einem Fehler, die `ROLLBACK TRANSACTION` in die `CATCH` Block wird die Datenbank in den Zustand vor dem Start der Transaktion.</span><span class="sxs-lookup"><span data-stu-id="89c9a-235">If, however, one of the statements results in an error, the `ROLLBACK TRANSACTION` in the `CATCH` block returns the database to its state prior to the start of the transaction.</span></span> <span data-ttu-id="89c9a-236">Die gespeicherte Prozedur löst ebenfalls eine Fehlermeldung mit dem [RAISERROR-Befehl](https://msdn.microsoft.com/library/ms178592.aspx), bewirkt, dass eine `SqlException` , die in der Anwendung ausgelöst werden.</span><span class="sxs-lookup"><span data-stu-id="89c9a-236">The stored procedure also raises an error using the [RAISERROR command](https://msdn.microsoft.com/library/ms178592.aspx), which causes a `SqlException` to be raised in the application.</span></span>

> [!NOTE]
> <span data-ttu-id="89c9a-237">Da die `TRY...CATCH` Block ist neu in SQL Server 2005, die in der obige Vorlage funktioniert nicht, wenn Sie ältere Versionen von Microsoft SQL Server verwenden.</span><span class="sxs-lookup"><span data-stu-id="89c9a-237">Since the `TRY...CATCH` block is new to SQL Server 2005, the above template will not work if you are using older versions of Microsoft SQL Server.</span></span> <span data-ttu-id="89c9a-238">Wenn Sie SQL Server 2005 nicht verwenden, wenden Sie sich an [Verwalten von Transaktionen in gespeicherten Prozeduren von SQL Server](http://www.4guysfromrolla.com/webtech/080305-1.shtml) für eine Vorlage, die mit anderen Versionen von SQL Server verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="89c9a-238">If you are not using SQL Server 2005, consult [Managing Transactions in SQL Server Stored Procedures](http://www.4guysfromrolla.com/webtech/080305-1.shtml) for a template that will work with other versions of SQL Server.</span></span>


<span data-ttu-id="89c9a-239">Lassen Sie s ein konkretes Beispiel betrachten.</span><span class="sxs-lookup"><span data-stu-id="89c9a-239">Let s look at a concrete example.</span></span> <span data-ttu-id="89c9a-240">Eine foreign Key-Einschränkung vorhanden ist, zwischen der `Categories` und `Products` Tabellen, was bedeutet, dass jedes `CategoryID` Feld der `Products` Tabelle muss zugeordnet eine `CategoryID` Wert in der `Categories` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="89c9a-240">A foreign key constraint exists between the `Categories` and `Products` tables, meaning that each `CategoryID` field in the `Products` table must map to a `CategoryID` value in the `Categories` table.</span></span> <span data-ttu-id="89c9a-241">Alle Aktionen, die gegen verstoßen würde, diese Einschränkung, wie z. B. versuchen, eine Kategorie löschen, die Produkte verknüpft ist, führt zu einer Verletzung der foreign Key-Einschränkung.</span><span class="sxs-lookup"><span data-stu-id="89c9a-241">Any action that would violate this constraint, such as attempting to delete a category that has associated products, results in a foreign key constraint violation.</span></span> <span data-ttu-id="89c9a-242">Um dies zu überprüfen, rufen Sie erneut das Beispiel aktualisieren und Löschen von vorhandenen Binärdaten in das Arbeiten mit Binärdaten Abschnitt (`~/BinaryData/UpdatingAndDeleting.aspx`).</span><span class="sxs-lookup"><span data-stu-id="89c9a-242">To verify this, revisit the Updating and Deleting Existing Binary Data example in the Working with Binary Data section (`~/BinaryData/UpdatingAndDeleting.aspx`).</span></span> <span data-ttu-id="89c9a-243">Diese Seite listet jede Kategorie im System sowie Schaltflächen zum Bearbeiten und löschen (siehe Abbildung 13), aber wenn Sie versuchen, eine Kategorie löschen, die Produkte – z. B. Getränke - verknüpft ist der Löschvorgang schlägt fehl, aufgrund einer Verletzung der foreign Key-Einschränkung (siehe Abbildung 14).</span><span class="sxs-lookup"><span data-stu-id="89c9a-243">This page lists each category in the system along with Edit and Delete buttons (see Figure 13), but if you attempt to delete a category that has associated products - such as Beverages - the delete fails due to a foreign key constraint violation (see Figure 14).</span></span>


<span data-ttu-id="89c9a-244">[![Jede Kategorie wird in einer GridView-Ansicht mit bearbeiten und Löschen von Schaltflächen angezeigt.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image38.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="89c9a-244">[![Each Category is Displayed in a GridView with Edit and Delete Buttons](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image38.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image37.png)</span></span>

<span data-ttu-id="89c9a-245">**Abbildung 13**: jede Kategorie wird in einer GridView-Ansicht mit bearbeiten und Löschen von Schaltflächen angezeigt ([klicken Sie, um das Bild in voller Größe anzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="89c9a-245">**Figure 13**: Each Category is Displayed in a GridView with Edit and Delete Buttons ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image39.png))</span></span>


<span data-ttu-id="89c9a-246">[![Sie können keine Kategorie löschen, das vorhandene Produkte](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image41.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="89c9a-246">[![You Cannot Delete a Category that has Existing Products](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image41.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image40.png)</span></span>

<span data-ttu-id="89c9a-247">**Abbildung 14**: eine Kategorie aus, das vorhandene Produkte kann nicht gelöscht werden ([klicken Sie, um das Bild in voller Größe anzeigen](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="89c9a-247">**Figure 14**: You Cannot Delete a Category that has Existing Products ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image42.png))</span></span>


<span data-ttu-id="89c9a-248">Stellen Sie sich vor, jedoch, dass Kategorien gelöscht werden soll, unabhängig davon, ob sie Produkte verknüpft haben zulässig sein sollen.</span><span class="sxs-lookup"><span data-stu-id="89c9a-248">Imagine, though, that we want to allow categories to be deleted regardless of whether they have associated products.</span></span> <span data-ttu-id="89c9a-249">Sollte eine Kategorie mit Produkte gelöscht werden, stellen Sie sich vor, dass auch die vorhandenen Produkte gelöscht werden soll (obwohl eine andere Möglichkeit wäre, legen Sie einfach seine Produkte `CategoryID` Werte `NULL`).</span><span class="sxs-lookup"><span data-stu-id="89c9a-249">Should a category with products be deleted, imagine that we want to also delete its existing products (although another option would be to simply set its products `CategoryID` values to `NULL`).</span></span> <span data-ttu-id="89c9a-250">Diese Funktion kann über die Cascade-Regeln für foreign Key-Einschränkung implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="89c9a-250">This functionality could be implemented through the cascade rules of the foreign key constraint.</span></span> <span data-ttu-id="89c9a-251">Alternativ können wir erstellen eine gespeicherte Prozedur, die akzeptiert eine `@CategoryID` Eingabeparameter und, wenn aufgerufen, löscht explizit alle die zugehörigen Produkte, und klicken Sie dann die angegebene Kategorie.</span><span class="sxs-lookup"><span data-stu-id="89c9a-251">Alternatively, we could create a stored procedure that accepts a `@CategoryID` input parameter and, when invoked, explicitly deletes all of the associated products and then the specified category.</span></span>

<span data-ttu-id="89c9a-252">Unserem erste Versuch zur solche gespeicherte Prozedur kann wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="89c9a-252">Our first attempt at such a stored procedure might look like the following:</span></span>


[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample5.sql)]

<span data-ttu-id="89c9a-253">Während dies auf jeden Fall die zugehörige Produkte und Kategorie gelöscht werden, ist dies nicht unter dem Dach einer Transaktion erfolgen.</span><span class="sxs-lookup"><span data-stu-id="89c9a-253">While this will definitely delete the associated products and category, it does not do so under the umbrella of a transaction.</span></span> <span data-ttu-id="89c9a-254">Stellen Sie sich vor, dass es einige andere foreign Key-Einschränkung auf `Categories` würde, die das Löschen eines bestimmten verbieten `@CategoryID` Wert.</span><span class="sxs-lookup"><span data-stu-id="89c9a-254">Imagine that there is some other foreign key constraint on `Categories` that would prohibit the deletion of a particular `@CategoryID` value.</span></span> <span data-ttu-id="89c9a-255">Das Problem ist, dass in diesem Fall alle Produkte gelöscht werden, bevor wir versuchen, das die Kategorie zu löschen.</span><span class="sxs-lookup"><span data-stu-id="89c9a-255">The problem is that in such a case all of the products will be deleted before we attempt to delete the category.</span></span> <span data-ttu-id="89c9a-256">Das Ergebnis ist, dass für eine Kategorie, diese gespeicherte Prozedur entfernt würde alle seine Produkte während die Kategorie geblieben, da es die Datensätze in einer anderen Tabelle immer noch verbunden ist.</span><span class="sxs-lookup"><span data-stu-id="89c9a-256">The net result is that for such a category, this stored procedure would remove all of its products while the category remained since it still has related records in some other table.</span></span>

<span data-ttu-id="89c9a-257">Wenn die gespeicherte Prozedur innerhalb des Bereichs einer Transaktion, jedoch die Löschvorgänge umschlossen wurden die `Products` Tabelle würde auf ein Rollback bei einem Fehler beim Löschen `Categories`.</span><span class="sxs-lookup"><span data-stu-id="89c9a-257">If the stored procedure were wrapped within the scope of a transaction, however, the deletes to the `Products` table would be rolled back in the face of a failed delete on `Categories`.</span></span> <span data-ttu-id="89c9a-258">Das folgende Skript für die gespeicherte Prozedur verwendet eine Transaktion, um die Unteilbarkeit zwischen den beiden gewährleisten `DELETE` Anweisungen:</span><span class="sxs-lookup"><span data-stu-id="89c9a-258">The following stored procedure script uses a transaction to assure atomicity between the two `DELETE` statements:</span></span>


[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample6.sql)]

<span data-ttu-id="89c9a-259">Hinzufügen in Ruhe die `Categories_Delete` gespeicherte Prozedur mit der Datenbank Northwind.</span><span class="sxs-lookup"><span data-stu-id="89c9a-259">Take a moment to add the `Categories_Delete` stored procedure to the Northwind database.</span></span> <span data-ttu-id="89c9a-260">Verweisen Sie zurück zu Schritt 1 Anleitungen zum Hinzufügen von gespeicherten Prozeduren in einer Datenbank.</span><span class="sxs-lookup"><span data-stu-id="89c9a-260">Refer back to Step 1 for instructions on adding stored procedures to a database.</span></span>

## <a name="step-6-updating-thecategoriestableadapter"></a><span data-ttu-id="89c9a-261">Schritt 6: Aktualisieren der`CategoriesTableAdapter`</span><span class="sxs-lookup"><span data-stu-id="89c9a-261">Step 6: Updating the`CategoriesTableAdapter`</span></span>

<span data-ttu-id="89c9a-262">Während wir hinzugefügt haben die `Categories_Delete` gespeicherte Prozedur in der Datenbank, der DAL ist gegenwärtig konfiguriert um Ad-hoc-SQL-Anweisungen zu verwenden, um den Löschvorgang auszuführen.</span><span class="sxs-lookup"><span data-stu-id="89c9a-262">While we ve added the `Categories_Delete` stored procedure to the database, the DAL is currently configured to use ad-hoc SQL statements to perform the delete.</span></span> <span data-ttu-id="89c9a-263">Wir müssen aktualisieren die `CategoriesTableAdapter` und weisen Sie ihn zur Verwendung der `Categories_Delete` stattdessen gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="89c9a-263">We need to update the `CategoriesTableAdapter` and instruct it to use the `Categories_Delete` stored procedure instead.</span></span>

> [!NOTE]
> <span data-ttu-id="89c9a-264">Weiter oben in diesem Tutorial wurden arbeiten wir mit der `NorthwindWithSprocs` DataSet.</span><span class="sxs-lookup"><span data-stu-id="89c9a-264">Earlier in this tutorial we were working with the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="89c9a-265">Aber, dass DataSet nur eine einzelne Entität `ProductsDataTable`, und wir arbeiten mit Kategorien müssen.</span><span class="sxs-lookup"><span data-stu-id="89c9a-265">But that DataSet only has a single entity, `ProductsDataTable`, and we need to work with categories.</span></span> <span data-ttu-id="89c9a-266">Aus diesem Grund für den Rest dieses Tutorials aus, wenn ich das Data Access Layer I-m auf sprechen die `Northwind` diejenige, die wir zuerst im erstellt-DataSet der [Erstellen einer Datenzugriffsschicht](../introduction/creating-a-data-access-layer-vb.md) Tutorial.</span><span class="sxs-lookup"><span data-stu-id="89c9a-266">Therefore, for the remainder of this tutorial when I talk about the Data Access Layer I m referring to the `Northwind` DataSet, the one that we first created in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial.</span></span>


<span data-ttu-id="89c9a-267">Öffnen des Datasets Northwind Sie wählen die `CategoriesTableAdapter`, und wechseln Sie zu dem Fenster "Eigenschaften".</span><span class="sxs-lookup"><span data-stu-id="89c9a-267">Open the Northwind DataSet, select the `CategoriesTableAdapter`, and go to the Properties window.</span></span> <span data-ttu-id="89c9a-268">Die Eigenschaften im Fenster umfassen die `InsertCommand`, `UpdateCommand`, `DeleteCommand`, und `SelectCommand` von TableAdapter als auch die Informationen und die Verbindungszeichenfolge verwendet.</span><span class="sxs-lookup"><span data-stu-id="89c9a-268">The Properties window lists the `InsertCommand`, `UpdateCommand`, `DeleteCommand`, and `SelectCommand` used by the TableAdapter, as well as its name and connection information.</span></span> <span data-ttu-id="89c9a-269">Erweitern Sie die `DeleteCommand` Eigenschaft, um dessen Details anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="89c9a-269">Expand the `DeleteCommand` property to see its details.</span></span> <span data-ttu-id="89c9a-270">Wie in Abbildung 15 gezeigt, die `DeleteCommand` s `ComamndType` -Eigenschaftensatz auf Text, den angewiesen wird, senden Sie den Text in die `CommandText` Eigenschaft als Ad-hoc-SQL-Abfrage.</span><span class="sxs-lookup"><span data-stu-id="89c9a-270">As Figure 15 shows, the `DeleteCommand` s `ComamndType` property is set to Text, which instructs it to send the text in the `CommandText` property as an ad-hoc SQL query.</span></span>


![Wählen Sie die CategoriesTableAdapter im Designer, um seine Eigenschaften im Eigenschaftenfenster anzuzeigen.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image43.png)

<span data-ttu-id="89c9a-272">**Abbildung 15**: Wählen Sie die `CategoriesTableAdapter` im Designer, um seine Eigenschaften im Eigenschaftenfenster anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="89c9a-272">**Figure 15**: Select the `CategoriesTableAdapter` in the Designer to View Its Properties in the Properties Window</span></span>


<span data-ttu-id="89c9a-273">Um diese Einstellungen zu ändern, wählen Sie den Text (DeleteCommand) im Fenster Eigenschaften, und wählen Sie aus der Dropdown-Liste (neu).</span><span class="sxs-lookup"><span data-stu-id="89c9a-273">To change these settings, select the (DeleteCommand) text in the Properties window and choose (New) from the drop-down list.</span></span> <span data-ttu-id="89c9a-274">Hiermit löschen Sie die Einstellungen für die `CommandText`, `CommandType`, und `Parameters` Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="89c9a-274">This will clear out the settings for the `CommandText`, `CommandType`, and `Parameters` properties.</span></span> <span data-ttu-id="89c9a-275">Legen Sie als Nächstes die `CommandType` Eigenschaft `StoredProcedure` und geben Sie dann den Namen der gespeicherten Prozedur für die `CommandText` (`dbo.Categories_Delete`).</span><span class="sxs-lookup"><span data-stu-id="89c9a-275">Next, set the `CommandType` property to `StoredProcedure` and then type in the name of the stored procedure for the `CommandText` (`dbo.Categories_Delete`).</span></span> <span data-ttu-id="89c9a-276">Wenn Sie sicherstellen, um die Eigenschaften in dieser Reihenfolge – zuerst eingeben, die `CommandType` und klicken Sie dann die `CommandText` -Visual Studio füllt automatisch die Parameterauflistung.</span><span class="sxs-lookup"><span data-stu-id="89c9a-276">If you make sure to enter the properties in this order - first the `CommandType` and then the `CommandText` - Visual Studio will automatically populate the Parameters collection.</span></span> <span data-ttu-id="89c9a-277">Wenn Sie diese Eigenschaften nicht in dieser Reihenfolge eingeben, müssen Sie die Parameter durch den Parameter-Auflistungs-Editor manuell hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="89c9a-277">If you do not enter these properties in this order, you will have to manually add the parameters through the Parameters Collection Editor.</span></span> <span data-ttu-id="89c9a-278">In beiden Fällen sie s rechnen, klicken auf die Auslassungspunkte in der Parameters-Eigenschaft, um den Parameter-Auflistungs-Editor zu öffnen, um sicherzustellen, dass die richtigen Parameter einstellungsänderungen vorgenommen wurden (finden Sie in Abbildung 16).</span><span class="sxs-lookup"><span data-stu-id="89c9a-278">In either case, it s prudent to click on the ellipses in the Parameters property to bring up the Parameters Collection Editor to verify that the correct parameter settings changes have been made (see Figure 16).</span></span> <span data-ttu-id="89c9a-279">Wenn Sie keine Parameter im Dialogfeld angezeigt werden, fügen Sie der `@CategoryID` Parameter manuell (Sie müssen nicht hinzufügen der `@RETURN_VALUE` Parameter).</span><span class="sxs-lookup"><span data-stu-id="89c9a-279">If you do not see any parameters in the dialog box, add the `@CategoryID` parameter manually (you do not need to add the `@RETURN_VALUE` parameter).</span></span>


![Stellen Sie sicher, dass die Einstellungen für die Parameter richtig sind.](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image44.png)

<span data-ttu-id="89c9a-281">**Abbildung 16**: Stellen Sie sicher, dass die Einstellungen für die Parameter richtig sind.</span><span class="sxs-lookup"><span data-stu-id="89c9a-281">**Figure 16**: Ensure That the Parameters Settings are Correct</span></span>


<span data-ttu-id="89c9a-282">Sobald die DAL aktualisiert wurde, löschen eine Kategorie automatisch Löschen aller seiner zugeordneten Produkte und unter dem Dach einer Transaktion tun.</span><span class="sxs-lookup"><span data-stu-id="89c9a-282">Once the DAL has been updated, deleting a category will automatically delete all of its associated products and do so under the umbrella of a transaction.</span></span> <span data-ttu-id="89c9a-283">Um dies zu überprüfen, auf die Seite aktualisieren und Löschen von vorhandenen Binärdaten zurück, und klicken Sie auf die Schaltfläche "löschen" für eine der Kategorien.</span><span class="sxs-lookup"><span data-stu-id="89c9a-283">To verify this, return to the Updating and Deleting Existing Binary Data page and click the Delete button for one of the categories.</span></span> <span data-ttu-id="89c9a-284">Mit nur einem Klick der Maus wird die Kategorie und alle seine zugehörige Produkte gelöscht werden.</span><span class="sxs-lookup"><span data-stu-id="89c9a-284">With one single click of the mouse, the category and all of its associated products will be deleted.</span></span>

> [!NOTE]
> <span data-ttu-id="89c9a-285">Vor dem Testen der `Categories_Delete` gespeicherte Prozedur, die eine Reihe von Produkten zusammen mit der ausgewählten Kategorie gelöscht werden, es kann ratsam, eine Sicherungskopie der Datenbank sein.</span><span class="sxs-lookup"><span data-stu-id="89c9a-285">Before testing the `Categories_Delete` stored procedure, which will delete a number of products along with the selected category, it might be prudent to make a backup copy of your database.</span></span> <span data-ttu-id="89c9a-286">Bei Verwendung der `NORTHWND.MDF` Datenbank `App_Data`, einfach schließen Sie Visual Studio, und kopieren Sie die MDF- und LDF-Dateien in `App_Data` auf einem anderen Ordner.</span><span class="sxs-lookup"><span data-stu-id="89c9a-286">If you are using the `NORTHWND.MDF` database in `App_Data`, simply close Visual Studio and copy the MDF and LDF files in `App_Data` to some other folder.</span></span> <span data-ttu-id="89c9a-287">Nach dem Testen der Funktionalität können Sie die Datenbank wiederherstellen, indem Sie Visual Studio schließen, und ersetzen die aktuellen MDF und LDF-Dateien im `App_Data` durch die Sicherungskopien.</span><span class="sxs-lookup"><span data-stu-id="89c9a-287">After testing the functionality, you can restore the database by closing Visual Studio and replacing the current MDF and LDF files in `App_Data` with the backup copies.</span></span>


## <a name="summary"></a><span data-ttu-id="89c9a-288">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="89c9a-288">Summary</span></span>

<span data-ttu-id="89c9a-289">Der TableAdapter-s-Assistent automatisch gespeicherte Prozeduren für uns generiert werden, gibt es Zeiten, wenn wir möglicherweise bereits solchen gespeicherten Prozeduren, die erstellt oder möchten sie stattdessen manuell oder mit anderen Tools erstellen.</span><span class="sxs-lookup"><span data-stu-id="89c9a-289">While the TableAdapter s wizard will automatically generate stored procedures for us, there are times when we might already have such stored procedures created or want to create them manually or with other tools instead.</span></span> <span data-ttu-id="89c9a-290">Um solche Szenarien zu unterstützen, kann der TableAdapter auch konfiguriert werden, um auf eine vorhandene gespeicherte Prozedur verweisen.</span><span class="sxs-lookup"><span data-stu-id="89c9a-290">To accommodate such scenarios, the TableAdapter can also be configured to point to an existing stored procedure.</span></span> <span data-ttu-id="89c9a-291">In diesem Tutorial erläutert, wie gespeicherte Prozeduren manuell über Visual Studio-Umgebung auf eine Datenbank hinzugefügt und die TableAdapter-s-Methoden mit dieser gespeicherten Prozeduren zu verknüpfen.</span><span class="sxs-lookup"><span data-stu-id="89c9a-291">In this tutorial we looked at how to manually add stored procedures to a database through the Visual Studio environment and how to wire the TableAdapter s methods to these stored procedures.</span></span> <span data-ttu-id="89c9a-292">Wir untersucht auch die T-SQL-Befehle und das Skript-Muster, die zum Starten, Commit und Rollback für Transaktionen innerhalb einer gespeicherten Prozedur.</span><span class="sxs-lookup"><span data-stu-id="89c9a-292">We also examined the T-SQL commands and script pattern used for starting, committing, and rolling back transactions from within a stored procedure.</span></span>

<span data-ttu-id="89c9a-293">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="89c9a-293">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="89c9a-294">Der Autor</span><span class="sxs-lookup"><span data-stu-id="89c9a-294">About the Author</span></span>

<span data-ttu-id="89c9a-295">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben Büchern zu ASP/ASP.NET und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), arbeitet mit Microsoft-Web-Technologien seit 1998.</span><span class="sxs-lookup"><span data-stu-id="89c9a-295">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="89c9a-296">Er ist als ein unabhängiger Berater, Schulungsleiter und Autor.</span><span class="sxs-lookup"><span data-stu-id="89c9a-296">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="89c9a-297">Sein neueste Buch wird [*Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="89c9a-297">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="89c9a-298">Er ist unter [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="89c9a-298">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="89c9a-299">oder über seinen Blog finden Sie unter [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="89c9a-299">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="89c9a-300">Besonderen Dank an</span><span class="sxs-lookup"><span data-stu-id="89c9a-300">Special Thanks To</span></span>

<span data-ttu-id="89c9a-301">Diese tutorialreihe wurde durch viele hilfreiche Reviewer überprüft.</span><span class="sxs-lookup"><span data-stu-id="89c9a-301">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="89c9a-302">Führendes Prüfer für dieses Tutorial wurden Hilton Geisenow S Ren Jacob Lauritsen und Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="89c9a-302">Lead reviewers for this tutorial were Hilton Geisenow, S ren Jacob Lauritsen, and Teresa Murphy.</span></span> <span data-ttu-id="89c9a-303">Meine zukünftigen MSDN-Artikeln überprüfen möchten?</span><span class="sxs-lookup"><span data-stu-id="89c9a-303">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="89c9a-304">Wenn dies der Fall ist, löschen Sie mir eine Linie an [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="89c9a-304">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="89c9a-305">[Zurück](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
> [Weiter](updating-the-tableadapter-to-use-joins-vb.md)</span><span class="sxs-lookup"><span data-stu-id="89c9a-305">[Previous](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
[Next](updating-the-tableadapter-to-use-joins-vb.md)</span></span>
