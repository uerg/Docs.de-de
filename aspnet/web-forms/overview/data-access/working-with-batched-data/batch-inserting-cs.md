---
uid: web-forms/overview/data-access/working-with-batched-data/batch-inserting-cs
title: Batch einfügen (c#) | Microsoft-Dokumentation
author: rick-anderson
description: Erfahren Sie, wie Sie mehrere Datenbankdatensätze in einem einzigen Vorgang einfügen. In der Benutzeroberflächenebene erweitern wir die GridView, damit der Benutzer zur Eingabe von mehreren n kann...
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/26/2007
ms.topic: article
ms.assetid: cf025e08-48fc-4385-b176-8610aa7b5565
ms.technology: dotnet-webforms
msc.legacyurl: /web-forms/overview/data-access/working-with-batched-data/batch-inserting-cs
msc.type: authoredcontent
ms.openlocfilehash: 347cd862afc70fa9e3386246ae14d989c5de1ba6
ms.sourcegitcommit: 953ff9ea4369f154d6fd0239599279ddd3280009
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 07/03/2018
ms.locfileid: "37370320"
---
<a name="batch-inserting-c"></a><span data-ttu-id="5a96f-104">Batch einfügen (c#)</span><span class="sxs-lookup"><span data-stu-id="5a96f-104">Batch Inserting (C#)</span></span>
====================
<span data-ttu-id="5a96f-105">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="5a96f-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="5a96f-106">[Code herunterladen](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_66_CS.zip) oder [PDF-Datei herunterladen](batch-inserting-cs/_static/datatutorial66cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="5a96f-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_66_CS.zip) or [Download PDF](batch-inserting-cs/_static/datatutorial66cs1.pdf)</span></span>

> <span data-ttu-id="5a96f-107">Erfahren Sie, wie Sie mehrere Datenbankdatensätze in einem einzigen Vorgang einfügen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-107">Learn how to insert multiple database records in a single operation.</span></span> <span data-ttu-id="5a96f-108">In die UI-Schicht erweitern wir die GridView, um den Benutzer zur Eingabe der mehrere neue Datensätze zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-108">In the User Interface Layer we extend the GridView to allow the user to enter multiple new records.</span></span> <span data-ttu-id="5a96f-109">In der Datenzugriffsebene umschließen wir mehrere Einfügevorgänge innerhalb einer Transaktion, um sicherzustellen, dass alle erfolgreich ausgeführt werden oder ein aller einfügungen Rollback.</span><span class="sxs-lookup"><span data-stu-id="5a96f-109">In the Data Access Layer we wrap the multiple Insert operations within a transaction to ensure that all insertions succeed or all insertions are rolled back.</span></span>


## <a name="introduction"></a><span data-ttu-id="5a96f-110">Einführung</span><span class="sxs-lookup"><span data-stu-id="5a96f-110">Introduction</span></span>

<span data-ttu-id="5a96f-111">In der [BatchUpdates](batch-updating-cs.md) Tutorial erläutert, Anpassen der GridView-Steuerelement, um eine Schnittstelle zu präsentieren, in denen mehrere Datensätze bearbeitet wurden.</span><span class="sxs-lookup"><span data-stu-id="5a96f-111">In the [Batch Updating](batch-updating-cs.md) tutorial we looked at customizing the GridView control to present an interface where multiple records were editable.</span></span> <span data-ttu-id="5a96f-112">Der Benutzer, die auf der Seite konnte stellen eine Reihe von Änderungen und führen Sie dann mit einem einzigen Mausklick, einem BatchUpdate.</span><span class="sxs-lookup"><span data-stu-id="5a96f-112">The user visiting the page could make a series of changes and then, with a single button click, perform a batch update.</span></span> <span data-ttu-id="5a96f-113">In Situationen, in denen Benutzer häufig viele Datensätze in einer Aktion aktualisieren, kann eine solche Schnittstelle unzählige klickt auf Speichern, und Tastatur, Maus Kontextwechsel im Vergleich zu Standard pro Zeile Bearbeitungsfunktionen kennengelernt, die zuerst wieder untersucht wurden die [ein Übersicht über das Einfügen, aktualisieren und Löschen von Daten](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) Tutorial.</span><span class="sxs-lookup"><span data-stu-id="5a96f-113">For situations where users commonly update many records in one go, such an interface can save countless clicks and keyboard-to-mouse context switches when compared to the default per-row editing features that were first explored back in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) tutorial.</span></span>

<span data-ttu-id="5a96f-114">Dieses Konzept kann auch angewendet werden, wenn Sie Datensätze hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-114">This concept can also be applied when adding records.</span></span> <span data-ttu-id="5a96f-115">Stellen Sie sich vor, die hier bei Northwind Traders wir häufig erhalten Lieferungen von Lieferanten, die eine Reihe von Produkten für eine bestimmte Kategorie enthalten.</span><span class="sxs-lookup"><span data-stu-id="5a96f-115">Imagine that here at Northwind Traders we commonly receive shipments from suppliers that contain a number of products for a particular category.</span></span> <span data-ttu-id="5a96f-116">Beispielsweise können wir eine Lieferung von sechs verschiedenen Tee und Kaffee Produkte von Tokio Traders erhalten.</span><span class="sxs-lookup"><span data-stu-id="5a96f-116">As an example, we might receive a shipment of six different tea and coffee products from Tokyo Traders.</span></span> <span data-ttu-id="5a96f-117">Wenn ein Benutzer die sechs Produkten, die eine zu einem Zeitpunkt über ein DetailsView-Steuerelement eingibt, werden sie auf den gleichen Werten viele immer wieder haben: sie müssen die gleiche Kategorie (Getränke), die demselben Lieferanten (Tokio Traders) auswählen, die den gleichen Wert (nicht mehr unterstützt "False"), und den gleichen Einheiten auf Order-Wert (0).</span><span class="sxs-lookup"><span data-stu-id="5a96f-117">If a user enters the six products one at a time through a DetailsView control, they will have to choose many of the same values over and over again: they will need to choose the same category (Beverages), the same supplier (Tokyo Traders), the same discontinued value (False), and the same units on order value (0).</span></span> <span data-ttu-id="5a96f-118">Diese repetitiven Daten-Eintrag ist nicht nur Zeit in Anspruch nehmen, aber anfällig für Fehler.</span><span class="sxs-lookup"><span data-stu-id="5a96f-118">This repetitive data entry is not only time consuming, but is prone to errors.</span></span>

<span data-ttu-id="5a96f-119">Mit ein wenig Aufwand können wir einen Batch, die einfügen-Schnittstelle, den Benutzer den Lieferanten und die Kategorie, geben Sie eine Reihe von Produktnamen und einem Stückpreis ermöglicht, und klicken Sie dann auf eine Schaltfläche zum Hinzufügen von neuen Produkte in der Datenbank, erstellen (siehe Abbildung 1).</span><span class="sxs-lookup"><span data-stu-id="5a96f-119">With a little work we can create a batch inserting interface that enables the user to choose the supplier and category once, enter a series of product names and unit prices, and then click a button to add the new products to the database (see Figure 1).</span></span> <span data-ttu-id="5a96f-120">Jedes Produkt hinzugefügt wird, dessen `ProductName` und `UnitPrice` Datenfelder werden in die Textfelder eingegebenen Werte zugewiesen während seiner `CategoryID` und `SupplierID` Werte werden die Werte aus der DropDownList-Steuerelementen auf der obersten fo Form zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-120">As each product is added, its `ProductName` and `UnitPrice` data fields are assigned the values entered in the TextBoxes, while its `CategoryID` and `SupplierID` values are assigned the values from the DropDownLists at the top fo the form.</span></span> <span data-ttu-id="5a96f-121">Die `Discontinued` und `UnitsOnOrder` Werte werden festgelegt, auf die hartcodierten Werte der `false` und 0 (null) bzw.</span><span class="sxs-lookup"><span data-stu-id="5a96f-121">The `Discontinued` and `UnitsOnOrder` values are set to the hard-coded values of `false` and 0, respectively.</span></span>


<span data-ttu-id="5a96f-122">[![Die Batch-einfügen-Schnittstelle](batch-inserting-cs/_static/image2.png)](batch-inserting-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="5a96f-122">[![The Batch Inserting Interface](batch-inserting-cs/_static/image2.png)](batch-inserting-cs/_static/image1.png)</span></span>

<span data-ttu-id="5a96f-123">**Abbildung 1**: die Batch-einfügen-Schnittstelle ([klicken Sie, um das Bild in voller Größe anzeigen](batch-inserting-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="5a96f-123">**Figure 1**: The Batch Inserting Interface ([Click to view full-size image](batch-inserting-cs/_static/image3.png))</span></span>


<span data-ttu-id="5a96f-124">In diesem Tutorial erstellen wir eine Seite, die den Batch-Benutzeroberfläche in Abbildung 1 einfügen implementiert.</span><span class="sxs-lookup"><span data-stu-id="5a96f-124">In this tutorial we will create a page that implements the batch inserting interface shown in Figure 1.</span></span> <span data-ttu-id="5a96f-125">Als mit den beiden vorherigen Tutorials werden wir die einfügungen innerhalb des Bereichs einer Transaktion, um die Unteilbarkeit sicherzustellen umschließen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-125">As with the previous two tutorials, we will wrap the insertions within the scope of a transaction to ensure atomicity.</span></span> <span data-ttu-id="5a96f-126">Lassen Sie s beginnen!</span><span class="sxs-lookup"><span data-stu-id="5a96f-126">Let s get started!</span></span>

## <a name="step-1-creating-the-display-interface"></a><span data-ttu-id="5a96f-127">Schritt 1: Erstellen der Anzeigenschnittstelle</span><span class="sxs-lookup"><span data-stu-id="5a96f-127">Step 1: Creating the Display Interface</span></span>

<span data-ttu-id="5a96f-128">In diesem Tutorial besteht aus einer einzelnen Seite, die in zwei Bereiche unterteilt ist: eine Anzeige und eine Region einfügen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-128">This tutorial will consist of a single page that is divided into two regions: a display region and an inserting region.</span></span> <span data-ttu-id="5a96f-129">Die Anzeigenschnittstelle, die wir in diesem Schritt erstellen, werden die Produkte in einer GridView-Ansicht angezeigt und enthält eine Schaltfläche mit dem Titel mit dem Produktversand Prozess.</span><span class="sxs-lookup"><span data-stu-id="5a96f-129">The display interface, which we'll create in this step, shows the products in a GridView and includes a button titled Process Product Shipment.</span></span> <span data-ttu-id="5a96f-130">Wenn diese Schaltfläche geklickt wird, wird die Anzeigenschnittstelle durch die einfügen-Schnittstelle, ersetzt, das in Abbildung 1 dargestellt ist.</span><span class="sxs-lookup"><span data-stu-id="5a96f-130">When this button is clicked, the display interface is replaced with the inserting interface, which is shown in Figure 1.</span></span> <span data-ttu-id="5a96f-131">Die Anzeigenschnittstelle, die nach der hinzufügen-Produkte aus Lieferung zurückgibt oder "Abbrechen"-Schaltflächen geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="5a96f-131">The display interface returns after the Add Products from Shipment or Cancel buttons are clicked.</span></span> <span data-ttu-id="5a96f-132">Wir erstellen die einfügende-Schnittstelle in Schritt2.</span><span class="sxs-lookup"><span data-stu-id="5a96f-132">We'll create the inserting interface in Step 2.</span></span>

<span data-ttu-id="5a96f-133">Beim Erstellen einer Seite mit zwei Schnittstellen, von denen nur eine zu einem Zeitpunkt sichtbar ist, jede Schnittstelle in der Regel befindet sich innerhalb einer [Panel-Websteuerelement](http://www.w3schools.com/aspnet/control_panel.asp), der als Container für andere Steuerelemente dient.</span><span class="sxs-lookup"><span data-stu-id="5a96f-133">When creating a page that has two interfaces, only one of which is visible at a time, each interface typically is placed within a [Panel Web control](http://www.w3schools.com/aspnet/control_panel.asp), which serves as a container for other controls.</span></span> <span data-ttu-id="5a96f-134">Aus diesem Grund müssen die Seite zwei Panel-Steuerelemente eine für jede Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="5a96f-134">Therefore, our page will have two Panel controls one for each interface.</span></span>

<span data-ttu-id="5a96f-135">Öffnen Sie zunächst die `BatchInsert.aspx` auf der Seite die `BatchData` Ordner, und ziehen Sie ein Panel aus der Toolbox in den Designer (siehe Abbildung 2).</span><span class="sxs-lookup"><span data-stu-id="5a96f-135">Start by opening the `BatchInsert.aspx` page in the `BatchData` folder and drag a Panel from the Toolbox onto the Designer (see Figure 2).</span></span> <span data-ttu-id="5a96f-136">Legen Sie den Zugriffsbereich s `ID` Eigenschaft `DisplayInterface`.</span><span class="sxs-lookup"><span data-stu-id="5a96f-136">Set the Panel s `ID` property to `DisplayInterface`.</span></span> <span data-ttu-id="5a96f-137">Wenn Sie im Bereich in den Designer, Hinzufügen der `Height` und `Width` Eigenschaften auf 50px 125px, bzw. festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="5a96f-137">When adding the Panel to the Designer, its `Height` and `Width` properties are set to 50px and 125px, respectively.</span></span> <span data-ttu-id="5a96f-138">Löschen Sie die Werte dieser Eigenschaften im Eigenschaftenfenster.</span><span class="sxs-lookup"><span data-stu-id="5a96f-138">Clear out these property values from the Properties window.</span></span>


<span data-ttu-id="5a96f-139">[![Ziehen Sie ein Panel aus der Toolbox in den Designer](batch-inserting-cs/_static/image5.png)](batch-inserting-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="5a96f-139">[![Drag a Panel from the Toolbox onto the Designer](batch-inserting-cs/_static/image5.png)](batch-inserting-cs/_static/image4.png)</span></span>

<span data-ttu-id="5a96f-140">**Abbildung 2**: Ziehen Sie ein Panel aus der Toolbox in den Designer ([klicken Sie, um das Bild in voller Größe anzeigen](batch-inserting-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="5a96f-140">**Figure 2**: Drag a Panel from the Toolbox onto the Designer ([Click to view full-size image](batch-inserting-cs/_static/image6.png))</span></span>


<span data-ttu-id="5a96f-141">Als Nächstes ziehen Sie eine Schaltfläche und GridView-Steuerelement in den Bereich ein.</span><span class="sxs-lookup"><span data-stu-id="5a96f-141">Next, drag a Button and GridView control into the Panel.</span></span> <span data-ttu-id="5a96f-142">Legen Sie die s `ID` Eigenschaft `ProcessShipment` und die zugehörige `Text` Eigenschaft, um den Prozess mit dem Produktversand.</span><span class="sxs-lookup"><span data-stu-id="5a96f-142">Set the Button s `ID` property to `ProcessShipment` and its `Text` property to Process Product Shipment.</span></span> <span data-ttu-id="5a96f-143">Legen Sie die GridView s `ID` Eigenschaft `ProductsGrid` und von sein Smarttag, binden Sie es an eine neue, mit dem Namen "ObjectDataSource" `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="5a96f-143">Set the GridView s `ID` property to `ProductsGrid` and, from its smart tag, bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="5a96f-144">Konfigurieren Sie zum Abrufen der Daten aus dem ObjectDataSource-Steuerelement die `ProductsBLL` Klasse s `GetProducts` Methode.</span><span class="sxs-lookup"><span data-stu-id="5a96f-144">Configure the ObjectDataSource to pull its data from the `ProductsBLL` class s `GetProducts` method.</span></span> <span data-ttu-id="5a96f-145">Da diese GridView nur zum Anzeigen von Daten verwendet wird, legen Sie die Dropdownlisten in der Update-, INSERT-, und Löschen von Registerkarten (keine) aus.</span><span class="sxs-lookup"><span data-stu-id="5a96f-145">Since this GridView is used only to display data, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None).</span></span> <span data-ttu-id="5a96f-146">Klicken Sie auf "Fertig stellen", um das Konfigurieren von Datenquellen-Assistenten zu beenden.</span><span class="sxs-lookup"><span data-stu-id="5a96f-146">Click Finish to complete the Configure Data Source wizard.</span></span>


<span data-ttu-id="5a96f-147">[![Anzeigen der Daten, die von der ProductsBLL Klasse s GetProducts-Methode zurückgegeben](batch-inserting-cs/_static/image8.png)](batch-inserting-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="5a96f-147">[![Display the Data Returned from the ProductsBLL Class s GetProducts Method](batch-inserting-cs/_static/image8.png)](batch-inserting-cs/_static/image7.png)</span></span>

<span data-ttu-id="5a96f-148">**Abbildung 3**: Anzeigen der Daten, die von zurückgegeben der `ProductsBLL` Klasse s `GetProducts` Methode ([klicken Sie, um das Bild in voller Größe anzeigen](batch-inserting-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="5a96f-148">**Figure 3**: Display the Data Returned from the `ProductsBLL` Class s `GetProducts` Method ([Click to view full-size image](batch-inserting-cs/_static/image9.png))</span></span>


<span data-ttu-id="5a96f-149">[![Legen Sie die Dropdownlisten in der Update-, INSERT- und DELETE werden Registerkarten (keine)](batch-inserting-cs/_static/image11.png)](batch-inserting-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="5a96f-149">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](batch-inserting-cs/_static/image11.png)](batch-inserting-cs/_static/image10.png)</span></span>

<span data-ttu-id="5a96f-150">**Abbildung 4**: Legen Sie die Dropdownlisten in der Update-, INSERT- und Löschen von Registerkarten auf (keine) ([klicken Sie, um das Bild in voller Größe anzeigen](batch-inserting-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="5a96f-150">**Figure 4**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](batch-inserting-cs/_static/image12.png))</span></span>


<span data-ttu-id="5a96f-151">Nach Abschluss des Assistenten "ObjectDataSource" wird in Visual Studio BoundFields und eine CheckBoxField für die Datenfelder Produkt hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="5a96f-151">After completing the ObjectDataSource wizard, Visual Studio will add BoundFields and a CheckBoxField for the product data fields.</span></span> <span data-ttu-id="5a96f-152">Entfernen Sie alle außer den `ProductName`, `CategoryName`, `SupplierName`, `UnitPrice`, und `Discontinued` Felder.</span><span class="sxs-lookup"><span data-stu-id="5a96f-152">Remove all but the `ProductName`, `CategoryName`, `SupplierName`, `UnitPrice`, and `Discontinued` fields.</span></span> <span data-ttu-id="5a96f-153">Alle ästhetischen Anpassungen vornehmen können.</span><span class="sxs-lookup"><span data-stu-id="5a96f-153">Feel free to make any aesthetic customizations.</span></span> <span data-ttu-id="5a96f-154">Ich habe mich entschieden, zum Formatieren der `UnitPrice` Felds als Währungswert, neu angeordnet, die Felder und einige Felder umbenannt `HeaderText` Werte.</span><span class="sxs-lookup"><span data-stu-id="5a96f-154">I decided to format the `UnitPrice` field as a currency value, reordered the fields, and renamed several of the fields `HeaderText` values.</span></span> <span data-ttu-id="5a96f-155">Außerdem konfigurieren Sie GridView Einbeziehung Auslagern und Sortieren von Unterstützung durch die Kontrollkästchen aktivieren, Paging und Sortieren aktivieren in das GridView-s-Smarttag überprüfen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-155">Also configure the GridView to include paging and sorting support by checking the Enable Paging and Enable Sorting checkboxes in the GridView s smart tag.</span></span>

<span data-ttu-id="5a96f-156">Nach dem Hinzufügen der Steuerelemente Panel "," Schaltfläche "," GridView "und" ObjectDataSource-Steuerelement, und die GridView-s-Felder anpassen, sollte im deklarativen Markup Ihrer Seite s etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="5a96f-156">After adding the Panel, Button, GridView, and ObjectDataSource controls and customizing the GridView s fields, your page s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](batch-inserting-cs/samples/sample1.aspx)]

<span data-ttu-id="5a96f-157">Beachten Sie, die das Markup für die Schaltfläche und ein GridView angezeigt werden, innerhalb des öffnenden und schließenden `<asp:Panel>` Tags.</span><span class="sxs-lookup"><span data-stu-id="5a96f-157">Note that the markup for the Button and GridView appear within the opening and closing `<asp:Panel>` tags.</span></span> <span data-ttu-id="5a96f-158">Da diese Steuerelemente in sind die `DisplayInterface` Bereich können wir dies ausblenden, indem Sie einfach im Bereich s festlegen `Visible` Eigenschaft `false`.</span><span class="sxs-lookup"><span data-stu-id="5a96f-158">Since these controls are within the `DisplayInterface` Panel, we can hide them by simply setting the Panel s `Visible` property to `false`.</span></span> <span data-ttu-id="5a96f-159">Schritt 3 untersucht die programmgesteuerte Änderung Bereich s `Visible` Eigenschaft als Reaktion auf eine Schaltfläche klicken, um eine Schnittstelle zu anzuzeigen, während die andere ausblenden.</span><span class="sxs-lookup"><span data-stu-id="5a96f-159">Step 3 looks at programmatically changing the Panel s `Visible` property in response to a button click to show one interface while hiding the other.</span></span>

<span data-ttu-id="5a96f-160">Nehmen Sie einen Moment Zeit, um unseren Fortschritt über einen Browser anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-160">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="5a96f-161">Wie in Abbildung 5 gezeigt, sehen Sie eine Prozess mit dem Produktversand oberhalb einer GridView-Ansicht auf die Schaltfläche, die die zehn Produkte zu einem Zeitpunkt auflistet.</span><span class="sxs-lookup"><span data-stu-id="5a96f-161">As Figure 5 shows, you should see a Process Product Shipment button above a GridView that lists the products ten at a time.</span></span>


<span data-ttu-id="5a96f-162">[![GridView Listet die Produkte und bietet, Sortieren und Paging-Funktionen](batch-inserting-cs/_static/image14.png)](batch-inserting-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="5a96f-162">[![The GridView Lists the Products and Offers Sorting and Paging Capabilities](batch-inserting-cs/_static/image14.png)](batch-inserting-cs/_static/image13.png)</span></span>

<span data-ttu-id="5a96f-163">**Abbildung 5**: GridView Listet die Produkte und bietet sortieren und Paging-Funktionen ([klicken Sie, um das Bild in voller Größe anzeigen](batch-inserting-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="5a96f-163">**Figure 5**: The GridView Lists the Products and Offers Sorting and Paging Capabilities ([Click to view full-size image](batch-inserting-cs/_static/image15.png))</span></span>


## <a name="step-2-creating-the-inserting-interface"></a><span data-ttu-id="5a96f-164">Schritt 2: Erstellen der einfügen-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="5a96f-164">Step 2: Creating the Inserting Interface</span></span>

<span data-ttu-id="5a96f-165">Mit der Anzeige abgeschlossen ist, es erneut bereit, die die einfügende Benutzeroberfläche erstellen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-165">With the display interface complete, we re ready to create the inserting interface.</span></span> <span data-ttu-id="5a96f-166">Können Sie für dieses Tutorial eine Einfügen von Schnittstelle zu erstellen, die einen Einzelwert Supplier "und" Kategorie Eingabeaufforderung aus, und klicken Sie dann kann der Benutzer zur Eingabe von bis zu fünf Produktnamen und Werte von planungseinheiten Preis s ein.</span><span class="sxs-lookup"><span data-stu-id="5a96f-166">For this tutorial, let s create an inserting interface that prompts for a single supplier and category value and then allows the user to enter up to five product names and unit price values.</span></span> <span data-ttu-id="5a96f-167">Mit dieser Schnittstelle kann Benutzer bis zu fünf neue Produkte hinzufügen, die alle Teilen der gleichen Kategorie und Lieferanten, aber einen eindeutigen Product und Preise.</span><span class="sxs-lookup"><span data-stu-id="5a96f-167">With this interface, the user can add one to five new products that all share the same category and supplier, but have unique product names and prices.</span></span>

<span data-ttu-id="5a96f-168">Beginnen Sie mit ziehen ein Panel aus der Toolbox auf den Designer, und platzieren es unterhalb der vorhandenen `DisplayInterface` Bereich.</span><span class="sxs-lookup"><span data-stu-id="5a96f-168">Start by dragging a Panel from the Toolbox onto the Designer, placing it beneath the existing `DisplayInterface` Panel.</span></span> <span data-ttu-id="5a96f-169">Legen Sie die `ID` Eigenschaften der neu hinzugefügten Bereich `InsertingInterface` und legen Sie seine `Visible` Eigenschaft `false`.</span><span class="sxs-lookup"><span data-stu-id="5a96f-169">Set the `ID` property of this newly added Panel to `InsertingInterface` and set its `Visible` property to `false`.</span></span> <span data-ttu-id="5a96f-170">Fügen wir Code, der festlegt der `InsertingInterface` Bereich s `Visible` Eigenschaft `true` in Schritt 3.</span><span class="sxs-lookup"><span data-stu-id="5a96f-170">We'll add code that sets the `InsertingInterface` Panel s `Visible` property to `true` in Step 3.</span></span> <span data-ttu-id="5a96f-171">Löschen Sie auch, den Bereich s `Height` und `Width` Eigenschaftswerte.</span><span class="sxs-lookup"><span data-stu-id="5a96f-171">Also clear out the Panel s `Height` and `Width` property values.</span></span>

<span data-ttu-id="5a96f-172">Als Nächstes müssen wir die einfügende-Schnittstelle zu erstellen, die in Abbildung 1 gezeigt wurde.</span><span class="sxs-lookup"><span data-stu-id="5a96f-172">Next, we need to create the inserting interface that was shown back in Figure 1.</span></span> <span data-ttu-id="5a96f-173">Diese Schnittstelle kann mithilfe einer Vielzahl von HTML-Verfahren erstellt werden, aber wir verwenden eine ziemlich einfach: eine Tabelle vier Spalten und sieben Zeilen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-173">This interface can be created through a variety of HTML techniques, but we will use a fairly straightforward one: a four-column, seven-row table.</span></span>

> [!NOTE]
> <span data-ttu-id="5a96f-174">Bei der Eingabe von Markup für HTML `<table>` Elemente, die von mir bevorzugte die Datenquellensicht an.</span><span class="sxs-lookup"><span data-stu-id="5a96f-174">When entering markup for HTML `<table>` elements, I prefer to use the Source view.</span></span> <span data-ttu-id="5a96f-175">Während Visual Studio-Tools für das Hinzufügen von verfügt `<table>` Elemente über den Designer, der Designer scheint alles zu möchte einfügen ungefragt für `style` Einstellungen in das Markup.</span><span class="sxs-lookup"><span data-stu-id="5a96f-175">While Visual Studio does have tools for adding `<table>` elements through the Designer, the Designer seems all too willing to inject unasked for `style` settings into the markup.</span></span> <span data-ttu-id="5a96f-176">Nachdem ich haben die `<table>` Markup ich normalerweise zurück zum Designer, um die Web-Steuerelemente hinzufügen und ihre Eigenschaften festlegen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-176">Once I have created the `<table>` markup, I usually return to the Designer to add the Web controls and set their properties.</span></span> <span data-ttu-id="5a96f-177">Beim Erstellen von Tabellen mit vordefinierten Spalten und Zeilen ich verwende lieber statischen HTML-Code anstelle der [Tabelle Websteuerelement](https://msdn.microsoft.com/library/system.web.ui.webcontrols.table.aspx) da Websteuerelementen zu wechseln, in ein Table-Steuerelement nur zugegriffen werden können, mit der `FindControl("controlID")` Muster.</span><span class="sxs-lookup"><span data-stu-id="5a96f-177">When creating tables with pre-determined columns and rows I prefer using static HTML rather than the [Table Web control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.table.aspx) because any Web controls placed within a Table Web control can only be accessed using the `FindControl("controlID")` pattern.</span></span> <span data-ttu-id="5a96f-178">Ich, verwenden jedoch Tabelle Websteuerelemente für dynamisch große Tabellen (diejenigen, deren Zeilen oder Spalten für eine Datenbank oder benutzerspezifische Kriterien basieren), da die Web-Tabelle, die Steuerelement programmgesteuert erstellt werden kann.</span><span class="sxs-lookup"><span data-stu-id="5a96f-178">I do, however, use Table Web controls for dynamically-sized tables (ones whose rows or columns are based on some database or user-specified criteria), since the Table Web control can be constructed programmatically.</span></span>


<span data-ttu-id="5a96f-179">Geben Sie das folgende Markup innerhalb der `<asp:Panel>` Tags der `InsertingInterface` Bereich:</span><span class="sxs-lookup"><span data-stu-id="5a96f-179">Enter the following markup within the `<asp:Panel>` tags of the `InsertingInterface` Panel:</span></span>


[!code-html[Main](batch-inserting-cs/samples/sample2.html)]

<span data-ttu-id="5a96f-180">Dies `<table>` Markup umfasst keine Steuerelemente des Web- noch, diese werden vorübergehend hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="5a96f-180">This `<table>` markup does not include any Web controls yet, we'll add those momentarily.</span></span> <span data-ttu-id="5a96f-181">Beachten Sie, dass jedes `<tr>` Element enthält eine bestimmte CSS-Klasse-Einstellung: `BatchInsertHeaderRow` für die Headerzeile, in dem der Lieferant und DropDownList-Steuerelementen geht; `BatchInsertFooterRow` für die Fußzeile, in denen die Produkte hinzufügen von Lieferung und die Schaltflächen Abbrechen geht; und die abwechselnden `BatchInsertRow` und `BatchInsertAlternatingRow` Werte für die Zeilen, die das Produkt und Komponententests enthält Preis TextBox-Steuerelemente.</span><span class="sxs-lookup"><span data-stu-id="5a96f-181">Note that each `<tr>` element contains a particular CSS class setting: `BatchInsertHeaderRow` for the header row where the supplier and category DropDownLists will go; `BatchInsertFooterRow` for the footer row where the Add Products from Shipment and Cancel Buttons will go; and alternating `BatchInsertRow` and `BatchInsertAlternatingRow` values for the rows that will contain the product and unit price TextBox controls.</span></span> <span data-ttu-id="5a96f-182">Ich Ve erstellt die entsprechende CSS-Klassen in der `Styles.css` Datei, die der einfügen-Schnittstelle eine ähnlich wie GridView und DetailsView aussehen zu verleihen steuert wir in diesen Tutorials verwendet haben.</span><span class="sxs-lookup"><span data-stu-id="5a96f-182">I ve created corresponding CSS classes in the `Styles.css` file to give the inserting interface an appearance similar to the GridView and DetailsView controls we ve used throughout these tutorials.</span></span> <span data-ttu-id="5a96f-183">Diese CSS-Klassen werden unten angezeigt.</span><span class="sxs-lookup"><span data-stu-id="5a96f-183">These CSS classes are shown below.</span></span>


[!code-css[Main](batch-inserting-cs/samples/sample3.css)]

<span data-ttu-id="5a96f-184">Mit diesem Markup eingegeben haben zurück zur Entwurfsansicht.</span><span class="sxs-lookup"><span data-stu-id="5a96f-184">With this markup entered, return to the Design view.</span></span> <span data-ttu-id="5a96f-185">Dies `<table>` sollte als Tabelle vier Spalten, die sieben Zeilen im Designer angezeigt, wie in Abbildung 6 gezeigt.</span><span class="sxs-lookup"><span data-stu-id="5a96f-185">This `<table>` should show as a four-column, seven-row table in the Designer, as Figure 6 illustrates.</span></span>


<span data-ttu-id="5a96f-186">[![Die einfügen-Schnittstelle besteht aus einer vier-Spalte, Tabelle mit sieben Zeilen](batch-inserting-cs/_static/image17.png)](batch-inserting-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="5a96f-186">[![The Inserting Interface is Composed of a Four-Column, Seven-Row Table](batch-inserting-cs/_static/image17.png)](batch-inserting-cs/_static/image16.png)</span></span>

<span data-ttu-id="5a96f-187">**Abbildung 6**: die einfügen-Schnittstelle besteht aus einer vier-Spalte, Tabelle mit sieben Zeilen ([klicken Sie, um das Bild in voller Größe anzeigen](batch-inserting-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="5a96f-187">**Figure 6**: The Inserting Interface is Composed of a Four-Column, Seven-Row Table ([Click to view full-size image](batch-inserting-cs/_static/image18.png))</span></span>


<span data-ttu-id="5a96f-188">Wir erneut jetzt bereit, das Einfügen von Schnittstelle Websteuerelemente hinzu.</span><span class="sxs-lookup"><span data-stu-id="5a96f-188">We re now ready to add the Web controls to the inserting interface.</span></span> <span data-ttu-id="5a96f-189">Ziehen Sie zwei DropDownList-Steuerelementen aus der Toolbox in die entsprechenden Zellen in der Tabelle für den Lieferanten und eine für die Kategorie ein.</span><span class="sxs-lookup"><span data-stu-id="5a96f-189">Drag two DropDownLists from the Toolbox into the appropriate cells in the table one for the supplier and one for the category.</span></span>

<span data-ttu-id="5a96f-190">Legen Sie den Lieferanten DropDownList s `ID` Eigenschaft `Suppliers` und binden sie an eine neue, mit dem Namen "ObjectDataSource" `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="5a96f-190">Set the supplier DropDownList s `ID` property to `Suppliers` and bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="5a96f-191">Konfigurieren Sie die neue "ObjectDataSource" zum Abrufen der Daten aus der `SuppliersBLL` Klasse s `GetSuppliers` Methode, und legen Sie das UPDATE Registerkarte s Dropdown-Liste (keine).</span><span class="sxs-lookup"><span data-stu-id="5a96f-191">Configure the new ObjectDataSource to retrieve its data from the `SuppliersBLL` class s `GetSuppliers` method and set the UPDATE tab s drop-down list to (None).</span></span> <span data-ttu-id="5a96f-192">Klicken Sie auf "Fertig stellen", um den Assistenten abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-192">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="5a96f-193">[![Konfigurieren von dem ObjectDataSource-Steuerelement zur Verwendung der SuppliersBLL Klasse s GetSuppliers-Methode](batch-inserting-cs/_static/image20.png)](batch-inserting-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="5a96f-193">[![Configure the ObjectDataSource to Use the SuppliersBLL Class s GetSuppliers Method](batch-inserting-cs/_static/image20.png)](batch-inserting-cs/_static/image19.png)</span></span>

<span data-ttu-id="5a96f-194">**Abbildung 7**: Konfigurieren von dem ObjectDataSource-Steuerelement verwenden die `SuppliersBLL` s-Klasse `GetSuppliers` Methode ([klicken Sie, um das Bild in voller Größe anzeigen](batch-inserting-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="5a96f-194">**Figure 7**: Configure the ObjectDataSource to Use the `SuppliersBLL` Class s `GetSuppliers` Method ([Click to view full-size image](batch-inserting-cs/_static/image21.png))</span></span>


<span data-ttu-id="5a96f-195">Haben die `Suppliers` DropDownList-Anzeige der `CompanyName` Feld "Daten" und die Verwendung der `SupplierID` Datenfeld als seine `ListItem` s Werte.</span><span class="sxs-lookup"><span data-stu-id="5a96f-195">Have the `Suppliers` DropDownList display the `CompanyName` data field and use the `SupplierID` data field as its `ListItem` s values.</span></span>


<span data-ttu-id="5a96f-196">[![Das Feld CompanyName-Daten anzeigen und SupplierID als Wert verwenden](batch-inserting-cs/_static/image23.png)](batch-inserting-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="5a96f-196">[![Display the CompanyName Data Field and Use SupplierID as the Value](batch-inserting-cs/_static/image23.png)](batch-inserting-cs/_static/image22.png)</span></span>

<span data-ttu-id="5a96f-197">**Abbildung 8**: Anzeige der `CompanyName` Datenfeld und Verwendung `SupplierID` als Wert ([klicken Sie, um das Bild in voller Größe anzeigen](batch-inserting-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="5a96f-197">**Figure 8**: Display the `CompanyName` Data Field and Use `SupplierID` as the Value ([Click to view full-size image](batch-inserting-cs/_static/image24.png))</span></span>


<span data-ttu-id="5a96f-198">Namen der zweiten Dropdownliste `Categories` und binden sie an eine neue, mit dem Namen "ObjectDataSource" `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="5a96f-198">Name the second DropDownList `Categories` and bind it to a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="5a96f-199">Konfigurieren der `CategoriesDataSource` "ObjectDataSource" Verwenden der `CategoriesBLL` Klasse s `GetCategories` Methode, die Gruppe, die die Dropdownlisten in der Update- und DELETE Registerkarten (keine) und klicken Sie auf Fertig stellen, um den Assistenten abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-199">Configure the `CategoriesDataSource` ObjectDataSource to use the `CategoriesBLL` class s `GetCategories` method; set the drop-down lists in the UPDATE and DELETE tabs to (None) and click Finish to complete the wizard.</span></span> <span data-ttu-id="5a96f-200">Schließlich müssen die DropDownList-Anzeige der `CategoryName` Feld "Daten" und die Verwendung der `CategoryID` als Wert.</span><span class="sxs-lookup"><span data-stu-id="5a96f-200">Finally, have the DropDownList display the `CategoryName` data field and use the `CategoryID` as the value.</span></span>

<span data-ttu-id="5a96f-201">Nachdem diese zwei DropDownList-Steuerelementen hinzugefügt und entsprechend konfigurierten ObjectDataSources gebunden wurden, sollte Ihr Bildschirm Abbildung 9 ähneln.</span><span class="sxs-lookup"><span data-stu-id="5a96f-201">After these two DropDownLists have been added and bound to appropriately configured ObjectDataSources, your screen should look similar to Figure 9.</span></span>


<span data-ttu-id="5a96f-202">[![Die Kopfzeile enthält jetzt den Lieferanten und Kategorien DropDownList-Steuerelementen](batch-inserting-cs/_static/image26.png)](batch-inserting-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="5a96f-202">[![The Header Row Now Contains the Suppliers and Categories DropDownLists](batch-inserting-cs/_static/image26.png)](batch-inserting-cs/_static/image25.png)</span></span>

<span data-ttu-id="5a96f-203">**Abbildung 9**: der Header Zeile enthält jetzt die `Suppliers` und `Categories` DropDownList-Steuerelementen ([klicken Sie, um das Bild in voller Größe anzeigen](batch-inserting-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="5a96f-203">**Figure 9**: The Header Row Now Contains the `Suppliers` and `Categories` DropDownLists ([Click to view full-size image](batch-inserting-cs/_static/image27.png))</span></span>


<span data-ttu-id="5a96f-204">Wir müssen jetzt erstellen Sie die Textfelder ein, um die Namen und den Preis für jedes neue Produkt zu sammeln.</span><span class="sxs-lookup"><span data-stu-id="5a96f-204">We now need to create the TextBoxes to collect the name and price for each new product.</span></span> <span data-ttu-id="5a96f-205">Ziehen Sie ein TextBox-Steuerelement aus der Toolbox in den Designer für jeden der fünf Product Name und Preis Zeilen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-205">Drag a TextBox control from the Toolbox onto the Designer for each of the five product name and price rows.</span></span> <span data-ttu-id="5a96f-206">Legen Sie die `ID` Eigenschaften der TextBox-Elemente zu `ProductName1`, `UnitPrice1`, `ProductName2`, `UnitPrice2`, `ProductName3`, `UnitPrice3`und so weiter.</span><span class="sxs-lookup"><span data-stu-id="5a96f-206">Set the `ID` properties of the TextBoxes to `ProductName1`, `UnitPrice1`, `ProductName2`, `UnitPrice2`, `ProductName3`, `UnitPrice3`, and so on.</span></span>

<span data-ttu-id="5a96f-207">Hinzufügen einer CompareValidator nach jedem des Einzelpreises Textfelder ein, und Festlegen der `ControlToValidate` -Eigenschaft auf die entsprechende `ID`.</span><span class="sxs-lookup"><span data-stu-id="5a96f-207">Add a CompareValidator after each of the unit price TextBoxes, setting the `ControlToValidate` property to the appropriate `ID`.</span></span> <span data-ttu-id="5a96f-208">Auch festlegen, die `Operator` Eigenschaft `GreaterThanEqual`, `ValueToCompare` auf 0 (null) und `Type` zu `Currency`.</span><span class="sxs-lookup"><span data-stu-id="5a96f-208">Also set the `Operator` property to `GreaterThanEqual`, `ValueToCompare` to 0, and `Type` to `Currency`.</span></span> <span data-ttu-id="5a96f-209">Diese Einstellungen weisen CompareValidator, stellen Sie sicher, dass der Preis, wenn eingegeben haben, einen gültigen Currency-Wert, der größer als oder gleich 0 (null) ist.</span><span class="sxs-lookup"><span data-stu-id="5a96f-209">These settings instruct the CompareValidator to ensure that the price, if entered, is a valid currency value that is greater than or equal to zero.</span></span> <span data-ttu-id="5a96f-210">Legen Sie die `Text` Eigenschaft \*, und `ErrorMessage` mit dem Preis muss größer als oder gleich 0 (null) sein.</span><span class="sxs-lookup"><span data-stu-id="5a96f-210">Set the `Text` property to \*, and `ErrorMessage` to The price must be greater than or equal to zero.</span></span> <span data-ttu-id="5a96f-211">Lassen Sie zudem alle Währungssymbole.</span><span class="sxs-lookup"><span data-stu-id="5a96f-211">Also, please omit any currency symbols.</span></span>

> [!NOTE]
> <span data-ttu-id="5a96f-212">Die einfügende-Schnittstelle umfasst keine RequiredFieldValidator-Steuerelemente, obwohl die `ProductName` -Feld in der `Products` Datenbanktabelle lässt keine `NULL` Werte.</span><span class="sxs-lookup"><span data-stu-id="5a96f-212">The inserting interface does not include any RequiredFieldValidator controls, even though the `ProductName` field in the `Products` database table does not allow `NULL` values.</span></span> <span data-ttu-id="5a96f-213">Dies ist das da soll den Benutzer bis zu fünf Produkten eingeben können.</span><span class="sxs-lookup"><span data-stu-id="5a96f-213">This is because we want to let the user enter up to five products.</span></span> <span data-ttu-id="5a96f-214">Beispielsweise würde der Benutzer die ersten drei Zeilen den Produktpreis, Name und Unit bereit, die letzten beiden Zeilen leer lassen, fügen wir hinzu d nur drei neue Produkte an das System.</span><span class="sxs-lookup"><span data-stu-id="5a96f-214">For example, if the user were to provide the product name and unit price for the first three rows, leaving the last two rows blank, we d just add three new products to the system.</span></span> <span data-ttu-id="5a96f-215">Da `ProductName` ist erforderlich, aber wir müssen programmgesteuert überprüfen, um, dass bei einen Preis je Einheit sicherzustellen, dass eingegeben werden, dass ein entsprechende Product Name-Wert angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="5a96f-215">Since `ProductName` is required, however, we will need to programmatically check to ensure that if a unit price is entered that a corresponding product name value is provided.</span></span> <span data-ttu-id="5a96f-216">Wir werden diese Prüfung in Schritt 4 in Angriff nehmen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-216">We'll tackle this check in Step 4.</span></span>


<span data-ttu-id="5a96f-217">Bei der Validierung der Benutzereingabe s meldet CompareValidator ungültige Daten auf, wenn der Wert ein Währungssymbol enthält.</span><span class="sxs-lookup"><span data-stu-id="5a96f-217">When validating the user s input, the CompareValidator reports invalid data if the value contains a currency symbol.</span></span> <span data-ttu-id="5a96f-218">Fügen Sie ein "$" vor jeder des Einzelpreises Textfelder als einen visuellen Hinweis zu dienen, die der Benutzer, um das Währungssymbol zu unterdrücken, bei der Eingabe des Preis angewiesen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-218">Add a $ in front of each of the unit price TextBoxes to serve as a visual cue that instructs the user to omit the currency symbol when entering the price.</span></span>

<span data-ttu-id="5a96f-219">Abschließend fügen Sie ein ValidationSummary-Steuerelement in der `InsertingInterface` Einstellungen im Bereich der `ShowMessageBox` Eigenschaft, um `true` und die zugehörige `ShowSummary` Eigenschaft, um `false`.</span><span class="sxs-lookup"><span data-stu-id="5a96f-219">Lastly, add a ValidationSummary control within the `InsertingInterface` Panel, settings its `ShowMessageBox` property to `true` and its `ShowSummary` property to `false`.</span></span> <span data-ttu-id="5a96f-220">Mit diesen Einstellungen Wenn der Benutzer eine ungültige Einheit Preis eingibt, ein Sternchen wird neben dem betreffenden TextBox-Steuerelemente angezeigt und die ValidationSummary zeigt eine Client-Side-Messagebox, die die Fehlermeldung anzeigt, die wir zuvor angegeben.</span><span class="sxs-lookup"><span data-stu-id="5a96f-220">With these settings, if the user enters an invalid unit price value, an asterisk will appear next to the offending TextBox controls and the ValidationSummary will display a client-side messagebox that shows the error message we specified earlier.</span></span>

<span data-ttu-id="5a96f-221">Ihr Bildschirm sollte an diesem Punkt ähnelt Abbildung 10 aussehen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-221">At this point, your screen should look similar to Figure 10.</span></span>


<span data-ttu-id="5a96f-222">[![Die Einfügen von-Schnittstelle enthält jetzt die Textfelder für die Produkte Namen und Preise](batch-inserting-cs/_static/image29.png)](batch-inserting-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="5a96f-222">[![The Inserting Interface Now Includes TextBoxes for the Products Names and Prices](batch-inserting-cs/_static/image29.png)](batch-inserting-cs/_static/image28.png)</span></span>

<span data-ttu-id="5a96f-223">**Abbildung 10**: die einfügen-Schnittstelle nun enthält Textfelder für die Namen der Produkte und Preise ([klicken Sie, um das Bild in voller Größe anzeigen](batch-inserting-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="5a96f-223">**Figure 10**: The Inserting Interface Now Includes TextBoxes for the Products Names and Prices ([Click to view full-size image](batch-inserting-cs/_static/image30.png))</span></span>


<span data-ttu-id="5a96f-224">Als Nächstes müssen wir den Produkten Hinzufügen von Schaltflächen "Lieferung" und "Abbrechen", das die Footerzeile hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-224">Next we need to add the Add Products from Shipment and Cancel buttons to the footer row.</span></span> <span data-ttu-id="5a96f-225">Ziehen Sie zwei Schaltflächen-Steuerelemente aus der Toolbox in die Fußzeile der einfügen-Schnittstelle, die Schaltflächen festlegen `ID` Eigenschaften `AddProducts` und `CancelButton` und `Text` Eigenschaften, die Produkte von Lieferungen und "Abbrechen", bzw. hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="5a96f-225">Drag two Button controls from the Toolbox into the footer of the inserting interface, setting the Buttons `ID` properties to `AddProducts` and `CancelButton` and `Text` properties to Add Products from Shipment and Cancel, respectively.</span></span> <span data-ttu-id="5a96f-226">Legen Sie außerdem die `CancelButton` Steuerelement s `CausesValidation` Eigenschaft `false`.</span><span class="sxs-lookup"><span data-stu-id="5a96f-226">In addition, set the `CancelButton` control s `CausesValidation` property to `false`.</span></span>

<span data-ttu-id="5a96f-227">Abschließend müssen wir ein Label-Steuerelement hinzufügen, die statusmeldungen für die beiden Schnittstellen angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="5a96f-227">Finally, we need to add a Label Web control that will display status messages for the two interfaces.</span></span> <span data-ttu-id="5a96f-228">Z. B. wenn ein Benutzer erfolgreich eine neue Lieferung von Produkten hinzufügt, möchten wir auf die Anzeigenschnittstelle zurück und zeigt eine bestätigungsmeldung an.</span><span class="sxs-lookup"><span data-stu-id="5a96f-228">For example, when a user successfully adds a new shipment of products, we want to return to the display interface and display a confirmation message.</span></span> <span data-ttu-id="5a96f-229">Wenn Sie jedoch der Benutzer einen Preis für ein neues Produkt, aber aufhört der Name des Produkts enthält, müssen wir eine Warnung angezeigt, da die `ProductName` ist ein Pflichtfeld.</span><span class="sxs-lookup"><span data-stu-id="5a96f-229">If, however, the user provides a price for a new product but leaves off the product name, we need to display a warning message since the `ProductName` field is required.</span></span> <span data-ttu-id="5a96f-230">Da wir diese Meldung, die für beide Schnittstellen angezeigt benötigen, platzieren Sie es am oberen Rand der Seite außerhalb der Bereiche.</span><span class="sxs-lookup"><span data-stu-id="5a96f-230">Since we need this message to display for both interfaces, place it at the top of the page outside of the Panels.</span></span>

<span data-ttu-id="5a96f-231">Ziehen Sie ein Label-Steuerelement aus der Toolbox auf den oberen Rand der Seite im Designer.</span><span class="sxs-lookup"><span data-stu-id="5a96f-231">Drag a Label Web control from the Toolbox to the top of the page in the Designer.</span></span> <span data-ttu-id="5a96f-232">Festlegen der `ID` Eigenschaft, um `StatusLabel`, deaktivieren Sie die `Text` -Eigenschaft, und legen die `Visible` und `EnableViewState` Eigenschaften `false`.</span><span class="sxs-lookup"><span data-stu-id="5a96f-232">Set the `ID` property to `StatusLabel`, clear out the `Text` property, and set the `Visible` and `EnableViewState` properties to `false`.</span></span> <span data-ttu-id="5a96f-233">Wie wir in vorherigen Tutorials gesehen haben, Festlegen der `EnableViewState` Eigenschaft `false` können programmgesteuert die Bezeichnung s Eigenschaftswerte ändern und wieder die Standardwerte für die nachfolgenden Postbacks automatisch zurückgesetzt.</span><span class="sxs-lookup"><span data-stu-id="5a96f-233">As we have seen in previous tutorials, setting the `EnableViewState` property to `false` allows us to programmatically change the Label s property values and have them automatically revert back to their defaults on the subsequent postback.</span></span> <span data-ttu-id="5a96f-234">Dies vereinfacht den Code für eine Statusmeldung angezeigt, als Reaktion auf eine Benutzeraktion, die die nachfolgenden beim Postback nicht mehr angezeigt.</span><span class="sxs-lookup"><span data-stu-id="5a96f-234">This simplifies the code for showing a status message in response to some user action that disappears on the subsequent postback.</span></span> <span data-ttu-id="5a96f-235">Legen Sie schließlich die `StatusLabel` Steuerelement s `CssClass` Eigenschaft in "Warnung", die den Namen einer CSS-Klasse darstellt, die in definierten `Styles.css` , Text in einer großen, kursiv, fett, Rot Schriftart anzeigt.</span><span class="sxs-lookup"><span data-stu-id="5a96f-235">Finally, set the `StatusLabel` control s `CssClass` property to Warning, which is the name of a CSS class defined in `Styles.css` that displays text in a large, italic, bold, red font.</span></span>

<span data-ttu-id="5a96f-236">Abbildung 11 zeigt Visual Studio-Designer aus, nachdem die Bezeichnung hinzugefügt und konfiguriert wurde.</span><span class="sxs-lookup"><span data-stu-id="5a96f-236">Figure 11 shows the Visual Studio Designer after the Label has been added and configured.</span></span>


<span data-ttu-id="5a96f-237">[![Platzieren Sie das Steuerelement StatusLabel über die zwei Panel-Steuerelemente](batch-inserting-cs/_static/image32.png)](batch-inserting-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="5a96f-237">[![Place the StatusLabel Control Above the Two Panel Controls](batch-inserting-cs/_static/image32.png)](batch-inserting-cs/_static/image31.png)</span></span>

<span data-ttu-id="5a96f-238">**Abbildung 11**: Ort der `StatusLabel` Steuerelement über die zwei Panel-Steuerelemente ([klicken Sie, um das Bild in voller Größe anzeigen](batch-inserting-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="5a96f-238">**Figure 11**: Place the `StatusLabel` Control Above the Two Panel Controls ([Click to view full-size image](batch-inserting-cs/_static/image33.png))</span></span>


## <a name="step-3-switching-between-the-display-and-inserting-interfaces"></a><span data-ttu-id="5a96f-239">Schritt 3: Wechseln zwischen der Anzeige und Einfügen von Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="5a96f-239">Step 3: Switching Between the Display and Inserting Interfaces</span></span>

<span data-ttu-id="5a96f-240">An diesem Punkt haben wir das Markup für unsere Anzeige und das Einfügen von Schnittstellen, sondern wir erneut noch läuft in zwei Aufgaben:</span><span class="sxs-lookup"><span data-stu-id="5a96f-240">At this point we have completed the markup for our display and inserting interfaces, but we re still left with two tasks:</span></span>

- <span data-ttu-id="5a96f-241">Wechseln zwischen der Anzeige und das Einfügen von Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="5a96f-241">Switching between the display and inserting interfaces</span></span>
- <span data-ttu-id="5a96f-242">Die Produkte hinzufügen in der Lieferung in der Datenbank</span><span class="sxs-lookup"><span data-stu-id="5a96f-242">Adding the products in the shipment to the database</span></span>

<span data-ttu-id="5a96f-243">Derzeit die Anzeigenschnittstelle sichtbar ist, aber die einfügende-Schnittstelle ist ausgeblendet.</span><span class="sxs-lookup"><span data-stu-id="5a96f-243">Currently, the display interface is visible but the inserting interface is hidden.</span></span> <span data-ttu-id="5a96f-244">Grund hierfür ist die `DisplayInterface` Bereich s `Visible` -Eigenschaftensatz auf `true` (der Standardwert), während die `InsertingInterface` Bereich s `Visible` -Eigenschaftensatz auf `false`.</span><span class="sxs-lookup"><span data-stu-id="5a96f-244">This is because the `DisplayInterface` Panel s `Visible` property is set to `true` (the default value), while the `InsertingInterface` Panel s `Visible` property is set to `false`.</span></span> <span data-ttu-id="5a96f-245">So wechseln Sie zwischen den beiden Schnittstellen wir lediglich zum Umschalten der einzelnen Steuerelemente s müssen `Visible` -Eigenschaftswert.</span><span class="sxs-lookup"><span data-stu-id="5a96f-245">To switch between the two interfaces we simply need to toggle each control s `Visible` property value.</span></span>

<span data-ttu-id="5a96f-246">Wir möchten, wechseln von der Anzeigenschnittstelle, auf die einfügen-Schnittstelle, wenn der Prozess mit dem Produktversand geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="5a96f-246">We want to move from the display interface to the inserting interface when the Process Product Shipment button is clicked.</span></span> <span data-ttu-id="5a96f-247">Aus diesem Grund erstellen Sie einen Ereignishandler für diese Schaltfläche s `Click` Ereignis, das den folgenden Code enthält:</span><span class="sxs-lookup"><span data-stu-id="5a96f-247">Therefore, create an event handler for this Button s `Click` event that contains the following code:</span></span>


[!code-csharp[Main](batch-inserting-cs/samples/sample4.cs)]

<span data-ttu-id="5a96f-248">Dieser Code einfach Blendet die `DisplayInterface` Bereich und zeigt die `InsertingInterface` Bereich.</span><span class="sxs-lookup"><span data-stu-id="5a96f-248">This code simply hides the `DisplayInterface` Panel and shows the `InsertingInterface` Panel.</span></span>

<span data-ttu-id="5a96f-249">Als Nächstes erstellen Sie Ereignishandler für die Produkte hinzufügen von Steuerelementen von Lieferung und die Schaltfläche "Abbrechen" in der einfügen-Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="5a96f-249">Next, create event handlers for the Add Products from Shipment and Cancel Button controls in the inserting interface.</span></span> <span data-ttu-id="5a96f-250">Wenn eine dieser Schaltflächen geklickt wird, muss die Anzeigenschnittstelle wiederherstellen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-250">When either of these Buttons is clicked, we need to revert back to the display interface.</span></span> <span data-ttu-id="5a96f-251">Erstellen Sie `Click` -Ereignishandlern für beide Schaltflächen-Steuerelemente, damit sie aufgerufen werden `ReturnToDisplayInterface`, eine Methode, die wir werden vorübergehend hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-251">Create `Click` event handlers for both Button controls so that they call `ReturnToDisplayInterface`, a method we will add momentarily.</span></span> <span data-ttu-id="5a96f-252">Zusätzlich zum Ausblenden der `InsertingInterface` klicken und mit der `DisplayInterface` Bereich der `ReturnToDisplayInterface` Methode muss die Web-Steuerelemente auf den Zustand vor der Bearbeitung zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="5a96f-252">In addition to hiding the `InsertingInterface` Panel and showing the `DisplayInterface` Panel, the `ReturnToDisplayInterface` method needs to return the Web controls to their pre-editing state.</span></span> <span data-ttu-id="5a96f-253">Dies umfasst das Festlegen der DropDownList-Steuerelementen `SelectedIndex` Eigenschaften auf 0 und Beseitigen der `Text` Eigenschaften der TextBox-Steuerelemente.</span><span class="sxs-lookup"><span data-stu-id="5a96f-253">This involves setting the DropDownLists `SelectedIndex` properties to 0 and clearing out the `Text` properties of the TextBox controls.</span></span>

> [!NOTE]
> <span data-ttu-id="5a96f-254">Beachten Sie, was passieren kann Wenn wir nihnen t Zurückgeben der Steuerelemente auf den Zustand vor der Bearbeitung vor der Rückgabe auf die Anzeigenschnittstelle.</span><span class="sxs-lookup"><span data-stu-id="5a96f-254">Consider what might happen if we didn t return the controls to their pre-editing state before returning to the display interface.</span></span> <span data-ttu-id="5a96f-255">Ein Benutzer möglicherweise klicken Sie auf die Schaltfläche mit den Prozess mit dem Produktversand, geben Sie die Produkte aus der Lieferung und klicken Sie dann auf Produkte aus Lieferung hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-255">A user might click the Process Product Shipment button, enter the products from the shipment, and then click Add Products from Shipment.</span></span> <span data-ttu-id="5a96f-256">Dies würde die Produkte hinzufügen und den Benutzer auf die Anzeigenschnittstelle zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="5a96f-256">This would add the products and return the user to the display interface.</span></span> <span data-ttu-id="5a96f-257">An diesem Punkt kann der Benutzer einer anderen Sendung hinzufügen möchten.</span><span class="sxs-lookup"><span data-stu-id="5a96f-257">At this point the user might want to add another shipment.</span></span> <span data-ttu-id="5a96f-258">Nach dem Klicken auf die Schaltfläche "Prozess mit dem Produktversand", die sie die einfügen-Schnittstelle, aber die DropDownList zurückgeben würde würde Auswahl und TextBox-Werte immer noch mit ihren vorherigen Wert aufgefüllt werden.</span><span class="sxs-lookup"><span data-stu-id="5a96f-258">Upon clicking the Process Product Shipment button they would return to the inserting interface but the DropDownList selections and TextBox values would still be populated with their previous values.</span></span>


[!code-csharp[Main](batch-inserting-cs/samples/sample5.cs)]

<span data-ttu-id="5a96f-259">Beide `Click` Ereignishandler rufen Sie einfach die `ReturnToDisplayInterface` -Methode, obwohl wir zu den Produkten hinzufügen aus Lieferung zurückkehren müssen `Click` -Ereignishandler in Schritt 4, und fügen Sie Code, um die Produkte zu speichern.</span><span class="sxs-lookup"><span data-stu-id="5a96f-259">Both `Click` event handlers simply call the `ReturnToDisplayInterface` method, although we'll return to the Add Products from Shipment `Click` event handler in Step 4 and add code to save the products.</span></span> <span data-ttu-id="5a96f-260">`ReturnToDisplayInterface` beginnt mit dem Zurückgeben der `Suppliers` und `Categories` DropDownList-Steuerelementen, die ersten Optionen aus.</span><span class="sxs-lookup"><span data-stu-id="5a96f-260">`ReturnToDisplayInterface` starts by returning the `Suppliers` and `Categories` DropDownLists to their first options.</span></span> <span data-ttu-id="5a96f-261">Die zwei Konstanten `firstControlID` und `lastControlID` markieren Sie die Start- und Endindexwerte Steuerelement verwendet, bei der Benennung des Name und Unit Produktpreis Textfelder einfügen, Schnittstelle, und werden verwendet, in die Begrenzungen des der `for` Schleife, die die festlegt`Text`Eigenschaften der TextBox-Steuerelemente auf eine leere Zeichenfolge zurück.</span><span class="sxs-lookup"><span data-stu-id="5a96f-261">The two constants `firstControlID` and `lastControlID` mark the starting and ending control index values used in naming the product name and unit price TextBoxes in the inserting interface and are used in the bounds of the `for` loop that sets the `Text` properties of the TextBox controls back to an empty string.</span></span> <span data-ttu-id="5a96f-262">Zum Schluss die Panels `Visible` Eigenschaften werden zurückgesetzt, damit die einfügende-Schnittstelle ausgeblendet ist und der Anzeigenschnittstelle, die angezeigt.</span><span class="sxs-lookup"><span data-stu-id="5a96f-262">Finally, the Panels `Visible` properties are reset so that the inserting interface is hidden and the display interface shown.</span></span>

<span data-ttu-id="5a96f-263">Nehmen Sie einen Moment Zeit, um diese Seite in einem Browser zu testen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-263">Take a moment to test out this page in a browser.</span></span> <span data-ttu-id="5a96f-264">Wenn die Seite zuerst besuchen sollten Sie die Anzeigenschnittstelle sehen, wie in Abbildung 5 gezeigt wurde.</span><span class="sxs-lookup"><span data-stu-id="5a96f-264">When first visiting the page you should see the display interface as was shown in Figure 5.</span></span> <span data-ttu-id="5a96f-265">Klicken Sie auf die Schaltfläche "Prozess mit dem Produktversand".</span><span class="sxs-lookup"><span data-stu-id="5a96f-265">Click the Process Product Shipment button.</span></span> <span data-ttu-id="5a96f-266">Die Seite wird postback, und die einfügende-Schnittstelle sollte jetzt angezeigt werden, wie in Abbildung 12 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="5a96f-266">The page will postback and you should now see the inserting interface as shown in Figure 12.</span></span> <span data-ttu-id="5a96f-267">Entweder die hinzufügen Produkte aus der Lieferung "oder" Abbrechen "klicken, kehren Sie zur Anzeigenschnittstelle zurück.</span><span class="sxs-lookup"><span data-stu-id="5a96f-267">Clicking either the Add Products from Shipment or Cancel buttons returns you to the display interface.</span></span>

> [!NOTE]
> <span data-ttu-id="5a96f-268">Können Sie während der Anzeige der einfügen-Schnittstelle, die CompareValidators auf den Einzelpreis Textfelder zu testen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-268">While viewing the inserting interface, take a moment to test out the CompareValidators on the unit price TextBoxes.</span></span> <span data-ttu-id="5a96f-269">Daraufhin sollte eine clientseitige Messagebox Warnung, wenn Sie die Produkte hinzufügen, Schaltfläche "Lieferung" mit ungültigen Currency-Werte oder Preise mit dem ein Wert kleiner als 0 (null) klicken.</span><span class="sxs-lookup"><span data-stu-id="5a96f-269">You should see a client-side messagebox warning when clicking the Add Products from Shipment button with invalid currency values or prices with a value less than zero.</span></span>


<span data-ttu-id="5a96f-270">[![Die einfügen-Schnittstelle wird angezeigt, nach dem Klicken auf die Schaltfläche "Prozess Produkt Lieferung"](batch-inserting-cs/_static/image35.png)](batch-inserting-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="5a96f-270">[![The Inserting Interface is Displayed After Clicking the Process Product Shipment Button](batch-inserting-cs/_static/image35.png)](batch-inserting-cs/_static/image34.png)</span></span>

<span data-ttu-id="5a96f-271">**Abbildung 12**: die einfügen-Schnittstelle wird angezeigt, nach dem Klicken auf die Schaltfläche "Prozess Produkt Lieferung" ([klicken Sie, um das Bild in voller Größe anzeigen](batch-inserting-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="5a96f-271">**Figure 12**: The Inserting Interface is Displayed After Clicking the Process Product Shipment Button ([Click to view full-size image](batch-inserting-cs/_static/image36.png))</span></span>


## <a name="step-4-adding-the-products"></a><span data-ttu-id="5a96f-272">Schritt 4: Hinzufügen der Produkte</span><span class="sxs-lookup"><span data-stu-id="5a96f-272">Step 4: Adding the Products</span></span>

<span data-ttu-id="5a96f-273">Alle, die verbleibt, für dieses Tutorial ist auf die Produkte in der Datenbank in den Produkten Hinzufügen von Schaltfläche "Lieferung" s zu speichern, `Click` -Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="5a96f-273">All that remains for this tutorial is to save the products to the database in the Add Products from Shipment Button s `Click` event handler.</span></span> <span data-ttu-id="5a96f-274">Dies kann erreicht werden, indem Sie erstellen eine `ProductsDataTable` und das Hinzufügen einer `ProductsRow` Instanz für jedes der angegebenen Produktnamen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-274">This can be accomplished by creating a `ProductsDataTable` and adding a `ProductsRow` instance for each of the product names supplied.</span></span> <span data-ttu-id="5a96f-275">Einmal diese `ProductsRow` s wurden hinzugefügt, werden wir einen Aufruf von stellen die `ProductsBLL` s-Klasse `UpdateWithTransaction` -Methode übergeben die `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="5a96f-275">Once these `ProductsRow` s have been added we will make a call to the `ProductsBLL` class s `UpdateWithTransaction` method passing in the `ProductsDataTable`.</span></span> <span data-ttu-id="5a96f-276">Bedenken Sie, dass die `UpdateWithTransaction` -Methode, die in erstellt wurde die [Umschließen von Datenbankänderungen innerhalb einer Transaktion](wrapping-database-modifications-within-a-transaction-cs.md) Tutorial, übergibt die `ProductsDataTable` auf die `ProductsTableAdapter` s `UpdateWithTransaction` Methode.</span><span class="sxs-lookup"><span data-stu-id="5a96f-276">Recall that the `UpdateWithTransaction` method, which was created back in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-cs.md) tutorial, passes the `ProductsDataTable` to the `ProductsTableAdapter` s `UpdateWithTransaction` method.</span></span> <span data-ttu-id="5a96f-277">Von dort aus eine ADO.NET-Transaktion gestartet wird und die Probleme TableAdatper ein `INSERT` Anweisung an die Datenbank für jede hinzugefügte `ProductsRow` in der Datentabelle.</span><span class="sxs-lookup"><span data-stu-id="5a96f-277">From there, an ADO.NET transaction is started and the TableAdatper issues an `INSERT` statement to the database for each added `ProductsRow` in the DataTable.</span></span> <span data-ttu-id="5a96f-278">Vorausgesetzt, dass alle Produkte ohne Fehler hinzugefügt werden, die Transaktion ein Commit ausgeführt wird, wird andernfalls ein Rollback.</span><span class="sxs-lookup"><span data-stu-id="5a96f-278">Assuming all products are added without error, the transaction is committed, otherwise it is rolled back.</span></span>

<span data-ttu-id="5a96f-279">Der Code für die Produkte hinzufügen, über die Schaltfläche "Lieferung" s `Click` -Ereignishandler auch etwas fehlerprüfung durchführen muss.</span><span class="sxs-lookup"><span data-stu-id="5a96f-279">The code for the Add Products from Shipment Button s `Click` event handler also needs to perform a bit of error checking.</span></span> <span data-ttu-id="5a96f-280">Da es sich um keine RequiredFieldValidators in der einfügen-Schnittstelle verwendet, kann ein Benutzer einen Preis für ein Produkt beim Auslassen von seinen Namens eingeben.</span><span class="sxs-lookup"><span data-stu-id="5a96f-280">Since there are no RequiredFieldValidators used in the inserting interface, a user could enter a price for a product while omitting its name.</span></span> <span data-ttu-id="5a96f-281">Da der Name des Produkts s erforderlich ist, wenn eine solche Bedingung erweitert müssen wir den Benutzer zu warnen und die einfügungen nicht fortgesetzt.</span><span class="sxs-lookup"><span data-stu-id="5a96f-281">Since the product s name is required, if such a condition unfolds we need to alert the user and not proceed with the inserts.</span></span> <span data-ttu-id="5a96f-282">Die vollständige `Click` Ereignishandlercode folgt:</span><span class="sxs-lookup"><span data-stu-id="5a96f-282">The complete `Click` event handler code follows:</span></span>


[!code-csharp[Main](batch-inserting-cs/samples/sample6.cs)]

<span data-ttu-id="5a96f-283">Der Ereignishandler startet, indem sichergestellt wird, die die `Page.IsValid` Eigenschaft gibt einen Wert von `true`.</span><span class="sxs-lookup"><span data-stu-id="5a96f-283">The event handler starts by ensuring that the `Page.IsValid` property returns a value of `true`.</span></span> <span data-ttu-id="5a96f-284">Wenn sie zurückgibt `false`, und ist dies eines oder mehrere der CompareValidators werden Berichtsdaten ungültig; in diesem Fall wir sollten nicht versuchen, fügen Sie die eingegebenen Produkte oder wir erhalten eine Ausnahme beim Versuch den Preis der freien Eingabe zuzuweisen Wert der `ProductsRow` s `UnitPrice` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="5a96f-284">If it returns `false`, then that means one or more of the CompareValidators are reporting invalid data; in such a case we do not want to attempt to insert the entered products or we'll end up with an exception when attempting to assign the user-entered unit price value to the `ProductsRow` s `UnitPrice` property.</span></span>

<span data-ttu-id="5a96f-285">Anschließend wird eine neue `ProductsDataTable` Instanz erstellt wird (`products`).</span><span class="sxs-lookup"><span data-stu-id="5a96f-285">Next, a new `ProductsDataTable` instance is created (`products`).</span></span> <span data-ttu-id="5a96f-286">Ein `for` Schleife wird verwendet, um das Durchlaufen des Name und Unit Produktpreis Textfelder und die `Text` Eigenschaften werden in der lokalen Variablen gelesen `productName` und `unitPrice`.</span><span class="sxs-lookup"><span data-stu-id="5a96f-286">A `for` loop is used to iterate through the product name and unit price TextBoxes and the `Text` properties are read into the local variables `productName` and `unitPrice`.</span></span> <span data-ttu-id="5a96f-287">Wenn sich der Benutzer einen Wert für den Einzelpreis jedoch nicht für den entsprechenden Produktnamen, die `StatusLabel` angezeigt, die die Nachricht, wenn Sie eine Einheit Preis Sie angeben, auch muss den Namen des Produkts enthalten, und der Ereignishandler beendet ist.</span><span class="sxs-lookup"><span data-stu-id="5a96f-287">If the user has entered a value for the unit price but not for the corresponding product name, the `StatusLabel` displays the message If you provide a unit price you must also include the name of the product and the event handler is exited.</span></span>

<span data-ttu-id="5a96f-288">Wenn Sie ein Produktnamen bereitgestellt wurde, ein neues `ProductsRow` Instanz wurde mit der `ProductsDataTable` s `NewProductsRow` Methode.</span><span class="sxs-lookup"><span data-stu-id="5a96f-288">If a product name has been provided, a new `ProductsRow` instance is created using the `ProductsDataTable` s `NewProductsRow` method.</span></span> <span data-ttu-id="5a96f-289">Diese neue `ProductsRow` s-Instanz `ProductName` -Eigenschaftensatz auf das aktuelle Produkt Textfeld beim Benennen der `SupplierID` und `CategoryID` Eigenschaften zugewiesen sind die `SelectedValue` Eigenschaften die DropDownList-Steuerelementen im Einfügen von Schnittstelle s-Header.</span><span class="sxs-lookup"><span data-stu-id="5a96f-289">This new `ProductsRow` instance s `ProductName` property is set to the current product name TextBox while the `SupplierID` and `CategoryID` properties are assigned to the `SelectedValue` properties of the DropDownLists in the inserting interface s header.</span></span> <span data-ttu-id="5a96f-290">Wenn der Benutzer einen Wert für den Produktpreis s eingegeben, zugewiesen wird die `ProductsRow` s-Instanz `UnitPrice` Eigenschaft; hingegen die Eigenschaft ist links nicht zugewiesen ist, führen eine `NULL` Wert für `UnitPrice` in der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="5a96f-290">If the user entered a value for the product s price, it is assigned to the `ProductsRow` instance s `UnitPrice` property; otherwise, the property is left unassigned, which will result in a `NULL` value for `UnitPrice` in the database.</span></span> <span data-ttu-id="5a96f-291">Zum Schluss die `Discontinued` und `UnitsOnOrder` Eigenschaften werden die hartcodierten Werten zugewiesen `false` und 0 (null) bzw.</span><span class="sxs-lookup"><span data-stu-id="5a96f-291">Finally, the `Discontinued` and `UnitsOnOrder` properties are assigned to the hard-coded values `false` and 0, respectively.</span></span>

<span data-ttu-id="5a96f-292">Nachdem Sie die Eigenschaften zugewiesen wurden die `ProductsRow` Instanz, die an die `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="5a96f-292">After the properties have been assigned to the `ProductsRow` instance it is added to the `ProductsDataTable`.</span></span>

<span data-ttu-id="5a96f-293">Nach Fertigstellung der `for` Schleife überprüft werden, ob alle Produkte hinzugefügt wurden.</span><span class="sxs-lookup"><span data-stu-id="5a96f-293">At the completion of the `for` loop, we check whether any products have been added.</span></span> <span data-ttu-id="5a96f-294">Der Benutzer kann schließlich aus Lieferung, bevor Sie eingeben, alle Produktnamen oder die Preise der Produkte hinzufügen geklickt haben.</span><span class="sxs-lookup"><span data-stu-id="5a96f-294">The user may, after all, have clicked the Add Products from Shipment before entering any product names or prices.</span></span> <span data-ttu-id="5a96f-295">Es ist mindestens ein Produkt in der `ProductsDataTable`, `ProductsBLL` s-Klasse `UpdateWithTransaction` Methode wird aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-295">If there is at least one product in the `ProductsDataTable`, the `ProductsBLL` class s `UpdateWithTransaction` method is called.</span></span> <span data-ttu-id="5a96f-296">Als Nächstes wird die Daten erneut gebunden die `ProductsGrid` GridView, damit die neu hinzugefügte Produkte in der Anzeigenschnittstelle angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="5a96f-296">Next, the data is rebound to the `ProductsGrid` GridView so that the newly added products will appear in the display interface.</span></span> <span data-ttu-id="5a96f-297">Die `StatusLabel` wird aktualisiert, um eine bestätigungsmeldung anzuzeigen und die `ReturnToDisplayInterface` wird aufgerufen, durch das Ausblenden der Schnittstelle einfügen und mit der Anzeigenschnittstelle.</span><span class="sxs-lookup"><span data-stu-id="5a96f-297">The `StatusLabel` is updated to display a confirmation message and the `ReturnToDisplayInterface` is invoked, hiding the inserting interface and showing the display interface.</span></span>

<span data-ttu-id="5a96f-298">Wenn keine Produkte eingegeben wurden, bleibt die einfügende Schnittstelle angezeigt, aber die Nachricht, die keine Produkte hinzugefügt wurden.</span><span class="sxs-lookup"><span data-stu-id="5a96f-298">If no products were entered, the inserting interface remains displayed but the message No products were added.</span></span> <span data-ttu-id="5a96f-299">Bitte geben Sie die Produktnamen und einem Stückpreis in den Textfeldern angezeigt.</span><span class="sxs-lookup"><span data-stu-id="5a96f-299">Please enter the product names and unit prices in the textboxes is displayed.</span></span>

<span data-ttu-id="5a96f-300">Abbildung s 13, 14 und 15 anzeigen, das Einfügen und Schnittstellen in Aktion anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-300">Figure s 13, 14, and 15 show the inserting and display interfaces in action.</span></span> <span data-ttu-id="5a96f-301">In Abbildung 13 wird der Benutzer hat eine Einheit Preis ohne einen entsprechenden Produktnamen eingegeben.</span><span class="sxs-lookup"><span data-stu-id="5a96f-301">In Figure 13, the user has entered a unit price value without a corresponding product name.</span></span> <span data-ttu-id="5a96f-302">Abbildung 14 zeigt der Anzeigenschnittstelle nach drei neue, dass Produkte während Abbildung 15 zwei neu hinzugefügten Produkten in den GridView-Ansicht zeigt (der dritte Parameter ist auf der vorherigen Seite) erfolgreich hinzugefügt wurden.</span><span class="sxs-lookup"><span data-stu-id="5a96f-302">Figure 14 shows the display interface after three new products have been added successfully, while Figure 15 shows two of the newly added products in the GridView (the third one is on the previous page).</span></span>


<span data-ttu-id="5a96f-303">[![Ein Produktname ist erforderlich, bei einem Preis je Einheit eingeben](batch-inserting-cs/_static/image38.png)](batch-inserting-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="5a96f-303">[![A Product Name is Required When Entering a Unit Price](batch-inserting-cs/_static/image38.png)](batch-inserting-cs/_static/image37.png)</span></span>

<span data-ttu-id="5a96f-304">**Abbildung 13**: A Product Name ist erforderlich, bei einem Preis je Einheit eingeben ([klicken Sie, um das Bild in voller Größe anzeigen](batch-inserting-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="5a96f-304">**Figure 13**: A Product Name is Required When Entering a Unit Price ([Click to view full-size image](batch-inserting-cs/_static/image39.png))</span></span>


<span data-ttu-id="5a96f-305">[![Drei neue Teil des Gartens mein wurde für den Lieferanten Mayumi s](batch-inserting-cs/_static/image41.png)](batch-inserting-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="5a96f-305">[![Three New Veggies Have Been Added for the Supplier Mayumi s](batch-inserting-cs/_static/image41.png)](batch-inserting-cs/_static/image40.png)</span></span>

<span data-ttu-id="5a96f-306">**Abbildung 14**: drei neue Teil des Gartens mein wurde für den Lieferanten Mayumi s ([klicken Sie, um das Bild in voller Größe anzeigen](batch-inserting-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="5a96f-306">**Figure 14**: Three New Veggies Have Been Added for the Supplier Mayumi s ([Click to view full-size image](batch-inserting-cs/_static/image42.png))</span></span>


<span data-ttu-id="5a96f-307">[![Die neuen Produkte finden Sie in der letzten Seite des GridView](batch-inserting-cs/_static/image44.png)](batch-inserting-cs/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="5a96f-307">[![The New Products Can Be Found in the Last Page of the GridView](batch-inserting-cs/_static/image44.png)](batch-inserting-cs/_static/image43.png)</span></span>

<span data-ttu-id="5a96f-308">**Abbildung 15**: die neuen Produkte finden Sie in der letzten Seite des GridView ([klicken Sie, um das Bild in voller Größe anzeigen](batch-inserting-cs/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="5a96f-308">**Figure 15**: The New Products Can Be Found in the Last Page of the GridView ([Click to view full-size image](batch-inserting-cs/_static/image45.png))</span></span>


> [!NOTE]
> <span data-ttu-id="5a96f-309">Der Batch, die in diesem Tutorial verwendete Logik einfügen dient als Wrapper für die einfügungen innerhalb des Bereichs der Transaktion.</span><span class="sxs-lookup"><span data-stu-id="5a96f-309">The batch inserting logic used in this tutorial wraps the inserts within the scope of transaction.</span></span> <span data-ttu-id="5a96f-310">Um dies zu überprüfen, führen Sie absichtlich einen Fehler auf Datenbankebene.</span><span class="sxs-lookup"><span data-stu-id="5a96f-310">To verify this, purposefully introduce a database-level error.</span></span> <span data-ttu-id="5a96f-311">Z. B. statt der Zuweisung von neuen `ProductsRow` s-Instanz `CategoryID` Eigenschaft, um den ausgewählten Wert in der `Categories` DropDownList, weisen Sie es auf einen Wert wie `i * 5`.</span><span class="sxs-lookup"><span data-stu-id="5a96f-311">For example, rather than assigning the new `ProductsRow` instance s `CategoryID` property to the selected value in the `Categories` DropDownList, assign it to a value like `i * 5`.</span></span> <span data-ttu-id="5a96f-312">Hier `i` ist der Indexer Schleife und Werte im Bereich von 1 bis 5.</span><span class="sxs-lookup"><span data-stu-id="5a96f-312">Here `i` is the loop indexer and has values ranging from 1 to 5.</span></span> <span data-ttu-id="5a96f-313">Daher beim Hinzufügen von zwei oder mehr Produkte in Batch fügen Sie das erste Produkt müssen eine gültige `CategoryID` Wert (5), aber nachfolgende Produkte müssen `CategoryID` Werte, die nicht bis zu entsprechen `CategoryID` Werte in der `Categories` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="5a96f-313">Therefore, when adding two or more products in batch insert the first product will have a valid `CategoryID` value (5), but subsequent products will have `CategoryID` values that do not match up to `CategoryID` values in the `Categories` table.</span></span> <span data-ttu-id="5a96f-314">Das Endergebnis ist, die während der ersten `INSERT` gelingt, alle weiteren mit einer Verletzung der foreign Key-Einschränkung nicht.</span><span class="sxs-lookup"><span data-stu-id="5a96f-314">The net effect is that while the first `INSERT` will succeed, subsequent ones will fail with a foreign key constraint violation.</span></span> <span data-ttu-id="5a96f-315">Da die batcheinfügung atomarisch, wird die erste `INSERT` wird ein Rollback, zurückgeben, die Datenbank auf seinen Zustand vor der Batch einfügen-Prozess wurde gestartet.</span><span class="sxs-lookup"><span data-stu-id="5a96f-315">Since the batch insert is atomic, the first `INSERT` will be rolled back, returning the database to its state before the batch insert process began.</span></span>


## <a name="summary"></a><span data-ttu-id="5a96f-316">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="5a96f-316">Summary</span></span>

<span data-ttu-id="5a96f-317">Über diese und die beiden vorherigen Tutorials wurde erstellt, Schnittstellen für das Aktualisieren, löschen und Einfügen von Batches von Daten, die die transaktionsunterstützung, die wir, in der Datenzugriffsebene hinzugefügt verwendet die [Umschließen von Datenbankänderungen innerhalb einer Transaktion](wrapping-database-modifications-within-a-transaction-cs.md) Tutorial.</span><span class="sxs-lookup"><span data-stu-id="5a96f-317">Over this and the previous two tutorials we have created interfaces that allow for updating, deleting, and inserting batches of data, all of which used the transaction support we added to the Data Access Layer in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-cs.md) tutorial.</span></span> <span data-ttu-id="5a96f-318">Für bestimmte die Effizienz Szenarien diese Benutzeroberflächen der Batch-Verarbeitung stark Endbenutzer Cutting nach unten auf der Anzahl der Klicks, Postbacks und Tastatur, Maus Kontextwechsel, wobei zudem gleichzeitig die Integrität der zugrunde liegenden Daten.</span><span class="sxs-lookup"><span data-stu-id="5a96f-318">For certain scenarios, such batch processing user interfaces greatly improve end user efficiency by cutting down on the number of clicks, postbacks, and keyboard-to-mouse context switches, while also maintaining the integrity of the underlying data.</span></span>

<span data-ttu-id="5a96f-319">Dieses Tutorial ist unser Blick auf die Arbeiten mit batchdaten abgeschlossen.</span><span class="sxs-lookup"><span data-stu-id="5a96f-319">This tutorial completes our look at working with batched data.</span></span> <span data-ttu-id="5a96f-320">Der nächste Satz von Tutorials untersucht eine Vielzahl von Szenarien für advanced Data Access Layer, einschließlich der Verwendung von gespeicherter Prozeduren in den TableAdapter s Methoden erstellen, das Konfigurieren der Verbindung und Befehlsebene-Einstellungen in der Datenzugriffsschicht, Verschlüsseln von Verbindungszeichenfolgen und mehr!</span><span class="sxs-lookup"><span data-stu-id="5a96f-320">The next set of tutorials explores a variety of advanced Data Access Layer scenarios, including using stored procedures in the TableAdapter s methods, configuring connection- and command-level settings in the DAL, encrypting connection strings, and more!</span></span>

<span data-ttu-id="5a96f-321">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="5a96f-321">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="5a96f-322">Der Autor</span><span class="sxs-lookup"><span data-stu-id="5a96f-322">About the Author</span></span>

<span data-ttu-id="5a96f-323">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben Büchern zu ASP/ASP.NET und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), arbeitet mit Microsoft-Web-Technologien seit 1998.</span><span class="sxs-lookup"><span data-stu-id="5a96f-323">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="5a96f-324">Er ist als ein unabhängiger Berater, Schulungsleiter und Autor.</span><span class="sxs-lookup"><span data-stu-id="5a96f-324">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="5a96f-325">Sein neueste Buch wird [*Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="5a96f-325">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="5a96f-326">Er ist unter [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="5a96f-326">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="5a96f-327">oder über seinen Blog finden Sie unter [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="5a96f-327">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="5a96f-328">Besonderen Dank an</span><span class="sxs-lookup"><span data-stu-id="5a96f-328">Special Thanks To</span></span>

<span data-ttu-id="5a96f-329">Diese tutorialreihe wurde durch viele hilfreiche Reviewer überprüft.</span><span class="sxs-lookup"><span data-stu-id="5a96f-329">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="5a96f-330">Führen Sie Prüfer für dieses Tutorial Hilton Giesenow und S Ren Jacob Lauritsen wurden.</span><span class="sxs-lookup"><span data-stu-id="5a96f-330">Lead reviewers for this tutorial were Hilton Giesenow and S ren Jacob Lauritsen.</span></span> <span data-ttu-id="5a96f-331">Meine zukünftigen MSDN-Artikeln überprüfen möchten?</span><span class="sxs-lookup"><span data-stu-id="5a96f-331">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="5a96f-332">Wenn dies der Fall ist, löschen Sie mir eine Linie an [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="5a96f-332">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="5a96f-333">[Zurück](batch-deleting-cs.md)
> [Weiter](wrapping-database-modifications-within-a-transaction-vb.md)</span><span class="sxs-lookup"><span data-stu-id="5a96f-333">[Previous](batch-deleting-cs.md)
[Next](wrapping-database-modifications-within-a-transaction-vb.md)</span></span>
