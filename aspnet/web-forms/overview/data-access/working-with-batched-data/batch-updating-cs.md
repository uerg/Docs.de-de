---
uid: web-forms/overview/data-access/working-with-batched-data/batch-updating-cs
title: Batch aktualisieren (c#) | Microsoft-Dokumentation
author: rick-anderson
description: Erfahren Sie, wie Sie mehrere Datenbankdatensätze in einem einzelnen Vorgang aktualisieren. In der UI-Schicht erstellen wir eine GridView, in dem jede Zeile bearbeitet werden kann. In den Daten...
ms.author: aspnetcontent
ms.date: 06/26/2007
ms.assetid: 4e849bcc-c557-4bc3-937e-f7453ee87265
msc.legacyurl: /web-forms/overview/data-access/working-with-batched-data/batch-updating-cs
msc.type: authoredcontent
ms.openlocfilehash: 0cb55689ac3a6dc36ed18459ecece82ff0b073b7
ms.sourcegitcommit: b28cd0313af316c051c2ff8549865bff67f2fbb4
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 07/05/2018
ms.locfileid: "37842191"
---
<a name="batch-updating-c"></a><span data-ttu-id="d712a-105">Batch-Update (c#)</span><span class="sxs-lookup"><span data-stu-id="d712a-105">Batch Updating (C#)</span></span>
====================
<span data-ttu-id="d712a-106">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="d712a-106">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="d712a-107">[Code herunterladen](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_64_CS.zip) oder [PDF-Datei herunterladen](batch-updating-cs/_static/datatutorial64cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="d712a-107">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_64_CS.zip) or [Download PDF](batch-updating-cs/_static/datatutorial64cs1.pdf)</span></span>

> <span data-ttu-id="d712a-108">Erfahren Sie, wie Sie mehrere Datenbankdatensätze in einem einzelnen Vorgang aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="d712a-108">Learn how to update multiple database records in a single operation.</span></span> <span data-ttu-id="d712a-109">In der UI-Schicht erstellen wir eine GridView, in dem jede Zeile bearbeitet werden kann.</span><span class="sxs-lookup"><span data-stu-id="d712a-109">In the User Interface Layer we build a GridView where each row is editable.</span></span> <span data-ttu-id="d712a-110">In der Datenzugriffsebene umschließen wir die mehrere Update-Vorgänge innerhalb einer Transaktion, um sicherzustellen, dass alle Updates erfolgreich ausgeführt oder alle Updates zurückgesetzt werden.</span><span class="sxs-lookup"><span data-stu-id="d712a-110">In the Data Access Layer we wrap the multiple Update operations within a transaction to ensure that all updates succeed or all updates are rolled back.</span></span>


## <a name="introduction"></a><span data-ttu-id="d712a-111">Einführung</span><span class="sxs-lookup"><span data-stu-id="d712a-111">Introduction</span></span>

<span data-ttu-id="d712a-112">In der [vorherigen Lernprogramm](wrapping-database-modifications-within-a-transaction-cs.md) wurde erläutert, wie der Data Access Layer, zum Hinzufügen der Unterstützung für Datenbanktransaktionen zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="d712a-112">In the [preceding tutorial](wrapping-database-modifications-within-a-transaction-cs.md) we saw how to extend the Data Access Layer to add support for database transactions.</span></span> <span data-ttu-id="d712a-113">Datenbanktransaktionen garantieren, dass eine Reihe von Anweisungen zur Datenänderung als einem atomaren Vorgang behandelt wird, wird sichergestellt, dass alle Änderungen werden oder alle fehlschlagen wird.</span><span class="sxs-lookup"><span data-stu-id="d712a-113">Database transactions guarantee that a series of data modification statements will be treated as one atomic operation, which ensures that all modifications will fail or all will succeed.</span></span> <span data-ttu-id="d712a-114">Low-Level DAL Funktionalität aus dem Weg bereit wir erneut unsere Aufmerksamkeit für das Erstellen von Batch-Änderung Schnittstellen zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="d712a-114">With this low-level DAL functionality out of the way, we re ready to turn our attention to creating batch data modification interfaces.</span></span>

<span data-ttu-id="d712a-115">In diesem Tutorial Erstellen einer GridView-Ansicht wir, in dem jede Zeile bearbeitet werden (siehe Abbildung 1) ist.</span><span class="sxs-lookup"><span data-stu-id="d712a-115">In this tutorial we'll build a GridView where each row is editable (see Figure 1).</span></span> <span data-ttu-id="d712a-116">Da jede Zeile in der Bearbeitung Oberfläche, dort s keine Notwendigkeit für eine Spalte mit der Bearbeitung gerendert wird, aktualisieren Sie und Abbrechen Sie (Schaltflächen).</span><span class="sxs-lookup"><span data-stu-id="d712a-116">Since each row is rendered in its editing interface, there s no need for a column of Edit, Update, and Cancel buttons.</span></span> <span data-ttu-id="d712a-117">Stattdessen, es gibt zwei Produkte aktualisieren Schaltflächen auf der Seite, die beim Klicken auf die GridView Zeilen aufgelistet, und Aktualisieren der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="d712a-117">Instead, there are two Update Products buttons on the page that, when clicked, enumerate the GridView rows and update the database.</span></span>


<span data-ttu-id="d712a-118">[![Jede Zeile in der GridView-Ansicht ist bearbeitbar](batch-updating-cs/_static/image1.gif)](batch-updating-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="d712a-118">[![Each Row in the GridView is Editable](batch-updating-cs/_static/image1.gif)](batch-updating-cs/_static/image1.png)</span></span>

<span data-ttu-id="d712a-119">**Abbildung 1**: jede Zeile in der GridView-Ansicht ist bearbeitbar ([klicken Sie, um das Bild in voller Größe anzeigen](batch-updating-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="d712a-119">**Figure 1**: Each Row in the GridView is Editable ([Click to view full-size image](batch-updating-cs/_static/image2.png))</span></span>


<span data-ttu-id="d712a-120">Lassen Sie s beginnen!</span><span class="sxs-lookup"><span data-stu-id="d712a-120">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="d712a-121">In der [Durchführen von BatchUpdates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-cs.md) Tutorial, die wir erstellt haben, ein Batch-Bearbeitung Schnittstelle mit dem DataList-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="d712a-121">In the [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-cs.md) tutorial we created a batch editing interface using the DataList control.</span></span> <span data-ttu-id="d712a-122">In diesem Tutorial unterscheidet, aus dem vorherigen, verwendet er, einer GridView-Ansicht und des BatchUpdates innerhalb des Bereichs einer Transaktion ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="d712a-122">This tutorial differs from the previous one in that is uses a GridView and the batch update is performed within the scope of a transaction.</span></span> <span data-ttu-id="d712a-123">Nach Abschluss dieses Lernprogramms sollten Sie mit dem früheren Tutorial zurück und aktualisieren, um die Datenbank transaktionsbezogenen Funktionalität hinzugefügt, in dem vorherigen Lernprogramm verwenden.</span><span class="sxs-lookup"><span data-stu-id="d712a-123">After completing this tutorial I encourage you to return to the earlier tutorial and update it to use the database transaction-related functionality added in the preceding tutorial.</span></span>


## <a name="examining-the-steps-for-making-all-gridview-rows-editable"></a><span data-ttu-id="d712a-124">Untersuchen die Schritte zum Erstellen der bearbeitet werden alle Zeilen der GridView</span><span class="sxs-lookup"><span data-stu-id="d712a-124">Examining the Steps for Making All GridView Rows Editable</span></span>

<span data-ttu-id="d712a-125">Siehe die [eine Übersicht der einfügen, aktualisieren und Löschen von Daten](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) Tutorial GridView bietet integrierte Unterstützung für die Bearbeitung der zugrunde liegenden Daten auf einer Basis pro Zeile.</span><span class="sxs-lookup"><span data-stu-id="d712a-125">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) tutorial, the GridView offers built-in support for editing its underlying data on a per-row basis.</span></span> <span data-ttu-id="d712a-126">Intern wird die GridView – Anmerkungen zu dieser, welche Zeile über bearbeitet werden kann die [ `EditIndex` Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.editindex(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="d712a-126">Internally, the GridView notes what row is editable through its [`EditIndex` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.editindex(VS.80).aspx).</span></span> <span data-ttu-id="d712a-127">Wie Sie mit der Datenquelle die GridView gebunden wird, überprüft er jede Zeile aus, um festzustellen, ob der Index der Zeile der Wert von entspricht `EditIndex`.</span><span class="sxs-lookup"><span data-stu-id="d712a-127">As the GridView is being bound to its data source, it checks each row to see if the index of the row equals the value of `EditIndex`.</span></span> <span data-ttu-id="d712a-128">Wenn dies der Fall ist, diese Zeile s, die Felder mit gerendert werden, deren Bearbeitung-Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="d712a-128">If so, that row s fields are rendered using their editing interfaces.</span></span> <span data-ttu-id="d712a-129">Die Bearbeitungsschnittstelle für BoundFields, befindet sich ein Textfeld, dessen `Text` Eigenschaft erhält den Wert des Felds durch die BoundField-s angegebene `DataField` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="d712a-129">For BoundFields, the editing interface is a TextBox whose `Text` property is assigned the value of the data field specified by the BoundField s `DataField` property.</span></span> <span data-ttu-id="d712a-130">Für von TemplateFields die `EditItemTemplate` wird anstelle von verwendet die `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="d712a-130">For TemplateFields, the `EditItemTemplate` is used in place of the `ItemTemplate`.</span></span>

<span data-ttu-id="d712a-131">Denken Sie daran, dass es sich bei der Bearbeitung Workflow startet, wenn ein Benutzer eine Zeile s Bearbeiten-Schaltfläche klickt.</span><span class="sxs-lookup"><span data-stu-id="d712a-131">Recall that the editing workflow starts when a user clicks a row s Edit button.</span></span> <span data-ttu-id="d712a-132">Dies führt dazu, dass einen Postback, legt die GridView-s `EditIndex` -Eigenschaft auf den geklickt wurde Zeilenindex s, und bindet die Daten in das Raster.</span><span class="sxs-lookup"><span data-stu-id="d712a-132">This causes a postback, sets the GridView s `EditIndex` property to the clicked row s index, and rebinds the data to the grid.</span></span> <span data-ttu-id="d712a-133">Wenn eine Zeile s-Abbrechen-Schaltfläche geklickt wird, beim Postback der `EditIndex` festgelegt ist, auf einen Wert von `-1` vor dem erneuten Binden der Daten in das Raster.</span><span class="sxs-lookup"><span data-stu-id="d712a-133">When a row s Cancel button is clicked, on postback the `EditIndex` is set to a value of `-1` before rebinding the data to the grid.</span></span> <span data-ttu-id="d712a-134">Da die GridView-s-Zeilen starten die Indizierung auf 0 (null), festlegen `EditIndex` zu `-1` hat den Effekt die GridView in schreibgeschützten Modus anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="d712a-134">Since the GridView s rows start indexing at zero, setting `EditIndex` to `-1` has the effect of displaying the GridView in read-only mode.</span></span>

<span data-ttu-id="d712a-135">Die `EditIndex` Eigenschaft eignet sich gut für jede Zeile zu bearbeiten, aber es dient nicht zum Bearbeiten von Batch.</span><span class="sxs-lookup"><span data-stu-id="d712a-135">The `EditIndex` property works well for per-row editing, but is not designed for batch editing.</span></span> <span data-ttu-id="d712a-136">Damit die gesamte GridView bearbeitet werden kann, muss jede Zeile mit der Bearbeitungsoberfläche gerendert werden.</span><span class="sxs-lookup"><span data-stu-id="d712a-136">To make the entire GridView editable, we need to have each row render using its editing interface.</span></span> <span data-ttu-id="d712a-137">Die einfachste Möglichkeit hierzu ist die Erstellung der, in dem jedes bearbeitbares Feld implementiert wird, wie in ein TemplateField mit der Bearbeitung Schnittstelle definiert die `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="d712a-137">The easiest way to accomplish this is to create where each editable field is implemented as a TemplateField with its editing interface defined in the `ItemTemplate`.</span></span>

<span data-ttu-id="d712a-138">In den nächsten Schritten vollständig bearbeitbare GridView erstellen wir.</span><span class="sxs-lookup"><span data-stu-id="d712a-138">Over the next several steps we'll create a completely editable GridView.</span></span> <span data-ttu-id="d712a-139">In Schritt 1 wir beginnen mit dem Erstellen der GridView und seine "ObjectDataSource" und seine BoundFields und CheckBoxField in von TemplateFields konvertieren.</span><span class="sxs-lookup"><span data-stu-id="d712a-139">In Step 1 we'll start by creating the GridView and its ObjectDataSource and convert its BoundFields and CheckBoxField into TemplateFields.</span></span> <span data-ttu-id="d712a-140">Wir verschieben in den Schritten 2 und 3 die Bearbeitung Schnittstellen aus der von TemplateFields `EditItemTemplate` s, um ihre `ItemTemplate` s.</span><span class="sxs-lookup"><span data-stu-id="d712a-140">In Steps 2 and 3 we'll move the editing interfaces from the TemplateFields `EditItemTemplate` s to their `ItemTemplate` s.</span></span>

## <a name="step-1-displaying-product-information"></a><span data-ttu-id="d712a-141">Schritt 1: Anzeigen von Produktinformationen</span><span class="sxs-lookup"><span data-stu-id="d712a-141">Step 1: Displaying Product Information</span></span>

<span data-ttu-id="d712a-142">Bevor wir fürchten, zum Erstellen einer GridView-Ansicht, in denen Zeilen sind, können bearbeitet werden, können zunächst einfach die Produktinformationen s.</span><span class="sxs-lookup"><span data-stu-id="d712a-142">Before we worry about creating a GridView where are rows are editable, let s start by simply displaying the product information.</span></span> <span data-ttu-id="d712a-143">Öffnen der `BatchUpdate.aspx` auf der Seite die `BatchData` Ordner, und ziehen Sie einer GridView-Ansicht aus der Toolbox in den Designer.</span><span class="sxs-lookup"><span data-stu-id="d712a-143">Open the `BatchUpdate.aspx` page in the `BatchData` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="d712a-144">Legen Sie die GridView s `ID` zu `ProductsGrid` und sein Smarttag, auswählen, um die Bindung an eine neue, mit dem Namen "ObjectDataSource" `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="d712a-144">Set the GridView s `ID` to `ProductsGrid` and, from its smart tag, choose to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="d712a-145">Konfigurieren Sie das "ObjectDataSource" zum Abrufen der Daten aus der `ProductsBLL` Klasse s `GetProducts` Methode.</span><span class="sxs-lookup"><span data-stu-id="d712a-145">Configure the ObjectDataSource to retrieve its data from the `ProductsBLL` class s `GetProducts` method.</span></span>


<span data-ttu-id="d712a-146">[![Konfigurieren von dem ObjectDataSource-Steuerelement zur Verwendung der ProductsBLL-Klasse](batch-updating-cs/_static/image2.gif)](batch-updating-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="d712a-146">[![Configure the ObjectDataSource to Use the ProductsBLL Class](batch-updating-cs/_static/image2.gif)](batch-updating-cs/_static/image3.png)</span></span>

<span data-ttu-id="d712a-147">**Abbildung 2**: Konfigurieren von dem ObjectDataSource-Steuerelement verwenden die `ProductsBLL` Klasse ([klicken Sie, um das Bild in voller Größe anzeigen](batch-updating-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="d712a-147">**Figure 2**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](batch-updating-cs/_static/image4.png))</span></span>


<span data-ttu-id="d712a-148">[![Abrufen der Produktdaten mithilfe der GetProducts-Methode](batch-updating-cs/_static/image3.gif)](batch-updating-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="d712a-148">[![Retrieve the Product Data Using the GetProducts Method](batch-updating-cs/_static/image3.gif)](batch-updating-cs/_static/image5.png)</span></span>

<span data-ttu-id="d712a-149">**Abbildung 3**: Rufen Sie die Product-Daten mithilfe der `GetProducts` Methode ([klicken Sie, um das Bild in voller Größe anzeigen](batch-updating-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="d712a-149">**Figure 3**: Retrieve the Product Data Using the `GetProducts` Method ([Click to view full-size image](batch-updating-cs/_static/image6.png))</span></span>


<span data-ttu-id="d712a-150">Wie GridView dienen die Funktionen zur pfadänderung von "ObjectDataSource" s auf einer Basis pro Zeile.</span><span class="sxs-lookup"><span data-stu-id="d712a-150">Like the GridView, the ObjectDataSource s modification features are designed to work on a per-row basis.</span></span> <span data-ttu-id="d712a-151">Um eine Gruppe von Datensätzen zu aktualisieren, müssen wir ein paar Codezeilen in der CodeBehind-Klasse in ASP.NET Seite "s" zu schreiben, der batches von Daten und übergibt sie an die BLL.</span><span class="sxs-lookup"><span data-stu-id="d712a-151">In order to update a set of records, we'll need to write a bit of code in the ASP.NET page s code-behind class that batches the data and passes it to the BLL.</span></span> <span data-ttu-id="d712a-152">Legen Sie daher die Dropdownlisten in der "ObjectDataSource"-s Update-, INSERT- und DELETE Registerkarten (keine).</span><span class="sxs-lookup"><span data-stu-id="d712a-152">Therefore, set the drop-down lists in the ObjectDataSource s UPDATE, INSERT, and DELETE tabs to (None).</span></span> <span data-ttu-id="d712a-153">Klicken Sie auf "Fertig stellen", um den Assistenten abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="d712a-153">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="d712a-154">[![Legen Sie die Dropdownlisten in der Update-, INSERT- und DELETE werden Registerkarten (keine)](batch-updating-cs/_static/image4.gif)](batch-updating-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="d712a-154">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](batch-updating-cs/_static/image4.gif)](batch-updating-cs/_static/image7.png)</span></span>

<span data-ttu-id="d712a-155">**Abbildung 4**: Legen Sie die Dropdownlisten in der Update-, INSERT- und Löschen von Registerkarten auf (keine) ([klicken Sie, um das Bild in voller Größe anzeigen](batch-updating-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="d712a-155">**Figure 4**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](batch-updating-cs/_static/image8.png))</span></span>


<span data-ttu-id="d712a-156">Nach Abschluss des Assistenten konfigurieren von Datenquellen sollten "ObjectDataSource" s deklarative Markup wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="d712a-156">After completing the Configure Data Source wizard, the ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](batch-updating-cs/samples/sample1.aspx)]

<span data-ttu-id="d712a-157">Der Assistent zum Konfigurieren von Datenquellen wird auch in Visual Studio um BoundFields und eine CheckBoxField für die Product-Datenfelder in den GridView-Ansicht zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="d712a-157">Completing the Configure Data Source wizard also causes Visual Studio to create BoundFields and a CheckBoxField for the product data fields in the GridView.</span></span> <span data-ttu-id="d712a-158">In diesem Tutorial können Sie s, die nur dem Benutzer ermöglichen, anzeigen und bearbeiten die Product-s-Name, Kategorie, Preis und nicht mehr unterstützte Status.</span><span class="sxs-lookup"><span data-stu-id="d712a-158">For this tutorial, let s only allow the user to view and edit the product s name, category, price, and discontinued status.</span></span> <span data-ttu-id="d712a-159">Entfernen Sie alle außer den `ProductName`, `CategoryName`, `UnitPrice`, und `Discontinued` Felder und benennen Sie die `HeaderText` Eigenschaften der ersten drei Felder Product Category und Preis.</span><span class="sxs-lookup"><span data-stu-id="d712a-159">Remove all but the `ProductName`, `CategoryName`, `UnitPrice`, and `Discontinued` fields and rename the `HeaderText` properties of the first three fields to Product, Category, and Price, respectively.</span></span> <span data-ttu-id="d712a-160">Und schließlich überprüfen Sie die Kontrollkästchen Paging aktivieren und die Sortierung zu aktivieren, in das GridView-s-Smarttag.</span><span class="sxs-lookup"><span data-stu-id="d712a-160">Lastly, check the Enable Paging and Enable Sorting checkboxes in the GridView s smart tag.</span></span>

<span data-ttu-id="d712a-161">An diesem Punkt das GridView hat drei BoundFields (`ProductName`, `CategoryName`, und `UnitPrice`) und eine CheckBoxField (`Discontinued`).</span><span class="sxs-lookup"><span data-stu-id="d712a-161">At this point the GridView has three BoundFields (`ProductName`, `CategoryName`, and `UnitPrice`) and a CheckBoxField (`Discontinued`).</span></span> <span data-ttu-id="d712a-162">Wir müssen diese vier Felder in von TemplateFields konvertieren aus, und klicken Sie dann die Bearbeitungsschnittstelle verschieben, aus der TemplateField s `EditItemTemplate` auf seine `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="d712a-162">We need to convert these four fields into TemplateFields and then move the editing interface from the TemplateField s `EditItemTemplate` to its `ItemTemplate`.</span></span>

> [!NOTE]
> <span data-ttu-id="d712a-163">Erstellen und Anpassen von TemplateFields im behandelt die [Anpassen der Benutzeroberfläche für die Änderung der Daten](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) Tutorial.</span><span class="sxs-lookup"><span data-stu-id="d712a-163">We explored creating and customizing TemplateFields in the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) tutorial.</span></span> <span data-ttu-id="d712a-164">Begleiten wir durch die Schritte der BoundFields und CheckBoxField in von TemplateFields konvertiert und Schnittstellen definieren, deren Bearbeitung ihrer `ItemTemplate` s, aber wenn Sie Probleme oder eine Auffrischung, Don ' t zögern muss, wieder mit diesen früheren Tutorial zu verweisen.</span><span class="sxs-lookup"><span data-stu-id="d712a-164">We'll walk through the steps of converting the BoundFields and CheckBoxField into TemplateFields and defining their editing interfaces in their `ItemTemplate` s, but if you get stuck or need a refresher, don t hesitate to refer back to this earlier tutorial.</span></span>


<span data-ttu-id="d712a-165">GridView s Smarttags klicken Sie auf die Spalten bearbeiten-Link, um die Felder (Dialogfeld) zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="d712a-165">From the GridView s smart tag, click the Edit Columns link to open the Fields dialog box.</span></span> <span data-ttu-id="d712a-166">Als nächstes wählen Sie jedes Feld, und klicken Sie auf das konvertierte dieses Feld in ein TemplateField-Link.</span><span class="sxs-lookup"><span data-stu-id="d712a-166">Next, select each field and click the Convert this field into a TemplateField link.</span></span>


![Die vorhandenen BoundFields und CheckBoxField in TemplateField konvertieren](batch-updating-cs/_static/image5.gif)

<span data-ttu-id="d712a-168">**Abbildung 5**: die vorhandene BoundFields und CheckBoxField in TemplateField konvertieren</span><span class="sxs-lookup"><span data-stu-id="d712a-168">**Figure 5**: Convert the Existing BoundFields and CheckBoxField Into TemplateField</span></span>


<span data-ttu-id="d712a-169">Nun, da jedes Feld ein TemplateField ist, es erneut bereit, um die Bearbeitung zu verschieben-Schnittstelle aus der `EditItemTemplate` s, um die `ItemTemplate` s.</span><span class="sxs-lookup"><span data-stu-id="d712a-169">Now that each field is a TemplateField, we re ready to move the editing interface from the `EditItemTemplate` s to the `ItemTemplate` s.</span></span>

## <a name="step-2-creating-theproductnameunitprice-anddiscontinuedediting-interfaces"></a><span data-ttu-id="d712a-170">Schritt 2: Erstellen der`ProductName`,`UnitPrice`, und`Discontinued`Schnittstellen bearbeiten</span><span class="sxs-lookup"><span data-stu-id="d712a-170">Step 2: Creating the`ProductName`,`UnitPrice`, and`Discontinued`Editing Interfaces</span></span>

<span data-ttu-id="d712a-171">Erstellen der `ProductName`, `UnitPrice`, und `Discontinued` bearbeiten die Schnittstellen sind Thema dieses Schritts und recht einfach gehalten wie jede Schnittstelle bereits in das TemplateField s definiert ist `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="d712a-171">Creating the `ProductName`, `UnitPrice`, and `Discontinued` editing interfaces are the topic of this step and are pretty straightforward, as each interface is already defined in the TemplateField s `EditItemTemplate`.</span></span> <span data-ttu-id="d712a-172">Erstellen der `CategoryName` bearbeiten-Schnittstelle ist etwas komplizierter, da wir einem DropDownList-Steuerelement die entsprechenden Kategorien zu erstellen müssen.</span><span class="sxs-lookup"><span data-stu-id="d712a-172">Creating the `CategoryName` editing interface is a bit more involved since we need to create a DropDownList of the applicable categories.</span></span> <span data-ttu-id="d712a-173">Dies `CategoryName` bearbeiten-Schnittstelle in Schritt 3 angegangen wird.</span><span class="sxs-lookup"><span data-stu-id="d712a-173">This `CategoryName` editing interface is tackled in Step 3.</span></span>

<span data-ttu-id="d712a-174">S Einstieg ermöglichen die `ProductName` TemplateField.</span><span class="sxs-lookup"><span data-stu-id="d712a-174">Let s start with the `ProductName` TemplateField.</span></span> <span data-ttu-id="d712a-175">Klicken Sie auf den Link "Vorlagen bearbeiten" aus dem GridView-s-Smarttag, und zeigen die `ProductName` TemplateField s `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="d712a-175">Click on the Edit Templates link from the GridView s smart tag and drill down to the `ProductName` TemplateField s `EditItemTemplate`.</span></span> <span data-ttu-id="d712a-176">Wählen Sie das Textfeld, in die Zwischenablage kopieren und fügen Sie ihn in das `ProductName` TemplateField s `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="d712a-176">Select the TextBox, copy it to the clipboard, and then paste it to the `ProductName` TemplateField s `ItemTemplate`.</span></span> <span data-ttu-id="d712a-177">Ändern Sie das Textfeld s `ID` Eigenschaft `ProductName`.</span><span class="sxs-lookup"><span data-stu-id="d712a-177">Change the TextBox s `ID` property to `ProductName`.</span></span>

<span data-ttu-id="d712a-178">Fügen Sie als Nächstes einen RequiredFieldValidator auf die `ItemTemplate` um sicherzustellen, dass der Benutzer einen Wert für jeden Produktnamen s bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="d712a-178">Next, add a RequiredFieldValidator to the `ItemTemplate` to ensure that the user provides a value for each product s name.</span></span> <span data-ttu-id="d712a-179">Legen Sie die `ControlToValidate` Eigenschaft ProductName, die `ErrorMessage` Eigenschaft, um Sie müssen den Namen des Produkts bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="d712a-179">Set the `ControlToValidate` property to ProductName, the `ErrorMessage` property to You must provide the product's name.</span></span> <span data-ttu-id="d712a-180">und die `Text` Eigenschaft \*.</span><span class="sxs-lookup"><span data-stu-id="d712a-180">and the `Text` property to \*.</span></span> <span data-ttu-id="d712a-181">Nach dem Herstellen dieser Ergänzungen zu den `ItemTemplate`, Ihr Bildschirm sollte ähnlich wie in Abbildung 6 aussehen.</span><span class="sxs-lookup"><span data-stu-id="d712a-181">After making these additions to the `ItemTemplate`, your screen should look similar to Figure 6.</span></span>


<span data-ttu-id="d712a-182">[![Die ProductName TemplateField jetzt enthält ein Textfeld und einer RequiredFieldValidator](batch-updating-cs/_static/image6.gif)](batch-updating-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="d712a-182">[![The ProductName TemplateField Now Includes a TextBox and a RequiredFieldValidator](batch-updating-cs/_static/image6.gif)](batch-updating-cs/_static/image9.png)</span></span>

<span data-ttu-id="d712a-183">**Abbildung 6**: die `ProductName` TemplateField enthält nun ein Textfeld und einen RequiredFieldValidator ([klicken Sie, um das Bild in voller Größe anzeigen](batch-updating-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="d712a-183">**Figure 6**: The `ProductName` TemplateField Now Includes a TextBox and a RequiredFieldValidator ([Click to view full-size image](batch-updating-cs/_static/image10.png))</span></span>


<span data-ttu-id="d712a-184">Für die `UnitPrice` bearbeiten-Schnittstelle, starten Sie durch Kopieren der im Textfeld die `EditItemTemplate` auf die `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="d712a-184">For the `UnitPrice` editing interface, start by copying the TextBox from the `EditItemTemplate` to the `ItemTemplate`.</span></span> <span data-ttu-id="d712a-185">Platzieren Sie ein "$" vor das Textfeld und anschließend die `ID` UnitPrice-Eigenschaft und die zugehörige `Columns` Eigenschaft auf 8.</span><span class="sxs-lookup"><span data-stu-id="d712a-185">Next, place a $ in front of the TextBox and set its `ID` property to UnitPrice and its `Columns` property to 8 .</span></span>

<span data-ttu-id="d712a-186">Auch eine CompareValidator zum Hinzufügen der `UnitPrice` s `ItemTemplate` um sicherzustellen, dass der vom Benutzer eingegebene Wert eine gültige Currency-Wert größer als oder gleich 0,00 US-Dollar.</span><span class="sxs-lookup"><span data-stu-id="d712a-186">Also add a CompareValidator to the `UnitPrice` s `ItemTemplate` to ensure that the value entered by the user is a valid currency value greater than or equal to $0.00.</span></span> <span data-ttu-id="d712a-187">Legen Sie das Validierungssteuerelement s `ControlToValidate` Eigenschaft UnitPrice, dessen `ErrorMessage` Eigenschaft, um Sie müssen einen gültigen Currency-Wert eingeben.</span><span class="sxs-lookup"><span data-stu-id="d712a-187">Set the validator s `ControlToValidate` property to UnitPrice, its `ErrorMessage` property to You must enter a valid currency value.</span></span> <span data-ttu-id="d712a-188">Sie lassen Währung Symbole., seine `Text` Eigenschaft, um \*, dessen `Type` Eigenschaft `Currency`, dessen `Operator` Eigenschaft, um `GreaterThanEqual`, und die zugehörige `ValueToCompare` Eigenschaft auf 0.</span><span class="sxs-lookup"><span data-stu-id="d712a-188">Please omit any currency symbols., its `Text` property to \*, its `Type` property to `Currency`, its `Operator` property to `GreaterThanEqual`, and its `ValueToCompare` property to 0 .</span></span>


<span data-ttu-id="d712a-189">[![Hinzufügen einer CompareValidator, um sicherzustellen, dass der Preis eingegeben haben ein nicht negativer Currency-Wert ist](batch-updating-cs/_static/image7.gif)](batch-updating-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="d712a-189">[![Add a CompareValidator to Ensure the Price Entered is a Non-Negative Currency Value](batch-updating-cs/_static/image7.gif)](batch-updating-cs/_static/image11.png)</span></span>

<span data-ttu-id="d712a-190">**Abbildung 7**: Hinzufügen einer CompareValidator, um sicherzustellen, dass der Preis eingegeben ist ein nicht negativer Währungswert ([klicken Sie, um das Bild in voller Größe anzeigen](batch-updating-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="d712a-190">**Figure 7**: Add a CompareValidator to Ensure the Price Entered is a Non-Negative Currency Value ([Click to view full-size image](batch-updating-cs/_static/image12.png))</span></span>


<span data-ttu-id="d712a-191">Für die `Discontinued` TemplateField können Sie das Kontrollkästchen, die bereits in definiert die `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="d712a-191">For the `Discontinued` TemplateField you can use the CheckBox already defined in the `ItemTemplate`.</span></span> <span data-ttu-id="d712a-192">Legen Sie einfach die `ID` zu Discontinued und die zugehörige `Enabled` Eigenschaft `true`.</span><span class="sxs-lookup"><span data-stu-id="d712a-192">Simply set its `ID` to Discontinued and its `Enabled` property to `true`.</span></span>

## <a name="step-3-creating-thecategorynameediting-interface"></a><span data-ttu-id="d712a-193">Schritt 3: Erstellen der`CategoryName`bearbeiten-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="d712a-193">Step 3: Creating the`CategoryName`Editing Interface</span></span>

<span data-ttu-id="d712a-194">Die Bearbeitungsschnittstelle in die `CategoryName` TemplateField s `EditItemTemplate` enthält ein Textfeld, das den Wert der `CategoryName` Feld "Daten".</span><span class="sxs-lookup"><span data-stu-id="d712a-194">The editing interface in the `CategoryName` TemplateField s `EditItemTemplate` contains a TextBox that displays the value of the `CategoryName` data field.</span></span> <span data-ttu-id="d712a-195">Wir müssen dies mit einem DropDownList-Steuerelement ersetzen, die die möglichen Kategorien auflistet.</span><span class="sxs-lookup"><span data-stu-id="d712a-195">We need to replace this with a DropDownList that lists the possible categories.</span></span>

> [!NOTE]
> <span data-ttu-id="d712a-196">Die [Anpassen der Benutzeroberfläche für die Änderung der Daten](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) Tutorial enthält eine umfassendere und vollständige Erläuterung der Anpassen einer Vorlage aus, um einem DropDownList-Steuerelement im Gegensatz zu einem Textfeld einzuschließen.</span><span class="sxs-lookup"><span data-stu-id="d712a-196">The [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) tutorial contains a more thorough and complete discussion on customizing a template to include a DropDownList as opposed to a TextBox.</span></span> <span data-ttu-id="d712a-197">Während die hier beschriebenen Schritte abgeschlossen sind, wird ihnen nur sehr knapp angezeigt.</span><span class="sxs-lookup"><span data-stu-id="d712a-197">While the steps here are complete, they are presented tersely.</span></span> <span data-ttu-id="d712a-198">Eine ausführlichere Betrachtung erstellen und konfigurieren die Kategorien DropDownList verweisen zurück auf die [Anpassen der Benutzeroberfläche für die Änderung der Daten](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) Tutorial.</span><span class="sxs-lookup"><span data-stu-id="d712a-198">For a more in-depth look at creating and configuring the categories DropDownList, refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) tutorial.</span></span>


<span data-ttu-id="d712a-199">Ziehen Sie von einem DropDownList-Steuerelement aus der Toolbox auf die `CategoryName` TemplateField s `ItemTemplate`wird durch das Festlegen der `ID` zu `Categories`.</span><span class="sxs-lookup"><span data-stu-id="d712a-199">Drag a DropDownList from the Toolbox onto the `CategoryName` TemplateField s `ItemTemplate`, setting its `ID` to `Categories`.</span></span> <span data-ttu-id="d712a-200">An diesem Punkt würde in der Regel die DropDownList-Steuerelementen-s-Datenquelle über sein Smarttag, definieren wir erstellen eine neue "ObjectDataSource".</span><span class="sxs-lookup"><span data-stu-id="d712a-200">At this point we would usually define the DropDownLists s data source through its smart tag, creating a new ObjectDataSource.</span></span> <span data-ttu-id="d712a-201">Dadurch wird jedoch hinzugefügt, dem ObjectDataSource-Steuerelement innerhalb der `ItemTemplate`, die führt zu einer "ObjectDataSource"-Instanz, die für jede GridView-Zeile erstellt.</span><span class="sxs-lookup"><span data-stu-id="d712a-201">However, this will add the ObjectDataSource within the `ItemTemplate`, which will result in an ObjectDataSource instance created for each GridView row.</span></span> <span data-ttu-id="d712a-202">Stattdessen können Sie s, die außerhalb der GridView-s von TemplateFields dem ObjectDataSource-Steuerelement zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="d712a-202">Instead, let s create the ObjectDataSource outside of the GridView s TemplateFields.</span></span> <span data-ttu-id="d712a-203">Beendet die vorlagenbearbeitung, und ziehen Sie ein ObjectDataSource-Steuerelement aus der Toolbox in den Designer unter der `ProductsDataSource` "ObjectDataSource".</span><span class="sxs-lookup"><span data-stu-id="d712a-203">End the template editing and drag an ObjectDataSource from the Toolbox onto the Designer beneath the `ProductsDataSource` ObjectDataSource.</span></span> <span data-ttu-id="d712a-204">Benennen Sie die neue "ObjectDataSource" `CategoriesDataSource` und konfigurieren Sie ihn zur Verwendung der `CategoriesBLL` Klasse s `GetCategories` Methode.</span><span class="sxs-lookup"><span data-stu-id="d712a-204">Name the new ObjectDataSource `CategoriesDataSource` and configure it to use the `CategoriesBLL` class s `GetCategories` method.</span></span>


<span data-ttu-id="d712a-205">[![Konfigurieren Sie die "ObjectDataSource", um den Assistenten CategoriesBLL verwenden](batch-updating-cs/_static/image8.gif)](batch-updating-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="d712a-205">[![Configure the ObjectDataSource to Use the CategoriesBLL Clas](batch-updating-cs/_static/image8.gif)](batch-updating-cs/_static/image13.png)</span></span>

<span data-ttu-id="d712a-206">**Abbildung 8**: Konfigurieren von dem ObjectDataSource-Steuerelement verwenden die `CategoriesBLL` Assistenten ([klicken Sie, um das Bild in voller Größe anzeigen](batch-updating-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="d712a-206">**Figure 8**: Configure the ObjectDataSource to Use the `CategoriesBLL` Clas ([Click to view full-size image](batch-updating-cs/_static/image14.png))</span></span>


<span data-ttu-id="d712a-207">[![Rufen Sie die Kategoriedaten mithilfe der Methode GetCategories ab](batch-updating-cs/_static/image9.gif)](batch-updating-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="d712a-207">[![Retrieve the Category Data Using the GetCategories Method](batch-updating-cs/_static/image9.gif)](batch-updating-cs/_static/image15.png)</span></span>

<span data-ttu-id="d712a-208">**Abbildung 9**: Rufen Sie die Kategorie Daten mithilfe der `GetCategories` Methode ([klicken Sie, um das Bild in voller Größe anzeigen](batch-updating-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="d712a-208">**Figure 9**: Retrieve the Category Data Using the `GetCategories` Method ([Click to view full-size image](batch-updating-cs/_static/image16.png))</span></span>


<span data-ttu-id="d712a-209">Da diese "ObjectDataSource" nur zum Abrufen von Daten verwendet wird, legen Sie die Dropdown-Listen in die Update- und DELETE-Registerkarten, um (keine) aus.</span><span class="sxs-lookup"><span data-stu-id="d712a-209">Since this ObjectDataSource is used merely to retrieve data, set the drop-down lists in the UPDATE and DELETE tabs to (None).</span></span> <span data-ttu-id="d712a-210">Klicken Sie auf "Fertig stellen", um den Assistenten abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="d712a-210">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="d712a-211">[![Gruppe der Dropdownlisten in der UPDATE und DELETE-Registerkarten, um (keine)](batch-updating-cs/_static/image10.gif)](batch-updating-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="d712a-211">[![Set the Drop-Down Lists in the UPDATE and DELETE Tabs to (None)](batch-updating-cs/_static/image10.gif)](batch-updating-cs/_static/image17.png)</span></span>

<span data-ttu-id="d712a-212">**Abbildung 10**: Legen Sie die Dropdownlisten im aktualisieren und Löschen von Registerkarten auf (keine) ([klicken Sie, um das Bild in voller Größe anzeigen](batch-updating-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="d712a-212">**Figure 10**: Set the Drop-Down Lists in the UPDATE and DELETE Tabs to (None) ([Click to view full-size image](batch-updating-cs/_static/image18.png))</span></span>


<span data-ttu-id="d712a-213">Nach Abschluss des Assistenten, der `CategoriesDataSource` s deklaratives Markup sollte wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="d712a-213">After completing the wizard, the `CategoriesDataSource` s declarative markup should look like the following:</span></span>


[!code-aspx[Main](batch-updating-cs/samples/sample2.aspx)]

<span data-ttu-id="d712a-214">Mit der `CategoriesDataSource` erstellt und konfiguriert haben, zurück zu den `CategoryName` TemplateField s `ItemTemplate` und DropDownList s Smarttags, klicken Sie auf den Link für die Datenquelle auswählen.</span><span class="sxs-lookup"><span data-stu-id="d712a-214">With the `CategoriesDataSource` created and configured, return to the `CategoryName` TemplateField s `ItemTemplate` and, from the DropDownList s smart tag, click on the Choose Data Source link.</span></span> <span data-ttu-id="d712a-215">Wählen Sie im Assistenten zum Konfigurieren von Datenquellen die `CategoriesDataSource` option in der ersten Dropdown-Liste, und entscheiden, dass `CategoryName` verwendet für die Anzeige und `CategoryID` als Wert.</span><span class="sxs-lookup"><span data-stu-id="d712a-215">In the Data Source Configuration wizard, select the `CategoriesDataSource` option from the first drop-down list and choose to have `CategoryName` used for the display and `CategoryID` as the value.</span></span>


<span data-ttu-id="d712a-216">[![Die DropDownList an die CategoriesDataSource binden](batch-updating-cs/_static/image11.gif)](batch-updating-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="d712a-216">[![Bind the DropDownList to the CategoriesDataSource](batch-updating-cs/_static/image11.gif)](batch-updating-cs/_static/image19.png)</span></span>

<span data-ttu-id="d712a-217">**Abbildung 11**: DropDownList, binden die `CategoriesDataSource` ([klicken Sie, um das Bild in voller Größe anzeigen](batch-updating-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="d712a-217">**Figure 11**: Bind the DropDownList to the `CategoriesDataSource` ([Click to view full-size image](batch-updating-cs/_static/image20.png))</span></span>


<span data-ttu-id="d712a-218">An diesem Punkt die `Categories` DropDownList Listet alle Kategorien, aber es nicht noch automatisch wählen Sie die entsprechende Kategorie für das Produkt an die GridView-Zeile gebunden.</span><span class="sxs-lookup"><span data-stu-id="d712a-218">At this point the `Categories` DropDownList lists all of the categories, but it does not yet automatically select the appropriate category for the product bound to the GridView row.</span></span> <span data-ttu-id="d712a-219">Um dies zu erreichen, wir legen müssen, die `Categories` DropDownList s `SelectedValue` für das Produkt s `CategoryID` Wert.</span><span class="sxs-lookup"><span data-stu-id="d712a-219">To accomplish this we need to set the `Categories` DropDownList s `SelectedValue` to the product s `CategoryID` value.</span></span> <span data-ttu-id="d712a-220">Klicken Sie auf den Link "DataBindings bearbeiten" aus dem DropDownList-s-Smarttag, und ordnen Sie die `SelectedValue` Eigenschaft mit dem `CategoryID` Datenfeld, wie in Abbildung 12 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="d712a-220">Click on the Edit DataBindings link from the DropDownList s smart tag and associate the `SelectedValue` property with the `CategoryID` data field as shown in Figure 12.</span></span>


![Binden von der Product-s-Kategorie-ID-Wert an die SelectedValue-Eigenschaft der DropDownList-s](batch-updating-cs/_static/image12.gif)

<span data-ttu-id="d712a-222">**Abbildung 12**: Binden Sie das Produkt s `CategoryID` Wert, der die DropDownList-Zuordnungsvorgänge `SelectedValue` Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="d712a-222">**Figure 12**: Bind the Product s `CategoryID` Value to the DropDownList s `SelectedValue` Property</span></span>


<span data-ttu-id="d712a-223">Eine letzte Problem bleibt: Wenn das Produkt t haben eine `CategoryID` Wert angegeben wird die Databinding-Anweisung auf `SelectedValue` führt zu einer Ausnahme.</span><span class="sxs-lookup"><span data-stu-id="d712a-223">One last problem remains: if the product doesn t have a `CategoryID` value specified then the databinding statement on `SelectedValue` will result in an exception.</span></span> <span data-ttu-id="d712a-224">Grund hierfür ist die DropDownList enthält nur die Elemente für die Kategorien und bietet keine Option für diese Produkte mit einem `NULL` Wert für die Datenbank `CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="d712a-224">This is because the DropDownList contains only items for the categories and does not offer an option for those products that have a `NULL` database value for `CategoryID`.</span></span> <span data-ttu-id="d712a-225">Legen Sie zur Behebung des Problems, das DropDownList-s `AppendDataBoundItems` Eigenschaft `true` und Hinzufügen eines neuen Elements zu DropDownList, Auslassen der `Value` Eigenschaft aus der deklarativen Syntax.</span><span class="sxs-lookup"><span data-stu-id="d712a-225">To remedy this, set the DropDownList s `AppendDataBoundItems` property to `true` and add a new item to the DropDownList, omitting the `Value` property from the declarative syntax.</span></span> <span data-ttu-id="d712a-226">Stellen Sie also sicher, dass die `Categories` DropDownList s deklarativer Syntax sieht wie folgt aus:</span><span class="sxs-lookup"><span data-stu-id="d712a-226">That is, make sure that the `Categories` DropDownList s declarative syntax looks like the following:</span></span>


[!code-aspx[Main](batch-updating-cs/samples/sample3.aspx)]

<span data-ttu-id="d712a-227">Hinweis wie die `<asp:ListItem Value="">` – wählen Sie eine – verfügt über seine `Value` Attribut explizit festgelegt wird, auf eine leere Zeichenfolge.</span><span class="sxs-lookup"><span data-stu-id="d712a-227">Note how the `<asp:ListItem Value="">` -- Select One -- has its `Value` attribute explicitly set to an empty string.</span></span> <span data-ttu-id="d712a-228">Verweisen zurück auf die [Anpassen der Benutzeroberfläche für die Änderung der Daten](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) Tutorial für eine ausführlichere Erläuterung der warum dieses zusätzliche DropDownList-Element erforderlich ist, behandelt der `NULL` Fall und warum Zuweisung der `Value` die Eigenschaft auf eine leere Zeichenfolge ist unerlässlich.</span><span class="sxs-lookup"><span data-stu-id="d712a-228">Refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) tutorial for a more thorough discussion on why this additional DropDownList item is needed to handle the `NULL` case and why assignment of the `Value` property to an empty string is essential.</span></span>

> [!NOTE]
> <span data-ttu-id="d712a-229">Es ist ein potenzielles Leistung und Skalierbarkeit Problem hier, das erwähnt werden muss.</span><span class="sxs-lookup"><span data-stu-id="d712a-229">There is a potential performance and scalability issue here that is worth mentioning.</span></span> <span data-ttu-id="d712a-230">Da jede Zeile mit einem DropDownList-Steuerelement enthält, die verwendet die `CategoriesDataSource` als Datenquelle, die `CategoriesBLL` s-Klasse `GetCategories` aufgerufene Methode *n* Mal pro Seite besuchen, in denen *n* ist die Anzahl der Zeilen in den GridView-Ansicht.</span><span class="sxs-lookup"><span data-stu-id="d712a-230">Since each row has a DropDownList that uses the `CategoriesDataSource` as its data source, the `CategoriesBLL` class s `GetCategories` method will be called *n* times per page visit, where *n* is the number of rows in the GridView.</span></span> <span data-ttu-id="d712a-231">Diese *n* Aufrufe von `GetCategories` führen *n* Abfragen an die Datenbank.</span><span class="sxs-lookup"><span data-stu-id="d712a-231">These *n* calls to `GetCategories` result in *n* queries to the database.</span></span> <span data-ttu-id="d712a-232">Diese Auswirkungen auf die Datenbank kann weniger problematisch werden, durch das Zwischenspeichern der zurückgegebenen Kategorien oder in einem Cache pro Anforderung als auch über die Caching-Schicht, die mittels einer SQL-Abhängigkeit oder eine sehr kurze Zeit-basierte Ablauf zwischengespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="d712a-232">This impact on the database could be lessened by caching the returned categories either in a per-request cache or through the Caching Layer using a SQL caching dependency or a very short time-based expiry.</span></span> <span data-ttu-id="d712a-233">Weitere Informationen zu den pro Anforderung, die Option zum Zwischenspeichern finden Sie unter [ `HttpContext.Items` ein pro-Request-Cache-Store](http://aspnet.4guysfromrolla.com/articles/060904-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="d712a-233">For more information on the per-request caching option, see [`HttpContext.Items` a Per-Request Cache Store](http://aspnet.4guysfromrolla.com/articles/060904-1.aspx).</span></span>


## <a name="step-4-completing-the-editing-interface"></a><span data-ttu-id="d712a-234">Schritt 4: Abschließen der Schnittstelle bearbeiten</span><span class="sxs-lookup"><span data-stu-id="d712a-234">Step 4: Completing the Editing Interface</span></span>

<span data-ttu-id="d712a-235">Wir haben eine Reihe von Änderungen an den GridView-s-Vorlagen ohne Anhalten und unseren Fortschritt anzeigen hergestellt.</span><span class="sxs-lookup"><span data-stu-id="d712a-235">We ve made a number of changes to the GridView s templates without pausing to view our progress.</span></span> <span data-ttu-id="d712a-236">Nehmen Sie einen Moment Zeit, um unseren Fortschritt über einen Browser anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="d712a-236">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="d712a-237">Wie in Abbildung 13 gezeigt, jede Zeile mit dargestellt wird seine `ItemTemplate`, die die Zelle s bearbeiten-Schnittstelle enthält.</span><span class="sxs-lookup"><span data-stu-id="d712a-237">As Figure 13 shows, each row is rendered using its `ItemTemplate`, which contains the cell s editing interface.</span></span>


<span data-ttu-id="d712a-238">[![Jede GridView-Zeile ist bearbeitbar](batch-updating-cs/_static/image13.gif)](batch-updating-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="d712a-238">[![Each GridView Row is Editable](batch-updating-cs/_static/image13.gif)](batch-updating-cs/_static/image21.png)</span></span>

<span data-ttu-id="d712a-239">**Abbildung 13**: jede GridView-Zeile ist bearbeitbar ([klicken Sie, um das Bild in voller Größe anzeigen](batch-updating-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="d712a-239">**Figure 13**: Each GridView Row is Editable ([Click to view full-size image](batch-updating-cs/_static/image22.png))</span></span>


<span data-ttu-id="d712a-240">Es gibt einige kleinere Probleme bei der Formatierung, denen wir an diesem Punkt kümmern müssen.</span><span class="sxs-lookup"><span data-stu-id="d712a-240">There are a few minor formatting issues that we should take care of at this point.</span></span> <span data-ttu-id="d712a-241">Beachten Sie, dass zuerst die `UnitPrice` Wert enthält vier Dezimalstellen.</span><span class="sxs-lookup"><span data-stu-id="d712a-241">First, note that the `UnitPrice` value contains four decimal points.</span></span> <span data-ttu-id="d712a-242">Um dieses Problem zu beheben, zurück zu den `UnitPrice` TemplateField s `ItemTemplate` und TextBox s Smarttags, klicken Sie auf den Link DataBindings bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="d712a-242">To fix this, return to the `UnitPrice` TemplateField s `ItemTemplate` and, from the TextBox s smart tag, click on the Edit DataBindings link.</span></span> <span data-ttu-id="d712a-243">Als Nächstes angeben, die die `Text` Eigenschaft als Zahl formatiert werden sollen.</span><span class="sxs-lookup"><span data-stu-id="d712a-243">Next, specify that the `Text` property should be formatted as a number.</span></span>


![Formatieren von Text-Eigenschaft als eine Zahl](batch-updating-cs/_static/image14.gif)

<span data-ttu-id="d712a-245">**Abbildung 14**: Format der `Text` Eigenschaft als Zahl</span><span class="sxs-lookup"><span data-stu-id="d712a-245">**Figure 14**: Format the `Text` Property as a Number</span></span>


<span data-ttu-id="d712a-246">Zweitens können s zentrieren Sie das Kontrollkästchen in der `Discontinued` Spalte (anstatt es linksbündig ausgerichtet).</span><span class="sxs-lookup"><span data-stu-id="d712a-246">Second, let s center the checkbox in the `Discontinued` column (rather than having it left-aligned).</span></span> <span data-ttu-id="d712a-247">Klicken Sie auf den Spalten bearbeiten das GridView-s-Smarttag, und wählen Sie die `Discontinued` TemplateField aus der Liste der Felder in der unteren linken Ecke.</span><span class="sxs-lookup"><span data-stu-id="d712a-247">Click on Edit Columns from the GridView s smart tag and select the `Discontinued` TemplateField from the list of fields in the bottom left corner.</span></span> <span data-ttu-id="d712a-248">Drilldown in `ItemStyle` und legen Sie die `HorizontalAlign` Eigenschaft Center, wie in Abbildung 15 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="d712a-248">Drill down into `ItemStyle` and set the `HorizontalAlign` property to Center as shown in Figure 15.</span></span>


![Zentrieren Sie das Kontrollkästchen nicht mehr unterstützte](batch-updating-cs/_static/image15.gif)

<span data-ttu-id="d712a-250">**Abbildung 15**: Center die `Discontinued` Kontrollkästchen</span><span class="sxs-lookup"><span data-stu-id="d712a-250">**Figure 15**: Center the `Discontinued` CheckBox</span></span>


<span data-ttu-id="d712a-251">Als Nächstes fügen Sie ein ValidationSummary-Steuerelement auf der Seite, und legen seine `ShowMessageBox` Eigenschaft `true` und die zugehörige `ShowSummary` Eigenschaft `false`.</span><span class="sxs-lookup"><span data-stu-id="d712a-251">Next, add a ValidationSummary control to the page and set its `ShowMessageBox` property to `true` and its `ShowSummary` property to `false`.</span></span> <span data-ttu-id="d712a-252">Fügen Sie auch, dass die Schaltfläche "Web steuert, die beim Klicken auf, die Benutzer s Änderungen aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="d712a-252">Also add the Button Web controls that, when clicked, will update the user s changes.</span></span> <span data-ttu-id="d712a-253">Insbesondere zwei Schaltfläche Web Steuerelemente hinzufügen, einen oberhalb der GridView und darunter liegenden beide Steuerelemente festlegen `Text` Eigenschaften, die Update-Produkte.</span><span class="sxs-lookup"><span data-stu-id="d712a-253">Specifically, add two Button Web controls, one above the GridView and one below it, setting both controls `Text` properties to Update Products .</span></span>

<span data-ttu-id="d712a-254">Seit der GridView-s bearbeiten-Schnittstelle ist definiert in der von TemplateFields `ItemTemplate` s, die `EditItemTemplate` s überflüssig und können gelöscht werden.</span><span class="sxs-lookup"><span data-stu-id="d712a-254">Since the GridView s editing interface is defined in its TemplateFields `ItemTemplate` s, the `EditItemTemplate` s are superfluous and may be deleted.</span></span>

<span data-ttu-id="d712a-255">Nachdem Formatänderungen machen oben bereits erwähnt, die Schaltflächen-Steuerelemente hinzufügen und entfernen Sie die unnötige `EditItemTemplate` s, sollte die Seite "s" deklarative Syntax wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="d712a-255">After making the above mentioned formatting changes, adding the Button controls, and removing the unnecessary `EditItemTemplate` s, your page s declarative syntax should look like the following:</span></span>


[!code-aspx[Main](batch-updating-cs/samples/sample4.aspx)]

<span data-ttu-id="d712a-256">Abbildung 16 zeigt diese Seite, wenn Sie über einen Browser angezeigt werden soll, nachdem die Schaltfläche "-Web-Steuerelemente hinzugefügt wurden und die Formatierungen vorgenommenen Änderungen.</span><span class="sxs-lookup"><span data-stu-id="d712a-256">Figure 16 shows this page when viewed through a browser after the Button Web controls have been added and the formatting changes made.</span></span>


<span data-ttu-id="d712a-257">[![Die Seite jetzt enthält zwei Schaltflächen der Update-Produkte](batch-updating-cs/_static/image16.gif)](batch-updating-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="d712a-257">[![The Page Now Includes Two Update Products Buttons](batch-updating-cs/_static/image16.gif)](batch-updating-cs/_static/image23.png)</span></span>

<span data-ttu-id="d712a-258">**Abbildung 16**: die Seite jetzt umfasst zwei Update-Produkte Schaltflächen ([klicken Sie, um das Bild in voller Größe anzeigen](batch-updating-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="d712a-258">**Figure 16**: The Page Now Includes Two Update Products Buttons ([Click to view full-size image](batch-updating-cs/_static/image24.png))</span></span>


## <a name="step-5-updating-the-products"></a><span data-ttu-id="d712a-259">Schritt 5: Aktualisieren der Produkte</span><span class="sxs-lookup"><span data-stu-id="d712a-259">Step 5: Updating the Products</span></span>

<span data-ttu-id="d712a-260">Wenn ein Benutzer diese Seite besucht werden sie ihre Änderungen vornehmen, und klicken Sie dann auf eine der zwei Schaltflächen, Update-Produkte.</span><span class="sxs-lookup"><span data-stu-id="d712a-260">When a user visits this page they will make their modifications and then click one of the two Update Products buttons.</span></span> <span data-ttu-id="d712a-261">An dieser Stelle müssen wir irgendwie speichern Sie die eingegebenen Werte für jede Zeile in einer `ProductsDataTable` -Instanz, und übergeben, die an eine BLL-Methode, die dann besteht, `ProductsDataTable` Instanz der DAL s `UpdateWithTransaction` Methode.</span><span class="sxs-lookup"><span data-stu-id="d712a-261">At that point we need to somehow save the user-entered values for each row into a `ProductsDataTable` instance and then pass that to a BLL method that will then pass that `ProductsDataTable` instance to the DAL s `UpdateWithTransaction` method.</span></span> <span data-ttu-id="d712a-262">Die `UpdateWithTransaction` -Methode, die wir in erstellt die [vorherigen Lernprogramm](wrapping-database-modifications-within-a-transaction-cs.md), stellt sicher, dass der Batch von Änderungen als atomaren Vorgang aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="d712a-262">The `UpdateWithTransaction` method, which we created in the [preceding tutorial](wrapping-database-modifications-within-a-transaction-cs.md), ensures that the batch of changes will be updated as an atomic operation.</span></span>

<span data-ttu-id="d712a-263">Erstellen Sie eine Methode mit dem Namen `BatchUpdate` in `BatchUpdate.aspx.cs` und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="d712a-263">Create a method named `BatchUpdate` in `BatchUpdate.aspx.cs` and add the following code:</span></span>


[!code-csharp[Main](batch-updating-cs/samples/sample5.cs)]

<span data-ttu-id="d712a-264">Diese Methode startet indem Sie alle Produkte abrufen in ein `ProductsDataTable` über einen Aufruf an die BLL s `GetProducts` Methode.</span><span class="sxs-lookup"><span data-stu-id="d712a-264">This method starts out by getting all of the products back in a `ProductsDataTable` via a call to the BLL s `GetProducts` method.</span></span> <span data-ttu-id="d712a-265">Zählt dann die `ProductGrid` GridView s [ `Rows` Auflistung](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rows(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="d712a-265">It then enumerates the `ProductGrid` GridView s [`Rows` collection](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rows(VS.80).aspx).</span></span> <span data-ttu-id="d712a-266">Die `Rows` Auflistung enthält ein [ `GridViewRow` Instanz](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewrow.aspx) für jede Zeile in der GridView-Ansicht angezeigt.</span><span class="sxs-lookup"><span data-stu-id="d712a-266">The `Rows` collection contains a [`GridViewRow` instance](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewrow.aspx) for each row displayed in the GridView.</span></span> <span data-ttu-id="d712a-267">Da wir höchstens zehn Zeilen pro Seite, die GridView s angezeigt werden `Rows` Auflistung wird nicht mehr als zehn Elemente haben.</span><span class="sxs-lookup"><span data-stu-id="d712a-267">Since we are showing at most ten rows per page, the GridView s `Rows` collection will have no more than ten items.</span></span>

<span data-ttu-id="d712a-268">Für jede Zeile der `ProductID` ist stammt aus der `DataKeys` Sammlung und die entsprechenden `ProductsRow` ausgewählt ist, aus der `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="d712a-268">For each row the `ProductID` is grabbed from the `DataKeys` collection and the appropriate `ProductsRow` is selected from the `ProductsDataTable`.</span></span> <span data-ttu-id="d712a-269">Die vier TemplateField-input-Steuerelemente programmgesteuert auf die verwiesen wird, und ihre Werte zugewiesen, die `ProductsRow` s Instanzeigenschaften.</span><span class="sxs-lookup"><span data-stu-id="d712a-269">The four TemplateField input controls are programmatically referenced and their values assigned to the `ProductsRow` instance s properties.</span></span> <span data-ttu-id="d712a-270">Nach jeder GridView Zeilenwerte s haben wurde zum Aktualisieren der `ProductsDataTable`, es s, die an die BLL s `UpdateWithTransaction` -Methode, die wie im vorherigen Tutorial beschrieben in der DAL s einfach nach unten ruft `UpdateWithTransaction` Methode.</span><span class="sxs-lookup"><span data-stu-id="d712a-270">After each GridView row s values have been used to update the `ProductsDataTable`, it s passed to the BLL s `UpdateWithTransaction` method which, as we saw in the preceding tutorial, simply calls down into the DAL s `UpdateWithTransaction` method.</span></span>

<span data-ttu-id="d712a-271">Der Batch-Update-Algorithmus für dieses Tutorial verwendete aktualisiert jede Zeile in der `ProductsDataTable` , entspricht einer Zeile in der GridView, unabhängig davon, ob die Produktinformationen s geändert wurde.</span><span class="sxs-lookup"><span data-stu-id="d712a-271">The batch update algorithm used for this tutorial updates each row in the `ProductsDataTable` that corresponds to a row in the GridView, regardless of whether the product s information has been changed.</span></span> <span data-ttu-id="d712a-272">Während solche Blind sind t in der Regel ein Leistungsproblem aktualisiert, können sie zu überflüssigen Datensätze führen re-Überwachung in die Datenbanktabelle überschreiten.</span><span class="sxs-lookup"><span data-stu-id="d712a-272">While such blind updates aren t usually a performance issue, they can lead to superfluous records if you re auditing changes to the database table.</span></span> <span data-ttu-id="d712a-273">In der [Durchführen von BatchUpdates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-cs.md) Tutorial wir untersucht einen Batch, die Schnittstelle mit DataList-Steuerelement aktualisiert und Code, der nur die Datensätze aktualisiert wird, die tatsächlich vom Benutzer geändert wurden.</span><span class="sxs-lookup"><span data-stu-id="d712a-273">Back in the [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-cs.md) tutorial we explored a batch updating interface with the DataList and added code that would only update those records that were actually modified by the user.</span></span> <span data-ttu-id="d712a-274">Gerne verwenden die Techniken von [Durchführen von BatchUpdates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-cs.md) so aktualisieren ggf. den Code in diesem Tutorial.</span><span class="sxs-lookup"><span data-stu-id="d712a-274">Feel free to use the techniques from [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-cs.md) to update the code in this tutorial, if desired.</span></span>

> [!NOTE]
> <span data-ttu-id="d712a-275">Beim Binden von der Datenquelle an die GridView über sein Smarttag, weist Visual Studio automatisch Werte für die primären Datenquelle s-Key der GridView-s `DataKeyNames` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="d712a-275">When binding the data source to the GridView through its smart tag, Visual Studio automatically assigns the data source s primary key value(s) to the GridView s `DataKeyNames` property.</span></span> <span data-ttu-id="d712a-276">Wenn Sie nicht dem ObjectDataSource-Steuerelement an die GridView über das GridView-s-Smarttag binden, wie in Schritt 1 beschrieben, müssen Sie manuell festlegen, die GridView s `DataKeyNames` Eigenschaft "ProductID", um Zugriff auf die `ProductID` Wert für jede Zeile über die `DataKeys` Auflistung.</span><span class="sxs-lookup"><span data-stu-id="d712a-276">If you did not bind the ObjectDataSource to the GridView through the GridView s smart tag as outlined in Step 1, then you will need to manually set the GridView s `DataKeyNames` property to ProductID in order to access the `ProductID` value for each row through the `DataKeys` collection.</span></span>


<span data-ttu-id="d712a-277">Der Code in verwendet `BatchUpdate` ähnelt, verwendet die BLL s `UpdateProduct` Methoden, die der Hauptunterschied besteht darin, die in der `UpdateProduct` Methoden nur eine einzige `ProductRow` Instanz abgerufen wird, von der Architektur.</span><span class="sxs-lookup"><span data-stu-id="d712a-277">The code used in `BatchUpdate` is similar to that used in the BLL s `UpdateProduct` methods, the main difference being that in the `UpdateProduct` methods only a single `ProductRow` instance is retrieved from the architecture.</span></span> <span data-ttu-id="d712a-278">Den Code, der die Eigenschaften des weist die `ProductRow` ist die gleiche Weise die `UpdateProducts` Methoden und den Code in der `foreach` wurde eine Schleife in `BatchUpdate`, da das gesamte Muster.</span><span class="sxs-lookup"><span data-stu-id="d712a-278">The code that assigns the properties of the `ProductRow` is the same between the `UpdateProducts` methods and the code within the `foreach` loop in `BatchUpdate`, as is the overall pattern.</span></span>

<span data-ttu-id="d712a-279">Um dieses Tutorial abzuschließen, müssen wir haben die `BatchUpdate` Methode wird aufgerufen, wenn eine der Update-Produkte-Schaltflächen geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="d712a-279">To complete this tutorial, we need to have the `BatchUpdate` method invoked when either of the Update Products buttons is clicked.</span></span> <span data-ttu-id="d712a-280">Erstellen von Ereignishandlern für die `Click` Ereignisse dieser beiden Steuerelemente Schaltfläche, und fügen Sie den folgenden Code in den Ereignishandlern:</span><span class="sxs-lookup"><span data-stu-id="d712a-280">Create event handlers for the `Click` events of these two Button controls and add the following code in the event handlers:</span></span>


[!code-csharp[Main](batch-updating-cs/samples/sample6.cs)]

<span data-ttu-id="d712a-281">Zunächst erfolgt ein Aufruf zum `BatchUpdate`.</span><span class="sxs-lookup"><span data-stu-id="d712a-281">First a call is made to `BatchUpdate`.</span></span> <span data-ttu-id="d712a-282">Als Nächstes die `ClientScript property` wird verwendet, um das Einfügen von JavaScript, die eine Messagebox anzeigt, die liest die Produkte wurden aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="d712a-282">Next, the `ClientScript property` is used to inject JavaScript that will display a messagebox that reads The products have been updated.</span></span>

<span data-ttu-id="d712a-283">Kurz, diesen Code zu testen.</span><span class="sxs-lookup"><span data-stu-id="d712a-283">Take a minute to test out this code.</span></span> <span data-ttu-id="d712a-284">Besuchen Sie `BatchUpdate.aspx` über einen Browser, bearbeiten Sie eine Anzahl von Zeilen, und klicken Sie auf eine der Schaltflächen Update-Produkte.</span><span class="sxs-lookup"><span data-stu-id="d712a-284">Visit `BatchUpdate.aspx` through a browser, edit a number of rows, and click one of the Update Products buttons.</span></span> <span data-ttu-id="d712a-285">Vorausgesetzt, dass keine Überprüfung der Eingabe-Fehler vorliegen, sollten Sie eine Messagebox sehen, die gelesen, dass die Produkte aktualisiert wurden.</span><span class="sxs-lookup"><span data-stu-id="d712a-285">Assuming there are no input validation errors, you should see a messagebox that reads The products have been updated.</span></span> <span data-ttu-id="d712a-286">Um die Unteilbarkeit des Updates zu überprüfen, erwägen Sie eine zufällige `CHECK` -Einschränkung, wie eine, die lässt keine `UnitPrice` 1234.56 Werte.</span><span class="sxs-lookup"><span data-stu-id="d712a-286">To verify the atomicity of the update, consider adding a random `CHECK` constraint, like one that disallows `UnitPrice` values of 1234.56.</span></span> <span data-ttu-id="d712a-287">Klicken Sie dann aus `BatchUpdate.aspx`, bearbeiten Sie eine Anzahl von Datensätzen, zum Festlegen des Produkts s sicherstellen `UnitPrice` Wert, der den unzulässigen Wert (1234.56).</span><span class="sxs-lookup"><span data-stu-id="d712a-287">Then from `BatchUpdate.aspx`, edit a number of records, making sure to set one of the product s `UnitPrice` value to the forbidden value ( 1234.56 ).</span></span> <span data-ttu-id="d712a-288">Dies sollte zu einem Fehler führen, wenn Update-Produkte mit den anderen Änderungen auf, während der Batchvorgang wieder auf ihre ursprünglichen Werte zurückgesetzt werden.</span><span class="sxs-lookup"><span data-stu-id="d712a-288">This should result in an error when clicking Update Products with the other changes during that batch operation rolled back to their original values.</span></span>

## <a name="an-alternativebatchupdatemethod"></a><span data-ttu-id="d712a-289">Eine Alternative`BatchUpdate`Methode</span><span class="sxs-lookup"><span data-stu-id="d712a-289">An Alternative`BatchUpdate`Method</span></span>

<span data-ttu-id="d712a-290">Die `BatchUpdate` Methode, die wir gerade untersucht ruft *alle* der Produkte von der BLL s `GetProducts` Methode und aktualisiert dann nur die Datensätze, die in den GridView-Ansicht angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="d712a-290">The `BatchUpdate` method we just examined retrieves *all* of the products from the BLL s `GetProducts` method and then updates just those records that appear in the GridView.</span></span> <span data-ttu-id="d712a-291">Dieser Ansatz ist ideal, wenn die GridView Paging nicht verwendet, aber wenn dies der Fall ist, gibt es möglicherweise Hunderte, Tausende oder Zehntausende von Produkten, aber nur zehn Zeilen in den GridView-Ansicht.</span><span class="sxs-lookup"><span data-stu-id="d712a-291">This approach is ideal if the GridView does not use paging, but if it does, there may be hundreds, thousands, or tens of thousands of products, but only ten rows in the GridView.</span></span> <span data-ttu-id="d712a-292">In diesem Fall ist das Abrufen aller Produkte aus der Datenbank nur 10 Zeilen ändern nicht ideal.</span><span class="sxs-lookup"><span data-stu-id="d712a-292">In such a case, getting all of the products from the database only to modify 10 of them is less than ideal.</span></span>

<span data-ttu-id="d712a-293">Für solche Situationen sollten Sie mit der folgenden `BatchUpdateAlternate` Methode stattdessen:</span><span class="sxs-lookup"><span data-stu-id="d712a-293">For those types of situations, consider using the following `BatchUpdateAlternate` method instead:</span></span>


[!code-csharp[Main](batch-updating-cs/samples/sample7.cs)]

<span data-ttu-id="d712a-294">`BatchMethodAlternate` gestartet wird, indem Sie erstellen ein neues leeres `ProductsDataTable` mit dem Namen `products`.</span><span class="sxs-lookup"><span data-stu-id="d712a-294">`BatchMethodAlternate` starts by creating a new empty `ProductsDataTable` named `products`.</span></span> <span data-ttu-id="d712a-295">Anschließend werden die Schritte der GridView-s `Rows` Auflistung und für jede Zeile der bestimmte Produktinformationen mithilfe der BLL s ruft `GetProductByProductID(productID)` Methode.</span><span class="sxs-lookup"><span data-stu-id="d712a-295">It then steps through the GridView s `Rows` collection and for each row gets the particular product information using the BLL s `GetProductByProductID(productID)` method.</span></span> <span data-ttu-id="d712a-296">Der abgerufene `ProductsRow` Instanz verfügt über Eigenschaften, die auf dieselbe Weise wie aktualisiert `BatchUpdate`, jedoch erst nach dem Aktualisieren der Zeile, die dem Import in die `products``ProductsDataTable` über die DataTable s [ `ImportRow(DataRow)` Methode](https://msdn.microsoft.com/library/system.data.datatable.importrow(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="d712a-296">The retrieved `ProductsRow` instance has its properties updated in the same fashion as `BatchUpdate`, but after updating the row it is imported into the `products``ProductsDataTable` via the DataTable s [`ImportRow(DataRow)` method](https://msdn.microsoft.com/library/system.data.datatable.importrow(VS.80).aspx).</span></span>

<span data-ttu-id="d712a-297">Nach der `foreach` Schleife abgeschlossen ist, `products` enthält mindestens ein `ProductsRow` Instanz für jede Zeile in der GridView-Ansicht.</span><span class="sxs-lookup"><span data-stu-id="d712a-297">After the `foreach` loop completes, `products` contains one `ProductsRow` instance for each row in the GridView.</span></span> <span data-ttu-id="d712a-298">Da jede von der `ProductsRow` Instanzen hinzugefügt wurden die `products` (anstelle von aktualisiert), wenn wir damit Blind übergeben der `UpdateWithTransaction` Methode der `ProductsTableAdatper` versucht, jede der Datensätze in der Datenbank eingefügt.</span><span class="sxs-lookup"><span data-stu-id="d712a-298">Since each of the `ProductsRow` instances have been added to the `products` (instead of updated), if we blindly pass it to the `UpdateWithTransaction` method the `ProductsTableAdatper` will try to insert each of the records into the database.</span></span> <span data-ttu-id="d712a-299">Stattdessen müssen wir angeben, dass jede dieser Zeilen (keine hinzugefügt) geändert wurde.</span><span class="sxs-lookup"><span data-stu-id="d712a-299">Instead, we need to specify that each of these rows has been modified (not added).</span></span>

<span data-ttu-id="d712a-300">Dies geschieht durch Hinzufügen einer neuen Methode an die BLL, die mit dem Namen `UpdateProductsWithTransaction`.</span><span class="sxs-lookup"><span data-stu-id="d712a-300">This can be accomplished by adding a new method to the BLL named `UpdateProductsWithTransaction`.</span></span> <span data-ttu-id="d712a-301">`UpdateProductsWithTransaction`, unten dargestellt, legt die `RowState` aller der `ProductsRow` -Instanzen in der `ProductsDataTable` zu `Modified` und übergibt dann die `ProductsDataTable` der DAL-s `UpdateWithTransaction` Methode.</span><span class="sxs-lookup"><span data-stu-id="d712a-301">`UpdateProductsWithTransaction`, shown below, sets the `RowState` of each of the `ProductsRow` instances in the `ProductsDataTable` to `Modified` and then passes the `ProductsDataTable` to the DAL s `UpdateWithTransaction` method.</span></span>


[!code-csharp[Main](batch-updating-cs/samples/sample8.cs)]

## <a name="summary"></a><span data-ttu-id="d712a-302">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="d712a-302">Summary</span></span>

<span data-ttu-id="d712a-303">GridView pro Zeile integrierten Funktionen enthält, aber Sie verfügt nicht über die Unterstützung für das Erstellen vollständig bearbeitbare Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="d712a-303">The GridView provides built-in per-row editing capabilities, but lacks support for creating fully editable interfaces.</span></span> <span data-ttu-id="d712a-304">Wie wir in diesem Tutorial gesehen haben, werden solche Schnittstellen sind möglich, aber ein wenig Aufwand erforderlich.</span><span class="sxs-lookup"><span data-stu-id="d712a-304">As we saw in this tutorial, such interfaces are possible, but require a bit of work.</span></span> <span data-ttu-id="d712a-305">Um einer GridView-Ansicht zu erstellen, in dem jede Zeile bearbeitet werden kann, müssen wir die GridView-s-Felder in von TemplateFields konvertieren und definieren die Bearbeitungsschnittstelle innerhalb der `ItemTemplate` s.</span><span class="sxs-lookup"><span data-stu-id="d712a-305">To create a GridView where every row is editable, we need to convert the GridView s fields into TemplateFields and define the editing interface within the `ItemTemplate` s.</span></span> <span data-ttu-id="d712a-306">Aktualisieren Sie darüber hinaus alle - Schaltfläche websteuerungselemente, hinzugefügt werden auf der Seite getrennt von der GridView.</span><span class="sxs-lookup"><span data-stu-id="d712a-306">Additionally, Update All -type Button Web controls must be added to the page, separate from the GridView.</span></span> <span data-ttu-id="d712a-307">Diese Schaltflächen `Click` Ereignishandler müssen zum Aufzählen der GridView-s `Rows` -Auflistung, speichern Sie die Änderungen in einer `ProductsDataTable`, und übergeben die aktualisierte Informationen in die entsprechende BLL-Methode.</span><span class="sxs-lookup"><span data-stu-id="d712a-307">These Buttons `Click` event handlers need to enumerate the GridView s `Rows` collection, store the changes in a `ProductsDataTable`, and pass the updated information into the appropriate BLL method.</span></span>

<span data-ttu-id="d712a-308">Im nächsten Tutorial sehen wir, wie Sie eine Schnittstelle für das Löschen von Batch zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="d712a-308">In the next tutorial we'll see how to create an interface for batch deleting.</span></span> <span data-ttu-id="d712a-309">Insbesondere jeder GridView-Zeile wird ein Kontrollkästchen und nicht alle aktualisieren – geben Sie Schaltflächen, haben wir dann die Schaltflächen der ausgewählten Zeilen löschen.</span><span class="sxs-lookup"><span data-stu-id="d712a-309">In particular, each GridView row will include a checkbox and instead of Update All -type buttons, we'll have Delete Selected Rows buttons.</span></span>

<span data-ttu-id="d712a-310">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="d712a-310">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="d712a-311">Der Autor</span><span class="sxs-lookup"><span data-stu-id="d712a-311">About the Author</span></span>

<span data-ttu-id="d712a-312">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben Büchern zu ASP/ASP.NET und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), arbeitet mit Microsoft-Web-Technologien seit 1998.</span><span class="sxs-lookup"><span data-stu-id="d712a-312">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="d712a-313">Er ist als ein unabhängiger Berater, Schulungsleiter und Autor.</span><span class="sxs-lookup"><span data-stu-id="d712a-313">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="d712a-314">Sein neueste Buch wird [*Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="d712a-314">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="d712a-315">Er ist unter [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d712a-315">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="d712a-316">oder über seinen Blog finden Sie unter [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="d712a-316">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="d712a-317">Besonderen Dank an</span><span class="sxs-lookup"><span data-stu-id="d712a-317">Special Thanks To</span></span>

<span data-ttu-id="d712a-318">Diese tutorialreihe wurde durch viele hilfreiche Reviewer überprüft.</span><span class="sxs-lookup"><span data-stu-id="d712a-318">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="d712a-319">Führendes Prüfer für dieses Tutorial wurden Teresa Murphy und David Suru.</span><span class="sxs-lookup"><span data-stu-id="d712a-319">Lead reviewers for this tutorial were Teresa Murphy and David Suru.</span></span> <span data-ttu-id="d712a-320">Meine zukünftigen MSDN-Artikeln überprüfen möchten?</span><span class="sxs-lookup"><span data-stu-id="d712a-320">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="d712a-321">Wenn dies der Fall ist, löschen Sie mir eine Linie an [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d712a-321">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="d712a-322">[Zurück](wrapping-database-modifications-within-a-transaction-cs.md)
> [Weiter](batch-deleting-cs.md)</span><span class="sxs-lookup"><span data-stu-id="d712a-322">[Previous](wrapping-database-modifications-within-a-transaction-cs.md)
[Next](batch-deleting-cs.md)</span></span>
