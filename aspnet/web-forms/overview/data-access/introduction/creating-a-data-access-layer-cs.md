---
uid: web-forms/overview/data-access/introduction/creating-a-data-access-layer-cs
title: Erstellen einer Datenzugriffsschicht (c#) | Microsoft-Dokumentation
author: rick-anderson
description: In diesem Tutorial wir ganz von vorn beginnen und die Daten Datenzugriffsebene (DAL), verwenden typisierte DataSets, Zugriff auf die Informationen in einer Datenbank zu erstellen.
ms.author: riande
ms.date: 04/05/2010
ms.assetid: cfe2a6a0-1e56-4dc8-9537-c8ec76ba96a4
msc.legacyurl: /web-forms/overview/data-access/introduction/creating-a-data-access-layer-cs
msc.type: authoredcontent
ms.openlocfilehash: fca6119b2e78c246724d6dd7277d5c4dc521f49c
ms.sourcegitcommit: 45ac74e400f9f2b7dbded66297730f6f14a4eb25
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/16/2018
ms.locfileid: "41831590"
---
<a name="creating-a-data-access-layer-c"></a><span data-ttu-id="cb9e7-103">Erstellen einer Datenzugriffsschicht (c#)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-103">Creating a Data Access Layer (C#)</span></span>
====================
<span data-ttu-id="cb9e7-104">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="cb9e7-105">[Beispiel-App herunter](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_1_CS.exe) oder [PDF-Datei herunterladen](creating-a-data-access-layer-cs/_static/datatutorial01cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-105">[Download Sample App](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_1_CS.exe) or [Download PDF](creating-a-data-access-layer-cs/_static/datatutorial01cs1.pdf)</span></span>

> <span data-ttu-id="cb9e7-106">In diesem Tutorial wir ganz von vorn beginnen und die Daten Datenzugriffsebene (DAL), verwenden typisierte DataSets, Zugriff auf die Informationen in einer Datenbank zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-106">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), using typed DataSets, to access the information in a database.</span></span>


## <a name="introduction"></a><span data-ttu-id="cb9e7-107">Einführung</span><span class="sxs-lookup"><span data-stu-id="cb9e7-107">Introduction</span></span>

<span data-ttu-id="cb9e7-108">Unser Leben ausgetauschten als Webentwickler mit Daten arbeiten.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-108">As web developers, our lives revolve around working with data.</span></span> <span data-ttu-id="cb9e7-109">Wir erstellen Datenbanken zum Speichern der Daten und Code zum Abrufen und bearbeiten, und die Webseiten zum Sammeln und Zusammenfassen der Daten.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-109">We create databases to store the data, code to retrieve and modify it, and web pages to collect and summarize it.</span></span> <span data-ttu-id="cb9e7-110">Dies ist das erste Tutorial in einer langen Reihe, die Techniken zum Implementieren von gemeinsamen Mustern in ASP.NET 2.0 vorgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-110">This is the first tutorial in a lengthy series that will explore techniques for implementing these common patterns in ASP.NET 2.0.</span></span> <span data-ttu-id="cb9e7-111">Wir beginnen mit dem Erstellen einer [Softwarearchitektur](http://en.wikipedia.org/wiki/Software_architecture) besteht aus der eine Daten Datenzugriffsebene (DAL) mithilfe von typisierten DataSets, eine Geschäftslogikschicht (Business Logic Layer, BLL) erzwingt, dass benutzerdefinierte Geschäftsregeln und eine Darstellungsschicht ASP.NET besteht aus Seiten, Verwenden Sie ein gebräuchliches Seitenlayout.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-111">We'll start with creating a [software architecture](http://en.wikipedia.org/wiki/Software_architecture) composed of a Data Access Layer (DAL) using Typed DataSets, a Business Logic Layer (BLL) that enforces custom business rules, and a presentation layer composed of ASP.NET pages that share a common page layout.</span></span> <span data-ttu-id="cb9e7-112">Sobald diese Back-End-Grundlagen in die berichterstellung, weiter angeordnet wurde, zeigt, wie Sie angezeigt werden, zusammenfassen, sammeln und Überprüfen von Daten aus einer Webanwendung.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-112">Once this backend groundwork has been laid, we'll move into reporting, showing how to display, summarize, collect, and validate data from a web application.</span></span> <span data-ttu-id="cb9e7-113">Diese Lernprogramme sind darauf ausgerichtet, präzise und enthalten schrittweise Anleitungen mit zahlreichen Screenshots, die Sie visuell durch den Prozess geführt.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-113">These tutorials are geared to be concise and provide step-by-step instructions with plenty of screen shots to walk you through the process visually.</span></span> <span data-ttu-id="cb9e7-114">Jedes Lernprogramm ist in c# und Visual Basic-Versionen verfügbar und umfasst ein Download, der den vollständigen Code verwendet.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-114">Each tutorial is available in C# and Visual Basic versions and includes a download of the complete code used.</span></span> <span data-ttu-id="cb9e7-115">(In diesem ersten Tutorial ist ziemlich umfassend, aber der Rest wird angezeigt, in Blöcken von viel mehr verständlichste.)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-115">(This first tutorial is quite lengthy, but the rest are presented in much more digestible chunks.)</span></span>

<span data-ttu-id="cb9e7-116">Für diese Tutorials wir verwenden eine Microsoft SQL Server 2005 Express Edition-Version der Northwind-Datenbank gespeichert, der **App\_Daten** Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-116">For these tutorials we'll be using a Microsoft SQL Server 2005 Express Edition version of the Northwind database placed in the **App\_Data** directory.</span></span> <span data-ttu-id="cb9e7-117">Zusätzlich zu der Datei die **App\_Daten** Ordner enthält auch die SQL-Skripts zum Erstellen der Datenbank, für den Fall, dass Sie eine andere Datenbank-Version verwenden möchten.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-117">In addition to the database file, the **App\_Data** folder also contains the SQL scripts for creating the database, in case you want to use a different database version.</span></span> <span data-ttu-id="cb9e7-118">Diese Skripts kann auch sein [direkt von Microsoft heruntergeladen](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en), wenn Sie möchten.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-118">These scripts can be also be [downloaded directly from Microsoft](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en), if you'd prefer.</span></span> <span data-ttu-id="cb9e7-119">Wenn Sie eine andere SQL Server-Version der Northwind-Datenbank verwenden, müssen Sie aktualisieren die **NORTHWNDConnectionString** festlegen in der Anwendung **"Web.config"** Datei.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-119">If you use a different SQL Server version of the Northwind database, you will need to update the **NORTHWNDConnectionString** setting in the application's **Web.config** file.</span></span> <span data-ttu-id="cb9e7-120">Die Webanwendung wurde mithilfe von Visual Studio 2005 Professional Edition als Datei System-basierte-Website-Projekt erstellt.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-120">The web application was built using Visual Studio 2005 Professional Edition as a file system-based Web site project.</span></span> <span data-ttu-id="cb9e7-121">Alle in den Tutorials funktionieren jedoch gleichermaßen gut mit der kostenlosen Version von Visual Studio 2005 [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/).</span><span class="sxs-lookup"><span data-stu-id="cb9e7-121">However, all of the tutorials will work equally well with the free version of Visual Studio 2005, [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/).</span></span>  
  
<span data-ttu-id="cb9e7-122">In diesem Tutorial wir ganz von vorn beginnen und die Data Access Layer (DAL), gefolgt von der Geschäftslogikschicht (Business Logic Layer, BLL) im zweiten Lernprogramm erstellen und arbeiten auf "Seitenlayout" und Navigation in der dritten erstellen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-122">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), followed by creating the Business Logic Layer (BLL) in the second tutorial, and working on page layout and navigation in the third.</span></span> <span data-ttu-id="cb9e7-123">Die Lernprogramme, die nach dem Erstellen der dritte Parameter auf Grundlage des in der ersten drei festgelegt.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-123">The tutorials after the third one will build upon the foundation laid in the first three.</span></span> <span data-ttu-id="cb9e7-124">Wir haben viel in diesem ersten Tutorial behandelt, so starten Sie Visual Studio, und lassen Sie uns loslegen!</span><span class="sxs-lookup"><span data-stu-id="cb9e7-124">We've got a lot to cover in this first tutorial, so fire up Visual Studio and let's get started!</span></span>

## <a name="step-1-creating-a-web-project-and-connecting-to-the-database"></a><span data-ttu-id="cb9e7-125">Schritt 1: Erstellen eines Webprojekts, und Verbinden mit der Datenbank</span><span class="sxs-lookup"><span data-stu-id="cb9e7-125">Step 1: Creating a Web Project and Connecting to the Database</span></span>

<span data-ttu-id="cb9e7-126">Bevor wir unsere Data Access Layer (DAL) erstellen können, müssen wir eine Website erstellen und Einrichten der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-126">Before we can create our Data Access Layer (DAL), we first need to create a web site and setup our database.</span></span> <span data-ttu-id="cb9e7-127">Zunächst erstellen eine neue Datei systembasierte ASP.NET-Website.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-127">Start by creating a new file system-based ASP.NET web site.</span></span> <span data-ttu-id="cb9e7-128">Um dies zu erreichen, finden Sie unter dem Menü "Datei" aus, und wählen Sie die neue Website, die das Dialogfeld Neue Website anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-128">To accomplish this, go to the File menu and choose New Web Site, displaying the New Web Site dialog box.</span></span> <span data-ttu-id="cb9e7-129">Wählen Sie die Vorlage für ASP.NET Web Site, legen Sie die Dropdownliste den Speicherort auf File System, wählen Sie einen Ordner aus, um die Website zu platzieren und Festlegen der Sprache c#.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-129">Choose the ASP.NET Web Site template, set the Location drop-down list to File System, choose a folder to place the web site, and set the language to C#.</span></span>


<span data-ttu-id="cb9e7-130">[![Erstellen einer neuen System-basierte-Website](creating-a-data-access-layer-cs/_static/image2.png)](creating-a-data-access-layer-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-130">[![Create a New File System-Based Web Site](creating-a-data-access-layer-cs/_static/image2.png)](creating-a-data-access-layer-cs/_static/image1.png)</span></span>

<span data-ttu-id="cb9e7-131">**Abbildung 1**: Erstellen einer Website New File System-Based ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-131">**Figure 1**: Create a New File System-Based Web Site ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image3.png))</span></span>


<span data-ttu-id="cb9e7-132">Hiermit wird eine neue Website mit einer **"default.aspx"** ASP.NET-Seite und **App\_Daten** Ordner.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-132">This will create a new web site with a **Default.aspx** ASP.NET page and an **App\_Data** folder.</span></span>

<span data-ttu-id="cb9e7-133">Im nächste Schritt werden mit der Website erstellt haben einen Verweis auf die Datenbank im Server-Explorer von Visual Studio hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-133">With the web site created, the next step is to add a reference to the database in Visual Studio's Server Explorer.</span></span> <span data-ttu-id="cb9e7-134">Durch Hinzufügen einer Datenbank zu Server-Explorer können Sie Tabellen, gespeicherte Prozeduren, Sichten und usw. alle Angaben stammen aus Visual Studio hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-134">By adding a database to the Server Explorer you can add tables, stored procedures, views, and so on all from within Visual Studio.</span></span> <span data-ttu-id="cb9e7-135">Sie können auch Tabellendaten anzeigen oder erstellen eigene Abfragen entweder manuell oder grafisch über den Abfrage-Generator.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-135">You can also view table data or create your own queries either by hand or graphically via the Query Builder.</span></span> <span data-ttu-id="cb9e7-136">Darüber hinaus beim Erstellen wir die typisierte DataSets für die DAL müssen zeigen Visual Studio mit der Datenbank wir aus denen typisierten DataSets erstellt werden soll.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-136">Furthermore, when we build the Typed DataSets for the DAL we'll need to point Visual Studio to the database from which the Typed DataSets should be constructed.</span></span> <span data-ttu-id="cb9e7-137">Während wir diese Verbindungsinformationen zu diesem Zeitpunkt bereitstellen können, füllt Visual Studio automatisch eine Dropdown-Liste der Datenbanken im Server-Explorer bereits registriert.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-137">While we can provide this connection information at that point in time, Visual Studio automatically populates a drop-down list of the databases already registered in the Server Explorer.</span></span>

<span data-ttu-id="cb9e7-138">Die Schritte für den Server-Explorer mit die Northwind-Datenbank hinzugefügt, hängen davon ab, ob Sie in die SQL Server 2005 Express Edition-Datenbank verwenden möchten die **App\_Daten** Ordner oder wenn Sie eine Microsoft SQL Server 2000 oder 2005 haben Datenbank-Server-Setup, die Sie verwenden möchten.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-138">The steps for adding the Northwind database to the Server Explorer depend on whether you want to use the SQL Server 2005 Express Edition database in the **App\_Data** folder or if you have a Microsoft SQL Server 2000 or 2005 database server setup that you want to use instead.</span></span>

## <a name="using-a-database-in-theappdatafolder"></a><span data-ttu-id="cb9e7-139">Verwenden eine Datenbank in TheApp\_DataFolder</span><span class="sxs-lookup"><span data-stu-id="cb9e7-139">Using a Database in theApp\_DataFolder</span></span>

<span data-ttu-id="cb9e7-140">Wenn Sie verfügen nicht über eine SQL Server 2000 oder 2005-Datenbankserver für die Verbindung, oder Sie einfach zu vermeiden, dass die Datenbank einen Datenbank-Server hinzufügen möchten, möchten, können Sie die SQL Server 2005 Express Edition-Version der Northwind-Datenbank verwenden, die in der heruntergeladenen Website befindet. e's **App\_Daten** Ordner (**NORTHWND. MDF-Datei**).</span><span class="sxs-lookup"><span data-stu-id="cb9e7-140">If you do not have a SQL Server 2000 or 2005 database server to connect to, or you simply want to avoid having to add the database to a database server, you can use the SQL Server 2005 Express Edition version of the Northwind database that is located in the downloaded website's **App\_Data** folder (**NORTHWND.MDF**).</span></span>

<span data-ttu-id="cb9e7-141">Eine Datenbank platziert werden, der **App\_Daten** Ordner wird im Server-Explorer automatisch hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-141">A database placed in the **App\_Data** folder is automatically added to the Server Explorer.</span></span> <span data-ttu-id="cb9e7-142">Vorausgesetzt, dass Sie SQL Server 2005 Express Edition auf Ihrem Computer installiert haben, sollten Sie einen Knoten namens NORTHWND sehen. MDF-Datei im Server-Explorer, die Sie erweitern können, und untersuchen die Tabellen, Ansichten, gespeicherten Prozeduren, und So weiter (siehe Abbildung 2).</span><span class="sxs-lookup"><span data-stu-id="cb9e7-142">Assuming you have SQL Server 2005 Express Edition installed on your machine you should see a node named NORTHWND.MDF in the Server Explorer, which you can expand and explore its tables, views, stored procedure, and so on (see Figure 2).</span></span>

<span data-ttu-id="cb9e7-143">Die **App\_Daten** Ordner kann auch Microsoft Access enthalten **MDB** -Dateien, die, wie sein Gegenstück in SQL Server im Server-Explorer automatisch hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-143">The **App\_Data** folder can also hold Microsoft Access **.mdb** files, which, like their SQL Server counterparts, are automatically added to the Server Explorer.</span></span> <span data-ttu-id="cb9e7-144">Wenn Sie nicht die SQL Server-Optionen verwenden möchten, können Sie immer [Laden Sie eine Microsoft Access-Version der Northwind-Datenbankdatei](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) und drop in die **App\_Daten** Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-144">If you don't want to use any of the SQL Server options, you can always [download a Microsoft Access version of the Northwind database file](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) and drop into the **App\_Data** directory.</span></span> <span data-ttu-id="cb9e7-145">Merken Sie jedoch, die nicht von Access-Datenbanken als Funktionsumfang wie SQL Server, und werden nicht in Website-Szenarien verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-145">Keep in mind, however, that Access databases aren't as feature-rich as SQL Server, and aren't designed to be used in web site scenarios.</span></span> <span data-ttu-id="cb9e7-146">Darüber hinaus werden eine Reihe von 35-Lernprogramme bestimmte Funktionen auf Datenbankebene verwendet, die durch den Zugriff nicht unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-146">Furthermore, a couple of the 35+ tutorials will utilize certain database-level features that aren't supported by Access.</span></span>

## <a name="connecting-to-the-database-in-a-microsoft-sql-server-2000-or-2005-database-server"></a><span data-ttu-id="cb9e7-147">Herstellen einer Verbindung mit der Datenbank auf einem Microsoft SQL Server 2000 oder 2005-Datenbankserver</span><span class="sxs-lookup"><span data-stu-id="cb9e7-147">Connecting to the Database in a Microsoft SQL Server 2000 or 2005 Database Server</span></span>

<span data-ttu-id="cb9e7-148">Alternativ können Sie mit einer Northwind-Datenbank auf einem Datenbankserver installiert verbinden.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-148">Alternatively, you may connect to a Northwind database installed on a database server.</span></span> <span data-ttu-id="cb9e7-149">Wenn der Datenbankserver nicht bereits über die installierte Northwind-Datenbank verfügt, zunächst müssen Sie hinzufügen es mit Datenbank-Server durch Ausführen des Installations-Skripts, die in diesem Tutorial herunterladen oder von [Herunterladen der SQL Server 2000-Version von Northwind und das Installationsskript](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) direkt aus der Microsoft-Website.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-149">If the database server does not already have the Northwind database installed, you first must add it to database server by running the installation script included in this tutorial's download or by [downloading the SQL Server 2000 version of Northwind and installation script](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) directly from Microsoft's web site.</span></span>

<span data-ttu-id="cb9e7-150">Nachdem Sie die Datenbank installiert haben, wechseln Sie zum Server-Explorer in Visual Studio, mit der Maustaste, auf den Knoten "Datenverbindungen" aus, und wählen die Verbindung hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-150">Once you have the database installed, go to the Server Explorer in Visual Studio, right-click on the Data Connections node, and choose Add Connection.</span></span> <span data-ttu-id="cb9e7-151">Wenn Sie nicht sehen, dass der Server-Explorer navigieren / Server-Explorer oder Strg + Alt + S drücken.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-151">If you don't see the Server Explorer go to the View / Server Explorer, or hit Ctrl+Alt+S.</span></span> <span data-ttu-id="cb9e7-152">Hierdurch wird das Dialogfeld "Verbindung hinzufügen", dort Sie den Server für die Verbindung angeben können, die Authentifizierungsinformationen, und der Name der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-152">This will bring up the Add Connection dialog box, where you can specify the server to connect to, the authentication information, and the database name.</span></span> <span data-ttu-id="cb9e7-153">Nachdem Sie erfolgreich die Datenbankverbindungsinformationen konfiguriert und auf die Schaltfläche "OK" geklickt haben, wird die Datenbank als Knoten unter dem Knoten "Datenverbindungen" hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-153">Once you have successfully configured the database connection information and clicked the OK button, the database will be added as a node underneath the Data Connections node.</span></span> <span data-ttu-id="cb9e7-154">Sie können den Datenbankknoten, um die Tabellen, Sichten, gespeicherte Prozeduren und So weiter zu untersuchen, erweitern.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-154">You can expand the database node to explore its tables, views, stored procedures, and so on.</span></span>


![Hinzufügen einer Verbindung mit Ihrem Datenbankserver Northwind-Datenbank](creating-a-data-access-layer-cs/_static/image4.png)

<span data-ttu-id="cb9e7-156">**Abbildung 2**: Hinzufügen einer Verbindung mit Ihrem Datenbankserver Northwind-Datenbank</span><span class="sxs-lookup"><span data-stu-id="cb9e7-156">**Figure 2**: Add a Connection to Your Database Server's Northwind Database</span></span>


## <a name="step-2-creating-the-data-access-layer"></a><span data-ttu-id="cb9e7-157">Schritt 2: Erstellen der Datenzugriffsebene</span><span class="sxs-lookup"><span data-stu-id="cb9e7-157">Step 2: Creating the Data Access Layer</span></span>

<span data-ttu-id="cb9e7-158">Bei der Arbeit mit ist eine Option für die Daten der Logik Daten direkt in der Darstellungsschicht (in einer Webanwendung, die ASP.NET Seiten bilden die Darstellungsschicht) einbetten.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-158">When working with data one option is to embed the data-specific logic directly into the presentation layer (in a web application, the ASP.NET pages make up the presentation layer).</span></span> <span data-ttu-id="cb9e7-159">Dies dauert Form ADO.NET-Code schreiben, in die ASP.NET-Seite Codeteil oder das SqlDataSource-Steuerelement aus dem Markup-Bereich verwenden.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-159">This may take the form of writing ADO.NET code in the ASP.NET page's code portion or using the SqlDataSource control from the markup portion.</span></span> <span data-ttu-id="cb9e7-160">In beiden Fällen koppelt dieser Ansatz eng an die Datenzugriffslogik der Darstellungsschicht.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-160">In either case, this approach tightly couples the data access logic with the presentation layer.</span></span> <span data-ttu-id="cb9e7-161">Die empfohlene Vorgehensweise, ist jedoch die Datenzugriffslogik von der Darstellungsschicht zu trennen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-161">The recommended approach, however, is to separate the data access logic from the presentation layer.</span></span> <span data-ttu-id="cb9e7-162">Diese separate Ebene wird als der Data Access Layer, DAL kurz, bezeichnet und wird in der Regel als ein separates Klassenbibliotheksprojekt implementiert.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-162">This separate layer is referred to as the Data Access Layer, DAL for short, and is typically implemented as a separate Class Library project.</span></span> <span data-ttu-id="cb9e7-163">Die Vorteile dieser Schichtenarchitektur sind gut dokumentiert (siehe Abschnitt "Weitere Literatur" am Ende dieses Tutorials für Informationen zu diesen Vorteilen) und ist der Ansatz, die wir in dieser Serie übernehmen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-163">The benefits of this layered architecture are well documented (see the "Further Readings" section at the end of this tutorial for information on these advantages) and is the approach we will take in this series.</span></span>

<span data-ttu-id="cb9e7-164">Sämtlicher Code, der für die zugrunde liegende Datenquelle z. B. das Erstellen einer Verbindungs mit der Datenbank ausgeben **wählen**, **einfügen**, **UPDATE**, und  **Löschen Sie** Befehle usw. sollten sich in der DAL befinden.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-164">All code that is specific to the underlying data source such as creating a connection to the database, issuing **SELECT**, **INSERT**, **UPDATE**, and **DELETE** commands, and so on should be located in the DAL.</span></span> <span data-ttu-id="cb9e7-165">Die Darstellungsschicht alle Verweise auf solche Datenzugriffscode sollte nicht enthalten, jedoch sollten Sie stattdessen Aufrufe in die DAL für alle Anforderungen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-165">The presentation layer should not contain any references to such data access code, but should instead make calls into the DAL for any and all data requests.</span></span> <span data-ttu-id="cb9e7-166">Datenzugriffsschichten enthalten normalerweise die Methoden für den Zugriff auf die zugrunde liegenden Datenbankdaten.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-166">Data Access Layers typically contain methods for accessing the underlying database data.</span></span> <span data-ttu-id="cb9e7-167">Die Northwind-Datenbank verfügt beispielsweise über **Produkte** und **Kategorien** Tabellen, mit denen die Produkte für den Verkauf und die Kategorien, zu dem sie gehören.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-167">The Northwind database, for example, has **Products** and **Categories** tables that record the products for sale and the categories to which they belong.</span></span> <span data-ttu-id="cb9e7-168">In der DAL verfügen wir Methoden wie z.B.:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-168">In our DAL we will have methods like:</span></span>

- <span data-ttu-id="cb9e7-169">**GetCategories(),** wodurch Informationen für alle Kategorien</span><span class="sxs-lookup"><span data-stu-id="cb9e7-169">**GetCategories(),** which will return information about all of the categories</span></span>
- <span data-ttu-id="cb9e7-170">**GetProducts()**, wodurch Informationen für alle Produkte</span><span class="sxs-lookup"><span data-stu-id="cb9e7-170">**GetProducts()**, which will return information about all of the products</span></span>
- <span data-ttu-id="cb9e7-171">**GetProductsByCategoryID (*CategoryID*)**, wodurch alle Produkte, die eine angegebene Kategorie angehören,</span><span class="sxs-lookup"><span data-stu-id="cb9e7-171">**GetProductsByCategoryID(*categoryID*)**, which will return all products that belong to a specified category</span></span>
- <span data-ttu-id="cb9e7-172">**GetProductByProductID (*"ProductID"*)**, die Informationen zu einem bestimmten Produkt zurück</span><span class="sxs-lookup"><span data-stu-id="cb9e7-172">**GetProductByProductID(*productID*)**, which will return information about a particular product</span></span>

<span data-ttu-id="cb9e7-173">Diese Methoden, wenn aufgerufen, werden eine Verbindung mit der Datenbank herstellen, geben Sie die entsprechende Abfrage und die Ergebnisse zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-173">These methods, when invoked, will connect to the database, issue the appropriate query, and return the results.</span></span> <span data-ttu-id="cb9e7-174">Es ist wichtig, wie wir diese Ergebnisse zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-174">How we return these results is important.</span></span> <span data-ttu-id="cb9e7-175">Diese Methoden können einfach zurückgeben, ein DataSet oder eine DataReader, die von der Datenbankabfrage gefüllt, aber im Idealfall diese Ergebnisse zurückgegeben werden sollen mit *stark typisierte Objekte*.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-175">These methods could simply return a DataSet or DataReader populated by the database query, but ideally these results should be returned using *strongly-typed objects*.</span></span> <span data-ttu-id="cb9e7-176">Ein stark typisiertes Objekt ist fest, deren Schema zum Zeitpunkt der Kompilierung definiert wird, während das Gegenteil, ein lose typisiertes Objekt, einer ist, deren Schema erst zur Laufzeit nicht bekannt ist.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-176">A strongly-typed object is one whose schema is rigidly defined at compile time, whereas the opposite, a loosely-typed object, is one whose schema is not known until runtime.</span></span>

<span data-ttu-id="cb9e7-177">Beispielsweise sind den DataReader und DataSet (standardmäßig) lose typisierte Objekte, da ihr Schema durch die von der Datenbankabfrage verwendet, um sie aufzufüllen zurückgegebenen Spalten definiert wird.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-177">For example, the DataReader and the DataSet (by default) are loosely-typed objects since their schema is defined by the columns returned by the database query used to populate them.</span></span> <span data-ttu-id="cb9e7-178">Auf eine bestimmte Spalte einer lose typisierte DataTable wir verwenden eine Syntax wie müssen:  <strong><em>DataTable</em>. Zeilen [<em>Index</em>] ["<em>ColumnName</em>"]</strong>.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-178">To access a particular column from a loosely-typed DataTable we need to use syntax like: <strong><em>DataTable</em>.Rows[<em>index</em>]["<em>columnName</em>"]</strong>.</span></span> <span data-ttu-id="cb9e7-179">Der DataTable lose typbindung, in diesem Beispiel wird durch die Tatsache zu verzeichnen, die den Spaltennamen, die mit einer Zeichenfolge oder Ordinalindex zugreifen müssen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-179">The DataTable's loose typing in this example is exhibited by the fact that we need to access the column name using a string or ordinal index.</span></span> <span data-ttu-id="cb9e7-180">Eine stark typisierte DataTable andererseits, müssen alle zugehörigen Spalten, die als Eigenschaften implementiert im Code, der aussieht wie resultierende:  <strong><em>DataTable</em>. Zeilen [<em>Index</em>]. *ColumnName</strong>*.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-180">A strongly-typed DataTable, on the other hand, will have each of its columns implemented as properties, resulting in code that looks like: <strong><em>DataTable</em>.Rows[<em>index</em>].*columnName</strong>*.</span></span>

<span data-ttu-id="cb9e7-181">Um stark typisierte Objekte zurückzugeben, können Entwickler eigene benutzerdefinierte Business-Objekte erstellen oder Verwenden von typisierten DataSets.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-181">To return strongly-typed objects, developers can either create their own custom business objects or use Typed DataSets.</span></span> <span data-ttu-id="cb9e7-182">Ein Geschäftsobjekt wird vom Entwickler implementiert, wie eine Klasse, deren Eigenschaften in der Regel die Spalten der zugrunde liegenden Datenbanktabelle das Geschäftsobjekt, das entsprechend, darstellt.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-182">A business object is implemented by the developer as a class whose properties typically reflect the columns of the underlying database table the business object represents.</span></span> <span data-ttu-id="cb9e7-183">Eine typisierte DataSet ist eine Klasse, die von Visual Studio auf der Grundlage eines Datenbankschemas und, deren Mitglieder fester typbindung gemäß diesem Schema sind für Sie generiert.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-183">A Typed DataSet is a class generated for you by Visual Studio based on a database schema and whose members are strongly-typed according to this schema.</span></span> <span data-ttu-id="cb9e7-184">Das typisierte DataSet selbst besteht aus Klassen, die ADO.NET DataSet-, DataTable- und DataRow-Klassen zu erweitern.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-184">The Typed DataSet itself consists of classes that extend the ADO.NET DataSet, DataTable, and DataRow classes.</span></span> <span data-ttu-id="cb9e7-185">Zusätzlich zu stark typisierte DataTable umfassen typisierter DataSets nun auch TableAdapters, die Klassen mit Methoden zum Auffüllen Datasetss, DataTables und das Weitergeben von Änderungen am vorhandenen DataTables an die Datenbank sind.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-185">In addition to strongly-typed DataTables, Typed DataSets now also include TableAdapters, which are classes with methods for populating the DataSet's DataTables and propagating modifications within the DataTables back to the database.</span></span>

> [!NOTE]
> <span data-ttu-id="cb9e7-186">Weitere Informationen zu den vor- und Nachteile der Verwendung von typisierten DataSets im Vergleich zu benutzerdefinierten Geschäftsobjekte, finden Sie unter [Datenschichtenkomponenten entwerfen und die Übergabe über Datenebenen](https://msdn.microsoft.com/library/ms978496.aspx).</span><span class="sxs-lookup"><span data-stu-id="cb9e7-186">For more information on the advantages and disadvantages of using Typed DataSets versus custom business objects, refer to [Designing Data Tier Components and Passing Data Through Tiers](https://msdn.microsoft.com/library/ms978496.aspx).</span></span>


<span data-ttu-id="cb9e7-187">Wir verwenden die stark typisierte DataSets für diese Tutorials Architektur.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-187">We'll use strongly-typed DataSets for these tutorials' architecture.</span></span> <span data-ttu-id="cb9e7-188">Abbildung 3 zeigt den Workflow zwischen den verschiedenen Ebenen einer Anwendung, die typisierte DataSets verwendet.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-188">Figure 3 illustrates the workflow between the different layers of an application that uses Typed DataSets.</span></span>


<span data-ttu-id="cb9e7-189">[![Alle Data Access Code wird an die DAL verwiesen.](creating-a-data-access-layer-cs/_static/image6.png)](creating-a-data-access-layer-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-189">[![All Data Access Code is Relegated to the DAL](creating-a-data-access-layer-cs/_static/image6.png)](creating-a-data-access-layer-cs/_static/image5.png)</span></span>

<span data-ttu-id="cb9e7-190">**Abbildung 3**: alle Data Access Code verwiesen wird, an die DAL ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-190">**Figure 3**: All Data Access Code is Relegated to the DAL ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image7.png))</span></span>


## <a name="creating-a-typed-dataset-and-table-adapter"></a><span data-ttu-id="cb9e7-191">Erstellen eines typisierten Datasets und die Tabellenadapter</span><span class="sxs-lookup"><span data-stu-id="cb9e7-191">Creating a Typed DataSet and Table Adapter</span></span>

<span data-ttu-id="cb9e7-192">Um zu beginnen, erstellen die DAL, zunächst das Projekt ein typisiertes DataSet hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-192">To begin creating our DAL, we start by adding a Typed DataSet to our project.</span></span> <span data-ttu-id="cb9e7-193">Zu diesem Zweck mit der rechten Maustaste auf den Projektknoten im Projektmappen-Explorer, und wählen Sie ein neues Element hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-193">To accomplish this, right-click on the project node in the Solution Explorer and choose Add a New Item.</span></span> <span data-ttu-id="cb9e7-194">Wählen Sie die Option für die Datasets aus der Liste der Vorlagen, und nennen Sie sie **Northwind.xsd**.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-194">Select the DataSet option from the list of templates and name it **Northwind.xsd**.</span></span>


<span data-ttu-id="cb9e7-195">[![Wählen Sie Ihr Projekt ein neues DataSet hinzu](creating-a-data-access-layer-cs/_static/image9.png)](creating-a-data-access-layer-cs/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-195">[![Choose to Add a New DataSet to Your Project](creating-a-data-access-layer-cs/_static/image9.png)](creating-a-data-access-layer-cs/_static/image8.png)</span></span>

<span data-ttu-id="cb9e7-196">**Abbildung 4**: Wählen Sie Ihr Projekt ein neues DataSet hinzu ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-196">**Figure 4**: Choose to Add a New DataSet to Your Project ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image10.png))</span></span>


<span data-ttu-id="cb9e7-197">Nach dem Klicken auf "Add", wenn Sie aufgefordert werden, um das DataSet, das Hinzufügen der **App\_Code** Ordner, wählen Sie "Ja".</span><span class="sxs-lookup"><span data-stu-id="cb9e7-197">After clicking Add, when prompted to add the DataSet to the **App\_Code** folder, choose Yes.</span></span> <span data-ttu-id="cb9e7-198">Klicken Sie dann der Designer für typisierte Datasets angezeigt, und den TableAdapter-Konfigurations-Assistenten startet, sodass Sie Ihre erste TableAdapter mit dem typisierten DataSet hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-198">The Designer for the Typed DataSet will then be displayed, and the TableAdapter Configuration Wizard will start, allowing you to add your first TableAdapter to the Typed DataSet.</span></span>

<span data-ttu-id="cb9e7-199">Eine typisierte DataSet dient als stark typisierte Auflistung von Daten; Es besteht aus stark typisierte DataTable-Instanzen, von denen jeder wiederum stark typisierte DataRow-Instanzen besteht.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-199">A Typed DataSet serves as a strongly-typed collection of data; it is composed of strongly-typed DataTable instances, each of which is in turn composed of strongly-typed DataRow instances.</span></span> <span data-ttu-id="cb9e7-200">Wir erstellen eine stark typisierte DataTable für jede von der zugrunde liegenden Datenbanktabellen, die in dieser Reihe von Tutorials arbeiten müssen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-200">We will create a strongly-typed DataTable for each of the underlying database tables that we need to work with in this tutorials series.</span></span> <span data-ttu-id="cb9e7-201">Beginnen wir mit dem Erstellen einer DataTable für die **Produkte** Tabelle.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-201">Let's start with creating a DataTable for the **Products** table.</span></span>

<span data-ttu-id="cb9e7-202">Bedenken Sie, dass stark typisierte DataTable keine Informationen zum Zugriff auf Daten aus ihren zugrunde liegenden Datenbanktabelle beinhalten.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-202">Keep in mind that strongly-typed DataTables do not include any information on how to access data from their underlying database table.</span></span> <span data-ttu-id="cb9e7-203">Um die Daten zum Füllen der DataTable abzurufen, verwenden wir eine TableAdapter-Klasse, die Funktionen, wie unsere Data Access Layer.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-203">In order to retrieve the data to populate the DataTable, we use a TableAdapter class, which functions as our Data Access Layer.</span></span> <span data-ttu-id="cb9e7-204">Für unsere **Produkte** DataTable des TableAdapter enthält die Methoden **GetProducts()**, **GetProductByCategoryID (*CategoryID*)** und so weiter, die wir von der Darstellungsschicht aufrufen müssen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-204">For our **Products** DataTable, the TableAdapter will contain the methods **GetProducts()**, **GetProductByCategoryID(*categoryID*)**, and so on that we'll invoke from the presentation layer.</span></span> <span data-ttu-id="cb9e7-205">Der DataTable Rolle besteht darin, wie die stark typisierte Objekte, die zum Übergeben von Daten zwischen den Ebenen dienen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-205">The DataTable's role is to serve as the strongly-typed objects used to pass data between the layers.</span></span>

<span data-ttu-id="cb9e7-206">Zunächst, dass den TableAdapter-Konfigurations-Assistenten dazu aufgefordert, nach welcher Datenbank Sie arbeiten mit auswählen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-206">The TableAdapter Configuration Wizard begins by prompting you to select which database to work with.</span></span> <span data-ttu-id="cb9e7-207">Die Dropdown-Liste zeigt die Datenbanken im Server-Explorer.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-207">The drop-down list shows those databases in the Server Explorer.</span></span> <span data-ttu-id="cb9e7-208">Wenn Sie den Server-Explorer nicht die Datenbank Northwind hinzugefügt haben, können Sie die Schaltfläche neue Verbindung zu diesem Zeitpunkt zu diesem Zweck klicken.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-208">If you did not add the Northwind database to the Server Explorer, you can click the New Connection button at this time to do so.</span></span>


<span data-ttu-id="cb9e7-209">[![Wählen Sie die Northwind-Datenbank aus der Dropdown-Liste](creating-a-data-access-layer-cs/_static/image12.png)](creating-a-data-access-layer-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-209">[![Choose the Northwind Database from the Drop-Down List](creating-a-data-access-layer-cs/_static/image12.png)](creating-a-data-access-layer-cs/_static/image11.png)</span></span>

<span data-ttu-id="cb9e7-210">**Abbildung 5**: Wählen Sie die Northwind-Datenbank aus der Dropdown-Liste ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-210">**Figure 5**: Choose the Northwind Database from the Drop-Down List ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image13.png))</span></span>


<span data-ttu-id="cb9e7-211">Nachdem Sie die Datenbank auswählen und auf Weiter klicken, werden Sie aufgefordert, wenn Sie die Verbindungszeichenfolge in speichern möchten die **"Web.config"** Datei.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-211">After selecting the database and clicking Next, you'll be asked if you want to save the connection string in the **Web.config** file.</span></span> <span data-ttu-id="cb9e7-212">Durch Speichern der Verbindungszeichenfolge müssen Sie vermeiden, dass es schwer codiert in den TableAdapter-Klassen, die Dinge vereinfacht, wenn die Informationen zur Verbindungszeichenfolge in der Zukunft ändern.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-212">By saving the connection string you'll avoid having it hard coded in the TableAdapter classes, which simplifies things if the connection string information changes in the future.</span></span> <span data-ttu-id="cb9e7-213">Wenn Sie sich entscheiden, um die Verbindungszeichenfolge in der Konfigurationsdatei zu speichern. es befindet sich der **&lt;ConnectionStrings&gt;** Abschnitt möglich [optional verschlüsselte](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) für verbessert Sicherheit oder geänderte später über die neuen ASP.NET 2.0-Eigenschaftenseite innerhalb der IIS GUI-Verwaltungstool, handelt es sich besser für Administratoren ist.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-213">If you opt to save the connection string in the configuration file it's placed in the **&lt;connectionStrings&gt;** section, which can be [optionally encrypted](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) for improved security or modified later through the new ASP.NET 2.0 Property Page within the IIS GUI Admin Tool, which is more ideal for administrators.</span></span>


<span data-ttu-id="cb9e7-214">[![Speichern Sie die Verbindungszeichenfolge in "Web.config"](creating-a-data-access-layer-cs/_static/image15.png)](creating-a-data-access-layer-cs/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-214">[![Save the Connection String to Web.config](creating-a-data-access-layer-cs/_static/image15.png)](creating-a-data-access-layer-cs/_static/image14.png)</span></span>

<span data-ttu-id="cb9e7-215">**Abbildung 6**: Speichern der Verbindungszeichenfolge für **"Web.config"** ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-215">**Figure 6**: Save the Connection String to **Web.config** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image16.png))</span></span>


<span data-ttu-id="cb9e7-216">Als Nächstes müssen wir das Schema für die erste stark typisierte DataTable zu definieren, und geben Sie die erste Methode für unsere TableAdapter zu verwenden, wenn die stark typisierte DataSet zu füllen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-216">Next, we need to define the schema for the first strongly-typed DataTable and provide the first method for our TableAdapter to use when populating the strongly-typed DataSet.</span></span> <span data-ttu-id="cb9e7-217">Gleichzeitig werden diese beiden Schritte durchgeführt, durch das Erstellen einer Abfrage, die den Spalten aus der Tabelle zurückgegeben werden, dass in unserem DataTable wiedergegeben werden soll.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-217">These two steps are accomplished simultaneously by creating a query that returns the columns from the table that we want reflected in our DataTable.</span></span> <span data-ttu-id="cb9e7-218">Am Ende des Assistenten erhalten wir einen Methodennamen an dieser Abfrage.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-218">At the end of the wizard we'll give a method name to this query.</span></span> <span data-ttu-id="cb9e7-219">Nach, die durchgeführt wird, kann diese Methode auf unsere Darstellungsschicht aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-219">Once that's been accomplished, this method can be invoked from our presentation layer.</span></span> <span data-ttu-id="cb9e7-220">Die Methode wird die definierte Abfrage auszuführen und eine stark typisierte DataTable füllen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-220">The method will execute the defined query and populate a strongly-typed DataTable.</span></span>

<span data-ttu-id="cb9e7-221">Informationen zum Einstieg in die Definition der SQL-Abfrage müssen wir zuerst angeben, wie soll den TableAdapter zum Ausstellen von der Abfrage.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-221">To get started defining the SQL query we must first indicate how we want the TableAdapter to issue the query.</span></span> <span data-ttu-id="cb9e7-222">Wir können eine Ad-hoc-SQL-Anweisung verwenden, erstellen eine neue gespeicherte Prozedur oder eine vorhandene gespeicherte Prozedur verwenden.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-222">We can use an ad-hoc SQL statement, create a new stored procedure, or use an existing stored procedure.</span></span> <span data-ttu-id="cb9e7-223">Für diese Tutorials verwenden wir die Ad-hoc-SQL-Anweisungen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-223">For these tutorials we'll use ad-hoc SQL statements.</span></span> <span data-ttu-id="cb9e7-224">Finden Sie unter [Brian Noyes](http://briannoyes.net/)des Artikel [Erstellen einer Datenzugriffsschicht mit der DataSet-Designer von Visual Studio 2005](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) ein Beispiel für die Verwendung von gespeicherten Prozeduren.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-224">Refer to [Brian Noyes](http://briannoyes.net/)'s article, [Build a Data Access Layer with the Visual Studio 2005 DataSet Designer](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) for an example of using stored procedures.</span></span>


<span data-ttu-id="cb9e7-225">[![Daten Sie die mithilfe einer Ad-hoc-SQL-Anweisung](creating-a-data-access-layer-cs/_static/image18.png)](creating-a-data-access-layer-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-225">[![Query the Data Using an Ad-Hoc SQL Statement](creating-a-data-access-layer-cs/_static/image18.png)](creating-a-data-access-layer-cs/_static/image17.png)</span></span>

<span data-ttu-id="cb9e7-226">**Abbildung 7**: Abfragen der Daten, die mit Ad-hoc-SQL-Anweisungen ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-226">**Figure 7**: Query the Data Using an Ad-Hoc SQL Statement ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image19.png))</span></span>


<span data-ttu-id="cb9e7-227">An diesem Punkt können wir in der SQL-Abfrage von hand eingeben.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-227">At this point we can type in the SQL query by hand.</span></span> <span data-ttu-id="cb9e7-228">Wenn Sie die erste Methode in der TableAdapter erstellen sollen in der Regel, die Abfrage diese Spalten zurück, die in die entsprechende DataTable ausgedrückt werden müssen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-228">When creating the first method in the TableAdapter you typically want to have the query return those columns that need to be expressed in the corresponding DataTable.</span></span> <span data-ttu-id="cb9e7-229">Wir erreichen dies durch Erstellen einer Abfrage, die alle Spalten und alle Zeilen aus, gibt die **Produkte** Tabelle:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-229">We can accomplish this by creating a query that returns all columns and all rows from the **Products** table:</span></span>


<span data-ttu-id="cb9e7-230">[![Geben Sie die SQL-Abfrage in das Textfeld ein](creating-a-data-access-layer-cs/_static/image21.png)](creating-a-data-access-layer-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-230">[![Enter the SQL Query Into the Textbox](creating-a-data-access-layer-cs/_static/image21.png)](creating-a-data-access-layer-cs/_static/image20.png)</span></span>

<span data-ttu-id="cb9e7-231">**Abbildung 8**: Geben Sie die SQL-Abfrage in das Textfeld ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-231">**Figure 8**: Enter the SQL Query Into the Textbox ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image22.png))</span></span>


<span data-ttu-id="cb9e7-232">Klicken Sie alternativ verwenden Sie den Abfrage-Generator, und erstellen Sie die Abfrage grafisch zu, wie in Abbildung 9 gezeigt.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-232">Alternatively, use the Query Builder and graphically construct the query, as shown in Figure 9.</span></span>


<span data-ttu-id="cb9e7-233">[![Erstellen Sie die Abfrage grafisch dargestellt, über den Abfrage-Editor](creating-a-data-access-layer-cs/_static/image24.png)](creating-a-data-access-layer-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-233">[![Create the Query Graphically, through the Query Editor](creating-a-data-access-layer-cs/_static/image24.png)](creating-a-data-access-layer-cs/_static/image23.png)</span></span>

<span data-ttu-id="cb9e7-234">**Abbildung 9**: Erstellen der Abfrage grafisch dargestellt, über den Abfrage-Editor ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-234">**Figure 9**: Create the Query Graphically, through the Query Editor ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image25.png))</span></span>


<span data-ttu-id="cb9e7-235">Nach dem Erstellen der Abfrage, aber bevor Sie fortfahren mit dem nächsten Bildschirm klicken Sie auf die Schaltfläche "Erweiterte Optionen".</span><span class="sxs-lookup"><span data-stu-id="cb9e7-235">After creating the query, but before moving onto the next screen, click the Advanced Options button.</span></span> <span data-ttu-id="cb9e7-236">In Projekten auf Website ist "Generate INSERT-, Update- und Delete-Anweisungen die einzige erweiterte Optionen, die standardmäßig aktiviert; Wenn Sie diesen Assistenten aus einer Klassenbibliothek oder ein Windows-Projekt ausführen wird auch die Option "Vollständigen Parallelität verwenden" ausgewählt werden.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-236">In Web Site Projects, "Generate Insert, Update, and Delete statements" is the only advanced option selected by default; if you run this wizard from a Class Library or a Windows Project the "Use optimistic concurrency" option will also be selected.</span></span> <span data-ttu-id="cb9e7-237">Lassen Sie die Option "Verwenden von optimistischer Parallelität" jetzt deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-237">Leave the "Use optimistic concurrency" option unchecked for now.</span></span> <span data-ttu-id="cb9e7-238">In zukünftigen Lernprogrammen untersuchen wir die vollständigen Parallelität.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-238">We'll examine optimistic concurrency in future tutorials.</span></span>


<span data-ttu-id="cb9e7-239">[![Wählen Sie nur die generieren Insert, Update und Delete-Anweisungen Option](creating-a-data-access-layer-cs/_static/image27.png)](creating-a-data-access-layer-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-239">[![Select Only the Generate Insert, Update, and Delete statements Option](creating-a-data-access-layer-cs/_static/image27.png)](creating-a-data-access-layer-cs/_static/image26.png)</span></span>

<span data-ttu-id="cb9e7-240">**Abbildung 10**: Wählen Sie nur die generieren Insert, Update und Delete-Anweisungen Option ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-240">**Figure 10**: Select Only the Generate Insert, Update, and Delete statements Option ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image28.png))</span></span>


<span data-ttu-id="cb9e7-241">Klicken Sie nachdem Sie überprüft haben, die erweiterten Optionen auf Weiter, um mit dem letzten Bildschirm fortfahren.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-241">After verifying the advanced options, click Next to proceed to the final screen.</span></span> <span data-ttu-id="cb9e7-242">Hier sind wir dazu aufgefordert, wählen Sie die Methoden des TableAdapter hinzu.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-242">Here we are asked to select which methods to add to the TableAdapter.</span></span> <span data-ttu-id="cb9e7-243">Es gibt zwei Muster zum Auffüllen von Daten:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-243">There are two patterns for populating data:</span></span>

- <span data-ttu-id="cb9e7-244">**DataTable füllen** bei diesem Ansatz wird eine Methode erstellt, die in einer Datentabelle als Parameter akzeptiert und füllt anhand der Ergebnisse der Abfrage.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-244">**Fill a DataTable** with this approach a method is created that takes in a DataTable as a parameter and populates it based on the results of the query.</span></span> <span data-ttu-id="cb9e7-245">Die ADO.NET DataAdapter-Klasse, z. B. implementiert dieses Muster mit der **Fill()** Methode.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-245">The ADO.NET DataAdapter class, for example, implements this pattern with its **Fill()** method.</span></span>
- <span data-ttu-id="cb9e7-246">**DataTable zurückgeben** bei diesem Ansatz die Methode erstellt und füllt die DataTable für Sie aus, und gibt zurück, wie die Methoden Wert zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-246">**Return a DataTable** with this approach the method creates and fills the DataTable for you and returns it as the methods return value.</span></span>

<span data-ttu-id="cb9e7-247">Sie können den TableAdapter, implementieren Sie eine oder beide dieser Muster verwenden.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-247">You can have the TableAdapter implement one or both of these patterns.</span></span> <span data-ttu-id="cb9e7-248">Sie können auch die Methoden, die hier bereitgestellten umbenennen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-248">You can also rename the methods provided here.</span></span> <span data-ttu-id="cb9e7-249">Lassen Sie beide Kontrollkästchen aktiviert ist, lassen Sie uns, obwohl wir nur das zweite Muster für die gesamte in diesen Tutorials verwenden.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-249">Let's leave both checkboxes checked, even though we'll only be using the latter pattern throughout these tutorials.</span></span> <span data-ttu-id="cb9e7-250">Darüber hinaus wir benennen die Recht generischen **GetData** Methode, um **GetProducts**.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-250">Also, let's rename the rather generic **GetData** method to **GetProducts**.</span></span>

<span data-ttu-id="cb9e7-251">Wenn dieses Kontrollkästchen aktiviert, erstellt das letzte Kontrollkästchen "GenerateDBDirectMethods," **Insert()**, **Update()**, und **Delete()** Methoden für den TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-251">If checked, the final checkbox, "GenerateDBDirectMethods," creates **Insert()**, **Update()**, and **Delete()** methods for the TableAdapter.</span></span> <span data-ttu-id="cb9e7-252">Wenn Sie diese Option deaktiviert lassen, müssen alle Updates über die TableAdapter Sole **Update()** Methode, die in typisierten Datasets, einer "DataTable", einer einzelnen DataRow oder ein Array von DataRows verwendet.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-252">If you leave this option unchecked, all updates will need to be done through the TableAdapter's sole **Update()** method, which takes in the Typed DataSet, a DataTable, a single DataRow, or an array of DataRows.</span></span> <span data-ttu-id="cb9e7-253">(Haben deaktiviert die "Generate INSERT-, Update- und Delete-Anweisungen" option die erweiterten Eigenschaften in Abbildung 9 dieses Kontrollkästchen, die Einstellung hat keine Auswirkungen.) Wir lassen Sie dieses Kontrollkästchen aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-253">(If you've unchecked the "Generate Insert, Update, and Delete statements" option from the advanced properties in Figure 9 this checkbox's setting will have no effect.) Let's leave this checkbox selected.</span></span>


<span data-ttu-id="cb9e7-254">[![Ändern Sie den Methodennamen von GetData auf GetProducts](creating-a-data-access-layer-cs/_static/image30.png)](creating-a-data-access-layer-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-254">[![Change the Method Name from GetData to GetProducts](creating-a-data-access-layer-cs/_static/image30.png)](creating-a-data-access-layer-cs/_static/image29.png)</span></span>

<span data-ttu-id="cb9e7-255">**Abbildung 11**: Ändern Sie den Methodennamen aus **GetData** zu **GetProducts** ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-255">**Figure 11**: Change the Method Name from **GetData** to **GetProducts** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image31.png))</span></span>


<span data-ttu-id="cb9e7-256">Schließen Sie den Assistenten, indem Sie auf "Fertig stellen".</span><span class="sxs-lookup"><span data-stu-id="cb9e7-256">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="cb9e7-257">Nach dem Schließen des Assistenten werden wir dem DataSet-Designer zurückgegeben, die DataTable anzeigt, dass wir gerade erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-257">After the wizard closes we are returned to the DataSet Designer which shows the DataTable we just created.</span></span> <span data-ttu-id="cb9e7-258">Sehen Sie die Liste der Spalten in der **Produkte** DataTable (**"ProductID"**, **ProductName**und so weiter), sowie die Methoden von der  **ProductsTableAdapter** (**Fill()** und **GetProducts()**).</span><span class="sxs-lookup"><span data-stu-id="cb9e7-258">You can see the list of columns in the **Products** DataTable (**ProductID**, **ProductName**, and so on), as well as the methods of the **ProductsTableAdapter** (**Fill()** and **GetProducts()**).</span></span>


<span data-ttu-id="cb9e7-259">[![Die Produkte DataTable und ProductsTableAdapter wurden für das typisierte DataSet hinzugefügt](creating-a-data-access-layer-cs/_static/image33.png)](creating-a-data-access-layer-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-259">[![The Products DataTable and ProductsTableAdapter have been Added to the Typed DataSet](creating-a-data-access-layer-cs/_static/image33.png)](creating-a-data-access-layer-cs/_static/image32.png)</span></span>

<span data-ttu-id="cb9e7-260">**Abbildung 12**: die **Produkte** DataTable und **ProductsTableAdapter** das typisierte DataSet hinzugefügt wurden ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-260">**Figure 12**: The **Products** DataTable and **ProductsTableAdapter** have been Added to the Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image34.png))</span></span>


<span data-ttu-id="cb9e7-261">An diesem Punkt haben wir eine typisierte DataSet mit einer einzelnen Datentabelle (**Northwind.Products**) und eine stark typisierte DataAdapter-Klasse (**NorthwindTableAdapters.ProductsTableAdapter**) mit einem  **GetProducts()** Methode.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-261">At this point we have a Typed DataSet with a single DataTable (**Northwind.Products**) and a strongly-typed DataAdapter class (**NorthwindTableAdapters.ProductsTableAdapter**) with a **GetProducts()** method.</span></span> <span data-ttu-id="cb9e7-262">Diese Objekte können verwendet werden, Code wie eine Liste aller Produkte auf:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-262">These objects can be used to access a list of all products from code like:</span></span>

[!code-html[Main](creating-a-data-access-layer-cs/samples/sample1.html)]

<span data-ttu-id="cb9e7-263">Dieser Code war nicht erforderlich, eine Data Access spezifischen Code schreiben.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-263">This code did not require us to write one bit of data access-specific code.</span></span> <span data-ttu-id="cb9e7-264">Wir mussten keine Klassen von ADO.NET zu instanziieren, vorliegenden nicht zum Verweisen auf alle Verbindungszeichenfolgen, SQL-Abfragen oder gespeicherte Prozeduren.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-264">We did not have to instantiate any ADO.NET classes, we didn't have to refer to any connection strings, SQL queries, or stored procedures.</span></span> <span data-ttu-id="cb9e7-265">Stattdessen stellt der TableAdapter auf niedriger Ebene Datenzugriffscode für uns.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-265">Instead, the TableAdapter provides the low-level data access code for us.</span></span>

<span data-ttu-id="cb9e7-266">Jedes Objekt, das in diesem Beispiel verwendeten ist auch eine stark typisierte, ermöglicht Visual Studio IntelliSense und die typüberprüfung zur Kompilierzeit angeben.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-266">Each object used in this example is also strongly-typed, allowing Visual Studio to provide IntelliSense and compile-time type checking.</span></span> <span data-ttu-id="cb9e7-267">Und alle Datentabellen, die dem TableAdapter vom besten auf Daten der ASP.NET Web-Steuerelemente, z. B. GridView, DetailsView, DropDownList, "CheckBoxList" und verschiedene andere gebunden werden können.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-267">And best of all the DataTables returned by the TableAdapter can be bound to ASP.NET data Web controls, such as the GridView, DetailsView, DropDownList, CheckBoxList, and several others.</span></span> <span data-ttu-id="cb9e7-268">Das folgende Beispiel veranschaulicht das Binden von zurückgegebene DataTable der **GetProducts()** Methode, um nur eine mangelnder drei Codezeilen in einer GridView-Ansicht der **Seite\_Load** -Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-268">The following example illustrates binding the DataTable returned by the **GetProducts()** method to a GridView in just a scant three lines of code within the **Page\_Load** event handler.</span></span>

<span data-ttu-id="cb9e7-269">AllProducts.aspx</span><span class="sxs-lookup"><span data-stu-id="cb9e7-269">AllProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample2.aspx)]

<span data-ttu-id="cb9e7-270">AllProducts.aspx.cs</span><span class="sxs-lookup"><span data-stu-id="cb9e7-270">AllProducts.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample3.cs)]


<span data-ttu-id="cb9e7-271">[![Die Liste der Produkte wird in einer GridView-Ansicht angezeigt.](creating-a-data-access-layer-cs/_static/image36.png)](creating-a-data-access-layer-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-271">[![The List of Products is Displayed in a GridView](creating-a-data-access-layer-cs/_static/image36.png)](creating-a-data-access-layer-cs/_static/image35.png)</span></span>

<span data-ttu-id="cb9e7-272">**Abbildung 13**: die Liste der Produkte in einer GridView-Ansicht angezeigt wird ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-272">**Figure 13**: The List of Products is Displayed in a GridView ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image37.png))</span></span>


<span data-ttu-id="cb9e7-273">In diesem Beispiel erforderlich, dass wir in unserer ASP.NET-Seite drei Codezeilen schreiben **Seite\_Load** -Ereignishandler, in Zukunft Lernprogramme, die untersucht, wie Sie mit dem ObjectDataSource-Steuerelement deklarativ Abrufen der Daten aus der DAL.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-273">While this example required that we write three lines of code in our ASP.NET page's **Page\_Load** event handler, in future tutorials we'll examine how to use the ObjectDataSource to declaratively retrieve the data from the DAL.</span></span> <span data-ttu-id="cb9e7-274">Mit dem ObjectDataSource-Steuerelement, wenn wir müssen keinen Code zu schreiben und erhalten Unterstützung paging und Sortierung!</span><span class="sxs-lookup"><span data-stu-id="cb9e7-274">With the ObjectDataSource we'll not have to write any code and will get paging and sorting support as well!</span></span>

## <a name="step-3-adding-parameterized-methods-to-the-data-access-layer"></a><span data-ttu-id="cb9e7-275">Schritt 3: Hinzufügen von Methoden an die Datenzugriffsebene parametrisiert</span><span class="sxs-lookup"><span data-stu-id="cb9e7-275">Step 3: Adding Parameterized Methods to the Data Access Layer</span></span>

<span data-ttu-id="cb9e7-276">An diesem Punkt unsere **ProductsTableAdapter** -Klasse, die jedoch eine Methode verfügt über **GetProducts()**, die alle Produkte in der Datenbank zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-276">At this point our **ProductsTableAdapter** class has but one method, **GetProducts()**, which returns all of the products in the database.</span></span> <span data-ttu-id="cb9e7-277">Wird mit allen Produkten arbeiten sicherlich nützlich ist, gibt es Zeiten, wenn wir Informationen zu einem bestimmten Produkt oder alle Produkte, die zu einer bestimmten Kategorie gehören abrufen möchten.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-277">While being able to work with all products is definitely useful, there are times when we'll want to retrieve information about a specific product, or all products that belong to a particular category.</span></span> <span data-ttu-id="cb9e7-278">Um solche Funktionen unserer Data Access Layer hinzuzufügen können wir dem TableAdapter parametrisierte Methoden hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-278">To add such functionality to our Data Access Layer we can add parameterized methods to the TableAdapter.</span></span>

<span data-ttu-id="cb9e7-279">Fügen Sie der **GetProductsByCategoryID (*CategoryID*)** Methode.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-279">Let's add the **GetProductsByCategoryID(*categoryID*)** method.</span></span> <span data-ttu-id="cb9e7-280">Zum Hinzufügen einer neuen Methode an die DAL, wechseln Sie zurück zur DataSet-Designer mit der Maustaste in den **ProductsTableAdapter** aus, und wählen Sie die Abfrage hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-280">To add a new method to the DAL, return to the DataSet Designer, right-click in the **ProductsTableAdapter** section, and choose Add Query.</span></span>


![Mit der rechten Maustaste auf den TableAdapter, und wählen Sie Abfrage hinzufügen](creating-a-data-access-layer-cs/_static/image38.png)

<span data-ttu-id="cb9e7-282">**Abbildung 14**: mit der rechten Maustaste auf den TableAdapter, und wählen Sie Abfrage hinzufügen</span><span class="sxs-lookup"><span data-stu-id="cb9e7-282">**Figure 14**: Right-Click on the TableAdapter and Choose Add Query</span></span>


<span data-ttu-id="cb9e7-283">Wir werden zunächst dazu aufgefordert, zu der gibt an, ob der Zugriff auf die Datenbank mit einer Ad-hoc-SQL-Anweisung oder einer neuen oder vorhandenen gespeicherten Prozedur werden sollten.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-283">We are first prompted about whether we want to access the database using an ad-hoc SQL statement or a new or existing stored procedure.</span></span> <span data-ttu-id="cb9e7-284">Wählen wir eine Ad-hoc-SQL-Anweisung erneut aus.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-284">Let's choose to use an ad-hoc SQL statement again.</span></span> <span data-ttu-id="cb9e7-285">Als Nächstes werden wir gefragt, welche Art von SQL-Abfrage wir gerne verwenden würden.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-285">Next, we are asked what type of SQL query we'd like to use.</span></span> <span data-ttu-id="cb9e7-286">Da wir alle Produkte zurückzugeben, die eine angegebene Kategorie angehören, möchten, möchten wir Schreiben einer **wählen** -Anweisung die Zeilen zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-286">Since we want to return all products that belong to a specified category, we want to write a **SELECT** statement which returns rows.</span></span>


<span data-ttu-id="cb9e7-287">[![Wählen Sie eine SELECT-Anweisung zu erstellen, die Zeilen zurückgibt](creating-a-data-access-layer-cs/_static/image40.png)](creating-a-data-access-layer-cs/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-287">[![Choose to Create a SELECT Statement Which Returns Rows](creating-a-data-access-layer-cs/_static/image40.png)](creating-a-data-access-layer-cs/_static/image39.png)</span></span>

<span data-ttu-id="cb9e7-288">**Abbildung 15**: Wählen Sie zum Erstellen einer **wählen** -Anweisung die Zeilen zurück ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-288">**Figure 15**: Choose to Create a **SELECT** Statement Which Returns Rows ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image41.png))</span></span>


<span data-ttu-id="cb9e7-289">Der nächste Schritt ist die SQL-Abfrage verwendet, um Zugriff auf die Daten zu definieren.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-289">The next step is to define the SQL query used to access the data.</span></span> <span data-ttu-id="cb9e7-290">Da wir nur solche Produkte zurück, die zu einer bestimmten Kategorie gehören möchten, verwenden ich die gleiche <strong>wählen</strong> -Anweisung vom <strong>GetProducts()</strong>, aber fügen Sie die folgenden <strong>, in denen</strong> Klausel: <strong>, in denen CategoryID = @CategoryID</strong> .</span><span class="sxs-lookup"><span data-stu-id="cb9e7-290">Since we want to return only those products that belong to a particular category, I use the same <strong>SELECT</strong> statement from <strong>GetProducts()</strong>, but add the following <strong>WHERE</strong> clause: <strong>WHERE CategoryID = @CategoryID</strong>.</span></span> <span data-ttu-id="cb9e7-291">Die <strong>@CategoryID</strong> Parameter gibt an, die dem TableAdapter-Assistenten, dass die Methode, die wir erstellen einen Eingabeparameter des entsprechenden Typs (d. h., ein NULL-Werte zulässt Integer) erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-291">The <strong>@CategoryID</strong> parameter indicates to the TableAdapter wizard that the method we're creating will require an input parameter of the corresponding type (namely, a nullable integer).</span></span>


<span data-ttu-id="cb9e7-292">[![Geben Sie eine Abfrage aus, um nur die Produkte in einer angegebenen Kategorie zurückzugeben](creating-a-data-access-layer-cs/_static/image43.png)](creating-a-data-access-layer-cs/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-292">[![Enter a Query to Only Return Products in a Specified Category](creating-a-data-access-layer-cs/_static/image43.png)](creating-a-data-access-layer-cs/_static/image42.png)</span></span>

<span data-ttu-id="cb9e7-293">**Abbildung 16**: Geben Sie eine Abfrage nur Zurückgeben von Produkten in eine angegebene Kategorie ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-293">**Figure 16**: Enter a Query to Only Return Products in a Specified Category ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image44.png))</span></span>


<span data-ttu-id="cb9e7-294">Im letzten Schritt, denen wir wählen können, die auf Daten, Muster zugreifen zu verwenden, sowie die Namen der generierten Methoden anpassen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-294">In the final step we can choose which data access patterns to use, as well as customize the names of the methods generated.</span></span> <span data-ttu-id="cb9e7-295">Für das Muster Füllung ändern wir den Namen in <strong>FillByCategoryID</strong> und für die Rückgabe eine "DataTable" Muster zurückgeben (der <strong>erhalten*X</strong>*  Methoden), verwenden wir  <strong>GetProductsByCategoryID</strong>.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-295">For the Fill pattern, let's change the name to <strong>FillByCategoryID</strong> and for the return a DataTable return pattern (the <strong>Get*X</strong>* methods), let's use <strong>GetProductsByCategoryID</strong>.</span></span>


<span data-ttu-id="cb9e7-296">[![Wählen Sie die Namen für die TableAdapter-Methoden](creating-a-data-access-layer-cs/_static/image46.png)](creating-a-data-access-layer-cs/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-296">[![Choose the Names for the TableAdapter Methods](creating-a-data-access-layer-cs/_static/image46.png)](creating-a-data-access-layer-cs/_static/image45.png)</span></span>

<span data-ttu-id="cb9e7-297">**Abbildung 17**: Wählen Sie die Namen für die TableAdapter-Methoden ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-297">**Figure 17**: Choose the Names for the TableAdapter Methods ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image47.png))</span></span>


<span data-ttu-id="cb9e7-298">Nach Abschluss des Assistenten enthält die DataSet-Designer die neuen TableAdapter-Methoden.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-298">After completing the wizard, the DataSet Designer includes the new TableAdapter methods.</span></span>


![Die Produkte können jetzt werden nach Kategorie abgefragt](creating-a-data-access-layer-cs/_static/image48.png)

<span data-ttu-id="cb9e7-300">**Abbildung 18**: die Produkte können jetzt nach Kategorie abgefragt werden</span><span class="sxs-lookup"><span data-stu-id="cb9e7-300">**Figure 18**: The Products Can Now be Queried by Category</span></span>


<span data-ttu-id="cb9e7-301">Ruhe Hinzufügen einer **GetProductByProductID (*"ProductID"*)** Methode, die mit derselben Technik.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-301">Take a moment to add a **GetProductByProductID(*productID*)** method using the same technique.</span></span>

<span data-ttu-id="cb9e7-302">Diese parametrisierten Abfragen können direkt aus dem DataSet-Designer getestet werden.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-302">These parameterized queries can be tested directly from the DataSet Designer.</span></span> <span data-ttu-id="cb9e7-303">Mit der rechten Maustaste auf die Methode in der TableAdapter aus, und wählen Sie die Vorschaudaten.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-303">Right-click on the method in the TableAdapter and choose Preview Data.</span></span> <span data-ttu-id="cb9e7-304">Geben Sie anschließend die Werte für die Parameter verwenden, und klicken Sie auf Vorschau.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-304">Next, enter the values to use for the parameters and click Preview.</span></span>


<span data-ttu-id="cb9e7-305">[![Diese Produkte gehören zur Kategorie Getränke werden angezeigt.](creating-a-data-access-layer-cs/_static/image50.png)](creating-a-data-access-layer-cs/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-305">[![Those Products Belonging to the Beverages Category are Shown](creating-a-data-access-layer-cs/_static/image50.png)](creating-a-data-access-layer-cs/_static/image49.png)</span></span>

<span data-ttu-id="cb9e7-306">**Abbildung 19**: Diese Produkte gehören zur Kategorie Getränke werden angezeigt ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-306">**Figure 19**: Those Products Belonging to the Beverages Category are Shown ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image51.png))</span></span>


<span data-ttu-id="cb9e7-307">Mit der **GetProductsByCategoryID (*CategoryID*)** -Methode in der DAL, können jetzt erstellen wir eine ASP.NET-Seite, die nur die Produkte in einer angegebenen Kategorie anzeigt.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-307">With the **GetProductsByCategoryID(*categoryID*)** method in our DAL, we can now create an ASP.NET page that displays only those products in a specified category.</span></span> <span data-ttu-id="cb9e7-308">Im folgenden Beispiel werden alle Produkte, die in der Kategorie "Getränke" sind mit einem **CategoryID** 1.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-308">The following example shows all products that are in the Beverages category, which have a **CategoryID** of 1.</span></span>

<span data-ttu-id="cb9e7-309">Beverages.ASP</span><span class="sxs-lookup"><span data-stu-id="cb9e7-309">Beverages.asp</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample4.aspx)]

<span data-ttu-id="cb9e7-310">Beverages.aspx.cs</span><span class="sxs-lookup"><span data-stu-id="cb9e7-310">Beverages.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample5.cs)]


<span data-ttu-id="cb9e7-311">[![Diese Produkte in der Kategorie "Getränke" werden angezeigt.](creating-a-data-access-layer-cs/_static/image53.png)](creating-a-data-access-layer-cs/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-311">[![Those Products in the Beverages Category are Displayed](creating-a-data-access-layer-cs/_static/image53.png)](creating-a-data-access-layer-cs/_static/image52.png)</span></span>

<span data-ttu-id="cb9e7-312">**Abbildung 20**: die Produkte in der Kategorie "Getränke" werden angezeigt ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-312">**Figure 20**: Those Products in the Beverages Category are Displayed ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image54.png))</span></span>


## <a name="step-4-inserting-updating-and-deleting-data"></a><span data-ttu-id="cb9e7-313">Schritt 4: Einfügen, aktualisieren und Löschen von Daten</span><span class="sxs-lookup"><span data-stu-id="cb9e7-313">Step 4: Inserting, Updating, and Deleting Data</span></span>

<span data-ttu-id="cb9e7-314">Es gibt zwei Muster, die häufig zum Einfügen, aktualisieren und Löschen von Daten verwendet.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-314">There are two patterns commonly used for inserting, updating, and deleting data.</span></span> <span data-ttu-id="cb9e7-315">Das erste Muster für die die direkte datenbankmuster aufgerufen werden, wenn aufgerufen, umfasst das Erstellen von Methoden, die Problem ein **einfügen**, **UPDATE**, oder **löschen** Befehl das Datenbank, die für ein einzelner Datensatz ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-315">The first pattern, which I'll call the database direct pattern, involves creating methods that, when invoked, issue an **INSERT**, **UPDATE**, or **DELETE** command to the database that operates on a single database record.</span></span> <span data-ttu-id="cb9e7-316">Solche Methoden werden in der Regel in einer Reihe von skalaren Werten (ganze Zahlen, Zeichenfolgen, boolesche Werte, Datums-/Uhrzeitangaben und So weiter), die entsprechen den Werten, einfügen, aktualisieren oder Löschen von übergeben.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-316">Such methods are typically passed in a series of scalar values (integers, strings, Booleans, DateTimes, and so on) that correspond to the values to insert, update, or delete.</span></span> <span data-ttu-id="cb9e7-317">Z. B. mit diesem Muster für die **Produkte** Tabelle, die die Delete-Methode in einen ganzzahligen Parameter an, dauern würde, der angibt, die **"ProductID"** des Datensatzes zu löschen, während die Insert-Methode dauern würde, ein Zeichenfolge für die **ProductName**, decimal für die **UnitPrice**, eine ganze Zahl für die **UnitsOnStock**und so weiter.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-317">For example, with this pattern for the **Products** table the delete method would take in an integer parameter, indicating the **ProductID** of the record to delete, while the insert method would take in a string for the **ProductName**, a decimal for the **UnitPrice**, an integer for the **UnitsOnStock**, and so on.</span></span>


<span data-ttu-id="cb9e7-318">[![Jede INSERT-, Update- und Delete-Anforderung wird die Datenbank sofort gesendet.](creating-a-data-access-layer-cs/_static/image56.png)](creating-a-data-access-layer-cs/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-318">[![Each Insert, Update, and Delete Request is Sent to the Database Immediately](creating-a-data-access-layer-cs/_static/image56.png)](creating-a-data-access-layer-cs/_static/image55.png)</span></span>

<span data-ttu-id="cb9e7-319">**Abbildung 21**: jede INSERT-, Update- und Delete-Anforderung an die Datenbank sofort gesendet ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-319">**Figure 21**: Each Insert, Update, and Delete Request is Sent to the Database Immediately ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image57.png))</span></span>


<span data-ttu-id="cb9e7-320">Das andere Muster, bezeichnet als Batch Muster aktualisieren, besteht darin, einen gesamten Datasets, DataTable oder Sammlung von DataRows in einem Methodenaufruf zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-320">The other pattern, which I'll refer to as the batch update pattern, is to update an entire DataSet, DataTable, or collection of DataRows in one method call.</span></span> <span data-ttu-id="cb9e7-321">Mit diesem Muster Entwickler löscht, einfügt, und ändert die DataRows in einer "DataTable" und übergibt dann diese DataRows oder DataTable in eine Updatemethode.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-321">With this pattern a developer deletes, inserts, and modifies the DataRows in a DataTable and then passes those DataRows or DataTable into an update method.</span></span> <span data-ttu-id="cb9e7-322">Klicken Sie dann diese Methode listet DataRows übergeben, die bestimmt, ob sie geändert, hinzugefügt, gelöscht oder wurde haben (über die DataRow [RowState-Eigenschaft](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) Wert), und gibt die entsprechende Datenbank-Anforderung für jeden Datensatz.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-322">This method then enumerates the DataRows passed in, determines whether or not they've been modified, added, or deleted (via the DataRow's [RowState property](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) value), and issues the appropriate database request for each record.</span></span>


<span data-ttu-id="cb9e7-323">[![Alle Änderungen werden mit der Datenbank synchronisiert, wenn die Update-Methode aufgerufen wird](creating-a-data-access-layer-cs/_static/image59.png)](creating-a-data-access-layer-cs/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-323">[![All Changes are Synchronized with the Database When the Update Method is Invoked](creating-a-data-access-layer-cs/_static/image59.png)](creating-a-data-access-layer-cs/_static/image58.png)</span></span>

<span data-ttu-id="cb9e7-324">**Abbildung 22**: Alle Änderungen werden mit der Datenbank synchronisiert, wenn die Update-Methode aufgerufen wird ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image60.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-324">**Figure 22**: All Changes are Synchronized with the Database When the Update Method is Invoked ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image60.png))</span></span>


<span data-ttu-id="cb9e7-325">Der TableAdapter updatemusters Batch wird standardmäßig verwendet, unterstützt aber auch das DB-direct-Muster.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-325">The TableAdapter uses the batch update pattern by default, but also supports the DB direct pattern.</span></span> <span data-ttu-id="cb9e7-326">Da wir die Option "Generate INSERT-, Update- und Delete-Anweisungen in den erweiterten Eigenschaften, beim Erstellen von unserem TableAdapter und ausgewählt die **ProductsTableAdapter** enthält ein **Update()** -Methode die das Batch-Update-Muster implementiert.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-326">Since we selected the "Generate Insert, Update, and Delete statements" option from the Advanced Properties when creating our TableAdapter, the **ProductsTableAdapter** contains an **Update()** method, which implements the batch update pattern.</span></span> <span data-ttu-id="cb9e7-327">Insbesondere der TableAdapter enthält ein **Update()** -Methode, die das typisierte DataSet, eine stark typisierte DataTable oder ein oder mehrere DataRows übergeben werden kann.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-327">Specifically, the TableAdapter contains an **Update()** method that can be passed the Typed DataSet, a strongly-typed DataTable, or one or more DataRows.</span></span> <span data-ttu-id="cb9e7-328">Wenn Sie bleibt das Kontrollkästchen "GenerateDBDirectMethods" überprüft beim ersten Erstellung des TableAdapter das DB-direct-Muster auch über implementiert wird **Insert()**, **Update()**, und **Delete()**  Methoden.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-328">If you left the "GenerateDBDirectMethods" checkbox checked when first creating the TableAdapter the DB direct pattern will also be implemented via **Insert()**, **Update()**, and **Delete()** methods.</span></span>

<span data-ttu-id="cb9e7-329">Beide Änderungen Datenmustern Verwenden des TableAdapter **InsertCommand**, **UpdateCommand**, und **DeleteCommand** Eigenschaften zum Ausgeben ihrer **einfügen** , **UPDATE**, und **löschen** Befehle aus, um die Datenbank.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-329">Both data modification patterns use the TableAdapter's **InsertCommand**, **UpdateCommand**, and **DeleteCommand** properties to issue their **INSERT**, **UPDATE**, and **DELETE** commands to the database.</span></span> <span data-ttu-id="cb9e7-330">Können Sie überprüfen und Ändern der **InsertCommand**, **UpdateCommand**, und **DeleteCommand** Eigenschaften, indem Sie durch Klicken auf den TableAdapter im DataSet-Designer, und klicken Sie dann um das Eigenschaftenfenster.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-330">You can inspect and modify the **InsertCommand**, **UpdateCommand**, and **DeleteCommand** properties by clicking on the TableAdapter in the DataSet Designer and then going to the Properties window.</span></span> <span data-ttu-id="cb9e7-331">(Stellen Sie sicher, dass Sie ausgewählt haben, den TableAdapter, und dass die **ProductsTableAdapter** Objekt wird in der Dropdown-Liste im Fenster Eigenschaften ausgewählt.)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-331">(Make sure you have selected the TableAdapter, and that the **ProductsTableAdapter** object is the one selected in the drop-down list in the Properties window.)</span></span>


<span data-ttu-id="cb9e7-332">[![Der TableAdapter hat InsertCommand, UpdateCommand und DeleteCommand-Eigenschaften](creating-a-data-access-layer-cs/_static/image62.png)](creating-a-data-access-layer-cs/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-332">[![The TableAdapter has InsertCommand, UpdateCommand, and DeleteCommand Properties](creating-a-data-access-layer-cs/_static/image62.png)](creating-a-data-access-layer-cs/_static/image61.png)</span></span>

<span data-ttu-id="cb9e7-333">**Abbildung 23**: der TableAdapter hat **InsertCommand**, **UpdateCommand**, und **DeleteCommand** Eigenschaften ([klicken Sie auf die in voller Größe anzeigen Image](creating-a-data-access-layer-cs/_static/image63.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-333">**Figure 23**: The TableAdapter has **InsertCommand**, **UpdateCommand**, and **DeleteCommand** Properties ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image63.png))</span></span>


<span data-ttu-id="cb9e7-334">Um zu überprüfen oder ändern Sie diesen Befehl Datenbankeigenschaften, klicken Sie auf die **CommandText** untergeordnete Eigenschaft, die in den Abfrage-Generator angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-334">To examine or modify any of these database command properties, click on the **CommandText** subproperty, which will bring up the Query Builder.</span></span>


<span data-ttu-id="cb9e7-335">[![Konfigurieren Sie die INSERT-, Update- und DELETE-Anweisungen im Abfrage-Generator](creating-a-data-access-layer-cs/_static/image65.png)](creating-a-data-access-layer-cs/_static/image64.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-335">[![Configure the INSERT, UPDATE, and DELETE Statements in the Query Builder](creating-a-data-access-layer-cs/_static/image65.png)](creating-a-data-access-layer-cs/_static/image64.png)</span></span>

<span data-ttu-id="cb9e7-336">**Abbildung 24**: Konfigurieren der **einfügen**, **UPDATE**, und **löschen** Anweisungen im Abfrage-Generator ([klicken Sie, um das Bild in voller Größeanzeigen](creating-a-data-access-layer-cs/_static/image66.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-336">**Figure 24**: Configure the **INSERT**, **UPDATE**, and **DELETE** Statements in the Query Builder ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image66.png))</span></span>


<span data-ttu-id="cb9e7-337">Im folgenden Codebeispiel wird veranschaulicht, wie das Batch-Update-Muster verwendet wird, auf den Preis aller Produkte, die nicht eingestellt werden, und deren 25 Einheiten auf Lager oder weniger, das doppelte wird:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-337">The following code example shows how to use the batch update pattern to double the price of all products that are not discontinued and that have 25 units in stock or less:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample6.cs)]

<span data-ttu-id="cb9e7-338">Der folgende Code veranschaulicht, wie die DB-direct-Muster verwenden, um programmgesteuert ein bestimmtes Produkt zu löschen und aktualisieren Sie eine aus, und klicken Sie dann ein neues Konto hinzufügen:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-338">The code below illustrates how to use the DB direct pattern to programmatically delete a particular product, then update one, and then add a new one:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample7.cs)]

## <a name="creating-custom-insert-update-and-delete-methods"></a><span data-ttu-id="cb9e7-339">Erstellen von benutzerdefinierten INSERT-, Update- und Delete-Methoden</span><span class="sxs-lookup"><span data-stu-id="cb9e7-339">Creating Custom Insert, Update, and Delete Methods</span></span>

<span data-ttu-id="cb9e7-340">Die **Insert()**, **Update()**, und **Delete()** Methoden, die von der DB-direct-Methode erstellt können ein bisschen aufwändig sein, insbesondere bei Tabellen mit vielen Spalten.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-340">The **Insert()**, **Update()**, and **Delete()** methods created by the DB direct method can be a bit cumbersome, especially for tables with many columns.</span></span> <span data-ttu-id="cb9e7-341">Betrachten das vorherige Codebeispiel, ohne IntelliSenses unterstützen, es ist nicht besonders klar, was **Produkte** Tabellenspalte zugeordnet, jeder Eingabeparameter für die **Update()** und **Insert()**  Methoden.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-341">Looking at the previous code example, without IntelliSense's help it's not particularly clear what **Products** table column maps to each input parameter to the **Update()** and **Insert()** methods.</span></span> <span data-ttu-id="cb9e7-342">Gibt es möglicherweise vorkommen, dass wir nur möchten Aktualisieren einer einzelnen Spalte oder zwei aus, oder möchten eine benutzerdefinierte **Insert()** -Methode, die vielleicht wird den Wert des neu eingefügten Datensatzes zurückgeben **Identität** (automatisch inkrementierten) Feld.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-342">There may be times when we only want to update a single column or two, or want a customized **Insert()** method that will, perhaps, return the value of the newly inserted record's **IDENTITY** (auto-increment) field.</span></span>

<span data-ttu-id="cb9e7-343">Um eine solche benutzerdefinierte Methode erstellen, geben Sie an der DataSet-Designer zurück.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-343">To create such a custom method, return to the DataSet Designer.</span></span> <span data-ttu-id="cb9e7-344">Mit der rechten Maustaste auf den TableAdapter, und wählen Sie die Abfrage hinzufügen, Rückgabe an den TableAdapter-Assistenten aus.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-344">Right-click on the TableAdapter and choose Add Query, returning to the TableAdapter wizard.</span></span> <span data-ttu-id="cb9e7-345">Geben wir den Typ der Abfrage zu erstellen, auf dem zweiten Bildschirm.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-345">On the second screen we can indicate the type of query to create.</span></span> <span data-ttu-id="cb9e7-346">Erstellen wir eine Methode, ein neues Produkt hinzugefügt und gibt anschließend den Wert von des neu hinzugefügten Datensatzes **"ProductID"**.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-346">Let's create a method that adds a new product and then returns the value of the newly added record's **ProductID**.</span></span> <span data-ttu-id="cb9e7-347">Aus diesem Grund erstellen Sie wahlweise eine **einfügen** Abfrage.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-347">Therefore, opt to create an **INSERT** query.</span></span>


<span data-ttu-id="cb9e7-348">[![Erstellen Sie eine Methode, um die Products-Tabelle eine neue Zeile hinzuzufügen](creating-a-data-access-layer-cs/_static/image68.png)](creating-a-data-access-layer-cs/_static/image67.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-348">[![Create a Method to Add a New Row to the Products Table](creating-a-data-access-layer-cs/_static/image68.png)](creating-a-data-access-layer-cs/_static/image67.png)</span></span>

<span data-ttu-id="cb9e7-349">**Abbildung 25**: Erstellen Sie eine Methode, um eine neue Zeile hinzuzufügen der **Produkte** Tabelle ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image69.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-349">**Figure 25**: Create a Method to Add a New Row to the **Products** Table ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image69.png))</span></span>


<span data-ttu-id="cb9e7-350">Auf dem nächsten Bildschirm die **InsertCommand**des **CommandText** angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-350">On the next screen the **InsertCommand**'s **CommandText** appears.</span></span> <span data-ttu-id="cb9e7-351">Erweitern Sie diese Abfrage durch Hinzufügen von **Bereich auswählen\_IDENTITY()** am Ende der Abfrage, wodurch den letzten Identitätswert eingefügte ein **Identität** Spalte im selben Bereich.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-351">Augment this query by adding **SELECT SCOPE\_IDENTITY()** at the end of the query, which will return the last identity value inserted into an **IDENTITY** column in the same scope.</span></span> <span data-ttu-id="cb9e7-352">(Finden Sie unter den [technische Dokumentation](https://msdn.microsoft.com/library/ms190315.aspx) für Weitere Informationen zu **Bereich\_IDENTITY()** und aus welchem Grund Sie wahrscheinlich möchten [verwenden Bereich\_IDENTITY() statt @ @IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx).) Stellen Sie sicher, dass Sie am Ende der **einfügen** -Anweisung mit einem Semikolon vor dem Hinzufügen der **wählen** Anweisung.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-352">(See the [technical documentation](https://msdn.microsoft.com/library/ms190315.aspx) for more information about **SCOPE\_IDENTITY()** and why you probably want to [use SCOPE\_IDENTITY() in lieu of @@IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx).) Make sure that you end the **INSERT** statement with a semi-colon before adding the **SELECT** statement.</span></span>


<span data-ttu-id="cb9e7-353">[![Erweitern Sie die Abfrage, um die SCOPE_IDENTITY()-Funktion-Wert zurückgeben](creating-a-data-access-layer-cs/_static/image71.png)](creating-a-data-access-layer-cs/_static/image70.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-353">[![Augment the Query to Return the SCOPE_IDENTITY() Value](creating-a-data-access-layer-cs/_static/image71.png)](creating-a-data-access-layer-cs/_static/image70.png)</span></span>

<span data-ttu-id="cb9e7-354">**Abbildung 26**: Erweitern Sie die Abfrage auf die Rückgabe der **Bereich\_IDENTITY()** Wert ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image72.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-354">**Figure 26**: Augment the Query to Return the **SCOPE\_IDENTITY()** Value ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image72.png))</span></span>


<span data-ttu-id="cb9e7-355">Benennen Sie abschließend die neue Methode **InsertProduct**.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-355">Finally, name the new method **InsertProduct**.</span></span>


<span data-ttu-id="cb9e7-356">[![Legen Sie den neuen Methodennamen InsertProduct](creating-a-data-access-layer-cs/_static/image74.png)](creating-a-data-access-layer-cs/_static/image73.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-356">[![Set the New Method Name to InsertProduct](creating-a-data-access-layer-cs/_static/image74.png)](creating-a-data-access-layer-cs/_static/image73.png)</span></span>

<span data-ttu-id="cb9e7-357">**Abbildung 27**: Legen Sie den Namen der neuen Methode **InsertProduct** ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image75.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-357">**Figure 27**: Set the New Method Name to **InsertProduct** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image75.png))</span></span>


<span data-ttu-id="cb9e7-358">Wenn Sie zurück zu DataSet-Designer sehen Sie, dass die **ProductsTableAdapter** enthält eine neue Methode **InsertProduct**.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-358">When you return to the DataSet Designer you'll see that the **ProductsTableAdapter** contains a new method, **InsertProduct**.</span></span> <span data-ttu-id="cb9e7-359">Wenn diese neue Methode einen Parameter für jede Spalte besitzt die **Produkte** Tabelle, die Chancen stehen, haben Sie vergessen, beenden die **einfügen** -Anweisung mit einem Semikolon.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-359">If this new method doesn't have a parameter for each column in the **Products** table, chances are you forgot to terminate the **INSERT** statement with a semi-colon.</span></span> <span data-ttu-id="cb9e7-360">Konfigurieren der **InsertProduct** Methode und sicherzustellen, dass Sie eine durch Semikolons als Trennzeichen das **einfügen** und **wählen** Anweisungen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-360">Configure the **InsertProduct** method and ensure you have a semi-colon delimiting the **INSERT** and **SELECT** statements.</span></span>

<span data-ttu-id="cb9e7-361">Fügen Sie in der Standardeinstellung Methoden Problem keine Methoden, was bedeutet, dass sie die Anzahl der betroffenen Zeilen zurück.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-361">By default, insert methods issue non-query methods, meaning that they return the number of affected rows.</span></span> <span data-ttu-id="cb9e7-362">Allerdings möchten wir die **InsertProduct** Methode, um den Rückgabewert von der Abfrage nicht die Anzahl der betroffenen Zeilen zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-362">However, we want the **InsertProduct** method to return the value returned by the query, not the number of rows affected.</span></span> <span data-ttu-id="cb9e7-363">Passen Sie zu diesem Zweck die **InsertProduct** Methode **ExecuteMode** Eigenschaft, um **Skalar**.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-363">To accomplish this, adjust the **InsertProduct** method's **ExecuteMode** property to **Scalar**.</span></span>


<span data-ttu-id="cb9e7-364">[![Ändern Sie die ExecuteMode-Eigenschaft an skalaren](creating-a-data-access-layer-cs/_static/image77.png)](creating-a-data-access-layer-cs/_static/image76.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-364">[![Change the ExecuteMode Property to Scalar](creating-a-data-access-layer-cs/_static/image77.png)](creating-a-data-access-layer-cs/_static/image76.png)</span></span>

<span data-ttu-id="cb9e7-365">**Abbildung 28**: Ändern der **ExecuteMode** Eigenschaft **Skalar** ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image78.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-365">**Figure 28**: Change the **ExecuteMode** Property to **Scalar** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image78.png))</span></span>


<span data-ttu-id="cb9e7-366">Der folgende code zeigt, die diese neue **InsertProduct** -Methode in Aktion:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-366">The following code shows this new **InsertProduct** method in action:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample8.cs)]

## <a name="step-5-completing-the-data-access-layer"></a><span data-ttu-id="cb9e7-367">Schritt 5: Abschließen der Datenzugriffsschicht</span><span class="sxs-lookup"><span data-stu-id="cb9e7-367">Step 5: Completing the Data Access Layer</span></span>

<span data-ttu-id="cb9e7-368">Beachten Sie, dass der **ProductsTableAdapters** Klasse gibt die **CategoryID** und **SupplierID** Werte aus der **Produkte** Tabelle jedoch enthält nicht die **"CategoryName"** Spalte aus der **Kategorien** Tabelle oder die **CompanyName** Spalte aus der **Lieferanten**Tabelle, obwohl dies wahrscheinlich die Spalten wir angezeigt sind, wenn Produktinformationen angezeigt werden soll.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-368">Note that the **ProductsTableAdapters** class returns the **CategoryID** and **SupplierID** values from the **Products** table, but doesn't include the **CategoryName** column from the **Categories** table or the **CompanyName** column from the **Suppliers** table, although these are likely the columns we want to display when showing product information.</span></span> <span data-ttu-id="cb9e7-369">Können wir die Methode des TableAdapter anfänglichen, verbessern **GetProducts()**, um beide enthalten den **"CategoryName"** und **CompanyName** Spaltenwerte, das aktualisiert die stark typisierte DataTable auch diese neuen Spalten eingeschlossen werden soll.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-369">We can augment the TableAdapter's initial method, **GetProducts()**, to include both the **CategoryName** and **CompanyName** column values, which will update the strongly-typed DataTable to include these new columns as well.</span></span>

<span data-ttu-id="cb9e7-370">Dies kann ein Problem darstellen, jedoch als dem TableAdapter-Methoden zum Einfügen, aktualisieren, und Löschen von Daten aus dieser Methode für erste basieren.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-370">This can present a problem, however, as the TableAdapter's methods for inserting, updating, and deleting data are based off of this initial method.</span></span> <span data-ttu-id="cb9e7-371">Zum Glück, die automatisch generierten Methoden für einfügen, aktualisieren und Löschen von nicht betroffen Unterabfragen in den **wählen** Klausel.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-371">Fortunately, the auto-generated methods for inserting, updating, and deleting are not affected by subqueries in the **SELECT** clause.</span></span> <span data-ttu-id="cb9e7-372">Durch sorgen, dass unsere Abfragen hinzufügen **Kategorien** und **Lieferanten** als Unterabfragen, statt **JOIN** s, wir werden zu vermeiden, dass diese Methoden zum Ändern von Daten zu überarbeiten.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-372">By taking care to add our queries to **Categories** and **Suppliers** as subqueries, rather than **JOIN** s, we'll avoid having to rework those methods for modifying data.</span></span> <span data-ttu-id="cb9e7-373">Mit der rechten Maustaste auf die **GetProducts()** -Methode in der die **ProductsTableAdapter** und wählen Sie konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-373">Right-click on the **GetProducts()** method in the **ProductsTableAdapter** and choose Configure.</span></span> <span data-ttu-id="cb9e7-374">Passen Sie dann die **wählen** Klausel, damit sie aussieht wie:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-374">Then, adjust the **SELECT** clause so that it looks like:</span></span>

[!code-sql[Main](creating-a-data-access-layer-cs/samples/sample9.sql)]


<span data-ttu-id="cb9e7-375">[![Aktualisieren Sie die SELECT-Anweisung für die GetProducts()-Methode](creating-a-data-access-layer-cs/_static/image80.png)](creating-a-data-access-layer-cs/_static/image79.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-375">[![Update the SELECT Statement for the GetProducts() Method](creating-a-data-access-layer-cs/_static/image80.png)](creating-a-data-access-layer-cs/_static/image79.png)</span></span>

<span data-ttu-id="cb9e7-376">**Abbildung 29**: Aktualisieren der **wählen** -Anweisung für die **GetProducts()** Methode ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image81.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-376">**Figure 29**: Update the **SELECT** Statement for the **GetProducts()** Method ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image81.png))</span></span>


<span data-ttu-id="cb9e7-377">Nach der Aktualisierung der **GetProducts()** Methode verwenden Sie diese neue Abfrage, die die DataTable umfasst zwei neue Spalten: **"CategoryName"** und **Lieferantenname**.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-377">After updating the **GetProducts()** method to use this new query the DataTable will include two new columns: **CategoryName** and **SupplierName**.</span></span>


![DataTable-Produkte weist zwei neue Spalten](creating-a-data-access-layer-cs/_static/image82.png)

<span data-ttu-id="cb9e7-379">**Abbildung 30**: die **Produkte** wurde, verfügt über zwei neue Spalten</span><span class="sxs-lookup"><span data-stu-id="cb9e7-379">**Figure 30**: The **Products** DataTable has Two New Columns</span></span>


<span data-ttu-id="cb9e7-380">Aktualisieren in Ruhe die **wählen** -Klausel in der **GetProductsByCategoryID (*CategoryID*)** -Methode.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-380">Take a moment to update the **SELECT** clause in the **GetProductsByCategoryID(*categoryID*)** method as well.</span></span>

<span data-ttu-id="cb9e7-381">Wenn Sie aktualisieren die **GetProducts()** **wählen** mit **JOIN** Syntax der DataSet-Designer wird nicht in der Lage, die Methoden zum Einfügen, aktualisieren und Löschen von automatisch generieren Datenbankdaten, die mit dem direkten DB-Muster.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-381">If you update the **GetProducts()** **SELECT** using **JOIN** syntax the DataSet Designer won't be able to auto-generate the methods for inserting, updating, and deleting database data using the DB direct pattern.</span></span> <span data-ttu-id="cb9e7-382">Stattdessen müssen Sie manuell viel erstellen wie mit der **InsertProduct** Methode weiter oben in diesem Tutorial.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-382">Instead, you'll have to manually create them much like we did with the **InsertProduct** method earlier in this tutorial.</span></span> <span data-ttu-id="cb9e7-383">Darüber hinaus manuell müssen Sie geben die **InsertCommand**, **UpdateCommand**, und **DeleteCommand** Eigenschaftswerte, wenn Sie den Batch, aktualisieren die Muster verwenden möchten.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-383">Furthermore, you'll manually have to provide the **InsertCommand**, **UpdateCommand**, and **DeleteCommand** property values if you want to use the batch updating pattern.</span></span>

## <a name="adding-the-remaining-tableadapters"></a><span data-ttu-id="cb9e7-384">Die verbleibenden TableAdapter hinzufügen</span><span class="sxs-lookup"><span data-stu-id="cb9e7-384">Adding the Remaining TableAdapters</span></span>

<span data-ttu-id="cb9e7-385">Bis jetzt haben wir nur erläutert, mit der Verwendung von einem einzelnen TableAdapter für eine einzelne Datenbanktabelle.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-385">Up until now, we've only looked at working with a single TableAdapter for a single database table.</span></span> <span data-ttu-id="cb9e7-386">Die Northwind-Datenbank enthält jedoch mehrere verknüpfte Tabellen, die wir zum Arbeiten benötigen mit in unserer Webanwendung.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-386">However, the Northwind database contains several related tables that we'll need to work with in our web application.</span></span> <span data-ttu-id="cb9e7-387">Eine typisierte DataSet mehrere darf im Zusammenhang mit Datentabellen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-387">A Typed DataSet can contain multiple, related DataTables.</span></span> <span data-ttu-id="cb9e7-388">Zum Abschließen der DAL müssen wir daher DataTables für die anderen Tabellen hinzufügen, die wir in diesen Tutorials verwenden.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-388">Therefore, to complete our DAL we need to add DataTables for the other tables we'll be using in these tutorials.</span></span> <span data-ttu-id="cb9e7-389">Um einen neuen TableAdapter typisiertes DataSet hinzuzufügen, öffnen Sie den DataSet-Designer, mit der rechten Maustaste im Designer und wählen Add / TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-389">To add a new TableAdapter to a Typed DataSet, open the DataSet Designer, right-click in the Designer, and choose Add / TableAdapter.</span></span> <span data-ttu-id="cb9e7-390">Dies erstellt eine neue DataTable und TableAdapter und führen Sie durch den Assistenten, die, den wir zuvor in diesem Tutorial untersucht.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-390">This will create a new DataTable and TableAdapter and walk you through the wizard we examined earlier in this tutorial.</span></span>

<span data-ttu-id="cb9e7-391">Erstellen Sie die folgenden Methoden, die mithilfe der folgenden Abfragen und TableAdapters einige Minuten dauern.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-391">Take a few minutes to create the following TableAdapters and methods using the following queries.</span></span> <span data-ttu-id="cb9e7-392">Beachten Sie, dass die Abfragen in der **ProductsTableAdapter** enthalten die Unterabfragen, um die Kategorie und Lieferanten des Produkts-Namen abrufen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-392">Note that the queries in the **ProductsTableAdapter** include the subqueries to grab each product's category and supplier names.</span></span> <span data-ttu-id="cb9e7-393">Darüber hinaus, wenn Sie folgen regelmäßig, Sie haben bereits hinzugefügt der **ProductsTableAdapter** Klasse **GetProducts()** und **GetProductsByCategoryID (*CategoryID* )** Methoden.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-393">Additionally, if you've been following along, you've already added the **ProductsTableAdapter** class's **GetProducts()** and **GetProductsByCategoryID(*categoryID*)** methods.</span></span>

- <span data-ttu-id="cb9e7-394">**ProductsTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="cb9e7-394">**ProductsTableAdapter**</span></span>

  - <span data-ttu-id="cb9e7-395">**GetProducts**:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-395">**GetProducts**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample10.sql)]
  - <span data-ttu-id="cb9e7-396">**GetProductsByCategoryID**:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-396">**GetProductsByCategoryID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample11.sql)]
  - <span data-ttu-id="cb9e7-397">**GetProductsBySupplierID**:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-397">**GetProductsBySupplierID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample12.sql)]
  - <span data-ttu-id="cb9e7-398">**GetProductByProductID**:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-398">**GetProductByProductID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample13.sql)]
- <span data-ttu-id="cb9e7-399">**CategoriesTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="cb9e7-399">**CategoriesTableAdapter**</span></span>

  - <span data-ttu-id="cb9e7-400">**GetCategories**:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-400">**GetCategories**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample14.sql)]
  - <span data-ttu-id="cb9e7-401">**GetCategoryByCategoryID**:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-401">**GetCategoryByCategoryID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample15.sql)]
- <span data-ttu-id="cb9e7-402">**SuppliersTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="cb9e7-402">**SuppliersTableAdapter**</span></span>

  - <span data-ttu-id="cb9e7-403">**GetSuppliers**:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-403">**GetSuppliers**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample16.sql)]
  - <span data-ttu-id="cb9e7-404">**GetSuppliersByCountry**:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-404">**GetSuppliersByCountry**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample17.sql)]
  - <span data-ttu-id="cb9e7-405">**GetSupplierBySupplierID**:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-405">**GetSupplierBySupplierID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample18.sql)]
- <span data-ttu-id="cb9e7-406">**EmployeesTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="cb9e7-406">**EmployeesTableAdapter**</span></span>

  - <span data-ttu-id="cb9e7-407">**GetEmployees**:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-407">**GetEmployees**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample19.sql)]
  - <span data-ttu-id="cb9e7-408">**GetEmployeesByManager**:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-408">**GetEmployeesByManager**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample20.sql)]
  - <span data-ttu-id="cb9e7-409">**GetEmployeeByEmployeeID**:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-409">**GetEmployeeByEmployeeID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample21.sql)]


<span data-ttu-id="cb9e7-410">[![Der DataSet-Designer, nachdem die vier TableAdapter hinzugefügt wurden](creating-a-data-access-layer-cs/_static/image84.png)](creating-a-data-access-layer-cs/_static/image83.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-410">[![The DataSet Designer After the Four TableAdapters Have Been Added](creating-a-data-access-layer-cs/_static/image84.png)](creating-a-data-access-layer-cs/_static/image83.png)</span></span>

<span data-ttu-id="cb9e7-411">**Abbildung 31**: der DataSet-Designer nach der vier TableAdapters wurden hinzugefügt ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image85.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-411">**Figure 31**: The DataSet Designer After the Four TableAdapters Have Been Added ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image85.png))</span></span>


## <a name="adding-custom-code-to-the-dal"></a><span data-ttu-id="cb9e7-412">Hinzufügen von benutzerdefiniertem Code mit der Datenzugriffsschicht</span><span class="sxs-lookup"><span data-stu-id="cb9e7-412">Adding Custom Code to the DAL</span></span>

<span data-ttu-id="cb9e7-413">Die TableAdapters und Datentabellen, die das typisierte DataSet hinzugefügt wird als eine XML-Schemadefinitionsdatei (**Northwind.xsd**).</span><span class="sxs-lookup"><span data-stu-id="cb9e7-413">The TableAdapters and DataTables added to the Typed DataSet are expressed as an XML Schema Definition file (**Northwind.xsd**).</span></span> <span data-ttu-id="cb9e7-414">Sie können diese Schemainformationen anzeigen, indem Sie mit der rechten Maustaste auf die **Northwind.xsd** Datei im Projektmappen-Explorer, und wählen Sie Code anzeigen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-414">You can view this schema information by right-clicking on the **Northwind.xsd** file in the Solution Explorer and choosing View Code.</span></span>


<span data-ttu-id="cb9e7-415">[![Die XML-Schema (XSD-Datei) für die Employees typisiertes DataSet](creating-a-data-access-layer-cs/_static/image87.png)](creating-a-data-access-layer-cs/_static/image86.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-415">[![The XML Schema Definition (XSD) File for the Northwinds Typed DataSet](creating-a-data-access-layer-cs/_static/image87.png)](creating-a-data-access-layer-cs/_static/image86.png)</span></span>

<span data-ttu-id="cb9e7-416">**Abbildung 32**: The XML Schema Definition (XSD)-Datei für das Employees typisierten DataSet ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image88.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-416">**Figure 32**: The XML Schema Definition (XSD) File for the Northwinds Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image88.png))</span></span>


<span data-ttu-id="cb9e7-417">Diese Schemainformationen wird zur Entwurfszeit in c# oder Visual Basic-Code übersetzt, bei der Kompilierung oder zur Laufzeit (falls erforderlich), wodurch Sie es mit dem Debugger schrittweise durchlaufen können.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-417">This schema information is translated into C# or Visual Basic code at design time when compiled or at runtime (if needed), at which point you can step through it with the debugger.</span></span> <span data-ttu-id="cb9e7-418">Zum Anzeigen dieser automatisch generierter Code ausfallen, der Klassenansicht und einen Drilldown für die TableAdapter oder typisierte DataSet-Klassen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-418">To view this auto-generated code go to the Class View and drill down to the TableAdapter or Typed DataSet classes.</span></span> <span data-ttu-id="cb9e7-419">Wenn Sie die Klassenansicht, auf dem Bildschirm nicht angezeigt wird, finden Sie unter dem Menü "Ansicht" und wählen Sie ihn von dort aus, oder drücken Sie STRG + UMSCHALT + C.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-419">If you don't see the Class View on your screen, go to the View menu and select it from there, or hit Ctrl+Shift+C.</span></span> <span data-ttu-id="cb9e7-420">In der Klassenansicht sehen Sie die Eigenschaften, Methoden und Ereignisse von typisierte DataSet und TableAdapter-Klassen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-420">From the Class View you can see the properties, methods, and events of the Typed DataSet and TableAdapter classes.</span></span> <span data-ttu-id="cb9e7-421">Um den Code für eine bestimmte Methode anzuzeigen, doppelklicken Sie auf den Methodennamen in der Klassenansicht oder mit der rechten Maustaste darauf, und Gehe zu Definition auswählen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-421">To view the code for a particular method, double-click the method name in the Class View or right-click on it and choose Go To Definition.</span></span>


![Überprüfen Sie den automatisch generierten Code durch Auswählen von Go-Definition aus der Klassenansicht](creating-a-data-access-layer-cs/_static/image89.png)

<span data-ttu-id="cb9e7-423">**Abbildung 33**: Überprüfen Sie den automatisch generierten Code durch Auswählen von Go-Definition aus der Klassenansicht</span><span class="sxs-lookup"><span data-stu-id="cb9e7-423">**Figure 33**: Inspect the Auto-Generated Code by Selecting Go To Definition from the Class View</span></span>


<span data-ttu-id="cb9e7-424">Während der automatisch generierten Code eine große Zeitersparnis sein kann, wird der Code ist häufig sehr allgemein angelegt und muss angepasst werden, um die speziellen Anforderungen einer Anwendung zu erfüllen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-424">While auto-generated code can be a great time saver, the code is often very generic and needs to be customized to meet the unique needs of an application.</span></span> <span data-ttu-id="cb9e7-425">Das Risiko der Erweiterung von automatisch generiertem Code ist jedoch, dass das Tool, das den Code generiert hat, dass es Zeit, zu "neu generieren", und Ihre Anpassungen überschreiben ist ggf. ein.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-425">The risk of extending auto-generated code, though, is that the tool that generated the code might decide it's time to "regenerate" and overwrite your customizations.</span></span> <span data-ttu-id="cb9e7-426">Mit .NET 2.0 neue Teilklasse-Konzept ist es einfach, eine Klasse auf mehrere Dateien aufgeteilt.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-426">With .NET 2.0's new partial class concept, it's easy to split a class across multiple files.</span></span> <span data-ttu-id="cb9e7-427">Dadurch kann wir unseren eigenen Methoden, Eigenschaften und Ereignisse, die automatisch generierten Klassen hinzufügen, ohne Informationen zu Visual Studio, unserer Anpassungen zu überschreiben.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-427">This enables us to add our own methods, properties, and events to the auto-generated classes without having to worry about Visual Studio overwriting our customizations.</span></span>

<span data-ttu-id="cb9e7-428">Um die DAL anpassen zu demonstrieren, fügen Sie eine **GetProducts()** Methode, um die **SuppliersRow** Klasse.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-428">To demonstrate how to customize the DAL, let's add a **GetProducts()** method to the **SuppliersRow** class.</span></span> <span data-ttu-id="cb9e7-429">Die **SuppliersRow** Klasse stellt einen einzelnen Datensatz in die **Lieferanten** Tabelle; jeder Lieferant können Anbieter 0 (null) viele Produkte, damit **GetProducts()** gibt diese zurück Produkte, des angegebenen Lieferanten.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-429">The **SuppliersRow** class represents a single record in the **Suppliers** table; each supplier can provider zero to many products, so **GetProducts()** will return those products of the specified supplier.</span></span> <span data-ttu-id="cb9e7-430">Zum Ausführen, die dadurch erstellt einer neue Klassendatei in der **App\_Code** Ordner mit dem Namen **SuppliersRow.cs** und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-430">To accomplish this create a new class file in the **App\_Code** folder named **SuppliersRow.cs** and add the following code:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample22.cs)]

<span data-ttu-id="cb9e7-431">Diese partielle Klasse weist den Compiler, die bei Erstellen der **Northwind.SuppliersRow** Klasse einbeziehen, die **GetProducts()** Methode, die soeben definiert.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-431">This partial class instructs the compiler that when building the **Northwind.SuppliersRow** class to include the **GetProducts()** method we just defined.</span></span> <span data-ttu-id="cb9e7-432">Wenn Sie Ihr Projekt erstellen und dann in die Klassenansicht zurück sehen Sie **GetProducts()** jetzt als eine Methode aufgeführt **Northwind.SuppliersRow**.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-432">If you build your project and then return to the Class View you'll see **GetProducts()** now listed as a method of **Northwind.SuppliersRow**.</span></span>


![Die GetProducts()-Methode ist jetzt Teil der Northwind.SuppliersRow-Klasse](creating-a-data-access-layer-cs/_static/image90.png)

<span data-ttu-id="cb9e7-434">**Abbildung 34**: die **GetProducts()** Methode ist jetzt Teil der **Northwind.SuppliersRow** Klasse</span><span class="sxs-lookup"><span data-stu-id="cb9e7-434">**Figure 34**: The **GetProducts()** Method is Now Part of the **Northwind.SuppliersRow** Class</span></span>


<span data-ttu-id="cb9e7-435">Die **GetProducts()** Methode kann jetzt verwendet werden, zum Auflisten der Satz von Produkten für einen bestimmten Lieferanten, wie im folgenden Code gezeigt:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-435">The **GetProducts()** method can now be used to enumerate the set of products for a particular supplier, as the following code shows:</span></span>

[!code-html[Main](creating-a-data-access-layer-cs/samples/sample23.html)]

<span data-ttu-id="cb9e7-436">Diese Daten können auch in einer ASP angezeigt werden. NET Daten, die Websteuerelemente.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-436">This data can also be displayed in any of ASP.NET's data Web controls.</span></span> <span data-ttu-id="cb9e7-437">Die folgende Seite verwendet ein GridView-Steuerelement mit zwei Feldern:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-437">The following page uses a GridView control with two fields:</span></span>

- <span data-ttu-id="cb9e7-438">Eine BoundField-, die den Namen der einzelnen Lieferanten anzeigt und</span><span class="sxs-lookup"><span data-stu-id="cb9e7-438">A BoundField that displays the name of each supplier, and</span></span>
- <span data-ttu-id="cb9e7-439">Ein TemplateField, die ein BulletedList-Steuerelement enthält, die von der zurückgegebenen Ergebnisse gebunden ist die **GetProducts()** Methode für jeden Lieferanten.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-439">A TemplateField that contains a BulletedList control that is bound to the results returned by the **GetProducts()** method for each supplier.</span></span>

<span data-ttu-id="cb9e7-440">Vorgehensweise beim Anzeigen von solchen Master / Detail-Berichte in zukünftigen Lernprogrammen untersucht.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-440">We'll examine how to display such master-detail reports in future tutorials.</span></span> <span data-ttu-id="cb9e7-441">Jetzt in diesem Beispiel soll veranschaulichen, verwenden die benutzerdefinierte Methode hinzugefügt, die **Northwind.SuppliersRow** Klasse.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-441">For now, this example is designed to illustrate using the custom method added to the **Northwind.SuppliersRow** class.</span></span>

<span data-ttu-id="cb9e7-442">SuppliersAndProducts.aspx</span><span class="sxs-lookup"><span data-stu-id="cb9e7-442">SuppliersAndProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample24.aspx)]

<span data-ttu-id="cb9e7-443">SuppliersAndProducts.aspx.cs</span><span class="sxs-lookup"><span data-stu-id="cb9e7-443">SuppliersAndProducts.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample25.cs)]


<span data-ttu-id="cb9e7-444">[![Unternehmensname des Lieferanten ist in der linken Spalte, deren Produkte in der rechten Seite aufgeführt.](creating-a-data-access-layer-cs/_static/image92.png)](creating-a-data-access-layer-cs/_static/image91.png)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-444">[![The Supplier's Company Name is Listed in the Left Column, Their Products in the Right](creating-a-data-access-layer-cs/_static/image92.png)](creating-a-data-access-layer-cs/_static/image91.png)</span></span>

<span data-ttu-id="cb9e7-445">**Abbildung 35**: Unternehmensname für die Lieferanten finden Sie in der linken Spalte, deren Produkte in der rechten Seite ([klicken Sie, um das Bild in voller Größe anzeigen](creating-a-data-access-layer-cs/_static/image93.png))</span><span class="sxs-lookup"><span data-stu-id="cb9e7-445">**Figure 35**: The Supplier's Company Name is Listed in the Left Column, Their Products in the Right ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image93.png))</span></span>


## <a name="summary"></a><span data-ttu-id="cb9e7-446">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="cb9e7-446">Summary</span></span>

<span data-ttu-id="cb9e7-447">Wenn das Erstellen einer Webanwendung, erstellen die DAL sollte einer der ersten Arbeitsschritte, bevor Sie mit dem Erstellen Ihrer Darstellungsebene beginnen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-447">When building a web application creating the DAL should be one of your first steps, occurring before you start creating your presentation layer.</span></span> <span data-ttu-id="cb9e7-448">Mit Visual Studio ist das Erstellen einer DAL, die auf typisierten DataSets basiert eine Aufgabe, die innerhalb von 10 bis 15 Minuten ausgeführt werden kann, ohne eine einzige Zeile Code schreiben zu müssen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-448">With Visual Studio, creating a DAL based on Typed DataSets is a task that can be accomplished in 10-15 minutes without writing a line of code.</span></span> <span data-ttu-id="cb9e7-449">Die Lernprogramme, die für die Zukunft werden auf diesem DAL aufbauen.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-449">The tutorials moving forward will build upon this DAL.</span></span> <span data-ttu-id="cb9e7-450">In der [nächsten Tutorial](creating-a-business-logic-layer-cs.md) wir definieren eine Reihe von Geschäftsregeln und erfahren Sie, wie sie in einer separaten Geschäftslogikebene implementiert.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-450">In the [next tutorial](creating-a-business-logic-layer-cs.md) we'll define a number of business rules and see how to implement them in a separate Business Logic Layer.</span></span>

<span data-ttu-id="cb9e7-451">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="cb9e7-451">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="cb9e7-452">Weiterführende Themen</span><span class="sxs-lookup"><span data-stu-id="cb9e7-452">Further Reading</span></span>

<span data-ttu-id="cb9e7-453">Weitere Informationen zu den Themen in diesem Tutorial erläutert finden Sie in den folgenden Ressourcen:</span><span class="sxs-lookup"><span data-stu-id="cb9e7-453">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="cb9e7-454">Erstellen einer DAL, die mithilfe von stark typisierten TableAdapters und Datentabellen in Visual Studio 2005 und ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="cb9e7-454">Building a DAL using Strongly Typed TableAdapters and DataTables in VS 2005 and ASP.NET 2.0</span></span>](https://weblogs.asp.net/scottgu/435498)
- [<span data-ttu-id="cb9e7-455">Entwerfen von Datenebenenkomponenten und Weitergabe von Daten über die Tarife</span><span class="sxs-lookup"><span data-stu-id="cb9e7-455">Designing Data Tier Components and Passing Data Through Tiers</span></span>](https://msdn.microsoft.com/library/ms978496.aspx)
- [<span data-ttu-id="cb9e7-456">Erstellen einer Datenzugriffsschicht mit der DataSet-Designer von Visual Studio 2005</span><span class="sxs-lookup"><span data-stu-id="cb9e7-456">Build a Data Access Layer with the Visual Studio 2005 DataSet Designer</span></span>](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner)
- [<span data-ttu-id="cb9e7-457">Verschlüsseln von Konfigurationsinformationen in ASP.NET 2.0 Applications</span><span class="sxs-lookup"><span data-stu-id="cb9e7-457">Encrypting Configuration Information in ASP.NET 2.0 Applications</span></span>](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx)
- [<span data-ttu-id="cb9e7-458">Übersicht über TableAdapters</span><span class="sxs-lookup"><span data-stu-id="cb9e7-458">TableAdapter Overview</span></span>](https://msdn.microsoft.com/library/bz9tthwx.aspx)
- [<span data-ttu-id="cb9e7-459">Arbeiten mit einem typisierten DataSet</span><span class="sxs-lookup"><span data-stu-id="cb9e7-459">Working with a Typed DataSet</span></span>](https://msdn.microsoft.com/library/esbykkzb.aspx)
- [<span data-ttu-id="cb9e7-460">Mithilfe von stark typisierten Datenzugriff in Visual Studio 2005 und ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="cb9e7-460">Using Strongly-Typed Data Access in Visual Studio 2005 and ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/020806-1.aspx)
- [<span data-ttu-id="cb9e7-461">Erweitern der TableAdapter-Methoden</span><span class="sxs-lookup"><span data-stu-id="cb9e7-461">How to Extend TableAdapter Methods</span></span>](https://blogs.msdn.com/vbteam/archive/2005/05/04/ExtendingTableAdapters.aspx)
- [<span data-ttu-id="cb9e7-462">Abrufen von skalaren Daten aus einer gespeicherten Prozedur</span><span class="sxs-lookup"><span data-stu-id="cb9e7-462">Retrieving Scalar Data from a Stored Procedure</span></span>](http://aspnet.4guysfromrolla.com/articles/062905-1.aspx)

### <a name="video-training-on-topics-contained-in-this-tutorial"></a><span data-ttu-id="cb9e7-463">In den Themen in diesem Tutorial-Videotraining</span><span class="sxs-lookup"><span data-stu-id="cb9e7-463">Video Training on Topics Contained in this Tutorial</span></span>

- [<span data-ttu-id="cb9e7-464">Datenzugriffsschichten in ASP.NET-Anwendungen</span><span class="sxs-lookup"><span data-stu-id="cb9e7-464">Data Access Layers in ASP.NET Applications</span></span>](../../../videos/data-access/adonet-data-services/data-access-layers-in-aspnet-applications.md)
- [<span data-ttu-id="cb9e7-465">Gewusst wie: Binden Sie ein Dataset manuell an ein Datenraster</span><span class="sxs-lookup"><span data-stu-id="cb9e7-465">How to Manually Bind a Dataset to a Datagrid</span></span>](../../../videos/data-access/adonet-data-services/how-to-manually-bind-a-dataset-to-a-datagrid.md)
- [<span data-ttu-id="cb9e7-466">Wie für die Arbeit mit Datasets und Filtern aus einer ASP-Anwendung</span><span class="sxs-lookup"><span data-stu-id="cb9e7-466">How to Work with Datasets and Filters from an ASP Application</span></span>](../../../videos/data-access/adonet-data-services/how-to-work-with-datasets-and-filters-from-an-asp-application.md)

## <a name="about-the-author"></a><span data-ttu-id="cb9e7-467">Der Autor</span><span class="sxs-lookup"><span data-stu-id="cb9e7-467">About the Author</span></span>

<span data-ttu-id="cb9e7-468">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben Büchern zu ASP/ASP.NET und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), arbeitet mit Microsoft-Web-Technologien seit 1998.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-468">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="cb9e7-469">Er ist als ein unabhängiger Berater, Schulungsleiter und Autor.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-469">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="cb9e7-470">Sein neueste Buch wird [*Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="cb9e7-470">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="cb9e7-471">Er ist unter [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-471">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="cb9e7-472">oder über seinen Blog finden Sie unter [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="cb9e7-472">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="cb9e7-473">Besonderen Dank an</span><span class="sxs-lookup"><span data-stu-id="cb9e7-473">Special Thanks To</span></span>

<span data-ttu-id="cb9e7-474">Diese tutorialreihe wurde durch viele hilfreiche Reviewer überprüft.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-474">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="cb9e7-475">Führendes Prüfer für dieses Tutorial wurden Ron Green, Hilton Giesenow, Dennis Patterson, Liz Shulok, Abel Gomez und Carlos Santos.</span><span class="sxs-lookup"><span data-stu-id="cb9e7-475">Lead reviewers for this tutorial were Ron Green, Hilton Giesenow, Dennis Patterson, Liz Shulok, Abel Gomez, and Carlos Santos.</span></span> <span data-ttu-id="cb9e7-476">Meine zukünftigen MSDN-Artikeln überprüfen möchten?</span><span class="sxs-lookup"><span data-stu-id="cb9e7-476">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="cb9e7-477">Wenn dies der Fall ist, löschen Sie mir eine Linie an [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="cb9e7-477">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="cb9e7-478">Nächste</span><span class="sxs-lookup"><span data-stu-id="cb9e7-478">Next</span></span>](creating-a-business-logic-layer-cs.md)
