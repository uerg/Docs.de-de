---
uid: web-forms/overview/data-access/paging-and-sorting/paging-and-sorting-report-data-vb
title: Auslagern und Sortieren von Berichtsdaten (VB) | Microsoft-Dokumentation
author: rick-anderson
description: Paginierung und Sortierung sind zwei sehr allgemeine Funktionen zum Anzeigen von Daten in einer online-Anwendung. In diesem Tutorial werden wir einen ersten Blick auf das Hinzufügen einer Sortierung dauern und...
ms.author: aspnetcontent
ms.date: 08/15/2006
ms.assetid: b895e37e-0e69-45cc-a7e4-17ddd2e1b38d
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting/paging-and-sorting-report-data-vb
msc.type: authoredcontent
ms.openlocfilehash: e8e33bc11074815b5beacd92c49c95f8ea9da2c0
ms.sourcegitcommit: b28cd0313af316c051c2ff8549865bff67f2fbb4
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 07/05/2018
ms.locfileid: "37808459"
---
<a name="paging-and-sorting-report-data-vb"></a><span data-ttu-id="d2c96-104">Auslagern und Sortieren von Berichtsdaten (VB)</span><span class="sxs-lookup"><span data-stu-id="d2c96-104">Paging and Sorting Report Data (VB)</span></span>
====================
<span data-ttu-id="d2c96-105">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="d2c96-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="d2c96-106">[Beispiel-App herunter](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_24_VB.exe) oder [PDF-Datei herunterladen](paging-and-sorting-report-data-vb/_static/datatutorial24vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="d2c96-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_24_VB.exe) or [Download PDF](paging-and-sorting-report-data-vb/_static/datatutorial24vb1.pdf)</span></span>

> <span data-ttu-id="d2c96-107">Paginierung und Sortierung sind zwei sehr allgemeine Funktionen zum Anzeigen von Daten in einer online-Anwendung.</span><span class="sxs-lookup"><span data-stu-id="d2c96-107">Paging and sorting are two very common features when displaying data in an online application.</span></span> <span data-ttu-id="d2c96-108">In diesem Tutorial werden wir einen ersten Blick auf Hinzufügen, Sortieren und paging auf unsere Berichte, die wir dann nach in zukünftigen Lernprogrammen erstellen, nutzen.</span><span class="sxs-lookup"><span data-stu-id="d2c96-108">In this tutorial we'll take a first look at adding sorting and paging to our reports, which we will then build upon in future tutorials.</span></span>


## <a name="introduction"></a><span data-ttu-id="d2c96-109">Einführung</span><span class="sxs-lookup"><span data-stu-id="d2c96-109">Introduction</span></span>

<span data-ttu-id="d2c96-110">Paginierung und Sortierung sind zwei sehr allgemeine Funktionen zum Anzeigen von Daten in einer online-Anwendung.</span><span class="sxs-lookup"><span data-stu-id="d2c96-110">Paging and sorting are two very common features when displaying data in an online application.</span></span> <span data-ttu-id="d2c96-111">Z. B. bei der Suche nach ASP.NET Bücher im Onlinebuchhandel gibt es möglicherweise Hunderte von Büchern, aber der Bericht mit den Suchergebnissen werden nur zehn Übereinstimmungen pro Seite aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="d2c96-111">For example, when searching for ASP.NET books at an online bookstore, there may be hundreds of such books, but the report listing the search results lists only ten matches per page.</span></span> <span data-ttu-id="d2c96-112">Darüber hinaus können die Ergebnisse nach Titel, Preis, Seitenanzahl, Name des Autors und So weiter sortiert werden.</span><span class="sxs-lookup"><span data-stu-id="d2c96-112">Moreover, the results can be sorted by title, price, page count, author name, and so on.</span></span> <span data-ttu-id="d2c96-113">Während der letzten 23 Tutorials haben Gewusst wie: Erstellen Sie eine Vielzahl von Berichten, einschließlich der Schnittstellen, mit denen hinzufügen, bearbeiten und Löschen von Daten, überprüft es speichern, die nicht erläutert, wie zum Sortieren von Daten und die einzige Beispiele für paging wir Ve gesehen wurden mit DetailsView und FormView -Steuerelemente.</span><span class="sxs-lookup"><span data-stu-id="d2c96-113">While the past 23 tutorials have examined how to build a variety of reports, including interfaces that permit adding, editing, and deleting data, we ve not looked at how to sort data and the only paging examples we ve seen have been with the DetailsView and FormView controls.</span></span>

<span data-ttu-id="d2c96-114">In diesem Tutorial erfahren wir, wie Sortierung und paging auf unsere Berichte, die ausgeführt werden können, durch einfaches aktivieren einige Kontrollkästchen hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="d2c96-114">In this tutorial we'll see how to add sorting and paging to our reports, which can be accomplished by simply checking a few checkboxes.</span></span> <span data-ttu-id="d2c96-115">Leider wird dieser vereinfachten Implementierung hat auch Nachteile haben, die die Sortierung Schnittstelle ein wenig zu wünschen übrig lässt und die Paging-Routinen sind nicht für effizientes Auslagern von großen Resultsets konzipiert.</span><span class="sxs-lookup"><span data-stu-id="d2c96-115">Unfortunately, this simplistic implementation has its drawbacks the sorting interface leaves a bit to be desired and the paging routines are not designed for efficiently paging through large result sets.</span></span> <span data-ttu-id="d2c96-116">Zukünftige wird wie die Einschränkungen von der Out-von-the-Box Auslagern und Sortieren von Lösungen zu überwinden Tutorials werden.</span><span class="sxs-lookup"><span data-stu-id="d2c96-116">Future tutorials will explore how to overcome the limitations of the out-of-the-box paging and sorting solutions.</span></span>

## <a name="step-1-adding-the-paging-and-sorting-tutorial-web-pages"></a><span data-ttu-id="d2c96-117">Schritt 1: Hinzufügen von Paging und Sortieren von Tutorial Webseiten</span><span class="sxs-lookup"><span data-stu-id="d2c96-117">Step 1: Adding the Paging and Sorting Tutorial Web Pages</span></span>

<span data-ttu-id="d2c96-118">Bevor wir in diesem Tutorial beginnen, können Sie zuerst nehmen einen Moment Zeit, um die ASP.NET-Seiten hinzuzufügen, benötigen wir für dieses Lernprogramm sowie die folgenden drei s ein.</span><span class="sxs-lookup"><span data-stu-id="d2c96-118">Before we start this tutorial, let s first take a moment to add the ASP.NET pages we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="d2c96-119">Zunächst erstellen Sie einen neuen Ordner im Projekt mit dem Namen `PagingAndSorting`.</span><span class="sxs-lookup"><span data-stu-id="d2c96-119">Start by creating a new folder in the project named `PagingAndSorting`.</span></span> <span data-ttu-id="d2c96-120">Fügen Sie die folgenden fünf ASP.NET-Seiten in diesen Ordner, wenn all diese Einstellungen zu konfigurieren, um die Masterseite verwenden `Site.master`:</span><span class="sxs-lookup"><span data-stu-id="d2c96-120">Next, add the following five ASP.NET pages to this folder, having all of them configured to use the master page `Site.master`:</span></span>

- `Default.aspx`
- `SimplePagingSorting.aspx`
- `EfficientPaging.aspx`
- `SortParameter.aspx`
- `CustomSortingUI.aspx`


![Erstellen Sie einen Ordner PagingAndSorting, und fügen Sie die Tutorial ASP.NET-Seiten](paging-and-sorting-report-data-vb/_static/image1.png)

<span data-ttu-id="d2c96-122">**Abbildung 1**: Erstellen Sie einen Ordner PagingAndSorting, und fügen Sie die Tutorial ASP.NET-Seiten</span><span class="sxs-lookup"><span data-stu-id="d2c96-122">**Figure 1**: Create a PagingAndSorting Folder and Add the Tutorial ASP.NET Pages</span></span>


<span data-ttu-id="d2c96-123">Öffnen Sie als Nächstes die `Default.aspx` Seite, und ziehen Sie die `SectionLevelTutorialListing.ascx` Benutzersteuerelement aus der `UserControls` Ordner auf die Entwurfsoberfläche.</span><span class="sxs-lookup"><span data-stu-id="d2c96-123">Next, open the `Default.aspx` page and drag the `SectionLevelTutorialListing.ascx` User Control from the `UserControls` folder onto the Design surface.</span></span> <span data-ttu-id="d2c96-124">Dieses Benutzersteuerelement, die wir in den erstellt die [Masterseiten und Sitenavigation](../introduction/master-pages-and-site-navigation-vb.md) Tutorial, listet die Sitemap und zeigt diese Tutorials im aktuellen Abschnitt in einer Liste mit Aufzählungszeichen.</span><span class="sxs-lookup"><span data-stu-id="d2c96-124">This User Control, which we created in the [Master Pages and Site Navigation](../introduction/master-pages-and-site-navigation-vb.md) tutorial, enumerates the site map and displays those tutorials in the current section in a bulleted list.</span></span>


![Fügen Sie das SectionLevelTutorialListing.ascx-Benutzersteuerelement an "default.aspx"](paging-and-sorting-report-data-vb/_static/image2.png)

<span data-ttu-id="d2c96-126">**Abbildung 2**: Fügen Sie das SectionLevelTutorialListing.ascx-Benutzersteuerelement an "default.aspx"</span><span class="sxs-lookup"><span data-stu-id="d2c96-126">**Figure 2**: Add the SectionLevelTutorialListing.ascx User Control to Default.aspx</span></span>


<span data-ttu-id="d2c96-127">Um die Liste mit Aufzählungszeichen angezeigt, die Paginierung und Sortierung von Tutorials, die wir erstellen, müssen wir diese Siteübersicht hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="d2c96-127">In order to have the bulleted list display the paging and sorting tutorials we'll be creating, we need to add them to the site map.</span></span> <span data-ttu-id="d2c96-128">Öffnen der `Web.sitemap` Datei, und fügen Sie das folgende Markup nach dem vom Markup bearbeiten, einfügen und löschen Site Map, Knoten:</span><span class="sxs-lookup"><span data-stu-id="d2c96-128">Open the `Web.sitemap` file and add the following markup after the Editing, Inserting, and Deleting site map node markup:</span></span>


[!code-xml[Main](paging-and-sorting-report-data-vb/samples/sample1.xml)]


![Aktualisieren Sie die Website-Karte, um die neuen ASP.NET-Seiten enthalten](paging-and-sorting-report-data-vb/_static/image3.png)

<span data-ttu-id="d2c96-130">**Abbildung 3**: Aktualisieren Sie die Website-Karte, um die neuen ASP.NET-Seiten enthalten</span><span class="sxs-lookup"><span data-stu-id="d2c96-130">**Figure 3**: Update the Site Map to Include the New ASP.NET Pages</span></span>


## <a name="step-2-displaying-product-information-in-a-gridview"></a><span data-ttu-id="d2c96-131">Schritt 2: Anzeigen von Produktinformationen in einer GridView-Ansicht</span><span class="sxs-lookup"><span data-stu-id="d2c96-131">Step 2: Displaying Product Information in a GridView</span></span>

<span data-ttu-id="d2c96-132">Bevor wir tatsächlich implementieren Auslagern und Sortieren von Funktionen, können Sie s, erstellen Sie zunächst eine standardmäßige nicht-Srotable, nicht auslagerbaren GridView, die die Produktinformationen enthält.</span><span class="sxs-lookup"><span data-stu-id="d2c96-132">Before we actually implement paging and sorting capabilities, let s first create a standard non-srotable, non-pageable GridView that lists the product information.</span></span> <span data-ttu-id="d2c96-133">Diese Aufgabe ist es häufig vor der in dieser tutorialreihe also diese Schritte ausgeführt haben vertraut sein.</span><span class="sxs-lookup"><span data-stu-id="d2c96-133">This is a task we ve done many times before throughout this tutorial series so these steps should be familiar.</span></span> <span data-ttu-id="d2c96-134">Öffnen Sie zunächst die `SimplePagingSorting.aspx` Seite, und ziehen Sie ein GridView-Steuerelement aus der Toolbox auf den Designer, Festlegen der `ID` Eigenschaft `Products`.</span><span class="sxs-lookup"><span data-stu-id="d2c96-134">Start by opening the `SimplePagingSorting.aspx` page and drag a GridView control from the Toolbox onto the Designer, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="d2c96-135">Als Nächstes erstellen Sie eine neue "ObjectDataSource", die die Klasse ProductsBLL s verwendet `GetProducts()` Methode, um alle Produktinformationen, zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="d2c96-135">Next, create a new ObjectDataSource that uses the ProductsBLL class s `GetProducts()` method to return all of the product information.</span></span>


![Abrufen von Informationen zu allen Produkten mithilfe der GetProducts()-Methode](paging-and-sorting-report-data-vb/_static/image4.png)

<span data-ttu-id="d2c96-137">**Abbildung 4**: Abrufen von Informationen zu allen Produkten mithilfe der GetProducts()-Methode</span><span class="sxs-lookup"><span data-stu-id="d2c96-137">**Figure 4**: Retrieve Information About All of the Products Using the GetProducts() Method</span></span>


<span data-ttu-id="d2c96-138">Da in diesem Bericht kein schreibgeschützter Bericht, der es s ist das "ObjectDataSource"-s zuordnen müssen `Insert()`, `Update()`, oder `Delete()` Methoden, um die entsprechenden `ProductsBLL` -Methoden (keine) daher aus der Dropdown-Liste auswählen, für das UPDATE, INSERT, Registerkarten "" und löschen.</span><span class="sxs-lookup"><span data-stu-id="d2c96-138">Since this report is a read-only report, there s no need to map the ObjectDataSource s `Insert()`, `Update()`, or `Delete()` methods to corresponding `ProductsBLL` methods; therefore, choose (None) from the drop-down list for the UPDATE, INSERT, and DELETE tabs.</span></span>


![Wählen Sie die (None) Option in der Dropdown-Liste in der Update-, INSERT- und Löschen von Registerkarten](paging-and-sorting-report-data-vb/_static/image5.png)

<span data-ttu-id="d2c96-140">**Abbildung 5**: Wählen Sie die (None) Option in der Dropdown-Liste in der Update-, INSERT- und Löschen von Registerkarten</span><span class="sxs-lookup"><span data-stu-id="d2c96-140">**Figure 5**: Choose the (None) Option in the Drop-Down List in the UPDATE, INSERT, and DELETE Tabs</span></span>


<span data-ttu-id="d2c96-141">Als Nächstes können Sie s GridView s Felder anpassen, sodass nur die Produktnamen, Lieferanten, Kategorien, Preise und nicht mehr unterstützte Status angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="d2c96-141">Next, let s customize the GridView s fields so that only the products names, suppliers, categories, prices, and discontinued statuses are displayed.</span></span> <span data-ttu-id="d2c96-142">Darüber hinaus können alle Feldebene Formatierungsänderungen vorzunehmen ändert, z. B. zum Anpassen der `HeaderText` Eigenschaften oder formatieren den Preis als Währung.</span><span class="sxs-lookup"><span data-stu-id="d2c96-142">Furthermore, feel free to make any field-level formatting changes, such as adjusting the `HeaderText` properties or formatting the price as a currency.</span></span> <span data-ttu-id="d2c96-143">Nach diesen Änderungen sollte Ihre GridView s deklarative Markup etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="d2c96-143">After these changes, your GridView s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](paging-and-sorting-report-data-vb/samples/sample2.aspx)]

<span data-ttu-id="d2c96-144">Abbildung 6 zeigt unseren Fortschritt bisher ein, wenn Sie über einen Browser angezeigt.</span><span class="sxs-lookup"><span data-stu-id="d2c96-144">Figure 6 shows our progress thus far when viewed through a browser.</span></span> <span data-ttu-id="d2c96-145">Beachten Sie, dass die Seite zeigt eine Liste aller Produkte in einem Bildschirm mit einer jeden Produktname s, Kategorie, Lieferanten, Preis, und nicht mehr Status unterstützte.</span><span class="sxs-lookup"><span data-stu-id="d2c96-145">Note that the page lists all of the products in one screen, showing each product s name, category, supplier, price, and discontinued status.</span></span>


<span data-ttu-id="d2c96-146">[![Jedes der Produkte werden aufgelistet](paging-and-sorting-report-data-vb/_static/image7.png)](paging-and-sorting-report-data-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="d2c96-146">[![Each of the Products are Listed](paging-and-sorting-report-data-vb/_static/image7.png)](paging-and-sorting-report-data-vb/_static/image6.png)</span></span>

<span data-ttu-id="d2c96-147">**Abbildung 6**: jedes der Produkte aufgeführt sind ([klicken Sie, um das Bild in voller Größe anzeigen](paging-and-sorting-report-data-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="d2c96-147">**Figure 6**: Each of the Products are Listed ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image8.png))</span></span>


## <a name="step-3-adding-paging-support"></a><span data-ttu-id="d2c96-148">Schritt 3: Hinzufügen von Pagingunterstützung</span><span class="sxs-lookup"><span data-stu-id="d2c96-148">Step 3: Adding Paging Support</span></span>

<span data-ttu-id="d2c96-149">Auflisten von *alle* Produkte auf einem Bildschirm Informationsflut für den Benutzer zum Durchlesen der das führen kann.</span><span class="sxs-lookup"><span data-stu-id="d2c96-149">Listing *all* of the products on one screen can lead to information overload for the user perusing the data.</span></span> <span data-ttu-id="d2c96-150">Damit werden die Ergebnisse übersichtlicher zu machen, können wir teilen Sie die Daten in kleinere Seiten mit Daten und ermöglicht dem Benutzer, die eine Seite mit Daten zu einem Zeitpunkt durchlaufen.</span><span class="sxs-lookup"><span data-stu-id="d2c96-150">To help make the results more manageable, we can break up the data into smaller pages of data and allow the user to step through the data one page at a time.</span></span> <span data-ttu-id="d2c96-151">Zum Ausführen dieser einfach das Kontrollkästchen Paging aktivieren aus dem GridView-s-Smarttag (Dadurch wird das GridView-s [ `AllowPaging` Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.allowpaging.aspx) zu `true`).</span><span class="sxs-lookup"><span data-stu-id="d2c96-151">To accomplish this simply check the Enable Paging checkbox from the GridView s smart tag (this sets the GridView s [`AllowPaging` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.allowpaging.aspx) to `true`).</span></span>


<span data-ttu-id="d2c96-152">[![Aktivieren Sie das Kontrollkästchen aktivieren Paging, zum Hinzufügen von Paging-Unterstützung](paging-and-sorting-report-data-vb/_static/image10.png)](paging-and-sorting-report-data-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="d2c96-152">[![Check the Enable Paging Checkbox to Add Paging Support](paging-and-sorting-report-data-vb/_static/image10.png)](paging-and-sorting-report-data-vb/_static/image9.png)</span></span>

<span data-ttu-id="d2c96-153">**Abbildung 7**: das Kontrollkästchen aktivieren Sie Paging, Paging-Unterstützung hinzufügen ([klicken Sie, um das Bild in voller Größe anzeigen](paging-and-sorting-report-data-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="d2c96-153">**Figure 7**: Check the Enable Paging Checkbox to Add Paging Support ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image11.png))</span></span>


<span data-ttu-id="d2c96-154">Aktivieren von Paging begrenzt die Anzahl der Datensätze pro Seite angezeigt wird, und fügt eine *Auslagerungsschnittstelle* an die GridView.</span><span class="sxs-lookup"><span data-stu-id="d2c96-154">Enabling paging limits the number of records shown per page and adds a *paging interface* to the GridView.</span></span> <span data-ttu-id="d2c96-155">Die Auslagerung Standardschnittstelle, dargestellt in Abbildung 7 ist eine Reihe von Seitenzahlen, damit der Benutzer schnell von einer Seite mit Daten in einen anderen zu navigieren.</span><span class="sxs-lookup"><span data-stu-id="d2c96-155">The default paging interface, shown in Figure 7, is a series of page numbers, allowing the user to quickly navigate from one page of data to another.</span></span> <span data-ttu-id="d2c96-156">Diese Schnittstelle Paging sollte Ihnen bekannt, wie wir haben gesehen, wenn die DetailsView und FormView-Steuerelemente in den letzten Tutorials Paging-Unterstützung hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="d2c96-156">This paging interface should look familiar, as we ve seen it when adding paging support to the DetailsView and FormView controls in past tutorials.</span></span>

<span data-ttu-id="d2c96-157">Sowohl die FormView-Steuerelement die DetailsView-Steuerelemente zeigen nur einen einzelnen Datensatz pro Seite.</span><span class="sxs-lookup"><span data-stu-id="d2c96-157">Both the DetailsView and FormView controls only show a single record per page.</span></span> <span data-ttu-id="d2c96-158">GridView jedoch berät seine [ `PageSize` Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.pagesize.aspx) um zu bestimmen, wie viele Datensätze pro Seite angezeigt (diese Eigenschaft hat einen Standardwert von 10).</span><span class="sxs-lookup"><span data-stu-id="d2c96-158">The GridView, however, consults its [`PageSize` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.pagesize.aspx) to determine how many records to show per page (this property defaults to a value of 10).</span></span>

<span data-ttu-id="d2c96-159">Diese Schnittstelle GridView, DetailsView oder FormView s Paging kann mithilfe der folgenden Eigenschaften angepasst werden:</span><span class="sxs-lookup"><span data-stu-id="d2c96-159">This GridView, DetailsView, and FormView s paging interface can be customized using the following properties:</span></span>

- <span data-ttu-id="d2c96-160">`PagerStyle` Gibt die Formatinformationen für die Paging-Schnittstelle an. Geben Sie die Einstellungen wie können `BackColor`, `ForeColor`, `CssClass`, `HorizontalAlign`und so weiter.</span><span class="sxs-lookup"><span data-stu-id="d2c96-160">`PagerStyle` indicates the style information for the paging interface; can specify settings like `BackColor`, `ForeColor`, `CssClass`, `HorizontalAlign`, and so on.</span></span>
- <span data-ttu-id="d2c96-161">`PagerSettings` enthält eine Reihe von Eigenschaften, die die Funktionalität der Auslagerungsschnittstelle anpassen können. `PageButtonCount` gibt die maximale Anzahl der numerischen Seitenzahlen, die in den Paging-Schnittstelle (der Standardwert ist 10) angezeigt; die [ `Mode` Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pagersettings.mode.aspx) gibt an, wie die Paging-Schnittstelle arbeitet, und kann so festgelegt werden:</span><span class="sxs-lookup"><span data-stu-id="d2c96-161">`PagerSettings` contains a bevy of properties that can customize the functionality of the paging interface; `PageButtonCount` indicates the maximum number of numeric page numbers displayed in the paging interface (the default is 10); the [`Mode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pagersettings.mode.aspx) indicates how the paging interface operates and can be set to:</span></span> 

    - <span data-ttu-id="d2c96-162">`NextPrevious` Zeigt ein Schaltflächen Weiter und zurück, damit der Benutzer eine Seite vorwärts oder rückwärts zu einem Zeitpunkt zu Schritt</span><span class="sxs-lookup"><span data-stu-id="d2c96-162">`NextPrevious` shows a Next and Previous buttons, allowing the user to step forwards or backwards one page at a time</span></span>
    - <span data-ttu-id="d2c96-163">`NextPreviousFirstLast` Zusätzlich zu die Schaltflächen Weiter und zurück sind auch erste und letzte Schaltflächen enthalten, damit der Benutzer schnell in der ersten oder letzten Seite der Daten verschieben</span><span class="sxs-lookup"><span data-stu-id="d2c96-163">`NextPreviousFirstLast` in addition to Next and Previous buttons, First and Last buttons are also included, allowing the user to quickly move to the first or last page of data</span></span>
    - <span data-ttu-id="d2c96-164">`Numeric` Zeigt eine Reihe von Seitenzahlen, damit der Benutzer sofort auf einer beliebigen Seite wechseln</span><span class="sxs-lookup"><span data-stu-id="d2c96-164">`Numeric` shows a series of page numbers, allowing the user to immediately jump to any page</span></span>
    - <span data-ttu-id="d2c96-165">`NumericFirstLast` neben der Seitenzahlen enthält erste und letzte Schaltflächen, damit der Benutzer schnell in der ersten oder letzten Seite der Daten zu verschieben; die ersten/letzten Schaltflächen werden nur angezeigt, wenn alle numerischen Seitenzahlen nicht geeignet</span><span class="sxs-lookup"><span data-stu-id="d2c96-165">`NumericFirstLast` in addition to the page numbers, includes First and Last buttons, allowing the user to quickly move to the first or last page of data; the First/Last buttons are only shown if all of the numeric page numbers cannot fit</span></span>

<span data-ttu-id="d2c96-166">Darüber hinaus die GridView, DetailsView und FormView-Steuerelement alle bieten die `PageIndex` und `PageCount` Eigenschaften, die die aktuelle Seite, die angezeigt wird und die Gesamtzahl der Seiten mit Daten, Serveroptionsparameter anzugeben.</span><span class="sxs-lookup"><span data-stu-id="d2c96-166">Moreover, the GridView, DetailsView, and FormView all offer the `PageIndex` and `PageCount` properties, which indicate the current page being viewed and the total number of pages of data, respectively.</span></span> <span data-ttu-id="d2c96-167">Die `PageIndex` -Eigenschaft ist indiziert, beginnend mit 0, was bedeutet, dass beim Anzeigen der ersten Seite des Data `PageIndex` ist gleich 0.</span><span class="sxs-lookup"><span data-stu-id="d2c96-167">The `PageIndex` property is indexed starting at 0, meaning that when viewing the first page of data `PageIndex` will equal 0.</span></span> <span data-ttu-id="d2c96-168">`PageCount`, auf der anderen Seite beginnt Zähler bei 1, was bedeutet, dass `PageIndex` ist auf den Werten zwischen 0 und `PageCount - 1`.</span><span class="sxs-lookup"><span data-stu-id="d2c96-168">`PageCount`, on the other hand, starts counting at 1, meaning that `PageIndex` is limited to the values between 0 and `PageCount - 1`.</span></span>

<span data-ttu-id="d2c96-169">Lassen Sie s, die die standarddarstellung der unsere GridView-s-Auslagerungsschnittstelle verbessert werden.</span><span class="sxs-lookup"><span data-stu-id="d2c96-169">Let s take a moment to improve the default appearance of our GridView s paging interface.</span></span> <span data-ttu-id="d2c96-170">Können Sie insbesondere s haben die Paging-Schnittstelle, die mit einem hellgrauen Hintergrund rechtsbündig ausgerichtet.</span><span class="sxs-lookup"><span data-stu-id="d2c96-170">Specifically, let s have the paging interface right-aligned with a light gray background.</span></span> <span data-ttu-id="d2c96-171">Statt diese Eigenschaften direkt über das GridView-s `PagerStyle` -Eigenschaft können s erstellen Sie eine CSS-Klasse in `Styles.css` mit dem Namen `PagerRowStyle` und weisen Sie dann die `PagerStyle` s `CssClass` Eigenschaft über unser Design.</span><span class="sxs-lookup"><span data-stu-id="d2c96-171">Rather than setting these properties directly through the GridView s `PagerStyle` property, let s create a CSS class in `Styles.css` named `PagerRowStyle` and then assign the `PagerStyle` s `CssClass` property through our Theme.</span></span> <span data-ttu-id="d2c96-172">Öffnen Sie zunächst `Styles.css` und Definition der Klasse das folgende CSS hinzufügen:</span><span class="sxs-lookup"><span data-stu-id="d2c96-172">Start by opening `Styles.css` and adding the following CSS class definition:</span></span>


[!code-css[Main](paging-and-sorting-report-data-vb/samples/sample3.css)]

<span data-ttu-id="d2c96-173">Öffnen Sie als Nächstes die `GridView.skin` Datei die `DataWebControls` Ordner innerhalb der `App_Themes` Ordner.</span><span class="sxs-lookup"><span data-stu-id="d2c96-173">Next, open the `GridView.skin` file in the `DataWebControls` folder within the `App_Themes` folder.</span></span> <span data-ttu-id="d2c96-174">Wie wir unter den *Masterseiten und Sitenavigation* Lernprogramm, Designmodus Dateien können verwendet werden, um die Standardwerte für die Eigenschaft für ein Steuerelement anzugeben.</span><span class="sxs-lookup"><span data-stu-id="d2c96-174">As we discussed in the *Master Pages and Site Navigation* tutorial, Skin files can be used to specify the default property values for a Web control.</span></span> <span data-ttu-id="d2c96-175">Aus diesem Grund ergänzen die vorhandenen Einstellungen aus, um die Einstellung der `PagerStyle` s `CssClass` Eigenschaft `PagerRowStyle`.</span><span class="sxs-lookup"><span data-stu-id="d2c96-175">Therefore, augment the existing settings to include setting the `PagerStyle` s `CssClass` property to `PagerRowStyle`.</span></span> <span data-ttu-id="d2c96-176">Darüber hinaus können s konfigurieren Sie die Paging-Schnittstelle auf höchstens fünf numerische Schaltflächen mit Anzeigen der `NumericFirstLast` Auslagerungsschnittstelle.</span><span class="sxs-lookup"><span data-stu-id="d2c96-176">Also, let s configure the paging interface to show at most five numeric page buttons using the `NumericFirstLast` paging interface.</span></span>


[!code-aspx[Main](paging-and-sorting-report-data-vb/samples/sample4.aspx)]

## <a name="the-paging-user-experience"></a><span data-ttu-id="d2c96-177">Die Paging-Benutzeroberfläche</span><span class="sxs-lookup"><span data-stu-id="d2c96-177">The Paging User Experience</span></span>

<span data-ttu-id="d2c96-178">Abbildung 8 zeigt die Webseite, wenn über einen Browser aufgerufen werden soll, nachdem die GridView s Paging aktivieren das Kontrollkästchen markiert ist und die `PagerStyle` und `PagerSettings` Konfigurationen wurden durch die `GridView.skin` Datei.</span><span class="sxs-lookup"><span data-stu-id="d2c96-178">Figure 8 shows the web page when visited through a browser after the GridView s Enable Paging checkbox has been checked and the `PagerStyle` and `PagerSettings` configurations have been made through the `GridView.skin` file.</span></span> <span data-ttu-id="d2c96-179">Hinweis wie nur zehn Datensätze werden angezeigt, und die Paging-Schnittstelle gibt an, dass wir die erste Seite der Daten angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="d2c96-179">Note how only ten records are shown, and the paging interface indicates that we are viewing the first page of data.</span></span>


<span data-ttu-id="d2c96-180">[![Mit Paging aktiviert ist werden nur eine Teilmenge der Datensätze zu einem Zeitpunkt angezeigt](paging-and-sorting-report-data-vb/_static/image13.png)](paging-and-sorting-report-data-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="d2c96-180">[![With Paging Enabled, Only a Subset of the Records are Displayed at a Time](paging-and-sorting-report-data-vb/_static/image13.png)](paging-and-sorting-report-data-vb/_static/image12.png)</span></span>

<span data-ttu-id="d2c96-181">**Abbildung 8**: mit Paging aktiviert, nur eine Teilmenge der Datensätze zu einem Zeitpunkt angezeigt werden ([klicken Sie, um das Bild in voller Größe anzeigen](paging-and-sorting-report-data-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="d2c96-181">**Figure 8**: With Paging Enabled, Only a Subset of the Records are Displayed at a Time ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image14.png))</span></span>


<span data-ttu-id="d2c96-182">Klickt der Benutzer auf eine Seite Zahlen in den Paging-Schnittstelle, erfolgt ein Postback aus, und die Seite lädt angezeigt, die Datensätze der Seite "s" angefordert.</span><span class="sxs-lookup"><span data-stu-id="d2c96-182">When the user clicks on one of the page numbers in the paging interface, a postback ensues and the page reloads showing that requested page s records.</span></span> <span data-ttu-id="d2c96-183">Abbildung 9 zeigt die Ergebnisse nach der Aktivierung, um die letzte Seite der Daten anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="d2c96-183">Figure 9 shows the results after opting to view the final page of data.</span></span> <span data-ttu-id="d2c96-184">Beachten Sie, dass die letzte Seite nur einem Datensatz; Dies ist da 81 Datensätze vorhanden sind, insgesamt acht Seiten der 10 Datensätze pro Seite plus eine Seite mit einem Datensatz einzelne führt.</span><span class="sxs-lookup"><span data-stu-id="d2c96-184">Notice that the final page only has one record; this is because there are 81 records in total, resulting in eight pages of 10 records per page plus one page with a lone record.</span></span>


<span data-ttu-id="d2c96-185">[![Durch Klicken auf eine Seitenzahl ein Postback auslöst, und zeigt einen entsprechenden Teil der Datensätze](paging-and-sorting-report-data-vb/_static/image16.png)](paging-and-sorting-report-data-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="d2c96-185">[![Clicking On a Page Number Causes a Postback and Shows the Appropriate Subset of Records](paging-and-sorting-report-data-vb/_static/image16.png)](paging-and-sorting-report-data-vb/_static/image15.png)</span></span>

<span data-ttu-id="d2c96-186">**Abbildung 9**: durch Klicken auf eine Seitenzahl ein Postback auslöst, und zeigt die entsprechenden Teilmenge der Datensätze ([klicken Sie, um das Bild in voller Größe anzeigen](paging-and-sorting-report-data-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="d2c96-186">**Figure 9**: Clicking On a Page Number Causes a Postback and Shows the Appropriate Subset of Records ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image17.png))</span></span>


## <a name="paging-s-server-side-workflow"></a><span data-ttu-id="d2c96-187">Paging s serverseitige Workflow</span><span class="sxs-lookup"><span data-stu-id="d2c96-187">Paging s Server-Side Workflow</span></span>

<span data-ttu-id="d2c96-188">Klickt der Endbenutzer auf eine Schaltfläche in der Auslagerungsdatei-Schnittstelle, ein Postback erfolgt und im folgende serverseitigen-Workflow beginnt:</span><span class="sxs-lookup"><span data-stu-id="d2c96-188">When the end user clicks on a button in the paging interface, a postback ensues and the following server-side workflow begins:</span></span>

1. <span data-ttu-id="d2c96-189">Das GridView-s (oder DetailsView oder FormView) `PageIndexChanging` -Ereignis ausgelöst</span><span class="sxs-lookup"><span data-stu-id="d2c96-189">The GridView s (or DetailsView or FormView) `PageIndexChanging` event fires</span></span>
2. <span data-ttu-id="d2c96-190">Dem ObjectDataSource-Steuerelement erneut anfordert *alle* der Daten aus der BLL; das GridView-s `PageIndex` und `PageSize` Eigenschaftswerte werden verwendet, um zu bestimmen, was der BLL zurückgegebenen Datensätze in den GridView-Ansicht angezeigt werden müssen</span><span class="sxs-lookup"><span data-stu-id="d2c96-190">The ObjectDataSource re-requests *all* of the data from the BLL; the GridView s `PageIndex` and `PageSize` property values are used to determine what records returned from the BLL need to be displayed in the GridView</span></span>
3. <span data-ttu-id="d2c96-191">Das GridView-s `PageIndexChanged` -Ereignis ausgelöst</span><span class="sxs-lookup"><span data-stu-id="d2c96-191">The GridView s `PageIndexChanged` event fires</span></span>

<span data-ttu-id="d2c96-192">In Schritt2 fordert erneut dem ObjectDataSource-Steuerelement alle Daten aus der Datenquelle.</span><span class="sxs-lookup"><span data-stu-id="d2c96-192">In Step 2, the ObjectDataSource re-requests all of the data from its data source.</span></span> <span data-ttu-id="d2c96-193">Diese Art von Auslagerung wird häufig als bezeichnet *Standardpaging*, wie sie s das auslagerungsverhalten verwendet standardmäßig beim Festlegen der `AllowPaging` Eigenschaft `true`.</span><span class="sxs-lookup"><span data-stu-id="d2c96-193">This style of paging is commonly referred to as *default paging*, as it s the paging behavior used by default when setting the `AllowPaging` property to `true`.</span></span> <span data-ttu-id="d2c96-194">Standardwert ruft naiv Auslagern von der Daten-Websteuerelement alle Datensätze für jede Seite der Daten, obwohl nur eine Teilmenge der Datensätze sind tatsächlich dargestellt in der HTML-Code, s, die an den Browser gesendet.</span><span class="sxs-lookup"><span data-stu-id="d2c96-194">With default paging the data Web control naively retrieves all records for each page of data, even though only a subset of records are actually rendered into the HTML that s sent to the browser.</span></span> <span data-ttu-id="d2c96-195">Wenn die Daten für die von der BLL oder "ObjectDataSource" zwischengespeichert werden, ist das Standardpaging betriebsbereiten bei ausreichend großen Resultsets oder für Webanwendungen mit vielen gleichzeitigen Benutzern.</span><span class="sxs-lookup"><span data-stu-id="d2c96-195">Unless the database data is cached by the BLL or ObjectDataSource, default paging is unworkable for sufficiently large result sets or for web applications with many concurrent users.</span></span>

<span data-ttu-id="d2c96-196">Im nächsten Tutorial untersuchen wir implementieren *benutzerdefiniertes Paging*.</span><span class="sxs-lookup"><span data-stu-id="d2c96-196">In the next tutorial we'll examine how to implement *custom paging*.</span></span> <span data-ttu-id="d2c96-197">Mit benutzerdefiniertem Paging können Sie insbesondere dem ObjectDataSource-Steuerelement den genauen Satz von Datensätzen, die für die angeforderte Seite der Daten erforderlich sind nur abrufen anweisen.</span><span class="sxs-lookup"><span data-stu-id="d2c96-197">With custom paging you can specifically instruct the ObjectDataSource to only retrieve the precise set of records needed for the requested page of data.</span></span> <span data-ttu-id="d2c96-198">Sich sicher vorstellen können, wird die Effizienz von Paging für große Resultsets in benutzerdefiniertes Paging erheblich verbessert.</span><span class="sxs-lookup"><span data-stu-id="d2c96-198">As you can imagine, custom paging greatly improves the efficiency of paging through large result sets.</span></span>

> [!NOTE]
> <span data-ttu-id="d2c96-199">Während das Standardpaging nicht geeignet ist, wenn ausreichend große Resultsets oder Websites mit vielen gleichzeitigen Benutzern Auslagerung, beachten Sie, dass benutzerdefinierte Paginierung erfordert weitere Änderungen und Aufwand zum Implementieren und nicht so einfach ist wie das Aktivieren eines Kontrollkästchens, (wie der Standardwert ist Paging) auf.</span><span class="sxs-lookup"><span data-stu-id="d2c96-199">While default paging is not suitable when paging through sufficiently large result sets or for sites with many simultaneous users, realize that custom paging requires more changes and effort to implement and is not as simple as checking a checkbox (as is default paging).</span></span> <span data-ttu-id="d2c96-200">Aus diesem Grund das Standardpaging ist möglicherweise die ideale Wahl für kleine, mit geringer Auslastung Websites oder wenn Paging für relativ kleine Resultsets legt fest, wie sie s sehr viel einfacher und schneller zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="d2c96-200">Therefore, default paging may be the ideal choice for small, low-traffic websites or when paging through relatively small result sets, as it s much easier and quicker to implement.</span></span>


<span data-ttu-id="d2c96-201">Wenn wir wissen, dass wir in unserer Datenbank nie mehr als 100 Produkte haben, ist der minimale Leistungsgewinn zusammenarbeitsmöglichkeiten benutzerdefiniertes Paging z. B. wahrscheinlich von den für ihre Implementierung erforderliche Aufwand versetzt.</span><span class="sxs-lookup"><span data-stu-id="d2c96-201">For example, if we know that we'll never have more than 100 products in our database, the minimal performance gain enjoyed by custom paging is likely offset by the effort required to implement it.</span></span> <span data-ttu-id="d2c96-202">Wenn Sie jedoch, wir eines Tages mehreren Tausend oder zehntausend von Tausenden von Produkten, haben möglicherweise *nicht* benutzerdefinierte Paginierung implementieren würde erheblich behindern die Skalierbarkeit der Anwendung.</span><span class="sxs-lookup"><span data-stu-id="d2c96-202">If, however, we may one day have thousands or tens of thousands of products, *not* implementing custom paging would greatly hamper the scalability of our application.</span></span>

## <a name="step-4-customizing-the-paging-experience"></a><span data-ttu-id="d2c96-203">Schritt 4: Anpassen der Paginierung</span><span class="sxs-lookup"><span data-stu-id="d2c96-203">Step 4: Customizing the Paging Experience</span></span>

<span data-ttu-id="d2c96-204">Die datenwebsteuerelementen bieten eine Reihe von Eigenschaften, die verwendet werden können, um die Benutzer s Paging zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="d2c96-204">The data Web controls provide a number of properties that can be used to enhance the user s paging experience.</span></span> <span data-ttu-id="d2c96-205">Die `PageCount` -Eigenschaft, z. B. gibt an, wie viele Seiten gesamte vorhanden sind, während die `PageIndex` Eigenschaft gibt an der aktuellen Seite aufgerufen wird, und kann festgelegt werden, um einen Benutzer zu einer bestimmten Seite schnell zu verschieben.</span><span class="sxs-lookup"><span data-stu-id="d2c96-205">The `PageCount` property, for example, indicates how many total pages there are, while the `PageIndex` property indicates the current page being visited and can be set to quickly move a user to a specific page.</span></span> <span data-ttu-id="d2c96-206">Um zu veranschaulichen, wie Sie mit diesen Eigenschaften können nach der Paginierung benutzerfreundlichkeit s verbessert werden, können eine Bezeichnung hinzufügen s Web Steuern auf unserer Seite, die die Benutzer darüber informiert, welche Seite wird sie erneut derzeit das Unternehmen besuchen, zusammen mit einem DropDownList-Steuerelement, das schnell zu einer Seite zu springen ermöglicht .</span><span class="sxs-lookup"><span data-stu-id="d2c96-206">To illustrate how to use these properties to improve upon the user s paging experience, let s add a Label Web control to our page that informs the user what page they re currently visiting, along with a DropDownList control that allows them to quickly jump to any given page.</span></span>

<span data-ttu-id="d2c96-207">Zunächst ein Label-Steuerelement auf Ihrer Seite hinzufügen, legen Sie seine `ID` Eigenschaft `PagingInformation`, und deaktivieren Sie die `Text` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="d2c96-207">First, add a Label Web control to your page, set its `ID` property to `PagingInformation`, and clear out its `Text` property.</span></span> <span data-ttu-id="d2c96-208">Als Nächstes erstellen Sie einen Ereignishandler für das GridView-s `DataBound` Ereignis und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="d2c96-208">Next, create an event handler for the GridView s `DataBound` event and add the following code:</span></span>


[!code-vb[Main](paging-and-sorting-report-data-vb/samples/sample5.vb)]

<span data-ttu-id="d2c96-209">Dieser Ereignishandler weist die `PagingInformation` Bezeichnung s `Text` Eigenschaft, um eine Nachricht informiert den Benutzer die Seite, die sie gerade besuchen `Products.PageIndex + 1` aus wie vielen Gesamtseitenzahl `Products.PageCount` (Vertriebsdatenpunkt auf 1 fest, um die `Products.PageIndex` Eigenschaft da `PageIndex` wird indiziert, beginnend mit 0).</span><span class="sxs-lookup"><span data-stu-id="d2c96-209">This event handler assigns the `PagingInformation` Label s `Text` property to a message informing the user the page they are currently visiting `Products.PageIndex + 1` out of how many total pages `Products.PageCount` (we add 1 to the `Products.PageIndex` property because `PageIndex` is indexed starting at 0).</span></span> <span data-ttu-id="d2c96-210">Ich habe der Zuweisen dieser Bezeichnung s `Text` -Eigenschaft in der `DataBound` -Ereignishandler im Gegensatz zu den `PageIndexChanged` -Ereignishandler da die `DataBound` Ereignis ausgelöst wird, jedes Mal, wenn Daten an die GridView gebunden werden, während die `PageIndexChanged` Ereignishandler nur wird ausgelöst, wenn der Seitenindex geändert wird.</span><span class="sxs-lookup"><span data-stu-id="d2c96-210">I chose the assign this Label s `Text` property in the `DataBound` event handler as opposed to the `PageIndexChanged` event handler because the `DataBound` event fires every time data is bound to the GridView whereas the `PageIndexChanged` event handler only fires when the page index is changed.</span></span> <span data-ttu-id="d2c96-211">Besuchen Sie die Wenn GridView zunächst Daten auf der ersten Seite gebunden ist, die `PageIndexChanging` Ereignis t ausgelöst (während der `DataBound` -Ereignis erledigt).</span><span class="sxs-lookup"><span data-stu-id="d2c96-211">When the GridView is initially data bound on the first page visit, the `PageIndexChanging` event doesn t fire (whereas the `DataBound` event does).</span></span>

<span data-ttu-id="d2c96-212">Durch diese hinzufügen wird der Benutzer jetzt eine Meldung angezeigt, der angibt, welcher Seite, die sie besuchen und wie viele Gesamtseitenzahl Daten vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="d2c96-212">With this addition, the user is now shown a message indicating what page they are visiting and how many total pages of data there are.</span></span>


<span data-ttu-id="d2c96-213">[![Die aktuelle Seitenzahl und die Anzahl der Seiten gesamt werden angezeigt.](paging-and-sorting-report-data-vb/_static/image19.png)](paging-and-sorting-report-data-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="d2c96-213">[![The Current Page Number and Total Number of Pages are Displayed](paging-and-sorting-report-data-vb/_static/image19.png)](paging-and-sorting-report-data-vb/_static/image18.png)</span></span>

<span data-ttu-id="d2c96-214">**Abbildung 10**: die aktuelle Seitenzahl und die gesamte Anzahl der Seiten werden angezeigt ([klicken Sie, um das Bild in voller Größe anzeigen](paging-and-sorting-report-data-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="d2c96-214">**Figure 10**: The Current Page Number and Total Number of Pages are Displayed ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image20.png))</span></span>


<span data-ttu-id="d2c96-215">Können Sie neben das Bezeichnungssteuerelement s, die auch ein DropDownList-Steuerelement hinzufügen, die die Seitennummern in den GridView-Ansicht mit der aktuell angezeigten Seite ausgewählt werden aufgelistet.</span><span class="sxs-lookup"><span data-stu-id="d2c96-215">In addition to the Label control, let s also add a DropDownList control that lists the page numbers in the GridView with the currently viewed page selected.</span></span> <span data-ttu-id="d2c96-216">Die Idee dabei ist, dass der Benutzer schnell von der aktuellen Seite wechseln kann indem Sie einfach den neuen Index für die Seite aus der Dropdownliste auswählen.</span><span class="sxs-lookup"><span data-stu-id="d2c96-216">The idea here is that the user can quickly jump from the current page to another by simply selecting the new page index from the DropDownList.</span></span> <span data-ttu-id="d2c96-217">Starten, indem Sie das Hinzufügen von einem DropDownList-Steuerelement, zum Festlegen der `ID` Eigenschaft `PageList` und überprüfen die Option "AutoPostBack aktivieren" smart Tag.</span><span class="sxs-lookup"><span data-stu-id="d2c96-217">Start by adding a DropDownList to the Designer, setting its `ID` property to `PageList` and checking the Enable AutoPostBack option from its smart tag.</span></span>

<span data-ttu-id="d2c96-218">Als Nächstes zurück zu den `DataBound` -Ereignishandler, und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="d2c96-218">Next, return to the `DataBound` event handler and add the following code:</span></span>


[!code-vb[Main](paging-and-sorting-report-data-vb/samples/sample6.vb)]

<span data-ttu-id="d2c96-219">Dieser Code beginnt, durch die Elemente im beseitigen der `PageList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="d2c96-219">This code begins by clearing out the items in the `PageList` DropDownList.</span></span> <span data-ttu-id="d2c96-220">Dies mag überflüssig, da eine ausreichen t erwarten, dass die Anzahl der Seiten ändern, aber anderen Benutzern können das System gleichzeitig zu verwenden, hinzufügen oder entfernen Datensätze aus der `Products` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="d2c96-220">This may seem superfluous, since one wouldn t expect the number of pages to change, but other users may be using the system simultaneously, adding or removing records from the `Products` table.</span></span> <span data-ttu-id="d2c96-221">Die Anzahl der Seiten mit Daten können geändert werden solche einfügungen oder löschungen.</span><span class="sxs-lookup"><span data-stu-id="d2c96-221">Such insertions or deletions could alter the number of pages of data.</span></span>

<span data-ttu-id="d2c96-222">Als Nächstes müssen wir erneut, die Seitenzahlen zu erstellen und verwenden diejenige, die an die aktuelle GridView ordnet `PageIndex` standardmäßig ausgewählt.</span><span class="sxs-lookup"><span data-stu-id="d2c96-222">Next, we need to create the page numbers again and have the one that maps to the current GridView `PageIndex` selected by default.</span></span> <span data-ttu-id="d2c96-223">Wir erreichen dies mit einer Schleife von 0 bis `PageCount - 1`, Hinzufügen eines neuen `ListItem` in jeder Iteration und die Einstellung der `Selected` Eigenschaft auf "true", der aktuellen Iterationsindex GridView s gleich `PageIndex` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="d2c96-223">We accomplish this with a loop from 0 to `PageCount - 1`, adding a new `ListItem` in each iteration and setting its `Selected` property to true if the current iteration index equals the GridView s `PageIndex` property.</span></span>

<span data-ttu-id="d2c96-224">Abschließend müssen wir erstellen einen Ereignishandler für das DropDownList-s `SelectedIndexChanged` Ereignis, das ausgelöst wird jedes Mal, die der Benutzer wählen Sie ein anderes Element aus der Liste.</span><span class="sxs-lookup"><span data-stu-id="d2c96-224">Finally, we need to create an event handler for the DropDownList s `SelectedIndexChanged` event, which fires each time the user pick a different item from the list.</span></span> <span data-ttu-id="d2c96-225">Um diesen Ereignishandler zu erstellen, einfach Doppelklicken Sie auf der Dropdownliste im Designer, und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="d2c96-225">To create this event handler, simply double-click the DropDownList in the Designer, then add the following code:</span></span>


[!code-vb[Main](paging-and-sorting-report-data-vb/samples/sample7.vb)]

<span data-ttu-id="d2c96-226">Wie in Abbildung 11 gezeigt, ändern Sie lediglich die GridView s `PageIndex` -Eigenschaft bewirkt, dass die Daten erneut an die GridView gebunden werden.</span><span class="sxs-lookup"><span data-stu-id="d2c96-226">As Figure 11 shows, merely changing the GridView s `PageIndex` property causes the data to be rebound to the GridView.</span></span> <span data-ttu-id="d2c96-227">In den GridView-s `DataBound` -Ereignishandler der entsprechenden Dropdownliste `ListItem` ausgewählt ist.</span><span class="sxs-lookup"><span data-stu-id="d2c96-227">In the GridView s `DataBound` event handler, the appropriate DropDownList `ListItem` is selected.</span></span>


<span data-ttu-id="d2c96-228">[![Der Benutzer ist die sechste Seite beim Auswählen der Element "Page" 6 Dropdown-Liste automatisch ausgeführt.](paging-and-sorting-report-data-vb/_static/image22.png)](paging-and-sorting-report-data-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="d2c96-228">[![The User is Automatically Taken to the Sixth Page When Selecting the Page 6 Drop-Down List Item](paging-and-sorting-report-data-vb/_static/image22.png)](paging-and-sorting-report-data-vb/_static/image21.png)</span></span>

<span data-ttu-id="d2c96-229">**Abbildung 11**: der Benutzer ist die sechste Seite beim Auswählen der Element "Page" 6 Dropdown-Liste automatisch ausgeführt ([klicken Sie, um das Bild in voller Größe anzeigen](paging-and-sorting-report-data-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="d2c96-229">**Figure 11**: The User is Automatically Taken to the Sixth Page When Selecting the Page 6 Drop-Down List Item ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image23.png))</span></span>


## <a name="step-5-adding-bi-directional-sorting-support"></a><span data-ttu-id="d2c96-230">Schritt 5: Hinzufügen von Unterstützung der Datenquellensortierung bidirektionale</span><span class="sxs-lookup"><span data-stu-id="d2c96-230">Step 5: Adding Bi-Directional Sorting Support</span></span>

<span data-ttu-id="d2c96-231">Überprüfen Sie die Option "Sortieren aktivieren" das GridView-s-Smarttag einfach hinzufügen der Unterstützung der datenquellensortierung bidirektionale ist so einfach wie das Hinzufügen von pagingunterstützung (wodurch das GridView-s [ `AllowSorting` Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.allowsorting.aspx) zu `true`).</span><span class="sxs-lookup"><span data-stu-id="d2c96-231">Adding bi-directional sorting support is as simple as adding paging support simply check the Enable Sorting option from the GridView s smart tag (which sets the GridView s [`AllowSorting` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.allowsorting.aspx) to `true`).</span></span> <span data-ttu-id="d2c96-232">Dies rendert die Header der GridView s Felder als LinkButtons, die beim Klicken auf, dazu führen, dass einen Postback aus, und die Daten nach der Spalte in aufsteigender Reihenfolge sortiert zurück.</span><span class="sxs-lookup"><span data-stu-id="d2c96-232">This renders each of the headers of the GridView s fields as LinkButtons that, when clicked, cause a postback and return the data sorted by the clicked column in ascending order.</span></span> <span data-ttu-id="d2c96-233">Die Daten in absteigender Reihenfolge klicken Sie erneut auf den gleichen Header LinkButton neu sortiert werden.</span><span class="sxs-lookup"><span data-stu-id="d2c96-233">Clicking the same header LinkButton again re-sorts the data in descending order.</span></span>

> [!NOTE]
> <span data-ttu-id="d2c96-234">Wenn Sie eine benutzerdefinierte Datenzugriffsschicht anstelle eines typisierten Datasets verwenden, Sie keine Option zum Sortieren Aktivieren der GridView-s-Smarttag möglicherweise.</span><span class="sxs-lookup"><span data-stu-id="d2c96-234">If you are using a custom Data Access Layer rather than a Typed DataSet, you may not have an Enable Sorting option in the GridView s smart tag.</span></span> <span data-ttu-id="d2c96-235">Nur GridViews an Datenquellen, die native sortieren Unterstützung gebunden haben, dieses Kontrollkästchen, die zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="d2c96-235">Only GridViews bound to data sources that natively support sorting have this checkbox available.</span></span> <span data-ttu-id="d2c96-236">Das typisierte DataSet bietet Unterstützung der datenquellensortierung Out-of-the-Box aus, da ADO.NET DataTable bietet eine `Sort` Methode, wenn aufgerufen, sortiert die DataTable s DataRows anhand der angegebenen Kriterien.</span><span class="sxs-lookup"><span data-stu-id="d2c96-236">The Typed DataSet provides out-of-the-box sorting support since the ADO.NET DataTable provides a `Sort` method that, when invoked, sorts the DataTable s DataRows using the criteria specified.</span></span>


<span data-ttu-id="d2c96-237">Wenn die DAL kein, Objekte, die nativ sortiert Sortierung unterstützen zurück, müssen Sie konfigurieren die "ObjectDataSource" zum Übergeben von Sortierinformationen an die Business Logic Layer, die die Daten sortieren oder die Daten können, von der DAL.</span><span class="sxs-lookup"><span data-stu-id="d2c96-237">If your DAL does not return objects that natively support sorting you will need to configure the ObjectDataSource to pass sorting information to the Business Logic Layer, which can either sort the data or have the data sorted by the DAL.</span></span> <span data-ttu-id="d2c96-238">Wir werden das Sortieren von Daten auf die Geschäftslogik und Datenzugriffsschichten in einem späteren Tutorial untersuchen.</span><span class="sxs-lookup"><span data-stu-id="d2c96-238">We'll explore how to sort data at the Business Logic and Data Access Layers in a future tutorial.</span></span>

<span data-ttu-id="d2c96-239">Die Sortierung LinkButtons werden als HTML-Links gerendert, deren aktuellen Farben (für einen nicht besuchter Link und Dunkelrot für ein bereits besuchter Link Blau) mit der Hintergrundfarbe der Kopfzeile miteinander in Konflikt geraten.</span><span class="sxs-lookup"><span data-stu-id="d2c96-239">The sorting LinkButtons are rendered as HTML hyperlinks, whose current colors (blue for an unvisited link and a dark red for a visited link) clash with the background color of the header row.</span></span> <span data-ttu-id="d2c96-240">Stattdessen können s haben alle Header-Zeile-Links, die weiß, unabhängig davon, ob sie Ve wurde aufgerufen oder nicht.</span><span class="sxs-lookup"><span data-stu-id="d2c96-240">Instead, let s have all header row links displayed in white, regardless of whether they ve been visited or not.</span></span> <span data-ttu-id="d2c96-241">Dies kann erreicht werden, indem Sie Folgendes hinzufügen der `Styles.css` Klasse:</span><span class="sxs-lookup"><span data-stu-id="d2c96-241">This can be accomplished by adding the following to the `Styles.css` class:</span></span>


[!code-css[Main](paging-and-sorting-report-data-vb/samples/sample8.css)]

<span data-ttu-id="d2c96-242">Diese Syntax gibt an, um die weißen Text verwenden, wenn diese Hyperlinks in einem Element anzeigen, die die HeaderStyle-Klasse verwendet.</span><span class="sxs-lookup"><span data-stu-id="d2c96-242">This syntax indicates to use white text when displaying those hyperlinks within an element that uses the HeaderStyle class.</span></span>

<span data-ttu-id="d2c96-243">Nach dem Hinzufügen dieses CSS beim Besuch der Seite über einen Browser sollte am Bildschirm ähnelt Abbildung 12.</span><span class="sxs-lookup"><span data-stu-id="d2c96-243">After this CSS addition, when visiting the page through a browser your screen should look similar to Figure 12.</span></span> <span data-ttu-id="d2c96-244">Abbildung 12 zeigt insbesondere, die Ergebnisse nach dem Preis s-Header auf den Link geklickt wurde.</span><span class="sxs-lookup"><span data-stu-id="d2c96-244">In particular, Figure 12 shows the results after the Price field s header link has been clicked.</span></span>


<span data-ttu-id="d2c96-245">[![Die Ergebnisse sind nach UnitPrice in aufsteigender Reihenfolge sortiert wurden](paging-and-sorting-report-data-vb/_static/image25.png)](paging-and-sorting-report-data-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="d2c96-245">[![The Results Have Been Sorted by the UnitPrice in Ascending Order](paging-and-sorting-report-data-vb/_static/image25.png)](paging-and-sorting-report-data-vb/_static/image24.png)</span></span>

<span data-ttu-id="d2c96-246">**Abbildung 12**: die Ergebnisse haben nach UnitPrice in aufsteigender Reihenfolge sortiert wurden ([klicken Sie, um das Bild in voller Größe anzeigen](paging-and-sorting-report-data-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="d2c96-246">**Figure 12**: The Results Have Been Sorted by the UnitPrice in Ascending Order ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image26.png))</span></span>


## <a name="examining-the-sorting-workflow"></a><span data-ttu-id="d2c96-247">Untersuchen die Sortierung Workflow</span><span class="sxs-lookup"><span data-stu-id="d2c96-247">Examining the Sorting Workflow</span></span>

<span data-ttu-id="d2c96-248">Alle GridView Felder, die BoundField-, CheckBoxField, TemplateField und usw. haben eine `SortExpression` -Eigenschaft, die der Ausdruck gibt an, die verwendet werden soll, die Daten sortiert werden soll, wenn dieses Feld s Header sortierlink geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="d2c96-248">All GridView fields the BoundField, CheckBoxField, TemplateField, and so on have a `SortExpression` property that indicates the expression that should be used to sort the data when that field s sorting header link is clicked.</span></span> <span data-ttu-id="d2c96-249">Das GridView hat auch eine `SortExpression` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="d2c96-249">The GridView also has a `SortExpression` property.</span></span> <span data-ttu-id="d2c96-250">Wenn Sortierung Header LinkButton geklickt wird, weist die GridView, Feld s `SortExpression` -Wert in seine `SortExpression` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="d2c96-250">When a sorting header LinkButton is clicked, the GridView assigns that field s `SortExpression` value to its `SortExpression` property.</span></span> <span data-ttu-id="d2c96-251">Als Nächstes die Daten aus dem ObjectDataSource-Steuerelement erneut abgerufen und entsprechend der GridView-s `SortExpression` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="d2c96-251">Next, the data is re-retrieved from the ObjectDataSource and sorted according to the GridView s `SortExpression` property.</span></span> <span data-ttu-id="d2c96-252">Die folgende Liste enthält die Abfolge der Schritte, die sich herausstellt, wenn ein Endbenutzer die Daten in einer GridView-Ansicht sortiert werden:</span><span class="sxs-lookup"><span data-stu-id="d2c96-252">The following list details the sequence of steps that transpires when an end user sorts the data in a GridView:</span></span>

1. <span data-ttu-id="d2c96-253">Das GridView-s [Sorting-Ereignis](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sorting(VS.80).aspx) ausgelöst wird</span><span class="sxs-lookup"><span data-stu-id="d2c96-253">The GridView s [Sorting event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sorting(VS.80).aspx) fires</span></span>
2. <span data-ttu-id="d2c96-254">Das GridView-s [ `SortExpression` Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sortexpression.aspx) nastaven NA hodnotu der `SortExpression` des Felds, deren Sortierung Header LinkButton geklickt wurde</span><span class="sxs-lookup"><span data-stu-id="d2c96-254">The GridView s [`SortExpression` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sortexpression.aspx) is set to the `SortExpression` of the field whose sorting header LinkButton was clicked</span></span>
3. <span data-ttu-id="d2c96-255">Die ObjectDataSource ruft alle Daten aus der BLL erneut ab und sortiert dann die Daten mithilfe der GridView-s `SortExpression`</span><span class="sxs-lookup"><span data-stu-id="d2c96-255">The ObjectDataSource re-retrieves all of the data from the BLL and then sorts the data using the GridView s `SortExpression`</span></span>
4. <span data-ttu-id="d2c96-256">Das GridView-s `PageIndex` Eigenschaft auf 0 zurückgesetzt, was bedeutet, dass beim Sortieren des Benutzers wird zurückgegeben, zur ersten Seite der Daten (vorausgesetzt, Unterstützung der Paginierung implementiert wurde)</span><span class="sxs-lookup"><span data-stu-id="d2c96-256">The GridView s `PageIndex` property is reset to 0, meaning that when sorting the user is returned to the first page of data (assuming paging support has been implemented)</span></span>
5. <span data-ttu-id="d2c96-257">Das GridView-s [ `Sorted` Ereignis](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sorted(VS.80).aspx) ausgelöst wird</span><span class="sxs-lookup"><span data-stu-id="d2c96-257">The GridView s [`Sorted` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sorted(VS.80).aspx) fires</span></span>

<span data-ttu-id="d2c96-258">Wie Sie mit Standardpaging, sortieren die Option standardmäßig erneut abgerufen *alle* Datensätze aus der Geschäftslogikschicht.</span><span class="sxs-lookup"><span data-stu-id="d2c96-258">Like with default paging, the default sorting option re-retrieves *all* of the records from the BLL.</span></span> <span data-ttu-id="d2c96-259">Sortierung ohne Paging oder bei Verwendung der Sortierung mit standardmäßig Paging, dort s keine Möglichkeit, diese Leistung erreicht (ohne das Zwischenspeichern von Daten in der Datenbank) zu umgehen.</span><span class="sxs-lookup"><span data-stu-id="d2c96-259">When using sorting without paging or when using sorting with default paging, there s no way to circumvent this performance hit (short of caching the database data).</span></span> <span data-ttu-id="d2c96-260">Jedoch, in einem späteren Tutorial sehen es möglich, Daten effizient zu sortieren, wenn benutzerdefiniertes Paging zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="d2c96-260">However, as we'll see in a future tutorial, it s possible to efficiently sort data when using custom paging.</span></span>

<span data-ttu-id="d2c96-261">Beim Binden von einem ObjectDataSource-Steuerelement an die GridView in der Dropdown-Liste in den GridView-s-Smarttag jedes GridView-Feld verfügt automatisch über die `SortExpression` -Eigenschaft zugewiesen. auf den Namen des Datenfelds in der `ProductsRow` Klasse.</span><span class="sxs-lookup"><span data-stu-id="d2c96-261">When binding an ObjectDataSource to the GridView through the drop-down list in the GridView s smart tag, each GridView field automatically has its `SortExpression` property assigned to the name of the data field in the `ProductsRow` class.</span></span> <span data-ttu-id="d2c96-262">Z. B. die `ProductName` BoundField-s `SortExpression` nastaven NA hodnotu `ProductName`, wie im folgenden deklarativen Markup dargestellt:</span><span class="sxs-lookup"><span data-stu-id="d2c96-262">For example, the `ProductName` BoundField s `SortExpression` is set to `ProductName`, as shown in the following declarative markup:</span></span>


[!code-aspx[Main](paging-and-sorting-report-data-vb/samples/sample9.aspx)]

<span data-ttu-id="d2c96-263">Ein Feld kann so konfiguriert werden, damit sie s nicht sortierbar durch Beseitigen der `SortExpression` Eigenschaft (eine leere Zeichenfolge zuweisen).</span><span class="sxs-lookup"><span data-stu-id="d2c96-263">A field can be configured so that it s not sortable by clearing out its `SortExpression` property (assigning it to an empty string).</span></span> <span data-ttu-id="d2c96-264">Um dies zu veranschaulichen, stellen Sie sich vor, die wir nihnen t können unsere Kunden, unsere Produkte nach Preis sortiert werden soll.</span><span class="sxs-lookup"><span data-stu-id="d2c96-264">To illustrate this, imagine that we didn t want to let our customers sort our products by price.</span></span> <span data-ttu-id="d2c96-265">Die `UnitPrice` BoundField-s `SortExpression` Eigenschaft entfernt werden kann, oder aus dem deklarativen Markup als auch über die Felder (Dialogfeld) (das durch Klicken auf den Link "Spalten bearbeiten" in das GridView-s-Smarttag).</span><span class="sxs-lookup"><span data-stu-id="d2c96-265">The `UnitPrice` BoundField s `SortExpression` property can be removed either from the declarative markup or through the Fields dialog box (which is accessible by clicking on the Edit Columns link in the GridView s smart tag).</span></span>


![Die Ergebnisse sind nach UnitPrice in aufsteigender Reihenfolge sortiert wurden](paging-and-sorting-report-data-vb/_static/image27.png)

<span data-ttu-id="d2c96-267">**Abbildung 13**: die Ergebnisse haben UnitPrice in aufsteigender Reihenfolge sortiert wurden</span><span class="sxs-lookup"><span data-stu-id="d2c96-267">**Figure 13**: The Results Have Been Sorted by the UnitPrice in Ascending Order</span></span>


<span data-ttu-id="d2c96-268">Nach der `SortExpression` Eigenschaft wurde für entfernt die `UnitPrice` BoundField, als Text und nicht als einen Link an, wodurch verhindert, dass Benutzer die Daten nach Preis sortiert, wird der Header gerendert.</span><span class="sxs-lookup"><span data-stu-id="d2c96-268">Once the `SortExpression` property has been removed for the `UnitPrice` BoundField, the header is rendered as text rather than as a link, thereby preventing users from sorting the data by price.</span></span>


<span data-ttu-id="d2c96-269">[![Entfernen Sie die SortExpression-Eigenschaft, können Benutzer nicht mehr die Produkte nach Preis sortieren](paging-and-sorting-report-data-vb/_static/image29.png)](paging-and-sorting-report-data-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="d2c96-269">[![By Removing the SortExpression Property, Users Can No Longer Sort the Products By Price](paging-and-sorting-report-data-vb/_static/image29.png)](paging-and-sorting-report-data-vb/_static/image28.png)</span></span>

<span data-ttu-id="d2c96-270">**Abbildung 14**: durch das Entfernen der SortExpression-Eigenschaft, können Benutzer nicht mehr der Produkte von Preis sortieren ([klicken Sie, um das Bild in voller Größe anzeigen](paging-and-sorting-report-data-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="d2c96-270">**Figure 14**: By Removing the SortExpression Property, Users Can No Longer Sort the Products By Price ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image30.png))</span></span>


## <a name="programmatically-sorting-the-gridview"></a><span data-ttu-id="d2c96-271">Programmgesteuertes Sortieren von GridView</span><span class="sxs-lookup"><span data-stu-id="d2c96-271">Programmatically Sorting the GridView</span></span>

<span data-ttu-id="d2c96-272">Sie können auch Sortieren des Inhalts der GridView programmgesteuert mithilfe der GridView-s [ `Sort` Methode](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sort.aspx).</span><span class="sxs-lookup"><span data-stu-id="d2c96-272">You can also sort the contents of the GridView programmatically by using the GridView s [`Sort` method](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sort.aspx).</span></span> <span data-ttu-id="d2c96-273">Übergeben Sie einfach die `SortExpression` Wert Sortierungskriterium zusammen mit den [ `SortDirection` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sortdirection.aspx) (`Ascending` oder `Descending`), und die GridView-s-Daten werden erneut sortiert werden.</span><span class="sxs-lookup"><span data-stu-id="d2c96-273">Simply pass in the `SortExpression` value to sort by along with the [`SortDirection`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sortdirection.aspx) (`Ascending` or `Descending`), and the GridView s data will be re-sorted.</span></span>

<span data-ttu-id="d2c96-274">Stellen Sie sich vor, dass der Grund, die wir Sortieren nach deaktiviert die `UnitPrice` wurde, weil bedenken, dass unsere Kunden einfach nur die kostengünstigste Produkte kaufen würde.</span><span class="sxs-lookup"><span data-stu-id="d2c96-274">Imagine that the reason we turned off sorting by the `UnitPrice` was because we were worried that our customers would simply buy only the lowest-priced products.</span></span> <span data-ttu-id="d2c96-275">Allerdings möchten wir empfehlen, zu der teuersten Produkte zu kaufen, damit wir d zu die Produkten nach Preis, jedoch nur von dem die teuersten Preis zu sortieren wie.</span><span class="sxs-lookup"><span data-stu-id="d2c96-275">However, we want to encourage them to buy the most expensive products, so we d like them to be able to sort the products by price, but only from the most expensive price to the least.</span></span>

<span data-ttu-id="d2c96-276">Erreichen dies hinzufügen ein Websteuerelements von Schaltfläche auf der Seite legen Sie seine `ID` Eigenschaft, um `SortPriceDescending`, und die zugehörige `Text` Eigenschaft sortieren nach Preis.</span><span class="sxs-lookup"><span data-stu-id="d2c96-276">To accomplish this add a Button Web control to the page, set its `ID` property to `SortPriceDescending`, and its `Text` property to Sort by Price.</span></span> <span data-ttu-id="d2c96-277">Als Nächstes erstellen Sie einen Ereignishandler für die Schaltfläche "s" `Click` Ereignis durch Doppelklicken auf das Schaltflächen-Steuerelement im Designer.</span><span class="sxs-lookup"><span data-stu-id="d2c96-277">Next, create an event handler for the Button s `Click` event by double-clicking the Button control in the Designer.</span></span> <span data-ttu-id="d2c96-278">Fügen Sie diesem Ereignishandler den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="d2c96-278">Add the following code to this event handler:</span></span>


[!code-vb[Main](paging-and-sorting-report-data-vb/samples/sample10.vb)]

<span data-ttu-id="d2c96-279">Auf diese Schaltfläche klicken, gibt den Benutzer auf die erste Seite mit den Produkten, sortiert nach Preis, teuersten am günstigsten ist (siehe Abbildung 15) zurück.</span><span class="sxs-lookup"><span data-stu-id="d2c96-279">Clicking this Button returns the user to the first page with the products sorted by price, from most expensive to least expensive (see Figure 15).</span></span>


<span data-ttu-id="d2c96-280">[![Klicken auf die Schaltfläche ordnet die Produkte aus dem die teuersten zur ältesten](paging-and-sorting-report-data-vb/_static/image32.png)](paging-and-sorting-report-data-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="d2c96-280">[![Clicking the Button Orders the Products From the Most Expensive to the Least](paging-and-sorting-report-data-vb/_static/image32.png)](paging-and-sorting-report-data-vb/_static/image31.png)</span></span>

<span data-ttu-id="d2c96-281">**Abbildung 15**: Klicken auf die Schaltfläche die Produkte aus der teuerste zur ältesten Aufträge ([klicken Sie, um das Bild in voller Größe anzeigen](paging-and-sorting-report-data-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="d2c96-281">**Figure 15**: Clicking the Button Orders the Products From the Most Expensive to the Least ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image33.png))</span></span>


## <a name="summary"></a><span data-ttu-id="d2c96-282">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="d2c96-282">Summary</span></span>

<span data-ttu-id="d2c96-283">In diesem Tutorial erläutert, wie standardmäßige Auslagern und Sortieren von Funktionen implementiert wurden beide so einfach wie das Aktivieren eines Kontrollkästchens!</span><span class="sxs-lookup"><span data-stu-id="d2c96-283">In this tutorial we saw how to implement default paging and sorting capabilities, both of which were as easy as checking a checkbox!</span></span> <span data-ttu-id="d2c96-284">Wenn ein Benutzer sortiert oder durch die Daten Seiten, erweitert ein ähnlichen Workflow:</span><span class="sxs-lookup"><span data-stu-id="d2c96-284">When a user sorts or pages through data, a similar workflow unfolds:</span></span>

1. <span data-ttu-id="d2c96-285">Ein Postback Sicherheitsvorschriften</span><span class="sxs-lookup"><span data-stu-id="d2c96-285">A postback ensues</span></span>
2. <span data-ttu-id="d2c96-286">Die Daten-Websteuerelement s Ebene vorab-Ereignis ausgelöst (`PageIndexChanging` oder `Sorting`)</span><span class="sxs-lookup"><span data-stu-id="d2c96-286">The data Web control s pre-level event fires (`PageIndexChanging` or `Sorting`)</span></span>
3. <span data-ttu-id="d2c96-287">Alle Daten erneut abgerufen, indem dem ObjectDataSource-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="d2c96-287">All of the data is re-retrieved by the ObjectDataSource</span></span>
4. <span data-ttu-id="d2c96-288">Die Daten-Websteuerelement s Ebene nach dem Ereignis wird ausgelöst (`PageIndexChanged` oder `Sorted`)</span><span class="sxs-lookup"><span data-stu-id="d2c96-288">The data Web control s post-level event fires (`PageIndexChanged` or `Sorted`)</span></span>

<span data-ttu-id="d2c96-289">Beim Implementieren von grundlegenden Paginierung und Sortierung zum Kinderspiel wird muss mehr Aufwand, der eine effizientere benutzerdefinierte Paging verwendet oder weiter verbessern, die Auslagerungsdatei oder Sortierung-Schnittstelle ausgeübt.</span><span class="sxs-lookup"><span data-stu-id="d2c96-289">While implementing basic paging and sorting is a breeze, more effort must be exerted to utilize the more efficient custom paging or to further enhance the paging or sorting interface.</span></span> <span data-ttu-id="d2c96-290">Zukünftige Tutorials werden diese Themen erkunden.</span><span class="sxs-lookup"><span data-stu-id="d2c96-290">Future tutorials will explore these topics.</span></span>

<span data-ttu-id="d2c96-291">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="d2c96-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="d2c96-292">Der Autor</span><span class="sxs-lookup"><span data-stu-id="d2c96-292">About the Author</span></span>

<span data-ttu-id="d2c96-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben Büchern zu ASP/ASP.NET und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), arbeitet mit Microsoft-Web-Technologien seit 1998.</span><span class="sxs-lookup"><span data-stu-id="d2c96-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="d2c96-294">Er ist als ein unabhängiger Berater, Schulungsleiter und Autor.</span><span class="sxs-lookup"><span data-stu-id="d2c96-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="d2c96-295">Sein neueste Buch wird [*Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="d2c96-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="d2c96-296">Er ist unter [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d2c96-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="d2c96-297">oder über seinen Blog finden Sie unter [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="d2c96-297">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="d2c96-298">[Zurück](creating-a-customized-sorting-user-interface-cs.md)
> [Weiter](efficiently-paging-through-large-amounts-of-data-vb.md)</span><span class="sxs-lookup"><span data-stu-id="d2c96-298">[Previous](creating-a-customized-sorting-user-interface-cs.md)
[Next](efficiently-paging-through-large-amounts-of-data-vb.md)</span></span>
