---
uid: web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
title: Einfügen eines neuen Datensatzes in den GridView Fuß (VB) | Microsoft-Dokumentation
author: rick-anderson
description: Das GridView-Steuerelement bietet zwar keine integrierten Unterstützung für das Einfügen eines neuen Datensatzes von Daten, handelt es sich bei diesem Lernprogramm wird erläutert, die zum Verbessern der GridView sollen eine...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/06/2007
ms.topic: article
ms.assetid: 528acc48-f20c-4b4e-aa16-4cc02f068ebb
ms.technology: dotnet-webforms
msc.legacyurl: /web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
msc.type: authoredcontent
ms.openlocfilehash: c228128e551f58aa003af10cf787875d26b1fab7
ms.sourcegitcommit: 953ff9ea4369f154d6fd0239599279ddd3280009
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 07/03/2018
ms.locfileid: "37375174"
---
<a name="inserting-a-new-record-from-the-gridviews-footer-vb"></a><span data-ttu-id="4b907-103">Einfügen eines neuen Datensatzes in den GridView Fuß (VB)</span><span class="sxs-lookup"><span data-stu-id="4b907-103">Inserting a New Record from the GridView's Footer (VB)</span></span>
====================
<span data-ttu-id="4b907-104">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="4b907-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="4b907-105">[Beispiel-App herunter](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe) oder [PDF-Datei herunterladen](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="4b907-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe) or [Download PDF](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span></span>

> <span data-ttu-id="4b907-106">Das GridView-Steuerelement bietet zwar keine integrierten Unterstützung für das Einfügen eines neuen Datensatzes von Daten, veranschaulicht dieses Tutorial verbessern die GridView, um eine Schnittstelle einfügen von aufzunehmen.</span><span class="sxs-lookup"><span data-stu-id="4b907-106">While the GridView control does not provide built-in support for inserting a new record of data, this tutorial shows how to augment the GridView to include an inserting interface.</span></span>


## <a name="introduction"></a><span data-ttu-id="4b907-107">Einführung</span><span class="sxs-lookup"><span data-stu-id="4b907-107">Introduction</span></span>

<span data-ttu-id="4b907-108">Siehe die [eine Übersicht der einfügen, aktualisieren und Löschen von Daten](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) Tutorial, mit den Steuerelementen GridView, DetailsView und FormView-Web gehören integrierte Möglichkeiten zur Datenänderung.</span><span class="sxs-lookup"><span data-stu-id="4b907-108">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, the GridView, DetailsView, and FormView Web controls each include built-in data modification capabilities.</span></span> <span data-ttu-id="4b907-109">Bei Verwendung mit der deklarativen Datenquellen-Steuerelemente dieser drei Websteuerelemente können schnell und einfach konfiguriert werden zum Ändern von Daten per Push – sowie in Szenarien ohne eine einzige Zeile Code schreiben.</span><span class="sxs-lookup"><span data-stu-id="4b907-109">When used with declarative data source controls, these three Web controls can be quickly and easily configured to modify data - and in scenarios without needing to write a single line of code.</span></span> <span data-ttu-id="4b907-110">Leider bereit nur die DetailsView und FormView-Steuerelemente, integrierte einfügen, bearbeiten und Löschen von Funktionen.</span><span class="sxs-lookup"><span data-stu-id="4b907-110">Unfortunately, only the DetailsView and FormView controls provide built-in inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="4b907-111">Das GridView bietet nur bearbeiten und Löschen von unterstützt.</span><span class="sxs-lookup"><span data-stu-id="4b907-111">The GridView only offers editing and deleting support.</span></span> <span data-ttu-id="4b907-112">Allerdings können wir mit etwas Scheitelpunkt fett, GridView um eine Schnittstelle einfügen von aufzunehmen erweitern.</span><span class="sxs-lookup"><span data-stu-id="4b907-112">However, with a little elbow grease, we can augment the GridView to include an inserting interface.</span></span>

<span data-ttu-id="4b907-113">In der GridView Einfügen von Funktionen hinzugefügt haben, können wir dafür entscheiden, wie neue Datensätze hinzugefügt werden, erstellen die einfügende-Schnittstelle und den Code zum Einfügen des neuen Datensatzes zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="4b907-113">In adding inserting capabilities to the GridView, we are responsible for deciding on how new records will be added, creating the inserting interface, and writing the code to insert the new record.</span></span> <span data-ttu-id="4b907-114">Die Zeile in diesem Lernprogramm aus, die wir uns wird, an die GridView-Fuß s die einfügende-Schnittstelle hinzugefügt (siehe Abbildung 1).</span><span class="sxs-lookup"><span data-stu-id="4b907-114">In this tutorial we will look at adding the inserting interface to the GridView s footer row (see Figure 1).</span></span> <span data-ttu-id="4b907-115">Die Zelle für jede Spalte enthält die entsprechenden Daten Auflistung Benutzeroberflächenelement (ein Textfeld für den Produktnamen s, einer DropDownList für Lieferanten und So weiter).</span><span class="sxs-lookup"><span data-stu-id="4b907-115">The footer cell for each column includes the appropriate data collection user interface element (a TextBox for the product s name, a DropDownList for the supplier, and so on).</span></span> <span data-ttu-id="4b907-116">Wir benötigen auch eine Spalte ein "Add"-Schaltfläche geklickt haben, wird ein Postback auslösen, und fügen Sie einen neuen Datensatz in die `Products` Tabelle mit den Werten in der Fußzeile angegeben.</span><span class="sxs-lookup"><span data-stu-id="4b907-116">We also need a column for an Add button that, when clicked, will cause a postback and insert a new record into the `Products` table using the values supplied in the footer row.</span></span>


<span data-ttu-id="4b907-117">[![Die Footerzeile stellt eine Schnittstelle für das Hinzufügen neuer Produkte](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="4b907-117">[![The Footer Row Provides an Interface for Adding New Products](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span></span>

<span data-ttu-id="4b907-118">**Abbildung 1**: die Footerzeile stellt eine Schnittstelle für neue Produkte hinzufügen ([klicken Sie, um das Bild in voller Größe anzeigen](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="4b907-118">**Figure 1**: The Footer Row Provides an Interface for Adding New Products ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png))</span></span>


## <a name="step-1-displaying-product-information-in-a-gridview"></a><span data-ttu-id="4b907-119">Schritt 1: Anzeigen von Produktinformationen in einer GridView-Ansicht</span><span class="sxs-lookup"><span data-stu-id="4b907-119">Step 1: Displaying Product Information in a GridView</span></span>

<span data-ttu-id="4b907-120">Bevor wir uns darum kümmern, die einfügende-Schnittstelle in der GridView-Fuß s erstellen, können Sie zuerst darauf konzentrieren s zum Hinzufügen einer GridView-Ansicht auf der Seite, die die Produkte in der Datenbank aufgelistet werden.</span><span class="sxs-lookup"><span data-stu-id="4b907-120">Before we concern ourselves with creating the inserting interface in the GridView s footer, let s first focus on adding a GridView to the page that lists the products in the database.</span></span> <span data-ttu-id="4b907-121">Öffnen Sie zunächst die `InsertThroughFooter.aspx` auf der Seite die `EnhancedGridView` Ordner, und ziehen Sie einer GridView-Ansicht aus der Toolbox auf den Designer, Festlegen der GridView-s `ID` Eigenschaft `Products`.</span><span class="sxs-lookup"><span data-stu-id="4b907-121">Start by opening the `InsertThroughFooter.aspx` page in the `EnhancedGridView` folder and drag a GridView from the Toolbox onto the Designer, setting the GridView s `ID` property to `Products`.</span></span> <span data-ttu-id="4b907-122">Als Nächstes das GridView-s-Smarttag verwenden, um die Bindung an eine neue, mit dem Namen "ObjectDataSource" `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="4b907-122">Next, use the GridView s smart tag to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span>


<span data-ttu-id="4b907-123">[![Erstellen Sie eine neue, mit dem Namen ProductsDataSource "ObjectDataSource"](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="4b907-123">[![Create a New ObjectDataSource Named ProductsDataSource](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span></span>

<span data-ttu-id="4b907-124">**Abbildung 2**: Erstellen einer neuen "ObjectDataSource" mit dem Namen `ProductsDataSource` ([klicken Sie, um das Bild in voller Größe anzeigen](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="4b907-124">**Figure 2**: Create a New ObjectDataSource Named `ProductsDataSource` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))</span></span>


<span data-ttu-id="4b907-125">Konfigurieren Sie mit dem ObjectDataSource-Steuerelement die `ProductsBLL` Klasse s `GetProducts()` Methode, um Produktinformationen abzurufen.</span><span class="sxs-lookup"><span data-stu-id="4b907-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method to retrieve product information.</span></span> <span data-ttu-id="4b907-126">Für dieses Tutorial s Fokus ausschließlich auf das Einfügen von Funktionen hinzufügen können, und sich keine Gedanken über bearbeiten und löschen.</span><span class="sxs-lookup"><span data-stu-id="4b907-126">For this tutorial, let s focus strictly on adding inserting capabilities and not worry about editing and deleting.</span></span> <span data-ttu-id="4b907-127">Stellen Sie daher sicher, dass die Dropdown-Liste in der Registerkarte "Einfügen", um festgelegt ist `AddProduct()` und die Dropdownlisten auf den Registerkarten Update- und DELETE auf (keine) festgelegt sind.</span><span class="sxs-lookup"><span data-stu-id="4b907-127">Therefore, make sure that the drop-down list in the INSERT tab is set to `AddProduct()` and that the drop-down lists in the UPDATE and DELETE tabs are set to (None) .</span></span>


<span data-ttu-id="4b907-128">[![Zuordnung der AddProduct-Methode, mit der "ObjectDataSource"-s-Insert()-Methode](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="4b907-128">[![Map the AddProduct Method to the ObjectDataSource s Insert() Method](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span></span>

<span data-ttu-id="4b907-129">**Abbildung 3**: Zuordnung der `AddProduct` Methode, um das "ObjectDataSource"-s `Insert()` Methode ([klicken Sie, um das Bild in voller Größe anzeigen](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="4b907-129">**Figure 3**: Map the `AddProduct` Method to the ObjectDataSource s `Insert()` Method ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png))</span></span>


<span data-ttu-id="4b907-130">[![Legen Sie das UPDATE und DELETE-Registerkarten in den Dropdownlisten auf (keine)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="4b907-130">[![Set the UPDATE and DELETE Tabs Drop-Down Lists to (None)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span></span>

<span data-ttu-id="4b907-131">**Abbildung 4**: Aktualisieren und Löschen von Registerkarten Dropdownlisten auf (keine) festgelegt ([klicken Sie, um das Bild in voller Größe anzeigen](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="4b907-131">**Figure 4**: Set the UPDATE and DELETE Tabs Drop-Down Lists to (None) ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))</span></span>


<span data-ttu-id="4b907-132">Für jede von den entsprechenden Datenfeldern wird Visual Studio nach Abschluss der Konfigurieren von Datenquellen-Assistenten von "ObjectDataSource" s Felder automatisch an die GridView hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="4b907-132">After completing the ObjectDataSource s Configure Data Source wizard, Visual Studio will automatically add fields to the GridView for each of the corresponding data fields.</span></span> <span data-ttu-id="4b907-133">Lassen Sie alle Felder, die von Visual Studio hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="4b907-133">For now, leave all of the fields added by Visual Studio.</span></span> <span data-ttu-id="4b907-134">Später in diesem Tutorial werden wir zurückkehren und entfernen, müssen einige der Felder, deren Werte keine Nachteile für Ihr, angegeben werden, wenn Sie einen neuen Datensatz hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="4b907-134">Later in this tutorial we'll come back and remove some of the fields whose values don t need to be specified when adding a new record.</span></span>

<span data-ttu-id="4b907-135">Da in der Nähe 80 Produkte in der Datenbank vorhanden sind, muss ein Benutzer bis hin zum unteren Rand der Webseite zu scrollen, um einen neuen Datensatz hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="4b907-135">Since there are close to 80 products in the database, a user will have to scroll all the way down to the bottom of the web page in order to add a new record.</span></span> <span data-ttu-id="4b907-136">Aus diesem Grund können Sie s Aktivieren von Paging, die die einfügende Schnittstelle besser sichtbar und zugreifbar machen.</span><span class="sxs-lookup"><span data-stu-id="4b907-136">Therefore, let s enable paging to make the inserting interface more visible and accessible.</span></span> <span data-ttu-id="4b907-137">Aktivieren Sie das Kontrollkästchen "Paging aktivieren" aus dem GridView-s-Smarttag einfach, um zum Paging aktivieren.</span><span class="sxs-lookup"><span data-stu-id="4b907-137">To turn on paging, simply check the Enable Paging checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="4b907-138">An diesem Punkt sollte die GridView und "ObjectDataSource" s deklarative Markup etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="4b907-138">At this point, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample1.aspx)]


<span data-ttu-id="4b907-139">[![Alle Felder der Product-Daten werden in einem ausgelagerten GridView angezeigt.](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="4b907-139">[![All Product Data Fields are Displayed in a Paged GridView](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span></span>

<span data-ttu-id="4b907-140">**Abbildung 5**: alle Felder der Product-Daten in einem ausgelagerten GridView angezeigt ([klicken Sie, um das Bild in voller Größe anzeigen](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="4b907-140">**Figure 5**: All Product Data Fields are Displayed in a Paged GridView ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png))</span></span>


## <a name="step-2-adding-a-footer-row"></a><span data-ttu-id="4b907-141">Schritt 2: Hinzufügen einer Fußzeile</span><span class="sxs-lookup"><span data-stu-id="4b907-141">Step 2: Adding a Footer Row</span></span>

<span data-ttu-id="4b907-142">Zusammen mit den Header als auch die Datenzeilen enthält die GridView eine Fußzeile.</span><span class="sxs-lookup"><span data-stu-id="4b907-142">Along with its header and data rows, the GridView includes a footer row.</span></span> <span data-ttu-id="4b907-143">Die Kopf- und Fußzeile Zeilen werden angezeigt, abhängig von den Werten der GridView Zuordnungsvorgänge [ `ShowHeader` ](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showheader.aspx) und [ `ShowFooter` ](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showfooter.aspx) Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="4b907-143">The header and footer rows are displayed depending on the values of the GridView s [`ShowHeader`](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showheader.aspx) and [`ShowFooter`](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showfooter.aspx) properties.</span></span> <span data-ttu-id="4b907-144">Um die Footerzeile anzuzeigen, legen Sie einfach die `ShowFooter` Eigenschaft `True`.</span><span class="sxs-lookup"><span data-stu-id="4b907-144">To show the footer row, simply set the `ShowFooter` property to `True`.</span></span> <span data-ttu-id="4b907-145">Wie in Abbildung 6 gezeigt, Festlegen der `ShowFooter` Eigenschaft `True` dem Raster eine Fußzeile hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="4b907-145">As Figure 6 illustrates, setting the `ShowFooter` property to `True` adds a footer row to the grid.</span></span>


<span data-ttu-id="4b907-146">[![Zum Anzeigen der Fußzeile ShowFooter auf "true" festgelegt](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="4b907-146">[![To Display the Footer Row, Set ShowFooter to True](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span></span>

<span data-ttu-id="4b907-147">**Abbildung 6**: Legen Sie zum Anzeigen der Fußzeile `ShowFooter` zu `True` ([klicken Sie, um das Bild in voller Größe anzeigen](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="4b907-147">**Figure 6**: To Display the Footer Row, Set `ShowFooter` to `True` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png))</span></span>


<span data-ttu-id="4b907-148">Beachten Sie, dass die Footerzeile eine dunkelroten Hintergrund-Farbe.</span><span class="sxs-lookup"><span data-stu-id="4b907-148">Note that the footer row has a dark red background color.</span></span> <span data-ttu-id="4b907-149">Dies liegt an der DataWebControls Design wurde erstellt und die Anwendung auf allen Seiten in der [Anzeigen von Daten mit dem ObjectDataSource-Steuerelement](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) Tutorial.</span><span class="sxs-lookup"><span data-stu-id="4b907-149">This is due to the DataWebControls Theme we created and applied to all pages back in the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial.</span></span> <span data-ttu-id="4b907-150">Insbesondere die `GridView.skin` Datei konfiguriert die `FooterStyle` Eigenschaft solche, die verwendet wird die `FooterStyle` CSS-Klasse.</span><span class="sxs-lookup"><span data-stu-id="4b907-150">Specifically, the `GridView.skin` file configures the `FooterStyle` property such that is uses the `FooterStyle` CSS class.</span></span> <span data-ttu-id="4b907-151">Die `FooterStyle` Klasse ist in definiert `Styles.css` wie folgt:</span><span class="sxs-lookup"><span data-stu-id="4b907-151">The `FooterStyle` class is defined in `Styles.css` as follows:</span></span>


[!code-css[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample2.css)]

> [!NOTE]
> <span data-ttu-id="4b907-152">Wir haben mit der GridView-s-Fußzeile in vorherigen Tutorials untersucht.</span><span class="sxs-lookup"><span data-stu-id="4b907-152">We ve explored using the GridView s footer row in previous tutorials.</span></span> <span data-ttu-id="4b907-153">Bei Bedarf verweisen zurück auf die [Anzeigen von Zusammenfassungsinformationen im GridView Fuß](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) Tutorial zu auffrischen.</span><span class="sxs-lookup"><span data-stu-id="4b907-153">If needed, refer back to the [Displaying Summary Information in the GridView's Footer](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) tutorial for a refresher.</span></span>


<span data-ttu-id="4b907-154">Nach dem Festlegen der `ShowFooter` Eigenschaft `True`, können Sie die Ausgabe in einem Browser anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="4b907-154">After setting the `ShowFooter` property to `True`, take a moment to view the output in a browser.</span></span> <span data-ttu-id="4b907-155">Derzeit die Fußzeile Zeile t einem beliebigen Text- oder Websteuerelemente enthalten.</span><span class="sxs-lookup"><span data-stu-id="4b907-155">Currently the footer row doesn t contain any text or Web controls.</span></span> <span data-ttu-id="4b907-156">In Schritt 3 ändern wir die Fußzeile für jedes Feld GridView, damit sie die entsprechende Einfügen von Schnittstelle enthält.</span><span class="sxs-lookup"><span data-stu-id="4b907-156">In Step 3 we'll modify the footer for each GridView field so that it includes the appropriate inserting interface.</span></span>


<span data-ttu-id="4b907-157">[![Der leere Fußzeile wird angezeigt, über das Paging Steuerelemente der Benutzeroberfläche](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="4b907-157">[![The Empty Footer Row is Displayed Above the Paging Interface Controls](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span></span>

<span data-ttu-id="4b907-158">**Abbildung 7**: die leere Fußzeile wird angezeigt, über das Paging Steuerelemente der Benutzeroberfläche ([klicken Sie, um das Bild in voller Größe anzeigen](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="4b907-158">**Figure 7**: The Empty Footer Row is Displayed Above the Paging Interface Controls ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png))</span></span>


## <a name="step-3-customizing-the-footer-row"></a><span data-ttu-id="4b907-159">Schritt 3: Anpassen der Fußzeile</span><span class="sxs-lookup"><span data-stu-id="4b907-159">Step 3: Customizing the Footer Row</span></span>

<span data-ttu-id="4b907-160">In der [Verwenden von TemplateFields, im GridView-Steuerelement](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) Tutorial wurde erläutert, wie die Anzeige von einer bestimmten GridView-Spalte, verwenden von TemplateFields (im Gegensatz zu BoundFields oder CheckBoxFields) anpassen, in [ Anpassen der Benutzeroberfläche für die Änderung der Daten](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) wir haben uns über das Verwenden von TemplateFields die Bearbeitungsschnittstelle in einer GridView-Ansicht anpassen.</span><span class="sxs-lookup"><span data-stu-id="4b907-160">Back in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial we saw how to greatly customize the display of a particular GridView column using TemplateFields (as opposed to BoundFields or CheckBoxFields); in [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) we looked at using TemplateFields to customize the editing interface in a GridView.</span></span> <span data-ttu-id="4b907-161">Beachten Sie, dass ein TemplateField eine Reihe von Vorlagen besteht, die die Kombination aus Markup, Websteuerelemente und Databinding-Syntax definiert, wird für bestimmte Arten von Zeilen verwendet.</span><span class="sxs-lookup"><span data-stu-id="4b907-161">Recall that a TemplateField is composed of a number of templates that defines the mix of markup, Web controls, and databinding syntax used for certain types of rows.</span></span> <span data-ttu-id="4b907-162">Die `ItemTemplate`, gibt beispielsweise die Vorlage für nur-Lese Zeilen, während die `EditItemTemplate` definiert die Vorlage für die Zeile bearbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="4b907-162">The `ItemTemplate`, for example, specifies the template used for read-only rows, while the `EditItemTemplate` defines the template for the editable row.</span></span>

<span data-ttu-id="4b907-163">Zusammen mit den `ItemTemplate` und `EditItemTemplate`, das TemplateField enthält auch eine `FooterTemplate` , die den Inhalt für die Footerzeile angibt.</span><span class="sxs-lookup"><span data-stu-id="4b907-163">Along with the `ItemTemplate` and `EditItemTemplate`, the TemplateField also includes a `FooterTemplate` that specifies the content for the footer row.</span></span> <span data-ttu-id="4b907-164">Wir können daher benötigt für jedes Feld s einfügen Schnittstelle für Websteuerelemente hinzufügen der `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="4b907-164">Therefore, we can add the Web controls needed for each field s inserting interface into the `FooterTemplate`.</span></span> <span data-ttu-id="4b907-165">Um zu starten, konvertieren Sie alle Felder in den GridView-Ansicht in von TemplateFields aus.</span><span class="sxs-lookup"><span data-stu-id="4b907-165">To start, convert all of the fields in the GridView to TemplateFields.</span></span> <span data-ttu-id="4b907-166">Dies kann erfolgen durch Klicken auf den Link "Spalten bearbeiten" im GridView s Smarttag, wählen jedes Feld in der unteren linken Ecke, und klicken auf das konvertierte dieses Feld in ein TemplateField-Link.</span><span class="sxs-lookup"><span data-stu-id="4b907-166">This can be done by clicking the Edit Columns link in the GridView s smart tag, selecting each field in the lower left corner, and clicking the Convert this field into a TemplateField link.</span></span>


![Jedes Feld in ein TemplateField konvertieren](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.gif)

<span data-ttu-id="4b907-168">**Abbildung 8**: jedes Feld in ein TemplateField konvertieren</span><span class="sxs-lookup"><span data-stu-id="4b907-168">**Figure 8**: Convert Each Field Into a TemplateField</span></span>


<span data-ttu-id="4b907-169">Klicken Sie auf das konvertierte wird dieses Feld in ein TemplateField den aktuellen Feldtyp in ein TemplateField entspricht.</span><span class="sxs-lookup"><span data-stu-id="4b907-169">Clicking the Convert this field into a TemplateField turns the current field type into an equivalent TemplateField.</span></span> <span data-ttu-id="4b907-170">Beispielsweise jede BoundField wird ersetzt durch ein TemplateField mit einer `ItemTemplate` , enthält eine Bezeichnung, die das entsprechenden Datenfeld anzeigt und ein `EditItemTemplate` , die das Datenfeld in einem Textfeld anzeigt.</span><span class="sxs-lookup"><span data-stu-id="4b907-170">For example, each BoundField is replaced by a TemplateField with an `ItemTemplate` that contains a Label that displays the corresponding data field and an `EditItemTemplate` that displays the data field in a TextBox.</span></span> <span data-ttu-id="4b907-171">Die `ProductName` BoundField wurde in der folgenden TemplateField-Markup konvertiert:</span><span class="sxs-lookup"><span data-stu-id="4b907-171">The `ProductName` BoundField has been converted into the following TemplateField markup:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample3.aspx)]

<span data-ttu-id="4b907-172">Ebenso die `Discontinued` CheckBoxField konvertiert wurde in ein TemplateField, deren `ItemTemplate` und `EditItemTemplate` ein Kontrollkästchen-Steuerelement enthalten (mit der `ItemTemplate` s Kontrollkästchen deaktiviert).</span><span class="sxs-lookup"><span data-stu-id="4b907-172">Likewise, the `Discontinued` CheckBoxField has been converted into a TemplateField whose `ItemTemplate` and `EditItemTemplate` contain a CheckBox Web control (with the `ItemTemplate` s CheckBox disabled).</span></span> <span data-ttu-id="4b907-173">Die schreibgeschützte `ProductID` BoundField in ein TemplateField mit sowohl ein Label-Steuerelement umgewandelt wurde die `ItemTemplate` und `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="4b907-173">The read-only `ProductID` BoundField has been converted into a TemplateField with a Label control in both the `ItemTemplate` and `EditItemTemplate`.</span></span> <span data-ttu-id="4b907-174">Kurz gesagt, ist das Konvertieren einer vorhandenen GridView-Feld in ein TemplateField eine schnelle und einfache Möglichkeit, die besser anpassbare TemplateField wechseln, ohne das vorhandene Feld s Funktionalität verloren aus.</span><span class="sxs-lookup"><span data-stu-id="4b907-174">In short, converting an existing GridView field into a TemplateField is a quick and easy way to switch to the more customizable TemplateField without losing any of the existing field s functionality.</span></span>

<span data-ttu-id="4b907-175">Seit der GridView wir erneut die Arbeit mit Unterstützung für t bearbeiten, können Sie entfernen die `EditItemTemplate` aus jeder TemplateField, verlassen Sie einfach die `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="4b907-175">Since the GridView we re working with doesn t support editing, feel free to remove the `EditItemTemplate` from each TemplateField, leaving just the `ItemTemplate`.</span></span> <span data-ttu-id="4b907-176">Nach auf diese Weise sollte die GridView s deklarative Markup wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="4b907-176">After doing this, your GridView s declarative markup should look like the following:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample4.aspx)]

<span data-ttu-id="4b907-177">Nun, da jedes GridView-Feld in ein TemplateField konvertiert wurde, können wir die entsprechende Einfügen von Schnittstelle in jedes Feld s eingeben `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="4b907-177">Now that each GridView field has been converted into a TemplateField, we can enter the appropriate inserting interface into each field s `FooterTemplate`.</span></span> <span data-ttu-id="4b907-178">Einige der Felder müssen keiner einfügen-Schnittstelle (`ProductID`, z. B.); andere variieren in den Websteuerelementen verwendet, um die neuen Produkt s Informationen sammeln.</span><span class="sxs-lookup"><span data-stu-id="4b907-178">Some of the fields will not have an inserting interface (`ProductID`, for instance); others will vary in the Web controls used to collect the new product s information.</span></span>

<span data-ttu-id="4b907-179">Um die Bearbeitungsschnittstelle zu erstellen, wählen Sie den Vorlagen bearbeiten-Link aus dem GridView-s-Smarttag.</span><span class="sxs-lookup"><span data-stu-id="4b907-179">To create the editing interface, choose the Edit Templates link from the GridView s smart tag.</span></span> <span data-ttu-id="4b907-180">Wählen Sie dann aus der Dropdown-Liste das entsprechende Feld s `FooterTemplate` und das entsprechende Steuerelement aus der Toolbox in den Designer ziehen.</span><span class="sxs-lookup"><span data-stu-id="4b907-180">Then, from the drop-down list, select the appropriate field s `FooterTemplate` and drag the appropriate control from the Toolbox onto the Designer.</span></span>


<span data-ttu-id="4b907-181">[![Fügen Sie die entsprechende einfügende-Schnittstelle auf jedes Feld s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="4b907-181">[![Add the Appropriate Inserting Interface to Each Field s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span></span>

<span data-ttu-id="4b907-182">**Abbildung 9**: Fügen Sie die entsprechende einfügen-Schnittstelle auf jedes Feld s `FooterTemplate` ([klicken Sie, um das Bild in voller Größe anzeigen](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="4b907-182">**Figure 9**: Add the Appropriate Inserting Interface to Each Field s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png))</span></span>


<span data-ttu-id="4b907-183">Der folgenden Liste aufgeführt sind die GridView-Felder, die die einfügende Schnittstelle hinzufügen angeben:</span><span class="sxs-lookup"><span data-stu-id="4b907-183">The following bulleted list enumerates the GridView fields, specifying the inserting interface to add:</span></span>

- <span data-ttu-id="4b907-184">`ProductID` "None".</span><span class="sxs-lookup"><span data-stu-id="4b907-184">`ProductID` none.</span></span>
- <span data-ttu-id="4b907-185">`ProductName` Fügen Sie ein Textfeld hinzu, und legen Sie dessen `ID` zu `NewProductName`.</span><span class="sxs-lookup"><span data-stu-id="4b907-185">`ProductName` add a TextBox and set its `ID` to `NewProductName`.</span></span> <span data-ttu-id="4b907-186">Fügen Sie auch ein RequiredFieldValidator-Steuerelement hinzu, um sicherzustellen, dass der Benutzer einen Wert für den neuen Produktnamen s eingibt.</span><span class="sxs-lookup"><span data-stu-id="4b907-186">Add a RequiredFieldValidator control as well to ensure that the user enters a value for the new product s name.</span></span>
- <span data-ttu-id="4b907-187">`SupplierID` "None".</span><span class="sxs-lookup"><span data-stu-id="4b907-187">`SupplierID` none.</span></span>
- <span data-ttu-id="4b907-188">`CategoryID` "None".</span><span class="sxs-lookup"><span data-stu-id="4b907-188">`CategoryID` none.</span></span>
- <span data-ttu-id="4b907-189">`QuantityPerUnit` Fügen Sie ein Textfeld, das Festlegen der `ID` zu `NewQuantityPerUnit`.</span><span class="sxs-lookup"><span data-stu-id="4b907-189">`QuantityPerUnit` add a TextBox, setting its `ID` to `NewQuantityPerUnit`.</span></span>
- <span data-ttu-id="4b907-190">`UnitPrice` Fügen Sie ein Textfeld mit dem Namen `NewUnitPrice` und ein CompareValidator-Steuerelement, das den eingegebene Wert wird sichergestellt ist, einen Währungswert größer als oder gleich 0 (null).</span><span class="sxs-lookup"><span data-stu-id="4b907-190">`UnitPrice` add a TextBox named `NewUnitPrice` and a CompareValidator that ensures the value entered is a currency value greater than or equal to zero.</span></span>
- <span data-ttu-id="4b907-191">`UnitsInStock` Verwenden Sie ein Textfeld, dessen `ID` nastaven NA hodnotu `NewUnitsInStock`.</span><span class="sxs-lookup"><span data-stu-id="4b907-191">`UnitsInStock` use a TextBox whose `ID` is set to `NewUnitsInStock`.</span></span> <span data-ttu-id="4b907-192">Enthalten Sie ein CompareValidator-Steuerelement, das sicherstellt, dass der eingegebene Wert ein ganzzahliger Wert größer als oder gleich 0 (null) ist.</span><span class="sxs-lookup"><span data-stu-id="4b907-192">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="4b907-193">`UnitsOnOrder` Verwenden Sie ein Textfeld, dessen `ID` nastaven NA hodnotu `NewUnitsOnOrder`.</span><span class="sxs-lookup"><span data-stu-id="4b907-193">`UnitsOnOrder` use a TextBox whose `ID` is set to `NewUnitsOnOrder`.</span></span> <span data-ttu-id="4b907-194">Enthalten Sie ein CompareValidator-Steuerelement, das sicherstellt, dass der eingegebene Wert ein ganzzahliger Wert größer als oder gleich 0 (null) ist.</span><span class="sxs-lookup"><span data-stu-id="4b907-194">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="4b907-195">`ReorderLevel` Verwenden Sie ein Textfeld, dessen `ID` nastaven NA hodnotu `NewReorderLevel`.</span><span class="sxs-lookup"><span data-stu-id="4b907-195">`ReorderLevel` use a TextBox whose `ID` is set to `NewReorderLevel`.</span></span> <span data-ttu-id="4b907-196">Enthalten Sie ein CompareValidator-Steuerelement, das sicherstellt, dass der eingegebene Wert ein ganzzahliger Wert größer als oder gleich 0 (null) ist.</span><span class="sxs-lookup"><span data-stu-id="4b907-196">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="4b907-197">`Discontinued` Fügen Sie ein Kontrollkästchen, das Festlegen der `ID` zu `NewDiscontinued`.</span><span class="sxs-lookup"><span data-stu-id="4b907-197">`Discontinued` add a CheckBox, setting its `ID` to `NewDiscontinued`.</span></span>
- <span data-ttu-id="4b907-198">`CategoryName` Fügen Sie einem DropDownList-Steuerelement hinzu, und legen Sie dessen `ID` zu `NewCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="4b907-198">`CategoryName` add a DropDownList and set its `ID` to `NewCategoryID`.</span></span> <span data-ttu-id="4b907-199">Binden Sie es an eine neue, mit dem Namen "ObjectDataSource" `CategoriesDataSource` und konfigurieren Sie ihn zur Verwendung der `CategoriesBLL` Klasse s `GetCategories()` Methode.</span><span class="sxs-lookup"><span data-stu-id="4b907-199">Bind it to a new ObjectDataSource named `CategoriesDataSource` and configure it to use the `CategoriesBLL` class s `GetCategories()` method.</span></span> <span data-ttu-id="4b907-200">Die DropDownList-Zuordnungsvorgänge haben `ListItem` s Anzeige der `CategoryName` Daten Feld mit der `CategoryID` Feld "Daten" als Werte.</span><span class="sxs-lookup"><span data-stu-id="4b907-200">Have the DropDownList s `ListItem` s display the `CategoryName` data field, using the `CategoryID` data field as their values.</span></span>
- <span data-ttu-id="4b907-201">`SupplierName` Fügen Sie einem DropDownList-Steuerelement hinzu, und legen Sie dessen `ID` zu `NewSupplierID`.</span><span class="sxs-lookup"><span data-stu-id="4b907-201">`SupplierName` add a DropDownList and set its `ID` to `NewSupplierID`.</span></span> <span data-ttu-id="4b907-202">Binden Sie es an eine neue, mit dem Namen "ObjectDataSource" `SuppliersDataSource` und konfigurieren Sie ihn zur Verwendung der `SuppliersBLL` Klasse s `GetSuppliers()` Methode.</span><span class="sxs-lookup"><span data-stu-id="4b907-202">Bind it to a new ObjectDataSource named `SuppliersDataSource` and configure it to use the `SuppliersBLL` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="4b907-203">Die DropDownList-Zuordnungsvorgänge haben `ListItem` s Anzeige der `CompanyName` Daten Feld mit der `SupplierID` Feld "Daten" als Werte.</span><span class="sxs-lookup"><span data-stu-id="4b907-203">Have the DropDownList s `ListItem` s display the `CompanyName` data field, using the `SupplierID` data field as their values.</span></span>

<span data-ttu-id="4b907-204">Für jedes der Steuerelemente zur gültigkeitsprüfung, lösche die `ForeColor` Eigenschaft, damit die `FooterStyle` weißen Vordergrundfarbe für CSS-s-Klasse anstelle des standardmäßigen roten verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="4b907-204">For each of the validation controls, clear out the `ForeColor` property so that the `FooterStyle` CSS class s white foreground color will be used in place of the default red.</span></span> <span data-ttu-id="4b907-205">Auch verwenden, die `ErrorMessage` -Eigenschaft für eine ausführliche Beschreibung, legen Sie jedoch die `Text` Eigenschaft auf ein Sternchen.</span><span class="sxs-lookup"><span data-stu-id="4b907-205">Also use the `ErrorMessage` property for a detailed description, but set the `Text` property to an asterisk.</span></span> <span data-ttu-id="4b907-206">Um zu verhindern, dass die Überprüfung Steuerelementtext s verursacht die einfügende-Schnittstelle auf zwei Zeilen umbrochen, legen Sie die `FooterStyle` s `Wrap` Eigenschaft auf "false" für jede der `FooterTemplate` s, die einem Validierungssteuerelement verwenden.</span><span class="sxs-lookup"><span data-stu-id="4b907-206">To prevent the validation control s text from causing the inserting interface to wrap to two lines, set the `FooterStyle` s `Wrap` property to false for each of the `FooterTemplate` s that use a validation control.</span></span> <span data-ttu-id="4b907-207">Fügen Sie abschließend ein ValidationSummary-Steuerelement unterhalb der GridView und legen seine `ShowMessageBox` Eigenschaft `True` und die zugehörige `ShowSummary` Eigenschaft `False`.</span><span class="sxs-lookup"><span data-stu-id="4b907-207">Finally, add a ValidationSummary control beneath the GridView and set its `ShowMessageBox` property to `True` and its `ShowSummary` property to `False`.</span></span>

<span data-ttu-id="4b907-208">Wenn Sie ein neues Produkt hinzufügen möchten, müssen wir geben die `CategoryID` und `SupplierID`.</span><span class="sxs-lookup"><span data-stu-id="4b907-208">When adding a new product, we need to provide the `CategoryID` and `SupplierID`.</span></span> <span data-ttu-id="4b907-209">Diese Informationen werden erfasst, über das DropDownList-Steuerelementen in der Fußzeilenzellen für die `CategoryName` und `SupplierName` Felder.</span><span class="sxs-lookup"><span data-stu-id="4b907-209">This information is captured through the DropDownLists in the footer cells for the `CategoryName` and `SupplierName` fields.</span></span> <span data-ttu-id="4b907-210">Ich habe mich entschieden, diese Felder im Gegensatz zu den `CategoryID` und `SupplierID` von TemplateFields, da im Raster s den Benutzer Datenzeilen wahrscheinlich mehr interessiert die Namen der Kategorie und Lieferanten statt von ihren ID-Werten ist.</span><span class="sxs-lookup"><span data-stu-id="4b907-210">I chose to use these fields as opposed to the `CategoryID` and `SupplierID` TemplateFields because in the grid s data rows the user is likely more interested in seeing the category and supplier names rather than their ID values.</span></span> <span data-ttu-id="4b907-211">Da die `CategoryID` und `SupplierID` Werte werden jetzt erfasst wird, der `CategoryName` und `SupplierName` Feld s Einfügen von Schnittstellen, die wir entfernen das `CategoryID` und `SupplierID` von TemplateFields aus der GridView.</span><span class="sxs-lookup"><span data-stu-id="4b907-211">Since the `CategoryID` and `SupplierID` values are now being captured in the `CategoryName` and `SupplierName` field s inserting interfaces, we can remove the `CategoryID` and `SupplierID` TemplateFields from the GridView.</span></span>

<span data-ttu-id="4b907-212">Auf ähnliche Weise die `ProductID` wird nicht verwendet werden, wenn Sie ein neues Produkt hinzufügen daher `ProductID` TemplateField ebenfalls entfernt werden kann.</span><span class="sxs-lookup"><span data-stu-id="4b907-212">Similarly, the `ProductID` is not used when adding a new product, so the `ProductID` TemplateField can be removed as well.</span></span> <span data-ttu-id="4b907-213">Jedoch lassen, s, lassen Sie die `ProductID` Feld im Raster.</span><span class="sxs-lookup"><span data-stu-id="4b907-213">However, let s leave the `ProductID` field in the grid.</span></span> <span data-ttu-id="4b907-214">Neben den Textfeldern, DropDownList-Steuerelementen, Kontrollkästchen und Steuerelementen zur gültigkeitsprüfung, die die einfügende Schnittstelle bilden, benötigen wir auch ein "Add"-Schaltfläche geklickt wird, führt die Logik, um das neue Produkt mit der Datenbank hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="4b907-214">In addition to the TextBoxes, DropDownLists, CheckBoxes, and validation controls that make up the inserting interface, we'll also need an Add button that, when clicked, performs the logic to add the new product to the database.</span></span> <span data-ttu-id="4b907-215">In Schritt 4 nehmen wir eine Schaltfläche "hinzufügen" die einfügen-Schnittstelle in der `ProductID` TemplateField s `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="4b907-215">In Step 4 we'll include an Add button in the inserting interface in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="4b907-216">Die Darstellung der verschiedenen Felder GridView verbessern können.</span><span class="sxs-lookup"><span data-stu-id="4b907-216">Feel free to improve the appearance of the various GridView fields.</span></span> <span data-ttu-id="4b907-217">Beispielsweise sollten Sie zum Formatieren der `UnitPrice` Werte als Währung, rechtsbündig ausgerichtet der `UnitsInStock`, `UnitsOnOrder`, und `ReorderLevel` Felder, und Aktualisieren der `HeaderText` Werte für die von TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="4b907-217">For example, you might want to format the `UnitPrice` values as a currency, right-align the `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` fields, and update the `HeaderText` values for the TemplateFields.</span></span>

<span data-ttu-id="4b907-218">Nach dem Erstellen der Menge nach dem Einfügen von Schnittstellen in den `FooterTemplate` s, entfernen die `SupplierID`, und `CategoryID` von TemplateFields, und verbessern die Ästhetik des Rasters über die Formatierung und die Abstimmung der von TemplateFields, die deklarative GridView-s Markup sollte in etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="4b907-218">After creating the slew of inserting interfaces in the `FooterTemplate` s, removing the `SupplierID`, and `CategoryID` TemplateFields, and improving the aesthetics of the grid through formatting and aligning the TemplateFields, your GridView s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample5.aspx)]

<span data-ttu-id="4b907-219">Wenn Sie über einen Browser angezeigt wird, der GridView-s-Fußzeile enthält jetzt die abgeschlossene einfügen Schnittstelle (siehe Abbildung 10).</span><span class="sxs-lookup"><span data-stu-id="4b907-219">When viewed through a browser, the GridView s footer row now includes the completed inserting interface (see Figure 10).</span></span> <span data-ttu-id="4b907-220">An diesem Punkt das Einfügen von Schnittstelle t ein Mittel für den Benutzer an, dass die Daten für das neue Produkt eingegeben und einen neuen Datensatz in die Datenbank einfügen möchte, Julie enthalten.</span><span class="sxs-lookup"><span data-stu-id="4b907-220">At this point, the inserting interface doesn t include a means for the user to indicate that she s entered the data for the new product and wants to insert a new record into the database.</span></span> <span data-ttu-id="4b907-221">Darüber hinaus wir haben noch zu behandeln, wie in der Fußzeile eingegebenen Daten in einen neuen Eintrag in übersetzt werden die `Products` Datenbank.</span><span class="sxs-lookup"><span data-stu-id="4b907-221">Also, we ve yet to address how the data entered into the footer will translate into a new record in the `Products` database.</span></span> <span data-ttu-id="4b907-222">In Schritt 4, die wir auf eine Schaltfläche "hinzufügen", auf die einfügen-Schnittstelle eingeschlossen und zum Ausführen von Code auf postback, wenn es s geklickt haben.</span><span class="sxs-lookup"><span data-stu-id="4b907-222">In Step 4 we'll look at how to include an Add button to the inserting interface and how to execute code on postback when it s clicked.</span></span> <span data-ttu-id="4b907-223">Schritt 5 zeigt, wie Sie einen neuen Datensatz mit den Daten aus der Fußzeile einzufügen.</span><span class="sxs-lookup"><span data-stu-id="4b907-223">Step 5 shows how to insert a new record using the data from the footer.</span></span>


<span data-ttu-id="4b907-224">[![Das GridView-Fuß stellt eine Schnittstelle für das Hinzufügen eines neuen Datensatzes bereit.](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="4b907-224">[![The GridView Footer Provides an Interface for Adding a New Record](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span></span>

<span data-ttu-id="4b907-225">**Abbildung 10**: der GridView-Fuß stellt eine Schnittstelle für das Hinzufügen eines neuen Datensatzes ([klicken Sie, um das Bild in voller Größe anzeigen](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="4b907-225">**Figure 10**: The GridView Footer Provides an Interface for Adding a New Record ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png))</span></span>


## <a name="step-4-including-an-add-button-in-the-inserting-interface"></a><span data-ttu-id="4b907-226">Schritt 4: Einschließlich einer Schaltfläche "hinzufügen" in der einfügen-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="4b907-226">Step 4: Including an Add Button in the Inserting Interface</span></span>

<span data-ttu-id="4b907-227">Wir müssen eine Schaltfläche "hinzufügen" an einer beliebigen Stelle in der einfügen-Schnittstelle, da die Fußzeile Zeile s-Schnittstelle derzeit einfügen verfügt nicht über die Mittel für den Benutzer aus, um anzugeben, dass sie die neuen Produkt s-Informationen eingegeben haben.</span><span class="sxs-lookup"><span data-stu-id="4b907-227">We need to include an Add button somewhere in the inserting interface since the footer row s inserting interface currently lacks the means for the user to indicate that they have completed entering the new product s information.</span></span> <span data-ttu-id="4b907-228">Dies könnte in eine der vorhandenen eingefügt `FooterTemplate` s oder wir können eine neue Spalte hinzufügen zum Raster für diesen Zweck.</span><span class="sxs-lookup"><span data-stu-id="4b907-228">This could be placed in one of the existing `FooterTemplate` s or we could add a new column to the grid for this purpose.</span></span> <span data-ttu-id="4b907-229">In diesem Tutorial können s platzieren Sie die Schaltfläche "hinzufügen" die `ProductID` TemplateField s `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="4b907-229">For this tutorial, let s place the Add button in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="4b907-230">Aus dem Designer, klicken Sie auf den Link Vorlagen bearbeiten, in das GridView-s-Smarttag, und wählen Sie dann die `ProductID` Feld s `FooterTemplate` aus der Dropdown-Liste.</span><span class="sxs-lookup"><span data-stu-id="4b907-230">From the Designer, click on the Edit Templates link in the GridView s smart tag and then choose the `ProductID` field s `FooterTemplate` from the drop-down list.</span></span> <span data-ttu-id="4b907-231">Hinzufügen einer Schaltfläche-Websteuerelement (oder ein LinkButton oder ImageButton, falls gewünscht) für die Vorlage festlegen seiner ID auf `AddProduct`, dessen `CommandName` zum Einfügen, und die zugehörige `Text` Eigenschaft hinzufügen, wie in Abbildung 11 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="4b907-231">Add a Button Web control (or a LinkButton or ImageButton, if you prefer) to the template, setting its ID to `AddProduct`, its `CommandName` to Insert, and its `Text` property to Add as shown in Figure 11.</span></span>


<span data-ttu-id="4b907-232">[![Platzieren Sie die Schaltfläche "hinzufügen" in "ProductID" TemplateField s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="4b907-232">[![Place the Add Button in the ProductID TemplateField s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span></span>

<span data-ttu-id="4b907-233">**Abbildung 11**: platzieren Sie die Schaltfläche "hinzufügen" in der `ProductID` TemplateField s `FooterTemplate` ([klicken Sie, um das Bild in voller Größe anzeigen](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="4b907-233">**Figure 11**: Place the Add Button in the `ProductID` TemplateField s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png))</span></span>


<span data-ttu-id="4b907-234">Nachdem Sie speichern die Schaltfläche "hinzufügen" enthalten, testen Sie Sie auf der Seite in einem Browser.</span><span class="sxs-lookup"><span data-stu-id="4b907-234">Once you ve included the Add button, test out the page in a browser.</span></span> <span data-ttu-id="4b907-235">Beachten Sie, dass beim Klicken auf die Schaltfläche "hinzufügen" mit ungültigen Daten, die die einfügende-Benutzeroberfläche, die das Postback kurz circuited ist, und die ValidationSummary-Steuerelement gibt an, die ungültigen Daten (siehe Abbildung 12).</span><span class="sxs-lookup"><span data-stu-id="4b907-235">Note that when clicking the Add button with invalid data in the inserting interface, the postback is short circuited and the ValidationSummary control indicates the invalid data (see Figure 12).</span></span> <span data-ttu-id="4b907-236">Mit der entsprechenden Daten eingegeben haben auslöst ein Postback klicken Sie auf die Schaltfläche "hinzufügen".</span><span class="sxs-lookup"><span data-stu-id="4b907-236">With appropriate data entered, clicking the Add button causes a postback.</span></span> <span data-ttu-id="4b907-237">Jedoch wird kein Datensatz in der Datenbank hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="4b907-237">No record is added to the database, however.</span></span> <span data-ttu-id="4b907-238">Wir benötigen, schreiben ein paar Codezeilen tatsächlich die Einfügung ausführen.</span><span class="sxs-lookup"><span data-stu-id="4b907-238">We will need to write a bit of code to actually perform the insert.</span></span>


<span data-ttu-id="4b907-239">[![Die Schaltfläche "hinzufügen"-s ist Postback kurze Circuited bei ungültige Daten in der Schnittstelle einfügen](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="4b907-239">[![The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span></span>

<span data-ttu-id="4b907-240">**Abbildung 12**: die Schaltfläche "hinzufügen"-s-Postback ist kurz Circuited, wenn ungültige Daten vorhanden, in der einfügen-Schnittstelle sind ([klicken Sie, um das Bild in voller Größe anzeigen](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="4b907-240">**Figure 12**: The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png))</span></span>


> [!NOTE]
> <span data-ttu-id="4b907-241">Die Validierungssteuerelemente in die einfügende-Schnittstelle wurden Validierungsgruppe nicht zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="4b907-241">The validation controls in the inserting interface were not assigned to a validation group.</span></span> <span data-ttu-id="4b907-242">Dies funktioniert gut, solange die einfügende-Schnittstelle die einzige Gruppe von Steuerelementen zur gültigkeitsprüfung auf der Seite ist.</span><span class="sxs-lookup"><span data-stu-id="4b907-242">This works fine so long as the inserting interface is the only set of validation controls on the page.</span></span> <span data-ttu-id="4b907-243">Wenn es gibt jedoch andere Validierungssteuerelemente auf der Seite (z. B. der Validierungssteuerelemente in der Bearbeitung Raster s-Schnittstelle), die Validierungssteuerelemente in der einfügen-Schnittstelle und fügen Sie die Schaltfläche "-s `ValidationGroup` Eigenschaften den gleichen Wert zugewiesen werden dass Ordnen Sie diese Steuerelemente mit einer bestimmten Validierungsgruppe an.</span><span class="sxs-lookup"><span data-stu-id="4b907-243">If, however, there are other validation controls on the page (such as validation controls in the grid s editing interface), the validation controls in the inserting interface and Add button s `ValidationGroup` properties should be assigned the same value so as to associate these controls with a particular validation group.</span></span> <span data-ttu-id="4b907-244">Finden Sie unter [Analyse der Validierungssteuerelemente in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) für Weitere Informationen zur Partitionierung der Steuerelemente zur gültigkeitsprüfung sowie -Schaltflächen auf einer Seite in Gruppen von Überprüfung.</span><span class="sxs-lookup"><span data-stu-id="4b907-244">See [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) for more information on partitioning the validation controls and buttons on a page into validation groups.</span></span>


## <a name="step-5-inserting-a-new-record-into-theproductstable"></a><span data-ttu-id="4b907-245">Schritt 5: Einfügen eines neuen Datensatzes in die`Products`Tabelle</span><span class="sxs-lookup"><span data-stu-id="4b907-245">Step 5: Inserting a New Record Into the`Products`Table</span></span>

<span data-ttu-id="4b907-246">Bei der Nutzung der integrierten Bearbeitungsfunktionen der GridView, behandelt die GridView automatisch alle notwendigen Aufgaben für die Durchführung der Aktualisierung.</span><span class="sxs-lookup"><span data-stu-id="4b907-246">When utilizing the built-in editing features of the GridView, the GridView automatically handles all of the work necessary for performing the update.</span></span> <span data-ttu-id="4b907-247">Insbesondere wenn auf die Schaltfläche "Aktualisieren" geklickt, wird sie kopiert die eingegebenen Werte von der Bearbeitung-Schnittstelle an die Parameter in der "ObjectDataSource"-s `UpdateParameters` Sammlung und die definierten sicherheitsschwellwerte deaktiviert das Update durch den Aufruf von "ObjectDataSource" s `Update()` Methode.</span><span class="sxs-lookup"><span data-stu-id="4b907-247">In particular, when the Update button is clicked it copies the values entered from the editing interface to the parameters in the ObjectDataSource s `UpdateParameters` collection and kicks off the update by invoking the ObjectDataSource s `Update()` method.</span></span> <span data-ttu-id="4b907-248">Da diese integrierten Funktionen für das Einfügen von GridView nicht bereitstellt, müssen wir Code, der das "ObjectDataSource"-s aufruft implementieren `Insert()` -Methode und kopiert die Werte aus den Einfügen-der "ObjectDataSource"-s Schnittstelle `InsertParameters` Auflistung .</span><span class="sxs-lookup"><span data-stu-id="4b907-248">Since the GridView does not provide such built-in functionality for inserting, we must implement code that calls the ObjectDataSource s `Insert()` method and copies the values from the inserting interface to the ObjectDataSource s `InsertParameters` collection.</span></span>

<span data-ttu-id="4b907-249">Diese Logik einfügen sollten ausgeführt werden, nachdem auf die Schaltfläche "Add" geklickt wurde.</span><span class="sxs-lookup"><span data-stu-id="4b907-249">This insert logic should be executed after the Add button has been clicked.</span></span> <span data-ttu-id="4b907-250">Siehe die [hinzufügen und reagieren auf Schaltflächen in einer GridView-Ansicht](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md) jedes Mal, wenn eine Schaltfläche, LinkButton oder ImageButton in einer GridView-Ansicht geklickt wird, das GridView-s-Lernprogramm `RowCommand` beim Postback-Ereignis ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="4b907-250">As discussed in the [Adding and Responding to Buttons in a GridView](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md) tutorial, anytime a Button, LinkButton, or ImageButton in a GridView is clicked, the GridView s `RowCommand` event fires on postback.</span></span> <span data-ttu-id="4b907-251">Dieses Ereignis wird ausgelöst, ob die Schaltfläche, LinkButton oder ImageButton explizit wie z. B. die Schaltfläche "hinzufügen" in der Fußzeile hinzugefügt wurde, oder wenn es automatisch von der GridView hinzugefügt wurde (z. B. die LinkButtons am oberen Rand der einzelnen Spalten beim Sortieren aktivieren ausgewählt ist, oder LinkButtons in den Paging-Schnittstelle, wenn Paging aktivieren ausgewählt wurde).</span><span class="sxs-lookup"><span data-stu-id="4b907-251">This event fires whether the Button, LinkButton, or ImageButton was added explicitly such as the Add button in the footer row or if it was automatically added by the GridView (such as the LinkButtons at the top of each column when Enable Sorting is selected, or the LinkButtons in the paging interface when Enable Paging is selected).</span></span>

<span data-ttu-id="4b907-252">Aus diesem Grund, um auf der Benutzer auf die Schaltfläche "hinzufügen" reagieren, müssen wir einen Ereignishandler für das GridView-s erstellen `RowCommand` Ereignis.</span><span class="sxs-lookup"><span data-stu-id="4b907-252">Therefore, to respond to the user clicking the Add button, we need to create an event handler for the GridView s `RowCommand` event.</span></span> <span data-ttu-id="4b907-253">Da jedes Mal, wenn dieses Ereignis wird ausgelöst, *alle* Button, LinkButton oder ImageButton in den GridView-Ansicht geklickt wird, es wichtig, dass wir nur das Einfügen von Logik Wenn fortsetzen s der `CommandName` Eigenschaft, die in den Ereignis-Handler Code Maps an die übergeben`CommandName` Wert der Schaltfläche "hinzufügen" (Einfügen).</span><span class="sxs-lookup"><span data-stu-id="4b907-253">Since this event fires whenever *any* Button, LinkButton, or ImageButton in the GridView is clicked, it s vital that we only proceed with the inserting logic if the `CommandName` property passed into the event handler maps to the `CommandName` value of the Add button ( Insert ).</span></span> <span data-ttu-id="4b907-254">Darüber hinaus sollten wir auch nur fortgesetzt, wenn die Validierungssteuerelemente gültige Daten melden.</span><span class="sxs-lookup"><span data-stu-id="4b907-254">Moreover, we should also only proceed if the validation controls report valid data.</span></span> <span data-ttu-id="4b907-255">Um dies zu unterstützen, erstellen Sie einen Ereignishandler für die `RowCommand` -Ereignis mit den folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="4b907-255">To accommodate this, create an event handler for the `RowCommand` event with the following code:</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample6.vb)]

> [!NOTE]
> <span data-ttu-id="4b907-256">Vielleicht warum der Ereignishandler draußen überprüfen die `Page.IsValid` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="4b907-256">You may be wondering why the event handler bothers checking the `Page.IsValid` property.</span></span> <span data-ttu-id="4b907-257">Schließlich gewonnenem t das Postback unterdrückt werden, wenn ungültige Daten in die einfügende-Schnittstelle bereitgestellt werden?</span><span class="sxs-lookup"><span data-stu-id="4b907-257">After all, won t the postback be suppressed if invalid data is provided in the inserting interface?</span></span> <span data-ttu-id="4b907-258">Diese Annahme ist richtig, solange der Benutzer nicht, JavaScript deaktiviert wurde oder verfügt über Schritte unternommen, um die clientseitige Validierungslogik zu umgehen.</span><span class="sxs-lookup"><span data-stu-id="4b907-258">This assumption is correct as long as the user has not disabled JavaScript or has taken steps to circumvent the client-side validation logic.</span></span> <span data-ttu-id="4b907-259">Kurz gesagt, sollte eine niemals ausschließlich auf die clientseitige Validierung verlassen; eine serverseitige Überprüfung auf Gültigkeit sollte immer ausgeführt werden, bevor Sie mit den Daten arbeiten.</span><span class="sxs-lookup"><span data-stu-id="4b907-259">In short, one should never rely strictly on client-side validation; a server-side check for validity should always be performed before working with the data.</span></span>


<span data-ttu-id="4b907-260">In Schritt 1 erstellten wir die `ProductsDataSource` "ObjectDataSource" so, dass die `Insert()` Methode zugeordnet ist die `ProductsBLL` Klasse s `AddProduct` Methode.</span><span class="sxs-lookup"><span data-stu-id="4b907-260">In Step 1 we created the `ProductsDataSource` ObjectDataSource such that its `Insert()` method is mapped to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="4b907-261">Zum Einfügen des neuen Datensatzes in die `Products` Tabelle rufen wir einfach das "ObjectDataSource"-s `Insert()` Methode:</span><span class="sxs-lookup"><span data-stu-id="4b907-261">To insert the new record into the `Products` table, we can simply invoke the ObjectDataSource s `Insert()` method:</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample7.vb)]

<span data-ttu-id="4b907-262">Nachdem die `Insert()` Methode wurde aufgerufen, wird übergeben, bleiben die Werte von der einfügen-Schnittstelle mit den Parametern zu kopieren ist, die `ProductsBLL` s-Klasse `AddProduct` Methode.</span><span class="sxs-lookup"><span data-stu-id="4b907-262">Now that the `Insert()` method has been invoked, all that remains is to copy the values from the inserting interface to the parameters passed to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="4b907-263">Wie in beschrieben der [Untersuchen der Ereignisse zugeordnet einfügen, aktualisieren und löschen](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) Tutorial, dies kann erreicht werden, über das ObjectDataSource-Steuerelement s `Inserting` Ereignis.</span><span class="sxs-lookup"><span data-stu-id="4b907-263">As we saw back in the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial, this can be accomplished through the ObjectDataSource s `Inserting` event.</span></span> <span data-ttu-id="4b907-264">In der `Inserting` Ereignis müssen wir verweisen auf die Steuerelemente aus der `Products` s GridView-Fuß-Zeile aus, und weisen Sie deren Werte in der `e.InputParameters` Auflistung.</span><span class="sxs-lookup"><span data-stu-id="4b907-264">In the `Inserting` event we need to programmatically reference the controls from the `Products` GridView s footer row and assign their values to the `e.InputParameters` collection.</span></span> <span data-ttu-id="4b907-265">Wenn der Benutzer einen Wert wie eine verlassen lässt die `ReorderLevel` Textfeld leer, die wir benötigen, um anzugeben, dass der Wert in die Datenbank eingefügt werden soll `NULL`.</span><span class="sxs-lookup"><span data-stu-id="4b907-265">If the user omits a value such as leaving the `ReorderLevel` TextBox blank we need to specify that the value inserted into the database should be `NULL`.</span></span> <span data-ttu-id="4b907-266">Da die `AddProducts` -Methode akzeptiert die nullable-Typen für die NULL-Werte zulassen Datenbankfelder, einfach einen nullable-Typ verwenden und setzen ihren Wert auf `Nothing` in die Groß-/Kleinschreibung, die eine Benutzereingabe ausgelassen wird.</span><span class="sxs-lookup"><span data-stu-id="4b907-266">Since the `AddProducts` method accepts nullable types for the nullable database fields, simply use a nullable type and set its value to `Nothing` in the case where user input is omitted.</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample8.vb)]

<span data-ttu-id="4b907-267">Mit der `Inserting` Ereignishandler, die abgeschlossen werden, neue Einträge können hinzugefügt werden die `Products` über der Fußzeile der GridView-s-Datenbanktabelle.</span><span class="sxs-lookup"><span data-stu-id="4b907-267">With the `Inserting` event handler completed, new records can be added to the `Products` database table via the GridView s footer row.</span></span> <span data-ttu-id="4b907-268">Fahren Sie fort, und versuchen Sie es Hinzufügen mehrerer neuer Produkte.</span><span class="sxs-lookup"><span data-stu-id="4b907-268">Go ahead and try adding several new products.</span></span>

## <a name="enhancing-and-customizing-the-add-operation"></a><span data-ttu-id="4b907-269">Erweitern und Anpassen von dem Vorgang hinzufügen</span><span class="sxs-lookup"><span data-stu-id="4b907-269">Enhancing and Customizing the Add Operation</span></span>

<span data-ttu-id="4b907-270">Derzeit auf die Schaltfläche "hinzufügen" Fügt einen neuen Datensatz in die Datenbanktabelle bietet jedoch jede Art von visuellem Feedback, dass der Datensatz wurde erfolgreich hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="4b907-270">Currently, clicking the Add button adds a new record to the database table but does not provide any sort of visual feedback that the record has successfully been added.</span></span> <span data-ttu-id="4b907-271">Im Idealfall würde auf ein Label-Web-Steuerelement oder die clientseitige Warnfeld den Benutzer informieren, den ihre Einfügung erfolgreich abgeschlossen wurde.</span><span class="sxs-lookup"><span data-stu-id="4b907-271">Ideally, a Label Web control or client-side alert box would inform the user that their insert has completed with success.</span></span> <span data-ttu-id="4b907-272">Ich lassen Sie dieses als Übung für den Leser.</span><span class="sxs-lookup"><span data-stu-id="4b907-272">I leave this as an exercise for the reader.</span></span>

<span data-ttu-id="4b907-273">In diesem Tutorial verwendete GridView gilt nicht keine Sortierreihenfolge für die hier aufgeführten Produkte und erlaubt es dem Benutzer die Daten zu sortieren.</span><span class="sxs-lookup"><span data-stu-id="4b907-273">The GridView used in this tutorial does not apply any sort order to the listed products, nor does it allow the end user to sort the data.</span></span> <span data-ttu-id="4b907-274">Daher werden die Datensätze sortiert, wie sie in der Datenbank durch ihre primären Schlüsselfelder sind.</span><span class="sxs-lookup"><span data-stu-id="4b907-274">Consequently, the records are ordered as they are in the database by their primary key field.</span></span> <span data-ttu-id="4b907-275">Da jeder neuer Datensatz ein `ProductID` Wert größer als der letzten Zeile jedes Mal, wenn ein neues Produkt hinzugefügt wird, ist es am Ende des Rasters übernommen.</span><span class="sxs-lookup"><span data-stu-id="4b907-275">Since each new record has a `ProductID` value greater than the last one, every time a new product is added it is tacked on to the end of the grid.</span></span> <span data-ttu-id="4b907-276">Aus diesem Grund sollten Sie automatisch den Benutzer an der letzten Seite des GridView senden, nach dem Hinzufügen eines neuen Datensatzes.</span><span class="sxs-lookup"><span data-stu-id="4b907-276">Therefore, you may want to automatically send the user to the last page of the GridView after adding a new record.</span></span> <span data-ttu-id="4b907-277">Dies kann erreicht werden, indem Sie die folgende Codezeile nach dem Aufruf von hinzufügen `ProductsDataSource.Insert()` in die `RowCommand` -Ereignishandler, um anzugeben, dass der Benutzer zur letzten Seite gesendet werden, nachdem die Daten an die GridView zu binden muss:</span><span class="sxs-lookup"><span data-stu-id="4b907-277">This can be accomplished by adding the following line of code after the call to `ProductsDataSource.Insert()` in the `RowCommand` event handler to indicate that the user needs to be sent to the last page after binding the data to the GridView:</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample9.vb)]

<span data-ttu-id="4b907-278">`SendUserToLastPage` eine auf Seitenebene boolesche Variable, die anfänglich ist ein Wert zugewiesen wird der `False`.</span><span class="sxs-lookup"><span data-stu-id="4b907-278">`SendUserToLastPage` is a page-level Boolean variable that is initially assigned a value of `False`.</span></span> <span data-ttu-id="4b907-279">In den GridView-s `DataBound` Ereignishandler, wenn `SendUserToLastPage` ist "false", die `PageIndex` -Eigenschaft aktualisiert, um zur letzten Seite des Benutzers zu senden.</span><span class="sxs-lookup"><span data-stu-id="4b907-279">In the GridView s `DataBound` event handler, if `SendUserToLastPage` is false, the `PageIndex` property is updated to send the user to the last page.</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample10.vb)]

<span data-ttu-id="4b907-280">Der Grund der `PageIndex` -eigenschaftssatzstruktur im der `DataBound` -Ereignishandler (im Gegensatz zu der `RowCommand` -Ereignishandler) liegt daran, dass bei der `RowCommand` -Ereignishandler wird ausgelöst, wir haben noch zu den neuen Datensatz hinzufügen der `Products` Datenbanktabelle.</span><span class="sxs-lookup"><span data-stu-id="4b907-280">The reason the `PageIndex` property is set in the `DataBound` event handler (as opposed to the `RowCommand` event handler) is because when the `RowCommand` event handler fires we ve yet to add the new record to the `Products` database table.</span></span> <span data-ttu-id="4b907-281">Aus diesem Grund in die `RowCommand` -Ereignishandler den Index der letzten Seite (`PageCount - 1`) stellt den Index der letzten Seite *vor* das neue Produkt wurde hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="4b907-281">Therefore, in the `RowCommand` event handler the last page index (`PageCount - 1`) represents the last page index *before* the new product has been added.</span></span> <span data-ttu-id="4b907-282">Für die meisten Produkte, die hinzugefügt wird entspricht der Index der letzten Seite nach dem Hinzufügen des neuen Produkts.</span><span class="sxs-lookup"><span data-stu-id="4b907-282">For the majority of products being added, the last page index is the same after adding the new product.</span></span> <span data-ttu-id="4b907-283">Aber wenn führt hinzugefügte Produkt einen neuen letzte Seitenindex, bei falsch Aktualisierung der `PageIndex` in die `RowCommand` -Ereignishandler dann wir gelangen zum zweiten zur letzten Seite (der letzten Seitenindex vor dem Hinzufügen des neuen Produkts) im Gegensatz zu der neuen letzten Seite i ndextyp.</span><span class="sxs-lookup"><span data-stu-id="4b907-283">But when the added product results in a new last page index, if we incorrectly update the `PageIndex` in the `RowCommand` event handler then we'll be taken to the second to last page (the last page index prior to adding the new product) as opposed to the new last page index.</span></span> <span data-ttu-id="4b907-284">Da die `DataBound` Ereignishandler ausgelöst wird, nachdem das neue Produkt wurde hinzugefügt, und die Daten in das Raster, erneut, durch Festlegen gebunden der `PageIndex` Eigenschaft es wir wissen wir erneut die erste des richtige Indexes der letzten Seite.</span><span class="sxs-lookup"><span data-stu-id="4b907-284">Since the `DataBound` event handler fires after the new product has been added and the data rebound to the grid, by setting the `PageIndex` property there we know we re getting the correct last page index.</span></span>

<span data-ttu-id="4b907-285">Schließlich ist die GridView, die in diesem Tutorial verwendeten sehr breit aufgrund der Anzahl von Feldern, die für das Hinzufügen eines neuen Produkts erfasst werden müssen.</span><span class="sxs-lookup"><span data-stu-id="4b907-285">Finally, the GridView used in this tutorial is quite wide due to the number of fields that must be collected for adding a new product.</span></span> <span data-ttu-id="4b907-286">Aufgrund dieser Breite möglicherweise ein DetailsView s vertikales Layout bevorzugt.</span><span class="sxs-lookup"><span data-stu-id="4b907-286">Due to this width, a DetailsView s vertical layout might be preferred.</span></span> <span data-ttu-id="4b907-287">Das GridView-s Gesamtbreite konnte das Sammeln von weniger Eingaben reduziert werden.</span><span class="sxs-lookup"><span data-stu-id="4b907-287">The GridView s overall width could be reduced by collecting fewer inputs.</span></span> <span data-ttu-id="4b907-288">Vielleicht Wir raten t muss zum Sammeln der `UnitsOnOrder`, `UnitsInStock`, und `ReorderLevel` Felder beim Hinzufügen eines neuen Produkts, in diesem Fall diese Felder aus der GridView entfernt werden konnte.</span><span class="sxs-lookup"><span data-stu-id="4b907-288">Perhaps we don t need to collect the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields when adding a new product, in which case these fields could be removed from the GridView.</span></span>

<span data-ttu-id="4b907-289">Um die gesammelten Daten anzupassen, können wir zwei Ansätze verwenden:</span><span class="sxs-lookup"><span data-stu-id="4b907-289">To adjust the data collected, we can use one of two approaches:</span></span>

- <span data-ttu-id="4b907-290">Weiterhin verwenden, die `AddProduct` -Methode, Werte für erwartet, die `UnitsOnOrder`, `UnitsInStock`, und `ReorderLevel` Felder.</span><span class="sxs-lookup"><span data-stu-id="4b907-290">Continue to use the `AddProduct` method that expects values for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="4b907-291">In der `Inserting` -Ereignishandler geben hartcodiert, Standardwerte für diese Eingaben verwenden, die von der einfügen-Schnittstelle entfernt wurden.</span><span class="sxs-lookup"><span data-stu-id="4b907-291">In the `Inserting` event handler, provide hard-coded, default values to use for these inputs that have been removed from the inserting interface.</span></span>
- <span data-ttu-id="4b907-292">Erstellen Sie eine neue Überladung der der `AddProduct` -Methode in der die `ProductsBLL` -Klasse, die keine Eingaben für akzeptiert die `UnitsOnOrder`, `UnitsInStock`, und `ReorderLevel` Felder.</span><span class="sxs-lookup"><span data-stu-id="4b907-292">Create a new overload of the `AddProduct` method in the `ProductsBLL` class that does not accept inputs for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="4b907-293">Konfigurieren Sie Sie dann auf der ASP.NET-Seite die "ObjectDataSource", um diese neue Überladung zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="4b907-293">Then, in the ASP.NET page, configure the ObjectDataSource to use this new overload.</span></span>

<span data-ttu-id="4b907-294">Beide Optionen werden ebenso wie gut funktionieren.</span><span class="sxs-lookup"><span data-stu-id="4b907-294">Either option will work equally as well.</span></span> <span data-ttu-id="4b907-295">In nach Tutorials wird die zweite Option verwenden, erstellen mehrere Überladungen für die `ProductsBLL` Klasse s `UpdateProduct` Methode.</span><span class="sxs-lookup"><span data-stu-id="4b907-295">In past tutorials we used the latter option, creating multiple overloads for the `ProductsBLL` class s `UpdateProduct` method.</span></span>

## <a name="summary"></a><span data-ttu-id="4b907-296">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="4b907-296">Summary</span></span>

<span data-ttu-id="4b907-297">GridView verfügt nicht über die integrierten Einfügen von Funktionen, die im DetailsView und FormView-Steuerelement gefunden, aber mit ein wenig Aufwand kann eine Schnittstelle einfügende, das die Footerzeile hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="4b907-297">The GridView lacks the built-in inserting capabilities found in the DetailsView and FormView, but with a bit of effort an inserting interface can be added to the footer row.</span></span> <span data-ttu-id="4b907-298">Einfach anzeigen, das die Footerzeile in einem GridView fest seine `ShowFooter` Eigenschaft `True`.</span><span class="sxs-lookup"><span data-stu-id="4b907-298">To display the footer row in a GridView simply set its `ShowFooter` property to `True`.</span></span> <span data-ttu-id="4b907-299">Inhalt der Zeile für jedes Feld angepasst werden kann, durch das Feld in ein TemplateField konvertieren und-Schnittstelle hinzufügen, das Einfügen der `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="4b907-299">The footer row content can be customized for each field by converting the field to a TemplateField and adding the inserting interface to the `FooterTemplate`.</span></span> <span data-ttu-id="4b907-300">Wie in diesem Tutorial erläutert die `FooterTemplate` Schaltflächen, Textfelder, DropDownList-Steuerelementen, Kontrollkästchen, Datenquellen-Steuerelemente für das Auffüllen der datengesteuerten von Websteuerelementen (z. B. DropDownList-Steuerelementen) und Steuerelemente zur gültigkeitsprüfung enthalten können.</span><span class="sxs-lookup"><span data-stu-id="4b907-300">As we saw in this tutorial, the `FooterTemplate` can contain Buttons, TextBoxes, DropDownLists, CheckBoxes, data source controls for populating data-driven Web controls (such as DropDownLists), and validation controls.</span></span> <span data-ttu-id="4b907-301">Sowie Steuerelemente zum Erfassen der Benutzereingabe s ist eine Schaltfläche "hinzufügen", LinkButton oder ImageButton erforderlich.</span><span class="sxs-lookup"><span data-stu-id="4b907-301">Along with controls for collecting the user s input, an Add Button, LinkButton, or ImageButton is needed.</span></span>

<span data-ttu-id="4b907-302">Wenn die Schaltfläche "Add" geklickt wird, das "ObjectDataSource"-s `Insert()` Methode wird aufgerufen, um die einfügen Workflow zu starten.</span><span class="sxs-lookup"><span data-stu-id="4b907-302">When the Add button is clicked, the ObjectDataSource s `Insert()` method is invoked to start the inserting workflow.</span></span> <span data-ttu-id="4b907-303">Die ObjectDataSource ruft dann die konfigurierten Insert-Methode (die `ProductsBLL` Klasse s `AddProduct` -Methode, in diesem Tutorial).</span><span class="sxs-lookup"><span data-stu-id="4b907-303">The ObjectDataSource will then call the configured insert method (the `ProductsBLL` class s `AddProduct` method, in this tutorial).</span></span> <span data-ttu-id="4b907-304">Wir müssen die Werte aus den einfügen-Schnittstelle, um das "ObjectDataSource"-s GridView-s kopieren `InsertParameters` hinzugefügt werden, bevor der Insert-Methode aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="4b907-304">We must copy the values from the GridView s inserting interface to the ObjectDataSource s `InsertParameters` collection prior to the insert method being invoked.</span></span> <span data-ttu-id="4b907-305">Dies kann erreicht werden, durch Programmgesteuertes Verweisen auf das Einfügen von Steuerelemente der Benutzeroberfläche Web in der "ObjectDataSource"-s `Inserting` -Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="4b907-305">This can be accomplished by programmatically referencing the inserting interface Web controls in the ObjectDataSource s `Inserting` event handler.</span></span>

<span data-ttu-id="4b907-306">Dieses Tutorial ist abgeschlossen, unsere Betrachtung Techniken zum Verbessern der GridView-s-Darstellung.</span><span class="sxs-lookup"><span data-stu-id="4b907-306">This tutorial completes our look at techniques for enhancing the GridView s appearance.</span></span> <span data-ttu-id="4b907-307">Der nächste Satz von Tutorials werden untersucht, wie Sie arbeiten mit Binärdaten wie Bilder, PDFs, Word-Dokumente, und so weiter die Daten und Websteuerelemente.</span><span class="sxs-lookup"><span data-stu-id="4b907-307">The next set of tutorials will examine how to work with binary data such as images, PDFs, Word documents, and so on and the data Web controls.</span></span>

<span data-ttu-id="4b907-308">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="4b907-308">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="4b907-309">Der Autor</span><span class="sxs-lookup"><span data-stu-id="4b907-309">About the Author</span></span>

<span data-ttu-id="4b907-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben Büchern zu ASP/ASP.NET und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), arbeitet mit Microsoft-Web-Technologien seit 1998.</span><span class="sxs-lookup"><span data-stu-id="4b907-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="4b907-311">Er ist als ein unabhängiger Berater, Schulungsleiter und Autor.</span><span class="sxs-lookup"><span data-stu-id="4b907-311">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="4b907-312">Sein neueste Buch wird [*Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="4b907-312">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="4b907-313">Er ist unter [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="4b907-313">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="4b907-314">oder über seinen Blog finden Sie unter [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="4b907-314">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="4b907-315">Besonderen Dank an</span><span class="sxs-lookup"><span data-stu-id="4b907-315">Special Thanks To</span></span>

<span data-ttu-id="4b907-316">Diese tutorialreihe wurde durch viele hilfreiche Reviewer überprüft.</span><span class="sxs-lookup"><span data-stu-id="4b907-316">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="4b907-317">Führendes Prüfer für dieses Tutorial wurde Bernadette Leigh.</span><span class="sxs-lookup"><span data-stu-id="4b907-317">Lead reviewer for this tutorial was Bernadette Leigh.</span></span> <span data-ttu-id="4b907-318">Meine zukünftigen MSDN-Artikeln überprüfen möchten?</span><span class="sxs-lookup"><span data-stu-id="4b907-318">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="4b907-319">Wenn dies der Fall ist, löschen Sie mir eine Linie an [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="4b907-319">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="4b907-320">Vorherige</span><span class="sxs-lookup"><span data-stu-id="4b907-320">Previous</span></span>](adding-a-gridview-column-of-checkboxes-vb.md)
