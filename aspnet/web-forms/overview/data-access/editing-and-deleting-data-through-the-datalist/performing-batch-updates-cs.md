---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/performing-batch-updates-cs
title: Durchführen von BatchUpdates (c#) | Microsoft-Dokumentation
author: rick-anderson
description: Erfahren Sie, wie erstellen Sie eine vollständig bearbeitbare DataList-Steuerelement, in dem alle Elemente sind im, Bearbeitungsmodus wird, deren Werte gespeichert werden können, indem Sie auf eine Schaltfläche "Alle aktualisieren" auf die...
ms.author: aspnetcontent
ms.date: 10/30/2006
ms.assetid: 57743ca7-5695-4e07-aed1-44b297f245a9
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/performing-batch-updates-cs
msc.type: authoredcontent
ms.openlocfilehash: 3528444269a3595681696251d3906a204090410c
ms.sourcegitcommit: b28cd0313af316c051c2ff8549865bff67f2fbb4
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 07/05/2018
ms.locfileid: "37807804"
---
<a name="performing-batch-updates-c"></a><span data-ttu-id="d28c3-103">Durchführen von BatchUpdates (c#)</span><span class="sxs-lookup"><span data-stu-id="d28c3-103">Performing Batch Updates (C#)</span></span>
====================
<span data-ttu-id="d28c3-104">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="d28c3-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="d28c3-105">[Beispiel-App herunter](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_37_CS.exe) oder [PDF-Datei herunterladen](performing-batch-updates-cs/_static/datatutorial37cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="d28c3-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_37_CS.exe) or [Download PDF](performing-batch-updates-cs/_static/datatutorial37cs1.pdf)</span></span>

> <span data-ttu-id="d28c3-106">Erfahren Sie, wie erstellen Sie eine vollständig bearbeitbare DataList-Steuerelement, in dem alle Elemente befinden sich in, zu bearbeiten, Modus und die Schaltfläche "Alle aktualisieren" auf der Seite, deren Werte gespeichert werden können.</span><span class="sxs-lookup"><span data-stu-id="d28c3-106">Learn how to create a fully-editable DataList where all of its items are in edit mode and whose values can be saved by clicking an "Update All" button on the page.</span></span>


## <a name="introduction"></a><span data-ttu-id="d28c3-107">Einführung</span><span class="sxs-lookup"><span data-stu-id="d28c3-107">Introduction</span></span>

<span data-ttu-id="d28c3-108">In der [vorherigen Lernprogramm](an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md) wurde beschrieben, wie ein DataList auf Elementebene zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="d28c3-108">In the [preceding tutorial](an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md) we examined how to create an item-level DataList.</span></span> <span data-ttu-id="d28c3-109">Wie standard bearbeitbaren GridView jedes Element im DataList-Steuerelement enthalten eine Bearbeitung-Schaltfläche geklickt wird, würde das Element bearbeitet werden machen.</span><span class="sxs-lookup"><span data-stu-id="d28c3-109">Like the standard editable GridView, each item in the DataList included an Edit button that, when clicked, would make the item editable.</span></span> <span data-ttu-id="d28c3-110">Während dies auf Elementebene Bearbeitung eignet sich gut für Daten, die nur gelegentlich aktualisiert werden, erfordern bestimmte Szenarien zu Anwendungsfällen die Benutzer viele Datensätze zu bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="d28c3-110">While this item-level editing works well for data that is only updated occasionally, certain use case scenarios require the user to edit many records.</span></span> <span data-ttu-id="d28c3-111">Wenn ein Benutzer so bearbeiten Sie Dutzende von Datensätzen muss und gezwungen, klicken Sie auf Bearbeiten, stellen ihre Änderungen und Updates für jeden einzelnen auf, kann die Menge des auf ihre Produktivität behindern.</span><span class="sxs-lookup"><span data-stu-id="d28c3-111">If a user needs to edit dozens of records and is forced to click Edit, make their changes, and click Update for each one, the amount of clicking can hamper her productivity.</span></span> <span data-ttu-id="d28c3-112">In solchen Situationen eine bessere Option darstellt, zu einem vollständig bearbeitbare DataList-Steuerelement, eine Where *alle* Elemente werden im Bearbeitungsmodus befindet und deren Werte bearbeitet werden können, indem Sie auf eine Schaltfläche "Alle aktualisieren", auf der Seite (siehe Abbildung 1).</span><span class="sxs-lookup"><span data-stu-id="d28c3-112">In such situations, a better option is to provide a fully-editable DataList, one where *all* of its items are in edit mode and whose values can be edited by clicking an Update All button on the page (see Figure 1).</span></span>


<span data-ttu-id="d28c3-113">[![Jedes Element in einem vollständig bearbeitbare DataList-Steuerelement kann geändert werden](performing-batch-updates-cs/_static/image2.png)](performing-batch-updates-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="d28c3-113">[![Each Item in a Fully Editable DataList can be Modified](performing-batch-updates-cs/_static/image2.png)](performing-batch-updates-cs/_static/image1.png)</span></span>

<span data-ttu-id="d28c3-114">**Abbildung 1**: jedes Element in einem vollständig bearbeitbare DataList-Steuerelement kann geändert werden ([klicken Sie, um das Bild in voller Größe anzeigen](performing-batch-updates-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="d28c3-114">**Figure 1**: Each Item in a Fully Editable DataList can be Modified ([Click to view full-size image](performing-batch-updates-cs/_static/image3.png))</span></span>


<span data-ttu-id="d28c3-115">In diesem Tutorial betrachten wir, wie Benutzer zum Aktualisieren der Lieferanten-Adressinformationen, die mit einem DataList-Steuerelement vollständig bearbeitet werden können.</span><span class="sxs-lookup"><span data-stu-id="d28c3-115">In this tutorial we'll examine how to enable users to update suppliers address information using a fully editable DataList.</span></span>

## <a name="step-1-create-the-editable-user-interface-in-the-datalist-s-itemtemplate"></a><span data-ttu-id="d28c3-116">Schritt 1: Erstellen der bearbeitbaren-Benutzeroberfläche in der ItemTemplate s DataList-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="d28c3-116">Step 1: Create the Editable User Interface in the DataList s ItemTemplate</span></span>

<span data-ttu-id="d28c3-117">Im vorherigen Tutorial, in denen wir zu einem standard, der auf Elementebene bearbeitbaren DataList-Steuerelement erstellen, wir zwei Vorlagen verwendet:</span><span class="sxs-lookup"><span data-stu-id="d28c3-117">In the preceding tutorial, where we creating a standard, item-level editable DataList, we used two templates:</span></span>

- <span data-ttu-id="d28c3-118">`ItemTemplate` enthalten, die nur-Lese Benutzeroberfläche (die Bezeichnung-Web-Steuerelemente zum Anzeigen von jeder s Produktnamen und Preis).</span><span class="sxs-lookup"><span data-stu-id="d28c3-118">`ItemTemplate` contained the read-only user interface (the Label Web controls for displaying each product s name and price).</span></span>
- <span data-ttu-id="d28c3-119">`EditItemTemplate` enthalten die bearbeiten-Modus-Benutzeroberfläche (die beiden TextBox-Web-Steuerelemente).</span><span class="sxs-lookup"><span data-stu-id="d28c3-119">`EditItemTemplate` contained the edit mode user interface (the two TextBox Web controls).</span></span>

<span data-ttu-id="d28c3-120">DataList-Steuerelement s `EditItemIndex` Eigenschaft gibt vor, was `DataListItem` (sofern vorhanden) gerendert wird, mit der `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="d28c3-120">The DataList s `EditItemIndex` property dictates what `DataListItem` (if any) is rendered using the `EditItemTemplate`.</span></span> <span data-ttu-id="d28c3-121">Insbesondere die `DataListItem` , deren `ItemIndex` Wert entspricht die DataList s `EditItemIndex` Eigenschaft gerendert wird, mit der `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="d28c3-121">In particular, the `DataListItem` whose `ItemIndex` value matches the DataList s `EditItemIndex` property is rendered using the `EditItemTemplate`.</span></span> <span data-ttu-id="d28c3-122">Dieses Modell funktioniert gut, wenn Sie eine Zeit, aber voneinander fällt nur ein Element bearbeitet werden kann, bei einem vollständig bearbeitbare DataList-Steuerelement zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="d28c3-122">This model works well when only one item can be edited at a time, but falls apart when creating a fully-editable DataList.</span></span>

<span data-ttu-id="d28c3-123">Für eine vollständig bearbeitbare DataList, möchten wir *alle* von der `DataListItem` s zum Rendern mithilfe der Benutzeroberfläche bearbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="d28c3-123">For a fully editable DataList, we want *all* of the `DataListItem` s to render using the editable interface.</span></span> <span data-ttu-id="d28c3-124">Die einfachste Möglichkeit hierzu ist, definiert die bearbeitbaren-Schnittstelle in der `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="d28c3-124">The simplest way to accomplish this is to define the editable interface in the `ItemTemplate`.</span></span> <span data-ttu-id="d28c3-125">Zum Ändern der Lieferanten-Adressinformationen, enthält die bearbeitbare Schnittstelle die Lieferantenname als Text und anschließend die Textfelder für die Adresse, Stadt und Land-Werte.</span><span class="sxs-lookup"><span data-stu-id="d28c3-125">For modifying the suppliers address information, the editable interface contains the supplier name as text and then TextBoxes for the address, city, and country values.</span></span>

<span data-ttu-id="d28c3-126">Öffnen Sie zunächst die `BatchUpdate.aspx` Seite, fügen Sie ein DataList-Steuerelement hinzu, und legen dessen `ID` Eigenschaft `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="d28c3-126">Start by opening the `BatchUpdate.aspx` page, add a DataList control, and set its `ID` property to `Suppliers`.</span></span> <span data-ttu-id="d28c3-127">Deaktivieren Sie aus dem Smarttag DataList s, um ein neues ObjectDataSource-Steuerelement, das mit dem Namen hinzuzufügen `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="d28c3-127">From the DataList s smart tag, opt to add a new ObjectDataSource control named `SuppliersDataSource`.</span></span>


<span data-ttu-id="d28c3-128">[![Erstellen Sie eine neue, mit dem Namen SuppliersDataSource "ObjectDataSource"](performing-batch-updates-cs/_static/image5.png)](performing-batch-updates-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="d28c3-128">[![Create a New ObjectDataSource Named SuppliersDataSource](performing-batch-updates-cs/_static/image5.png)](performing-batch-updates-cs/_static/image4.png)</span></span>

<span data-ttu-id="d28c3-129">**Abbildung 2**: Erstellen einer neuen "ObjectDataSource" mit dem Namen `SuppliersDataSource` ([klicken Sie, um das Bild in voller Größe anzeigen](performing-batch-updates-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="d28c3-129">**Figure 2**: Create a New ObjectDataSource Named `SuppliersDataSource` ([Click to view full-size image](performing-batch-updates-cs/_static/image6.png))</span></span>


<span data-ttu-id="d28c3-130">Konfigurieren Sie zum Abrufen von Daten, die mit dem ObjectDataSource-Steuerelement die `SuppliersBLL` Klasse s `GetSuppliers()` Methode (siehe Abbildung 3).</span><span class="sxs-lookup"><span data-stu-id="d28c3-130">Configure the ObjectDataSource to retrieve data using the `SuppliersBLL` class s `GetSuppliers()` method (see Figure 3).</span></span> <span data-ttu-id="d28c3-131">Wie bei dem vorherigen Lernprogramm, anstatt die Lieferanteninformationen über das ObjectDataSource-Steuerelement wird aktualisiert, arbeiten wir direkt mit der Geschäftslogikebene.</span><span class="sxs-lookup"><span data-stu-id="d28c3-131">As with the preceding tutorial, rather than updating the supplier information through the ObjectDataSource, we'll work directly with the Business Logic Layer.</span></span> <span data-ttu-id="d28c3-132">Legen Sie daher die Dropdown-Liste (keine) auf der Registerkarte "UPDATE" (siehe Abbildung 4).</span><span class="sxs-lookup"><span data-stu-id="d28c3-132">Therefore, set the drop-down list to (None) in the UPDATE tab (see Figure 4).</span></span>


<span data-ttu-id="d28c3-133">[![Abrufen von Lieferanteninformationen mithilfe der GetSuppliers()-Methode](performing-batch-updates-cs/_static/image8.png)](performing-batch-updates-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="d28c3-133">[![Retrieve Supplier Information Using the GetSuppliers() Method](performing-batch-updates-cs/_static/image8.png)](performing-batch-updates-cs/_static/image7.png)</span></span>

<span data-ttu-id="d28c3-134">**Abbildung 3**: Abrufen von Lieferanten Informationen mithilfe der `GetSuppliers()` Methode ([klicken Sie, um das Bild in voller Größe anzeigen](performing-batch-updates-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="d28c3-134">**Figure 3**: Retrieve Supplier Information Using the `GetSuppliers()` Method ([Click to view full-size image](performing-batch-updates-cs/_static/image9.png))</span></span>


<span data-ttu-id="d28c3-135">[![Legen Sie die Dropdown-Liste (keine) in der Registerkarte "Updates"](performing-batch-updates-cs/_static/image11.png)](performing-batch-updates-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="d28c3-135">[![Set the Drop-Down List to (None) in the UPDATE Tab](performing-batch-updates-cs/_static/image11.png)](performing-batch-updates-cs/_static/image10.png)</span></span>

<span data-ttu-id="d28c3-136">**Abbildung 4**: Legen Sie die Dropdown-Liste (keine) auf der Registerkarte "UPDATE" ([klicken Sie, um das Bild in voller Größe anzeigen](performing-batch-updates-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="d28c3-136">**Figure 4**: Set the Drop-Down List to (None) in the UPDATE Tab ([Click to view full-size image](performing-batch-updates-cs/_static/image12.png))</span></span>


<span data-ttu-id="d28c3-137">Nach Abschluss des Assistenten, generiert Visual Studio automatisch die DataList s `ItemTemplate` zum Anzeigen der einzelnen Datenfelder, die von der Datenquelle in ein Label-Steuerelement zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="d28c3-137">After completing the wizard, Visual Studio automatically generates the DataList s `ItemTemplate` to display each data field returned by the data source in a Label Web control.</span></span> <span data-ttu-id="d28c3-138">Wir müssen diese Vorlage zu ändern, sodass sie stattdessen die Bearbeitungsschnittstelle bieten.</span><span class="sxs-lookup"><span data-stu-id="d28c3-138">We need to modify this template so that it provides the editing interface instead.</span></span> <span data-ttu-id="d28c3-139">Die `ItemTemplate` kann angepasst werden, mithilfe des Designers mit der Option "Vorlagen bearbeiten" aus dem Smarttag DataList s oder direkt über die deklarative Syntax.</span><span class="sxs-lookup"><span data-stu-id="d28c3-139">The `ItemTemplate` can be customized through the Designer using the Edit Templates option from the DataList s smart tag or directly through the declarative syntax.</span></span>

<span data-ttu-id="d28c3-140">Nehmen Sie einen Moment Zeit, um eine Bearbeiten-Schnittstelle zu erstellen, die wird der Name des Lieferanten s als Text angezeigt, sondern enthält Textfelder für die Lieferanten-e-Adresse, Stadt und Land-Werte.</span><span class="sxs-lookup"><span data-stu-id="d28c3-140">Take a moment to create an editing interface that displays the supplier s name as text, but includes TextBoxes for the supplier s address, city, and country values.</span></span> <span data-ttu-id="d28c3-141">Nach diesen Änderungen sollte Ihre Seite s deklarative Syntax ähnlich der folgenden aussehen:</span><span class="sxs-lookup"><span data-stu-id="d28c3-141">After making these changes, your page s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](performing-batch-updates-cs/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="d28c3-142">Als muss mit dem vorherigen Lernprogramm, DataList-Steuerelement in diesem Tutorial Ansichtszustand aktiviert sein.</span><span class="sxs-lookup"><span data-stu-id="d28c3-142">As with the preceding tutorial, the DataList in this tutorial must have its view state enabled.</span></span>


<span data-ttu-id="d28c3-143">In der `ItemTemplate` ich m mithilfe von zwei neuen CSS-Klassen `SupplierPropertyLabel` und `SupplierPropertyValue`, die hinzugefügt wurden die `Styles.css` -Klasse und konfiguriert die gleichen stileinstellungen wie die `ProductPropertyLabel` und `ProductPropertyValue` CSS-Klassen.</span><span class="sxs-lookup"><span data-stu-id="d28c3-143">In the `ItemTemplate` I m using two new CSS classes, `SupplierPropertyLabel` and `SupplierPropertyValue`, which have been added to the `Styles.css` class and configured to use the same style settings as the `ProductPropertyLabel` and `ProductPropertyValue` CSS classes.</span></span>


[!code-css[Main](performing-batch-updates-cs/samples/sample2.css)]

<span data-ttu-id="d28c3-144">Finden Sie nach diesen Änderungen auf dieser Seite über einen Browser.</span><span class="sxs-lookup"><span data-stu-id="d28c3-144">After making these changes, visit this page through a browser.</span></span> <span data-ttu-id="d28c3-145">Wie in Abbildung 5 gezeigt, wird jedes DataList-Element zeigt den Lieferantennamen als Text und Textfelder zum Anzeigen der Adresse, Stadt und Land verwendet.</span><span class="sxs-lookup"><span data-stu-id="d28c3-145">As Figure 5 shows, each DataList item displays the supplier name as text and uses TextBoxes to display the address, city, and country.</span></span>


<span data-ttu-id="d28c3-146">[![Jeder Lieferant im DataList-Steuerelement ist bearbeitbar](performing-batch-updates-cs/_static/image14.png)](performing-batch-updates-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="d28c3-146">[![Each Supplier in the DataList is Editable](performing-batch-updates-cs/_static/image14.png)](performing-batch-updates-cs/_static/image13.png)</span></span>

<span data-ttu-id="d28c3-147">**Abbildung 5**: jeder Lieferant im DataList-Steuerelement ist bearbeitbar ([klicken Sie, um das Bild in voller Größe anzeigen](performing-batch-updates-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="d28c3-147">**Figure 5**: Each Supplier in the DataList is Editable ([Click to view full-size image](performing-batch-updates-cs/_static/image15.png))</span></span>


## <a name="step-2-adding-an-update-all-button"></a><span data-ttu-id="d28c3-148">Schritt 2: Hinzufügen einer Update-Schaltfläche "alle"</span><span class="sxs-lookup"><span data-stu-id="d28c3-148">Step 2: Adding an Update All Button</span></span>

<span data-ttu-id="d28c3-149">Während der einzelnen Lieferanten in Abbildung 5 die Adresse, Stadt und Landesfelder, die in einem Textfeld angezeigt hat, ist gibt es derzeit keine Schaltfläche "Aktualisieren" verfügbar.</span><span class="sxs-lookup"><span data-stu-id="d28c3-149">While each supplier in Figure 5 has its address, city, and country fields displayed in a TextBox, there currently is no Update button available.</span></span> <span data-ttu-id="d28c3-150">Anstatt eine Aktualisieren-Schaltfläche pro Element, mit vollständig bearbeitbare DataList-Steuerelementen unterstützt besteht in der Regel eine einzelne alle Aktualisieren-Schaltfläche auf der Seite, die beim Klicken auf updates *alle* der Datensätze im DataList-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="d28c3-150">Rather than having an Update button per item, with fully editable DataLists there is typically a single Update All button on the page that, when clicked, updates *all* of the records in the DataList.</span></span> <span data-ttu-id="d28c3-151">In diesem Tutorial können Sie s zwei Update alle Schaltflächen - einen am oberen Rand der Seite und einen am unteren Rand hinzufügen (auch wenn eine der Schaltflächen auf die gleiche Auswirkung haben wird).</span><span class="sxs-lookup"><span data-stu-id="d28c3-151">For this tutorial, let s add two Update All buttons - one at the top of the page and one at the bottom (although clicking either button will have the same effect).</span></span>

<span data-ttu-id="d28c3-152">Hinzufügen eines Steuerelements Schaltfläche Web über das DataList-Steuerelement und legen Sie zunächst die `ID` Eigenschaft `UpdateAll1`.</span><span class="sxs-lookup"><span data-stu-id="d28c3-152">Start by adding a Button Web control above the DataList and set its `ID` property to `UpdateAll1`.</span></span> <span data-ttu-id="d28c3-153">Als Nächstes fügen Sie die zweite Schaltfläche Websteuerelement unter DataList-Steuerelement, Festlegen der `ID` zu `UpdateAll2`.</span><span class="sxs-lookup"><span data-stu-id="d28c3-153">Next, add the second Button Web control beneath the DataList, setting its `ID` to `UpdateAll2`.</span></span> <span data-ttu-id="d28c3-154">Legen Sie die `Text` Eigenschaften für die beiden Schaltflächen Alle aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="d28c3-154">Set the `Text` properties for the two Buttons to Update All.</span></span> <span data-ttu-id="d28c3-155">Erstellen von Ereignishandlern und schließlich für beide Tasten `Click` Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="d28c3-155">Lastly, create event handlers for both Buttons `Click` events.</span></span> <span data-ttu-id="d28c3-156">Statt der Aktualisierungslogik in jeder der Ereignishandler, Umgestalten können s Diese Logik an eine dritte Methode `UpdateAllSupplierAddresses`, müssen die Ereignishandler, die diese dritte Methode einfach im aufrufen.</span><span class="sxs-lookup"><span data-stu-id="d28c3-156">Rather than duplicating the update logic in each of the event handlers, let s refactor that logic to a third method, `UpdateAllSupplierAddresses`, having the event handlers simply invoking this third method.</span></span>


[!code-csharp[Main](performing-batch-updates-cs/samples/sample3.cs)]

<span data-ttu-id="d28c3-157">Abbildung 6 zeigt die Seite, nachdem die Aktualisierung alle Schaltflächen hinzugefügt wurden.</span><span class="sxs-lookup"><span data-stu-id="d28c3-157">Figure 6 shows the page after the Update All buttons have been added.</span></span>


<span data-ttu-id="d28c3-158">[![Zwei Update alle Schaltflächen wurden auf der Seite hinzugefügt](performing-batch-updates-cs/_static/image17.png)](performing-batch-updates-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="d28c3-158">[![Two Update All Buttons have been Added to the Page](performing-batch-updates-cs/_static/image17.png)](performing-batch-updates-cs/_static/image16.png)</span></span>

<span data-ttu-id="d28c3-159">**Abbildung 6**: wurden zwei Update alle Schaltflächen auf der Seite hinzugefügt ([klicken Sie, um das Bild in voller Größe anzeigen](performing-batch-updates-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="d28c3-159">**Figure 6**: Two Update All Buttons have been Added to the Page ([Click to view full-size image](performing-batch-updates-cs/_static/image18.png))</span></span>


## <a name="step-3-updating-all-of-the-suppliers-address-information"></a><span data-ttu-id="d28c3-160">Schritt 3: Aktualisieren aller die Lieferanten-Adressinformationen</span><span class="sxs-lookup"><span data-stu-id="d28c3-160">Step 3: Updating All of the Suppliers Address Information</span></span>

<span data-ttu-id="d28c3-161">Mit allen die DataList-s-Elemente die Bearbeitungsschnittstelle anzeigen und durch das Aktualisieren aller Schaltflächen hinzufügen alle diese bleibt ist das Schreiben des Codes zur Ausführung der BatchUpdate.</span><span class="sxs-lookup"><span data-stu-id="d28c3-161">With all of the DataList s items displaying the editing interface and with the addition of the Update All buttons, all that remains is writing the code to perform the batch update.</span></span> <span data-ttu-id="d28c3-162">Insbesondere müssen wir so durchlaufen Sie das DataList-s-Elementen, und rufen die `SuppliersBLL` Klasse s `UpdateSupplierAddress` Methode für jede einzelne.</span><span class="sxs-lookup"><span data-stu-id="d28c3-162">Specifically, we need to loop through the DataList s items and call the `SuppliersBLL` class s `UpdateSupplierAddress` method for each one.</span></span>

<span data-ttu-id="d28c3-163">Die Auflistung der `DataListItem` Instanzen dieser Zusammensetzung DataList-Steuerelement kann, über DataList-Steuerelement s zugegriffen werden [ `Items` Eigenschaft](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.items.aspx).</span><span class="sxs-lookup"><span data-stu-id="d28c3-163">The collection of `DataListItem` instances that makeup the DataList can be accessed via the DataList s [`Items` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.items.aspx).</span></span> <span data-ttu-id="d28c3-164">Mit einem Verweis auf eine `DataListItem`, können wir ziehen Sie das entsprechende `SupplierID` aus der `DataKeys` Auflistung und programmgesteuert Verweis im TextBox-Web-innerhalb Steuerelemente der `ItemTemplate` wie der folgende Code veranschaulicht:</span><span class="sxs-lookup"><span data-stu-id="d28c3-164">With a reference to a `DataListItem`, we can grab the corresponding `SupplierID` from the `DataKeys` collection and programmatically reference the TextBox Web controls within the `ItemTemplate` as the following code illustrates:</span></span>


[!code-csharp[Main](performing-batch-updates-cs/samples/sample4.cs)]

<span data-ttu-id="d28c3-165">Eine der Schaltflächen Alle aktualisieren, klickt der Benutzer die `UpdateAllSupplierAddresses` Methode durchläuft die einzelnen `DataListItem` in die `Suppliers` DataList und ruft die `SuppliersBLL` s-Klasse `UpdateSupplierAddress` Methode und die entsprechenden Werte übergeben.</span><span class="sxs-lookup"><span data-stu-id="d28c3-165">When the user clicks one of the Update All buttons, the `UpdateAllSupplierAddresses` method iterates through each `DataListItem` in the `Suppliers` DataList and calls the `SuppliersBLL` class s `UpdateSupplierAddress` method, passing in the corresponding values.</span></span> <span data-ttu-id="d28c3-166">Ein nicht eingegebene Wert für die Adresse, Stadt oder Land übergibt ist ein Wert von `Nothing` zu `UpdateSupplierAddress` (anstatt eine leere Zeichenfolge), was dazu führt, in einer Datenbank `NULL` für die zugrunde liegenden Datensatz s-Felder.</span><span class="sxs-lookup"><span data-stu-id="d28c3-166">A non-entered value for address, city, or country passes is a value of `Nothing` to `UpdateSupplierAddress` (rather than a blank string), which results in a database `NULL` for the underlying record s fields.</span></span>

> [!NOTE]
> <span data-ttu-id="d28c3-167">Als eine Erweiterung empfiehlt sich der Status Bezeichnung-Websteuerelement zur Seite hinzufügen, die eine bestätigungsmeldung bereitstellt, nachdem das BatchUpdate ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="d28c3-167">As an enhancement, you may want to add a status Label Web control to the page that provides some confirmation message after the batch update is performed.</span></span>


## <a name="updating-only-those-addresses-that-have-been-modified"></a><span data-ttu-id="d28c3-168">Aktualisieren nur die Adressen, die geändert wurde.</span><span class="sxs-lookup"><span data-stu-id="d28c3-168">Updating Only Those Addresses That Have Been Modified</span></span>

<span data-ttu-id="d28c3-169">Der Batch-Update-Algorithmus für dieses Lernprogramm ruft verwendet die `UpdateSupplierAddress` -Methode für *jeder* Lieferanten im DataList-Steuerelement, unabhängig davon, ob ihre Adressinformationen geändert wurde.</span><span class="sxs-lookup"><span data-stu-id="d28c3-169">The batch update algorithm used for this tutorial calls the `UpdateSupplierAddress` method for *every* supplier in the DataList, regardless of whether their address information has been changed.</span></span> <span data-ttu-id="d28c3-170">Während solche Blind sind t in der Regel ein Leistungsproblem aktualisiert, können sie zu überflüssigen Datensätze führen re-Überwachung in die Datenbanktabelle überschreiten.</span><span class="sxs-lookup"><span data-stu-id="d28c3-170">While such blind updates aren t usually a performance issue, they can lead to superfluous records if you re auditing changes to the database table.</span></span> <span data-ttu-id="d28c3-171">Angenommen, Sie Trigger verwenden, um alle aufzuzeichnen `UPDATE` s, um die `Suppliers` Tabelle in die auf eine Überwachung, jedes Mal, wenn ein Benutzer die Schaltfläche "Alle aktualisieren" klickt, ein neuen Überwachungsdatensatz für jeden Lieferanten werden, im System erstellt wird, unabhängig davon, ob der Benutzer Änderungen vorgenommen, ändert.</span><span class="sxs-lookup"><span data-stu-id="d28c3-171">For example, if you use triggers to record all `UPDATE` s to the `Suppliers` table to an auditing table, every time a user clicks the Update All button a new audit record will be created for each supplier in the system, regardless of whether the user made any changes.</span></span>

<span data-ttu-id="d28c3-172">Die ADO.NET DataTable und DataAdapter-Klassen dienen zur Unterstützung von Batchaktualisierungen, in denen eine Datenbankkommunikation nur geändert, gelöscht und neue Datensätze zu.</span><span class="sxs-lookup"><span data-stu-id="d28c3-172">The ADO.NET DataTable and DataAdapter classes are designed to support batch updates where only modified, deleted, and new records results in any database communication.</span></span> <span data-ttu-id="d28c3-173">Jede Zeile in der Datentabelle verfügt über eine [ `RowState` Eigenschaft](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) , der angibt, ob die Zeile der Datentabelle, die von ihm, die geändert wurde, gelöscht oder unverändert bleibt.</span><span class="sxs-lookup"><span data-stu-id="d28c3-173">Each row in the DataTable has a [`RowState` property](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) that indicates whether the row has been added to the DataTable, deleted from it, modified, or remains unchanged.</span></span> <span data-ttu-id="d28c3-174">Wenn es sich bei eine "DataTable" Anfangs aufgefüllt wird, werden alle Zeilen nicht geändert markiert.</span><span class="sxs-lookup"><span data-stu-id="d28c3-174">When a DataTable is initially populated, all rows are marked unchanged.</span></span> <span data-ttu-id="d28c3-175">Ändern des Werts auf die Zeile s-Spalten wird die Zeile als geändert gekennzeichnet.</span><span class="sxs-lookup"><span data-stu-id="d28c3-175">Changing the value of any of the row s columns marks the row as modified.</span></span>

<span data-ttu-id="d28c3-176">In der `SuppliersBLL` Klasse, die wir die Adressinformationen für die angegebene Lieferanten s vom ersten Lesen des Datensatzes der einzelnen Lieferanten in Aktualisieren einer `SuppliersDataTable` und legen Sie dann die `Address`, `City`, und `Country` Spaltenwerte, die mit dem folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="d28c3-176">In the `SuppliersBLL` class we update the specified supplier s address information by first reading in the single supplier record into a `SuppliersDataTable` and then set the `Address`, `City`, and `Country` column values using the following code:</span></span>


[!code-csharp[Main](performing-batch-updates-cs/samples/sample5.cs)]

<span data-ttu-id="d28c3-177">Dieser Code weist naiv die übergebene Adresse, Stadt und Land-Werte, die `SuppliersRow` in die `SuppliersDataTable` unabhängig davon, ob die Werte geändert haben.</span><span class="sxs-lookup"><span data-stu-id="d28c3-177">This code naively assigns the passed-in address, city, and country values to the `SuppliersRow` in the `SuppliersDataTable` regardless of whether or not the values have changed.</span></span> <span data-ttu-id="d28c3-178">Diese Änderungen dazu führen, dass die `SuppliersRow` s `RowState` Eigenschaft als geändert markiert werden.</span><span class="sxs-lookup"><span data-stu-id="d28c3-178">These modifications cause the `SuppliersRow` s `RowState` property to be marked as modified.</span></span> <span data-ttu-id="d28c3-179">Wenn der Datenzugriffsebene s `Update` Methode aufgerufen wird, wird es angezeigt wird, die die `SupplierRow` geändert wurde, und deshalb sendet eine `UPDATE` Befehl in der Datenbank.</span><span class="sxs-lookup"><span data-stu-id="d28c3-179">When the Data Access Layer s `Update` method is called, it sees that the `SupplierRow` has been modified and therefore sends an `UPDATE` command to the database.</span></span>

<span data-ttu-id="d28c3-180">Stellen Sie sich vor, jedoch, dass wir Code, um diese Methode übergebene Adresse, Stadt und Land-Werte nur zuweisen hinzugefügt, wenn Unterschiede zu den `SuppliersRow` s vorhandenen Werte.</span><span class="sxs-lookup"><span data-stu-id="d28c3-180">Imagine, however, that we added code to this method to only assign the passed-in address, city, and country values if they differ from the `SuppliersRow` s existing values.</span></span> <span data-ttu-id="d28c3-181">Im Fall, in dem die Adresse, Stadt und Land identisch mit den vorhandenen Daten sind, werden keine Änderungen vorgenommen und die `SupplierRow` s `RowState` links als unverändert.</span><span class="sxs-lookup"><span data-stu-id="d28c3-181">In the case where the address, city, and country are the same as the existing data, no changes will be made and the `SupplierRow` s `RowState` will be left marked as unchanged.</span></span> <span data-ttu-id="d28c3-182">Das Ergebnis ist, wenn die DAL-s `Update` -Methode aufgerufen wird, wird kein Datenbankaufruf vorgenommen werden, da die `SuppliersRow` wurde nicht geändert.</span><span class="sxs-lookup"><span data-stu-id="d28c3-182">The net result is that when the DAL s `Update` method is called, no database call will be made because the `SuppliersRow` has not been modified.</span></span>

<span data-ttu-id="d28c3-183">Um diese Änderung in Kraft gesetzt, ersetzen Sie die Anweisungen, die blind weisen Sie die übergebene Adresse, Stadt und Land-Werte, mit dem folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="d28c3-183">To enact this change, replace the statements that blindly assign the passed-in address, city, and country values with the following code:</span></span>


[!code-csharp[Main](performing-batch-updates-cs/samples/sample6.cs)]

<span data-ttu-id="d28c3-184">Mit dieser zusätzlichen Code, der DAL s `Update` -Methode sendet ein `UPDATE` Anweisung an die Datenbank für die nur die Datensätze, deren Werte adressbezogenen geändert haben.</span><span class="sxs-lookup"><span data-stu-id="d28c3-184">With this added code, the DAL s `Update` method sends an `UPDATE` statement to the database for only those records whose address-related values have changed.</span></span>

<span data-ttu-id="d28c3-185">Sie können auch wir behalten den Überblick darüber, ob Unterschiede zwischen den Adressfeldern übergebene und die Daten der Datenbank vorhanden sind und, wenn keine vorhanden sind, umgehen Sie einfach den Aufruf der DAL-s `Update` Methode.</span><span class="sxs-lookup"><span data-stu-id="d28c3-185">Alternatively, we could keep track of whether there are any differences between the passed-in address fields and the database data and, if there are none, simply bypass the call to the DAL s `Update` method.</span></span> <span data-ttu-id="d28c3-186">Dieser Ansatz funktioniert gut, wenn Sie erneut mit dem DB-Methode, leiten, da es sich bei das DB-direktmethode ist t übergeben eine `SuppliersRow` Instanz, deren `RowState` kann überprüft werden, um zu bestimmen, ob ein Datenbankaufruf tatsächlich benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="d28c3-186">This approach works well if you re using the DB direct method, since the DB direct method isn t passed a `SuppliersRow` instance whose `RowState` can be checked to determine whether a database call is actually needed.</span></span>

> [!NOTE]
> <span data-ttu-id="d28c3-187">Jedes Mal die `UpdateSupplierAddress` -Methode wird aufgerufen, um die Datenbank wird ein Aufruf ausgelöst, um Informationen zu den aktualisierten Datensatz abzurufen.</span><span class="sxs-lookup"><span data-stu-id="d28c3-187">Each time the `UpdateSupplierAddress` method is invoked, a call is made to the database to retrieve information about the updated record.</span></span> <span data-ttu-id="d28c3-188">Klicken Sie dann, wenn alle Änderungen in den Daten vorhanden sind, einen anderen Aufruf an die Datenbank erfolgt auf die Tabellenzeile zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="d28c3-188">Then, if there are any changes in data, another call to the database is made to update the table row.</span></span> <span data-ttu-id="d28c3-189">Dieser Workflow kann optimiert werden, durch das Erstellen einer `UpdateSupplierAddress` methodenüberladung, die akzeptiert eine `EmployeesDataTable` Instanz mit *alle* der Änderungen aus der `BatchUpdate.aspx` Seite.</span><span class="sxs-lookup"><span data-stu-id="d28c3-189">This workflow could be optimized by creating an `UpdateSupplierAddress` method overload that accepts an `EmployeesDataTable` instance that has *all* of the changes from the `BatchUpdate.aspx` page.</span></span> <span data-ttu-id="d28c3-190">Es konnte stellen Sie dann einen Aufruf an die Datenbank zum Abrufen aller Datensätze aus der `Suppliers` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="d28c3-190">Then, it could make one call to the database to get all of the records from the `Suppliers` table.</span></span> <span data-ttu-id="d28c3-191">Die zwei Resultsets kann dann aufgelistet werden, und nur die Datensätze, in dem Änderungen vorgenommen wurden, können aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="d28c3-191">The two resultsets could then be enumerated and only those records where changes have occurred could be updated.</span></span>


## <a name="summary"></a><span data-ttu-id="d28c3-192">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="d28c3-192">Summary</span></span>

<span data-ttu-id="d28c3-193">In diesem Tutorial wurde erläutert, wie einem vollständig bearbeitbare DataList-Steuerelement, sodass Benutzer schnell geändert werden. die Adressinformationen für mehrere Lieferanten zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="d28c3-193">In this tutorial we saw how to create a fully editable DataList, allowing a user to quickly modify the address information for multiple suppliers.</span></span> <span data-ttu-id="d28c3-194">Wir begonnen, indem Sie definieren die Bearbeitungsschnittstelle ein TextBox-Steuerelement für die Lieferanten-e-Adresse, Stadt und Land-Werte im DataList-Steuerelement s `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="d28c3-194">We started by defining the editing interface a TextBox Web control for the supplier s address, city, and country values in the DataList s `ItemTemplate`.</span></span> <span data-ttu-id="d28c3-195">Als Nächstes haben wir alle aktualisieren Schaltflächen oben und unten DataList-Steuerelement hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="d28c3-195">Next, we added Update All buttons above and below the DataList.</span></span> <span data-ttu-id="d28c3-196">Nachdem ein Benutzer über seine Änderungen vorgenommen haben, und klicken Sie auf eine der Schaltflächen Alle aktualisieren, die `DataListItem` s aufgelistet und einem Aufruf an die `SuppliersBLL` s-Klasse `UpdateSupplierAddress` Methode erfolgt.</span><span class="sxs-lookup"><span data-stu-id="d28c3-196">After a user has made his changes and clicked one of the Update All buttons, the `DataListItem` s are enumerated and a call to the `SuppliersBLL` class s `UpdateSupplierAddress` method is made.</span></span>

<span data-ttu-id="d28c3-197">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="d28c3-197">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="d28c3-198">Der Autor</span><span class="sxs-lookup"><span data-stu-id="d28c3-198">About the Author</span></span>

<span data-ttu-id="d28c3-199">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben Büchern zu ASP/ASP.NET und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), arbeitet mit Microsoft-Web-Technologien seit 1998.</span><span class="sxs-lookup"><span data-stu-id="d28c3-199">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="d28c3-200">Er ist als ein unabhängiger Berater, Schulungsleiter und Autor.</span><span class="sxs-lookup"><span data-stu-id="d28c3-200">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="d28c3-201">Sein neueste Buch wird [*Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="d28c3-201">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="d28c3-202">Er ist unter [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d28c3-202">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="d28c3-203">oder über seinen Blog finden Sie unter [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="d28c3-203">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="d28c3-204">Besonderen Dank an</span><span class="sxs-lookup"><span data-stu-id="d28c3-204">Special Thanks To</span></span>

<span data-ttu-id="d28c3-205">Diese tutorialreihe wurde durch viele hilfreiche Reviewer überprüft.</span><span class="sxs-lookup"><span data-stu-id="d28c3-205">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="d28c3-206">Führendes Prüfer für dieses Tutorial wurden Zack Jones und Ken Pespisa.</span><span class="sxs-lookup"><span data-stu-id="d28c3-206">Lead reviewers for this tutorial were Zack Jones and Ken Pespisa.</span></span> <span data-ttu-id="d28c3-207">Meine zukünftigen MSDN-Artikeln überprüfen möchten?</span><span class="sxs-lookup"><span data-stu-id="d28c3-207">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="d28c3-208">Wenn dies der Fall ist, löschen Sie mir eine Linie an [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d28c3-208">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="d28c3-209">[Zurück](an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md)
> [Weiter](handling-bll-and-dal-level-exceptions-cs.md)</span><span class="sxs-lookup"><span data-stu-id="d28c3-209">[Previous](an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md)
[Next](handling-bll-and-dal-level-exceptions-cs.md)</span></span>
