---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/handling-bll-and-dal-level-exceptions-cs
title: Auf BLL- und DAL-Ebene-Ausnahmebehandlung (c#) | Microsoft-Dokumentation
author: rick-anderson
description: In diesem Tutorial sehen wir, wie Ausnahmen, die während der Workflow für die Aktualisierung einer bearbeitbaren DataList tactfully behandelt werden.
ms.author: aspnetcontent
ms.date: 10/30/2006
ms.assetid: f8fd58e2-f932-4f08-ab3d-fbf8ff3295d2
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/handling-bll-and-dal-level-exceptions-cs
msc.type: authoredcontent
ms.openlocfilehash: f83293f7b8482c2a24c3d825e271582edaadec59
ms.sourcegitcommit: b28cd0313af316c051c2ff8549865bff67f2fbb4
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 07/05/2018
ms.locfileid: "37812079"
---
<a name="handling-bll--and-dal-level-exceptions-c"></a><span data-ttu-id="2b1bf-103">Auf BLL- und DAL-Ebene-Ausnahmebehandlung (c#)</span><span class="sxs-lookup"><span data-stu-id="2b1bf-103">Handling BLL- and DAL-Level Exceptions (C#)</span></span>
====================
<span data-ttu-id="2b1bf-104">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="2b1bf-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="2b1bf-105">[Beispiel-App herunter](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_38_CS.exe) oder [PDF-Datei herunterladen](handling-bll-and-dal-level-exceptions-cs/_static/datatutorial38cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="2b1bf-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_38_CS.exe) or [Download PDF](handling-bll-and-dal-level-exceptions-cs/_static/datatutorial38cs1.pdf)</span></span>

> <span data-ttu-id="2b1bf-106">In diesem Tutorial sehen wir, wie Ausnahmen, die während der Workflow für die Aktualisierung einer bearbeitbaren DataList tactfully behandelt werden.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-106">In this tutorial, we'll see how to tactfully handle exceptions raised during an editable DataList's updating workflow.</span></span>


## <a name="introduction"></a><span data-ttu-id="2b1bf-107">Einführung</span><span class="sxs-lookup"><span data-stu-id="2b1bf-107">Introduction</span></span>

<span data-ttu-id="2b1bf-108">In der [Übersicht von bearbeiten und Löschen von Daten im DataList-Steuerelement](an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md) Tutorial wir einem DataList-Steuerelement, die angeboten wird, einfach bearbeiten und Löschen von Funktionen erstellt.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-108">In the [Overview of Editing and Deleting Data in the DataList](an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md) tutorial, we created a DataList that offered simple editing and deleting capabilities.</span></span> <span data-ttu-id="2b1bf-109">Voll funktionsfähig ist, war es kaum Benutzerfreundlicher als alle Fehler, die während der Bearbeitung aufgetreten ist oder Prozess löschen, die in einer nicht behandelten Ausnahme geführt hat.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-109">While fully functional, it was hardly user-friendly, as any error that occurred during the editing or deleting process resulted in an unhandled exception.</span></span> <span data-ttu-id="2b1bf-110">Z. B. der Name des Produkts s auslassen, oder beim Bearbeiten eines Produkts Preis der Eingabe des Werts sehr kostengünstige!, löst eine Ausnahme aus.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-110">For example, omitting the product s name or, when editing a product, entering a price value of Very affordable!, throws an exception.</span></span> <span data-ttu-id="2b1bf-111">Da diese Ausnahme im Code nicht abgefangen wird, ausgelöst es bis zu der ASP.NET-Laufzeit, die die Details der Ausnahme s Klicken Sie dann auf der Webseite angezeigt.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-111">Since this exception is not caught in code, it bubbles up to the ASP.NET runtime, which then displays the exception s details in the web page.</span></span>

<span data-ttu-id="2b1bf-112">Wie wir, in gesehen der [behandeln BLL- und DAL-Ebene von Ausnahmen in einer ASP.NET-Seite](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) Tutorial, wenn die Tiefe der Geschäftslogik oder Datenzugriffsschichten, eine Ausnahme ausgelöst wird die Details der Ausnahme werden zurückgegeben, dem ObjectDataSource-Steuerelement und Klicken Sie dann an die GridView.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-112">As we saw in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) tutorial, if an exception is raised from the depths of the Business Logic or Data Access Layers, the exception details are returned to the ObjectDataSource and then to the GridView.</span></span> <span data-ttu-id="2b1bf-113">Erläutert, wie diese Ausnahmen ordnungsgemäß durch das Erstellen behandeln `Updated` oder `RowUpdated` -Ereignishandler für das ObjectDataSource-Steuerelement oder eine GridView, überprüfen für eine Ausnahme aus, und gibt dann an, dass die Ausnahme behandelt wurde.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-113">We saw how to gracefully handle these exceptions by creating `Updated` or `RowUpdated` event handlers for the ObjectDataSource or GridView, checking for an exception, and then indicating that the exception was handled.</span></span>

<span data-ttu-id="2b1bf-114">Unsere DataList Tutorials, allerdings sind t, die mit dem ObjectDataSource-Steuerelement für das Aktualisieren und Löschen von Daten.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-114">Our DataList tutorials, however, aren t using the ObjectDataSource for updating and deleting data.</span></span> <span data-ttu-id="2b1bf-115">Stattdessen arbeiten wir direkt an die BLL.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-115">Instead, we are working directly against the BLL.</span></span> <span data-ttu-id="2b1bf-116">Um die Ausnahmen, die von der BLL oder DAL erkennen zu können, müssen wir Code im Code-Behind unsere ASP.NET-Seite zur Ausnahmebehandlung implementieren.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-116">In order to detect exceptions originating from the BLL or DAL, we need to implement exception handling code within the code-behind of our ASP.NET page.</span></span> <span data-ttu-id="2b1bf-117">In diesem Tutorial sehen wir, wie Sie mehr tactfully Behandlung von Ausnahmen, die ausgelöst wird, während ein bearbeitbaren DataList s Workflow aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-117">In this tutorial, we'll see how to more tactfully handle exceptions raised during an editable DataList s updating workflow.</span></span>

> [!NOTE]
> <span data-ttu-id="2b1bf-118">In der *eine Übersicht über die von bearbeiten und Löschen von Daten im DataList-Steuerelement* Tutorial erläutert verschiedene Techniken zum Bearbeiten und Löschen von Daten über DataList-Steuerelement einige Techniken beteiligten Nutzung einer ObjectDataSource gegeben, für die Aktualisierung und wird gelöscht.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-118">In the *An Overview of Editing and Deleting Data in the DataList* tutorial we discussed different techniques for editing and deleting data from the DataList, Some techniques involved using an ObjectDataSource for updating and deleting.</span></span> <span data-ttu-id="2b1bf-119">Wenn Sie diese Techniken einsetzen, können Sie behandeln von Ausnahmen von der BLL oder DAL über das ObjectDataSource-s `Updated` oder `Deleted` -Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-119">If you employ these techniques, you can handle exceptions from the BLL or DAL through the ObjectDataSource s `Updated` or `Deleted` event handlers.</span></span>


## <a name="step-1-creating-an-editable-datalist"></a><span data-ttu-id="2b1bf-120">Schritt 1: Erstellen einer bearbeitbaren DataList-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="2b1bf-120">Step 1: Creating an Editable DataList</span></span>

<span data-ttu-id="2b1bf-121">Bevor wir zur Behandlung von Ausnahmen, die während der Workflow für die Aktualisierung auftreten fürchten, können Sie s, erstellen Sie zunächst eine bearbeitbare DataList-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-121">Before we worry about handling exceptions that occur during the updating workflow, let s first create an editable DataList.</span></span> <span data-ttu-id="2b1bf-122">Öffnen der `ErrorHandling.aspx` auf der Seite die `EditDeleteDataList` Ordner hinzufügen, einem DataList-Steuerelement in den Designer, legen Sie dessen `ID` Eigenschaft `Products`, und fügen Sie eine neue, mit dem Namen "ObjectDataSource" `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-122">Open the `ErrorHandling.aspx` page in the `EditDeleteDataList` folder, add a DataList to the Designer, set its `ID` property to `Products`, and add a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="2b1bf-123">Konfigurieren Sie mit dem ObjectDataSource-Steuerelement die `ProductsBLL` Klasse s `GetProducts()` Methode für die Auswahl erfasst; legen Sie die Dropdownlisten in der INSERT-, Update- und Löschen von Registerkarten (keine).</span><span class="sxs-lookup"><span data-stu-id="2b1bf-123">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method for selecting records; set the drop-down lists in the INSERT, UPDATE, and DELETE tabs to (None).</span></span>


<span data-ttu-id="2b1bf-124">[![Zurückgeben der Produktinformationen mithilfe der GetProducts()-Methode](handling-bll-and-dal-level-exceptions-cs/_static/image2.png)](handling-bll-and-dal-level-exceptions-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="2b1bf-124">[![Return the Product Information Using the GetProducts() Method](handling-bll-and-dal-level-exceptions-cs/_static/image2.png)](handling-bll-and-dal-level-exceptions-cs/_static/image1.png)</span></span>

<span data-ttu-id="2b1bf-125">**Abbildung 1**: Zurückgeben von Informationen für das Produkt verwenden die `GetProducts()` Methode ([klicken Sie, um das Bild in voller Größe anzeigen](handling-bll-and-dal-level-exceptions-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="2b1bf-125">**Figure 1**: Return the Product Information Using the `GetProducts()` Method ([Click to view full-size image](handling-bll-and-dal-level-exceptions-cs/_static/image3.png))</span></span>


<span data-ttu-id="2b1bf-126">Nach Abschluss des Assistenten "ObjectDataSource" Visual Studio erstellt automatisch eine `ItemTemplate` für DataList-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-126">After completing the ObjectDataSource wizard, Visual Studio will automatically create an `ItemTemplate` for the DataList.</span></span> <span data-ttu-id="2b1bf-127">Ersetzen Sie dies mit einer `ItemTemplate` , werden alle Produktnamen s und den Preis angezeigt und enthält eine Schaltfläche "Bearbeiten".</span><span class="sxs-lookup"><span data-stu-id="2b1bf-127">Replace this with an `ItemTemplate` that displays each product s name and price and includes an Edit button.</span></span> <span data-ttu-id="2b1bf-128">Als Nächstes erstellen Sie eine `EditItemTemplate` mit ein TextBox-Steuerelement für den Namen "und" Price "und" Schaltflächen "Update" und "Abbrechen".</span><span class="sxs-lookup"><span data-stu-id="2b1bf-128">Next, create an `EditItemTemplate` with a TextBox Web control for name and price and Update and Cancel buttons.</span></span> <span data-ttu-id="2b1bf-129">Legen Sie schließlich DataList-Steuerelement s `RepeatColumns` Eigenschaft auf 2.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-129">Finally, set the DataList s `RepeatColumns` property to 2.</span></span>

<span data-ttu-id="2b1bf-130">Nach diesen Änderungen sollte Ihre Seite s deklarativen Markup etwa wie folgt aussehen.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-130">After these changes, your page s declarative markup should look similar to the following.</span></span> <span data-ttu-id="2b1bf-131">Noch einmal überprüfen, um sicherzustellen, dass von der Bearbeitung, "Abbrechen", und Update-Schaltflächen sind ihre `CommandName` Eigenschaften festgelegt werden, zu bearbeiten, Abbrechen und entsprechend zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-131">Double-check to make certain that the Edit, Cancel, and Update buttons have their `CommandName` properties set to Edit, Cancel, and Update, respectively.</span></span>


[!code-aspx[Main](handling-bll-and-dal-level-exceptions-cs/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="2b1bf-132">Für dieses Tutorial DataList-Steuerelement muss Ansichtszustand s aktiviert werden.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-132">For this tutorial the DataList s view state must be enabled.</span></span>


<span data-ttu-id="2b1bf-133">Können Sie unseren Fortschritt über einen Browser anzeigen (siehe Abbildung 2).</span><span class="sxs-lookup"><span data-stu-id="2b1bf-133">Take a moment to view our progress through a browser (see Figure 2).</span></span>


<span data-ttu-id="2b1bf-134">[![Jedes Produkt enthält eine Schaltfläche "Bearbeiten"](handling-bll-and-dal-level-exceptions-cs/_static/image5.png)](handling-bll-and-dal-level-exceptions-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="2b1bf-134">[![Each Product Includes an Edit Button](handling-bll-and-dal-level-exceptions-cs/_static/image5.png)](handling-bll-and-dal-level-exceptions-cs/_static/image4.png)</span></span>

<span data-ttu-id="2b1bf-135">**Abbildung 2**: jedes Produkt enthält eine Schaltfläche "Bearbeiten" ([klicken Sie, um das Bild in voller Größe anzeigen](handling-bll-and-dal-level-exceptions-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="2b1bf-135">**Figure 2**: Each Product Includes an Edit Button ([Click to view full-size image](handling-bll-and-dal-level-exceptions-cs/_static/image6.png))</span></span>


<span data-ttu-id="2b1bf-136">Die Schaltfläche "Bearbeiten" wird derzeit nur einen Postback es t dennoch gestalten des Produkts bearbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-136">Currently, the Edit button only causes a postback it doesn t yet make the product editable.</span></span> <span data-ttu-id="2b1bf-137">Um die Bearbeitung zu aktivieren, müssen wir für das Erstellen von Ereignishandlern für DataList-Steuerelement s `EditCommand`, `CancelCommand`, und `UpdateCommand` Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-137">To enable editing, we need to create event handlers for the DataList s `EditCommand`, `CancelCommand`, and `UpdateCommand` events.</span></span> <span data-ttu-id="2b1bf-138">Die `EditCommand` und `CancelCommand` Ereignisse nicht einfach aktualisieren, DataList-Steuerelement s `EditItemIndex` -Eigenschaft und Binden der Daten an die Datenliste:</span><span class="sxs-lookup"><span data-stu-id="2b1bf-138">The `EditCommand` and `CancelCommand` events simply update the DataList s `EditItemIndex` property and rebind the data to the DataList:</span></span>


[!code-csharp[Main](handling-bll-and-dal-level-exceptions-cs/samples/sample2.cs)]

<span data-ttu-id="2b1bf-139">Die `UpdateCommand` -Ereignishandler ist etwas komplizierter.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-139">The `UpdateCommand` event handler is a bit more involved.</span></span> <span data-ttu-id="2b1bf-140">Muss innerhalb des bearbeiteten Produkts s Lesen `ProductID` aus der `DataKeys` Collection zusammen mit dem die Produktnamen s und den Preis in die Textfelder ein, in der `EditItemTemplate`, und rufen Sie dann die `ProductsBLL` s-Klasse `UpdateProduct` Methode vor der Rückgabe DataList-Steuerelement vor der Bearbeitung Zustand.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-140">It needs to read in the edited product s `ProductID` from the `DataKeys` collection along with the product s name and price from the TextBoxes in the `EditItemTemplate`, and then call the `ProductsBLL` class s `UpdateProduct` method before returning the DataList to its pre-editing state.</span></span>

<span data-ttu-id="2b1bf-141">Let s nur verwenden Sie vorerst genauen den gleichen Code aus der `UpdateCommand` -Ereignishandler in der *Übersicht von bearbeiten und Löschen von Daten im DataList-Steuerelement* Tutorial.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-141">For now, let s just use the exact same code from the `UpdateCommand` event handler in the *Overview of Editing and Deleting Data in the DataList* tutorial.</span></span> <span data-ttu-id="2b1bf-142">Wir fügen den Code, um Ausnahmen in Schritt 2 ordnungsgemäß zu behandeln.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-142">We'll add the code to gracefully handle exceptions in step 2.</span></span>


[!code-csharp[Main](handling-bll-and-dal-level-exceptions-cs/samples/sample3.cs)]

<span data-ttu-id="2b1bf-143">Bei ungültiger Eingabe kann die werden in Form einer falsch formatierten Einzelpreis, eine ungültige Einheit Preis wie "-" $5.00 oder die Auslassung der Product-s-Name, die eine Ausnahme ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-143">In the face of invalid input which can be in the form of an improperly formatted unit price, an illegal unit price value like -$5.00, or the omission of the product s name an exception will be raised.</span></span> <span data-ttu-id="2b1bf-144">Da die `UpdateCommand` -Ereignishandler enthält keine Code zur Ausnahmebehandlung an diesem Punkt, bis zu der ASP.NET-Laufzeit die Ausnahme übergeben wird, wo es für den Endbenutzer angezeigt werden (siehe Abbildung 3).</span><span class="sxs-lookup"><span data-stu-id="2b1bf-144">Since the `UpdateCommand` event handler does not include any exception handling code at this point, the exception will bubble up to the ASP.NET runtime, where it will be displayed to the end user (see Figure 3).</span></span>


![Wenn eine nicht behandelte Ausnahme auftritt, sieht der Endbenutzer eine Fehlerseite angezeigt.](handling-bll-and-dal-level-exceptions-cs/_static/image7.png)

<span data-ttu-id="2b1bf-146">**Abbildung 3**: Wenn eine nicht behandelte Ausnahme auftritt, sieht der Endbenutzer eine Fehlerseite angezeigt.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-146">**Figure 3**: When an Unhandled Exception Occurs, the End User Sees an Error Page</span></span>


## <a name="step-2-gracefully-handling-exceptions-in-the-updatecommand-event-handler"></a><span data-ttu-id="2b1bf-147">Schritt 2: Ordnungsgemäße Behandlung von Ausnahmen in der UpdateCommand-Ereignishandler</span><span class="sxs-lookup"><span data-stu-id="2b1bf-147">Step 2: Gracefully Handling Exceptions in the UpdateCommand Event Handler</span></span>

<span data-ttu-id="2b1bf-148">Während der Workflow für die Aktualisierung, Ausnahmen auftreten können, der `UpdateCommand` -Ereignishandler, die BLL oder der DAL.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-148">During the updating workflow, exceptions can occur in the `UpdateCommand` event handler, the BLL, or the DAL.</span></span> <span data-ttu-id="2b1bf-149">Z. B., wenn ein Benutzer eingibt, einen Preis von zu viel Leistung beanspruchen, die `Decimal.Parse` -Anweisung in der `UpdateCommand` Ereignishandler löst eine `FormatException` Ausnahme.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-149">For example, if a user enters a price of Too expensive, the `Decimal.Parse` statement in the `UpdateCommand` event handler will throw a `FormatException` exception.</span></span> <span data-ttu-id="2b1bf-150">Wenn der Benutzer den Namen des Produkts s ausgelassen oder der Preis auf einen negativen Wert hat, wird die DAL eine Ausnahme ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-150">If the user omits the product s name or if the price has a negative value, the DAL will raise an exception.</span></span>

<span data-ttu-id="2b1bf-151">Wenn eine Ausnahme auftritt, möchten wir eine informationsmeldung auf der Seite selbst anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-151">When an exception occurs, we want to display an informative message within the page itself.</span></span> <span data-ttu-id="2b1bf-152">Hinzufügen eines Web-Bezeichnung-Steuerelement auf der Seite, dessen `ID` nastaven NA hodnotu `ExceptionDetails`.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-152">Add a Label Web control to the page whose `ID` is set to `ExceptionDetails`.</span></span> <span data-ttu-id="2b1bf-153">Konfigurieren Sie den Text der Bezeichnung s, zum Anzeigen in einem roten, sehr groß, fett und kursiv Schriftart durch Zuweisen der `CssClass` Eigenschaft, um die `Warning` CSS-Klasse, die in definiert ist die `Styles.css` Datei.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-153">Configure the Label s text to display in a red, extra-large, bold and italic font by assigning its `CssClass` property to the `Warning` CSS class, which is defined in the `Styles.css` file.</span></span>

<span data-ttu-id="2b1bf-154">Wenn ein Fehler auftritt, möchten wir nur die Bezeichnung auf einmal angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-154">When an error occurs, we only want the Label to be displayed once.</span></span> <span data-ttu-id="2b1bf-155">D. h. bei nachfolgenden Postbacks ist die Warnmeldung Bezeichnung s nicht mehr angezeigt.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-155">That is, on subsequent postbacks, the Label s warning message should disappear.</span></span> <span data-ttu-id="2b1bf-156">Dies kann erreicht werden, indem Sie entweder gelöscht wird, die Bezeichnung s `Text` Eigenschaft oder die Einstellungen der `Visible` Eigenschaft `False` in die `Page_Load` -Ereignishandler (wie in der [behandeln BLL- und DAL-Ebene-Ausnahmen in einer ASP Seite .NET](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) Tutorial) oder durch Deaktivieren der Unterstützung für den Bezeichnung s anzeigen.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-156">This can be accomplished by either clearing out the Label s `Text` property or settings its `Visible` property to `False` in the `Page_Load` event handler (as we did back in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) tutorial) or by disabling the Label s view state support.</span></span> <span data-ttu-id="2b1bf-157">Lassen Sie letztere Option verwenden, s an.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-157">Let s use the latter option.</span></span>


[!code-aspx[Main](handling-bll-and-dal-level-exceptions-cs/samples/sample4.aspx)]

<span data-ttu-id="2b1bf-158">Wenn eine Ausnahme ausgelöst wird, weisen wir werden die Details der Ausnahme, um die `ExceptionDetails` Beschriftungs-Steuerelement s `Text` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-158">When an exception is raised, we'll assign the details of the exception to the `ExceptionDetails` Label control s `Text` property.</span></span> <span data-ttu-id="2b1bf-159">Da der Ansichtszustand deaktiviert ist, bei nachfolgenden Postbacks der `Text` programmgesteuerte s eigenschaftsänderungen verloren, Zurücksetzen auf den Standardtext (eine leere Zeichenfolge), ausblenden und die Warnmeldung.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-159">Since its view state is disabled, on subsequent postbacks the `Text` property s programmatic changes will be lost, reverting back to the default text (an empty string), thereby hiding the warning message.</span></span>

<span data-ttu-id="2b1bf-160">Um zu bestimmen, wenn ein Fehler ausgelöst wurde um eine hilfreiche Meldung auf der Seite anzuzeigen, wir müssen eine `Try ... Catch` -block, um die `UpdateCommand` -Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-160">To determine when an error has been raised in order to display a helpful message on the page, we need to add a `Try ... Catch` block to the `UpdateCommand` event handler.</span></span> <span data-ttu-id="2b1bf-161">Die `Try` Teil enthält Code, der zu einer Ausnahme führen kann, während die `Catch` -Block enthält Code, der bei einer Ausnahme ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-161">The `Try` portion contains code that may lead to an exception, while the `Catch` block contains code that is executed in the face of an exception.</span></span> <span data-ttu-id="2b1bf-162">Sehen Sie sich die [Exception Handling Fundamentals](https://msdn.microsoft.com/library/2w8f0bss.aspx) auf .NET Framework-Dokumentation für Weitere Informationen im Abschnitt der `Try ... Catch` Block.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-162">Check out the [Exception Handling Fundamentals](https://msdn.microsoft.com/library/2w8f0bss.aspx) section in the .NET Framework documentation for more information on the `Try ... Catch` block.</span></span>


[!code-csharp[Main](handling-bll-and-dal-level-exceptions-cs/samples/sample5.cs)]

<span data-ttu-id="2b1bf-163">Wenn eine Ausnahme eines beliebigen Typs ausgelöst wird, durch den Code der `Try` Block, der `Catch` -s-Block-Code beginnt die Ausführung.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-163">When an exception of any type is thrown by code within the `Try` block, the `Catch` block s code will begin executing.</span></span> <span data-ttu-id="2b1bf-164">Der Typ der Ausnahme, die ausgelöst wird `DbException`, `NoNullAllowedException`, `ArgumentException`, und unmittelbar auf hängt, genau, den Fehler im vornherein vorausging.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-164">The type of exception that is thrown `DbException`, `NoNullAllowedException`, `ArgumentException`, and so on depends on what, exactly, precipitated the error in the first place.</span></span> <span data-ttu-id="2b1bf-165">Wenn dort s ein Problem auf Datenbankebene, eine `DbException` ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-165">If there s a problem at the database level, a `DbException` will be thrown.</span></span> <span data-ttu-id="2b1bf-166">Wenn für ein Unzulässiger Wert eingegeben wurde die `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, oder `ReorderLevel` Felder einer `ArgumentException` ausgelöst, wenn wir Code, um zu überprüfen, ob diese Feldwerte hinzugefügt der `ProductsDataTable` Klasse (finden Sie unter der [ Erstellen einer Geschäftslogikebene](../introduction/creating-a-business-logic-layer-cs.md) Tutorial).</span><span class="sxs-lookup"><span data-stu-id="2b1bf-166">If an illegal value is entered for the `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, or `ReorderLevel` fields, an `ArgumentException` will be thrown, as we added code to validate these field values in the `ProductsDataTable` class (see the [Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-cs.md) tutorial).</span></span>

<span data-ttu-id="2b1bf-167">Wir können den Meldungstext, basiert auf dem Typ der Ausnahme eine weitere nützliche Erläuterung für den Endbenutzer bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-167">We can provide a more helpful explanation to the end user by basing the message text on the type of exception caught.</span></span> <span data-ttu-id="2b1bf-168">Der folgende Code, der in einem Formular fast identisch verwendet wurde in der [behandeln BLL- und DAL-Ebene von Ausnahmen in einer ASP.NET-Seite](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) Tutorial enthält diese Detailebene:</span><span class="sxs-lookup"><span data-stu-id="2b1bf-168">The following code which was used in a nearly identical form back in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) tutorial provides this level of detail:</span></span>


[!code-csharp[Main](handling-bll-and-dal-level-exceptions-cs/samples/sample6.cs)]

<span data-ttu-id="2b1bf-169">Um dieses Tutorial abgeschlossen haben, rufen Sie einfach die `DisplayExceptionDetails` Methode aus der `Catch` Block übergeben wird, in das aufgefangene `Exception` Instanz (`ex`).</span><span class="sxs-lookup"><span data-stu-id="2b1bf-169">To complete this tutorial, simply call the `DisplayExceptionDetails` method from the `Catch` block passing in the caught `Exception` instance (`ex`).</span></span>

<span data-ttu-id="2b1bf-170">Mit der `Try ... Catch` block vorhanden, die Benutzer eine informativere Fehlermeldung wie die Abbildungen 4 und 5 anzeigen angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-170">With the `Try ... Catch` block in place, users are presented with a more informative error message, as Figures 4 and 5 show.</span></span> <span data-ttu-id="2b1bf-171">Beachten Sie, die bei einer Ausnahme DataList-Steuerelement verbleibt im Bearbeitungsmodus befindet.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-171">Note that in the face of an exception the DataList remains in edit mode.</span></span> <span data-ttu-id="2b1bf-172">Dies ist, da nach dem Auftreten der Ausnahme, die ablaufsteuerung sofort an umgeleitet wird die `Catch` Block unter Umgehung des Codes, der DataList-Steuerelement in den Zustand vor der Bearbeitung gibt.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-172">This is because once the exception occurs, the control flow is immediately redirected to the `Catch` block, bypassing the code that returns the DataList to its pre-editing state.</span></span>


<span data-ttu-id="2b1bf-173">[![Eine Fehlermeldung wird angezeigt, wenn ein Benutzer ein Feld erforderlich lässt](handling-bll-and-dal-level-exceptions-cs/_static/image9.png)](handling-bll-and-dal-level-exceptions-cs/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="2b1bf-173">[![An Error Message is Displayed if a User Omits a Required Field](handling-bll-and-dal-level-exceptions-cs/_static/image9.png)](handling-bll-and-dal-level-exceptions-cs/_static/image8.png)</span></span>

<span data-ttu-id="2b1bf-174">**Abbildung 4**: eine Fehlermeldung wird angezeigt, wenn ein Benutzer ein Feld erforderlich lässt ([klicken Sie, um das Bild in voller Größe anzeigen](handling-bll-and-dal-level-exceptions-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="2b1bf-174">**Figure 4**: An Error Message is Displayed if a User Omits a Required Field ([Click to view full-size image](handling-bll-and-dal-level-exceptions-cs/_static/image10.png))</span></span>


<span data-ttu-id="2b1bf-175">[![Eine Fehlermeldung wird angezeigt, wenn einen Preis negativ](handling-bll-and-dal-level-exceptions-cs/_static/image12.png)](handling-bll-and-dal-level-exceptions-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="2b1bf-175">[![An Error Message is Displayed When Entering a Negative Price](handling-bll-and-dal-level-exceptions-cs/_static/image12.png)](handling-bll-and-dal-level-exceptions-cs/_static/image11.png)</span></span>

<span data-ttu-id="2b1bf-176">**Abbildung 5**: eine Fehlermeldung wird angezeigt, wenn einen Preis negativ ([klicken Sie, um das Bild in voller Größe anzeigen](handling-bll-and-dal-level-exceptions-cs/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="2b1bf-176">**Figure 5**: An Error Message is Displayed When Entering a Negative Price ([Click to view full-size image](handling-bll-and-dal-level-exceptions-cs/_static/image13.png))</span></span>


## <a name="summary"></a><span data-ttu-id="2b1bf-177">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="2b1bf-177">Summary</span></span>

<span data-ttu-id="2b1bf-178">Geben Sie auf beitragsebene Ereignishandler, die Informationen über alle Ausnahmen, die während des aktualisieren und Löschen von Workflows ausgelöst wurden, sowie Eigenschaften, die festgelegt werden können, um anzugeben, und zwar unabhängig davon, ob die Ausnahme wurde enthalten, GridView und "ObjectDataSource" behandelt.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-178">The GridView and ObjectDataSource provide post-level event handlers that include information about any exceptions that were raised during the updating and deleting workflow, as well as properties that can be set to indicate whether or not the exception has been handled.</span></span> <span data-ttu-id="2b1bf-179">Diese Funktionen sind jedoch nicht verfügbar ist beim Arbeiten mit DataList-Steuerelement, und die BLL direkt verwenden.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-179">These features, however, are unavailable when working with the DataList and using the BLL directly.</span></span> <span data-ttu-id="2b1bf-180">Stattdessen werden wir für die Implementierung der Ausnahmebehandlung verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-180">Instead, we are responsible for implementing exception handling.</span></span>

<span data-ttu-id="2b1bf-181">In diesem Tutorial erläutert, wie Ausnahmebehandlung zum Aktualisieren von Workflows durch das Hinzufügen ein bearbeitet werden DataList-s-Hinzufügen einer `Try ... Catch` Blockieren der `UpdateCommand` -Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-181">In this tutorial we saw how to add exception handling to an editable DataList s updating workflow by adding a `Try ... Catch` block to the `UpdateCommand` event handler.</span></span> <span data-ttu-id="2b1bf-182">Wenn eine Ausnahme, während der Workflow für die Aktualisierung ausgelöst wird, die `Catch` -s-Block-Code ausgeführt wird, Anzeigen von nützliche Informationen in den `ExceptionDetails` Bezeichnung.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-182">If an exception is raised during the updating workflow, the `Catch` block s code executes, displaying helpful information in the `ExceptionDetails` Label.</span></span>

<span data-ttu-id="2b1bf-183">An diesem Punkt prüft DataList-Steuerelement nicht zu verhindern, dass Ausnahmen im vornherein passiert.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-183">At this point, the DataList makes no effort to prevent exceptions from happening in the first place.</span></span> <span data-ttu-id="2b1bf-184">Obwohl wir wissen, dass ein negativer Preis führt zu einer Ausnahme, die wir wurde hinzugefügt t noch keine Funktionen zur proaktiv verhindern einen Benutzer in eine solche ungültige Eingabe.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-184">Even though we know that a negative price will result in an exception, we haven t yet added any functionality to proactively prevent a user from entering such invalid input.</span></span> <span data-ttu-id="2b1bf-185">In unserem nächsten Tutorial erfahren Sie, wie zu reduzieren, dass die Ausnahmen, die durch ungültige Benutzereingaben verursacht werden, durch das Hinzufügen von Steuerelementen zur gültigkeitsprüfung in die `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-185">In our next tutorial we'll see how to help reduce the exceptions caused by invalid user input by adding validation controls in the `EditItemTemplate`.</span></span>

<span data-ttu-id="2b1bf-186">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="2b1bf-186">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="2b1bf-187">Weiterführende Themen</span><span class="sxs-lookup"><span data-stu-id="2b1bf-187">Further Reading</span></span>

<span data-ttu-id="2b1bf-188">Weitere Informationen zu den Themen in diesem Tutorial erläutert finden Sie in den folgenden Ressourcen:</span><span class="sxs-lookup"><span data-stu-id="2b1bf-188">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="2b1bf-189">Entwurfsrichtlinien für Ausnahmen</span><span class="sxs-lookup"><span data-stu-id="2b1bf-189">Design Guidelines for Exceptions</span></span>](https://msdn.microsoft.com/library/ms298399.aspx)
- <span data-ttu-id="2b1bf-190">[Error Logging Modules und Handler (ELMAH)](http://workspaces.gotdotnet.com/elmah) (ein Open Source-Bibliothek zum Protokollieren von Fehlern)</span><span class="sxs-lookup"><span data-stu-id="2b1bf-190">[Error Logging Modules and Handlers (ELMAH)](http://workspaces.gotdotnet.com/elmah) (an open-source library for logging errors)</span></span>
- <span data-ttu-id="2b1bf-191">[Enterprise Library für .NET Framework 2.0](https://www.microsoft.com/downloads/details.aspx?familyid=5A14E870-406B-4F2A-B723-97BA84AE80B5&amp;displaylang=en) (einschließlich der Exception Management Application Block)</span><span class="sxs-lookup"><span data-stu-id="2b1bf-191">[Enterprise Library for .NET Framework 2.0](https://www.microsoft.com/downloads/details.aspx?familyid=5A14E870-406B-4F2A-B723-97BA84AE80B5&amp;displaylang=en) (includes the Exception Management Application Block)</span></span>

## <a name="about-the-author"></a><span data-ttu-id="2b1bf-192">Der Autor</span><span class="sxs-lookup"><span data-stu-id="2b1bf-192">About the Author</span></span>

<span data-ttu-id="2b1bf-193">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor von sieben Büchern zu ASP/ASP.NET und Gründer von [4GuysFromRolla.com](http://www.4guysfromrolla.com), arbeitet mit Microsoft-Web-Technologien seit 1998.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-193">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="2b1bf-194">Er ist als ein unabhängiger Berater, Schulungsleiter und Autor.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-194">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="2b1bf-195">Sein neueste Buch wird [*Sams Schulen selbst ASP.NET 2.0 in 24 Stunden*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="2b1bf-195">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="2b1bf-196">Er ist unter [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2b1bf-196">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="2b1bf-197">oder über seinen Blog finden Sie unter [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="2b1bf-197">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="2b1bf-198">Besonderen Dank an</span><span class="sxs-lookup"><span data-stu-id="2b1bf-198">Special Thanks To</span></span>

<span data-ttu-id="2b1bf-199">Diese tutorialreihe wurde durch viele hilfreiche Reviewer überprüft.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-199">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="2b1bf-200">Führendes Prüfer für dieses Tutorial ist Ken Pespisa.</span><span class="sxs-lookup"><span data-stu-id="2b1bf-200">Lead reviewer for this tutorial was Ken Pespisa.</span></span> <span data-ttu-id="2b1bf-201">Meine zukünftigen MSDN-Artikeln überprüfen möchten?</span><span class="sxs-lookup"><span data-stu-id="2b1bf-201">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="2b1bf-202">Wenn dies der Fall ist, löschen Sie mir eine Linie an [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2b1bf-202">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="2b1bf-203">[Zurück](performing-batch-updates-cs.md)
> [Weiter](adding-validation-controls-to-the-datalist-s-editing-interface-cs.md)</span><span class="sxs-lookup"><span data-stu-id="2b1bf-203">[Previous](performing-batch-updates-cs.md)
[Next](adding-validation-controls-to-the-datalist-s-editing-interface-cs.md)</span></span>
