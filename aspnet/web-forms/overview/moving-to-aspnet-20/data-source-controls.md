---
uid: web-forms/overview/moving-to-aspnet-20/data-source-controls
title: Datenquellen-Steuerelemente | Microsoft-Dokumentation
author: microsoft
description: Das DataGrid-Steuerelement in ASP.NET 1.x eine große Verbesserung beim Datenzugriff in Webanwendungen gekennzeichnet. Allerdings war es so benutzerfreundlich wie konnte nicht...
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/20/2005
ms.topic: article
ms.assetid: 78fd0e92-f9c6-4e96-a5e9-0375b307a828
ms.technology: dotnet-webforms
msc.legacyurl: /web-forms/overview/moving-to-aspnet-20/data-source-controls
msc.type: authoredcontent
ms.openlocfilehash: 225e23c0e7f4c2f4b8a54ee3c07e2614e9ba1038
ms.sourcegitcommit: 953ff9ea4369f154d6fd0239599279ddd3280009
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 07/03/2018
ms.locfileid: "37388450"
---
<a name="data-source-controls"></a><span data-ttu-id="9a80d-104">Datenquellen-Steuerelemente</span><span class="sxs-lookup"><span data-stu-id="9a80d-104">Data Source Controls</span></span>
====================
<span data-ttu-id="9a80d-105">durch [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="9a80d-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="9a80d-106">Das DataGrid-Steuerelement in ASP.NET 1.x eine große Verbesserung beim Datenzugriff in Webanwendungen gekennzeichnet.</span><span class="sxs-lookup"><span data-stu-id="9a80d-106">The DataGrid control in ASP.NET 1.x marked a great improvement in data access in Web applications.</span></span> <span data-ttu-id="9a80d-107">Allerdings war es nicht so benutzerfreundlich wie es hätten verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="9a80d-107">However, it wasn't as user-friendly as it could have been.</span></span> <span data-ttu-id="9a80d-108">Es immer noch erforderlich, eine erhebliche Menge an Code, die viele nützliche Funktionen daraus zu gewinnen.</span><span class="sxs-lookup"><span data-stu-id="9a80d-108">It still required a considerable amount of code to obtain much useful functionality from it.</span></span> <span data-ttu-id="9a80d-109">Dies ist das Modell in der alle Data Access-Aufgaben in 1.x.</span><span class="sxs-lookup"><span data-stu-id="9a80d-109">Such is the model in all data access endeavors in 1.x.</span></span>


<span data-ttu-id="9a80d-110">Das DataGrid-Steuerelement in ASP.NET 1.x eine große Verbesserung beim Datenzugriff in Webanwendungen gekennzeichnet.</span><span class="sxs-lookup"><span data-stu-id="9a80d-110">The DataGrid control in ASP.NET 1.x marked a great improvement in data access in Web applications.</span></span> <span data-ttu-id="9a80d-111">Allerdings war es nicht so benutzerfreundlich wie es hätten verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="9a80d-111">However, it wasn't as user-friendly as it could have been.</span></span> <span data-ttu-id="9a80d-112">Es immer noch erforderlich, eine erhebliche Menge an Code, die viele nützliche Funktionen daraus zu gewinnen.</span><span class="sxs-lookup"><span data-stu-id="9a80d-112">It still required a considerable amount of code to obtain much useful functionality from it.</span></span> <span data-ttu-id="9a80d-113">Dies ist das Modell in der alle Data Access-Aufgaben in 1.x.</span><span class="sxs-lookup"><span data-stu-id="9a80d-113">Such is the model in all data access endeavors in 1.x.</span></span>

<span data-ttu-id="9a80d-114">ASP.NET 2.0 Adressen mit teilweise mit dem Datenquellen-Steuerelemente.</span><span class="sxs-lookup"><span data-stu-id="9a80d-114">ASP.NET 2.0 addresses this with in part with data source controls.</span></span> <span data-ttu-id="9a80d-115">Die Datenquellen-Steuerelementen in ASP.NET 2.0 bieten Entwicklern ein deklaratives Modell für das Abrufen von Daten, Daten anzeigen und Bearbeiten von Daten.</span><span class="sxs-lookup"><span data-stu-id="9a80d-115">The data source controls in ASP.NET 2.0 provide developers with a declarative model for retrieving data, displaying data, and editing data.</span></span> <span data-ttu-id="9a80d-116">Datenquellen-Steuerelemente dient, eine konsistente Darstellung von Daten in datengebundenen Steuerelementen unabhängig von der Quelle dieser Daten bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="9a80d-116">The purpose of data source controls is to provide a consistent representation of data to data-bound controls regardless of the source of those data.</span></span> <span data-ttu-id="9a80d-117">Das Herzstück der Datenquellen-Steuerelementen in ASP.NET 2.0 ist Sie die DataSourceControl abstrakte Klasse.</span><span class="sxs-lookup"><span data-stu-id="9a80d-117">At the heart of the data source controls in ASP.NET 2.0 is the DataSourceControl abstract class.</span></span> <span data-ttu-id="9a80d-118">Die DataSourceControl-Klasse bietet eine grundlegende Implementierung von IDataSource-Schnittstelle und der IListSource-Schnittstelle, die den Sie das Datenquellen-Steuerelement als Datenquelle eines datengebundenen Steuerelements (über die neue DataSourceID-Wert-Eigenschaft zuweisen können weiter unten behandelt) und die Daten darin als Liste verfügbar machen.</span><span class="sxs-lookup"><span data-stu-id="9a80d-118">The DataSourceControl class provides a base implementation of the IDataSource interface and the IListSource interface, the latter of which allows you to assign the data source control as the DataSource of a data-bound control (via the new DataSourceId property discussed later) and expose the data therein as a list.</span></span> <span data-ttu-id="9a80d-119">Jede Liste der Daten aus einem Datenquellen-Steuerelement wird als ein DataSourceView-Objekt verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="9a80d-119">Each list of data from a data source control is exposed as a DataSourceView object.</span></span> <span data-ttu-id="9a80d-120">Zugriff auf die DataSourceView-Instanzen wird durch die IDataSource-Schnittstelle bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="9a80d-120">Access to the DataSourceView instances is provided by the IDataSource interface.</span></span> <span data-ttu-id="9a80d-121">Beispielsweise gibt die GetViewNames-Methode zurück, eine ICollection, die Sie zum Auflisten der DataSourceViews ermöglicht, die mit bestimmten Datenquellen-Steuerelement verknüpft ist, und die GetView-Methode können Sie eine bestimmte Instanz der DataSourceView anhand Ihres Namens zugreifen.</span><span class="sxs-lookup"><span data-stu-id="9a80d-121">For example, the GetViewNames method returns an ICollection that allows you to enumerate the DataSourceViews associated with a particular data source control, and the GetView method allows you to access a particular DataSourceView instance by name.</span></span>

<span data-ttu-id="9a80d-122">Datenquellen-Steuerelemente haben keine Benutzeroberfläche an.</span><span class="sxs-lookup"><span data-stu-id="9a80d-122">Data source controls have no user-interface.</span></span> <span data-ttu-id="9a80d-123">Sie werden implementiert, und da Server gesteuert wird, sodass sie die deklarativen Syntax unterstützen können, damit sie Zugriff auf seitenspezifischen Status haben, falls gewünscht.</span><span class="sxs-lookup"><span data-stu-id="9a80d-123">They are implemented as server controls so that they can support declarative syntax and so that they have access to page state if desired.</span></span> <span data-ttu-id="9a80d-124">Datenquellen-Steuerelemente werden keine HTML-Markup an dem Client gerendert werden.</span><span class="sxs-lookup"><span data-stu-id="9a80d-124">Data source controls do not render any HTML markup to the client.</span></span>

> [!NOTE]
> <span data-ttu-id="9a80d-125">Wie Sie später sehen werden, Zwischenspeichern gibt es auch Vorteile, die mithilfe des Datenquellen-Steuerelemente abgerufen.</span><span class="sxs-lookup"><span data-stu-id="9a80d-125">As you'll see later, there are also caching benefits obtained by using data source controls.</span></span>


## <a name="storing-connection-strings"></a><span data-ttu-id="9a80d-126">Das Speichern von Verbindungszeichenfolgen</span><span class="sxs-lookup"><span data-stu-id="9a80d-126">Storing Connection Strings</span></span>

<span data-ttu-id="9a80d-127">Bevor wir uns mit Blick auf die Datenquellen-Steuerelemente zu konfigurieren, sollten wir eine neue Funktion in ASP.NET 2.0-Verbindungszeichenfolgen zu behandeln.</span><span class="sxs-lookup"><span data-stu-id="9a80d-127">Before we get into looking at how to configure data source controls, we should cover a new capability in ASP.NET 2.0 concerning connection strings.</span></span> <span data-ttu-id="9a80d-128">ASP.NET 2.0 werden einen neuen Abschnitt in der Konfigurationsdatei mit dem Sie ganz einfach Speichern von Verbindungszeichenfolgen, die dynamisch zur Laufzeit gelesen werden können.</span><span class="sxs-lookup"><span data-stu-id="9a80d-128">ASP.NET 2.0 introduces a new section in the configuration file that allows you to easily store connection strings that can be read dynamically at runtime.</span></span> <span data-ttu-id="9a80d-129">Die &lt;ConnectionStrings&gt; Abschnitt erleichtert das Speichern von Verbindungszeichenfolgen.</span><span class="sxs-lookup"><span data-stu-id="9a80d-129">The &lt;connectionStrings&gt; section makes it easy to store connection strings.</span></span>

<span data-ttu-id="9a80d-130">Der folgende Codeausschnitt fügt eine neue Verbindungszeichenfolge hinzu.</span><span class="sxs-lookup"><span data-stu-id="9a80d-130">The snippet below adds a new connection string.</span></span>

[!code-xml[Main](data-source-controls/samples/sample1.xml)]

> [!NOTE]
> <span data-ttu-id="9a80d-131">Wie bei der &lt;"appSettings"&gt; Abschnitt der &lt;ConnectionStrings&gt; im angezeigten Abschnitt außerhalb von den &lt;"System.Web"&gt; Abschnitt in der Konfigurationsdatei.</span><span class="sxs-lookup"><span data-stu-id="9a80d-131">Just as with the &lt;appSettings&gt; section, the &lt;connectionStrings&gt; section appears outside of the &lt;system.web&gt; section in the configuration file.</span></span>


<span data-ttu-id="9a80d-132">Um diese Verbindungszeichenfolge zu verwenden, können Sie die folgende Syntax, beim Festlegen der ConnectionString-Attribut eines Serversteuerelements.</span><span class="sxs-lookup"><span data-stu-id="9a80d-132">To use this connection string, you can use the following syntax when setting the ConnectionString attribute of a server control.</span></span>

[!code-aspx[Main](data-source-controls/samples/sample2.aspx)]

<span data-ttu-id="9a80d-133">Die &lt;ConnectionStrings&gt; Abschnitt kann auch verschlüsselt werden, damit vertraulicher Informationen nicht verfügbar gemacht wird.</span><span class="sxs-lookup"><span data-stu-id="9a80d-133">The &lt;connectionStrings&gt; section can also be encrypted so that sensitive information is not exposed.</span></span> <span data-ttu-id="9a80d-134">Diese Möglichkeit wird in einem Modul weiter unten erläutert.</span><span class="sxs-lookup"><span data-stu-id="9a80d-134">That ability will be covered in a later module.</span></span>

## <a name="caching-data-sources"></a><span data-ttu-id="9a80d-135">Zwischenspeichern von Datenquellen</span><span class="sxs-lookup"><span data-stu-id="9a80d-135">Caching Data Sources</span></span>

<span data-ttu-id="9a80d-136">Jede DataSourceControl stellt vier Eigenschaften zum Konfigurieren der Zwischenspeicherung bereit; EnableCaching, CacheDuration, CacheExpirationPolicy und CacheKeyDependency.</span><span class="sxs-lookup"><span data-stu-id="9a80d-136">Each DataSourceControl provides four properties for configuring caching; EnableCaching, CacheDuration, CacheExpirationPolicy, and CacheKeyDependency.</span></span>

## <a name="enablecaching"></a><span data-ttu-id="9a80d-137">EnableCaching</span><span class="sxs-lookup"><span data-stu-id="9a80d-137">EnableCaching</span></span>

<span data-ttu-id="9a80d-138">EnableCaching ist, dass eine boolesche Eigenschaft, die bestimmt, und zwar unabhängig davon, ob das Zwischenspeichern für das Datenquellen-Steuerelement aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="9a80d-138">EnableCaching is a Boolean property that determines whether or not caching is enabled for the data source control.</span></span>

## <a name="cacheduration-property"></a><span data-ttu-id="9a80d-139">CacheDuration-Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="9a80d-139">CacheDuration Property</span></span>

<span data-ttu-id="9a80d-140">Die CacheDuration-Eigenschaft legt fest, die Anzahl der Sekunden an, denen der Cache gültig bleibt.</span><span class="sxs-lookup"><span data-stu-id="9a80d-140">The CacheDuration property sets the number of seconds that the cache remains valid.</span></span> <span data-ttu-id="9a80d-141">Wenn diese Eigenschaft auf **0** bewirkt, dass der Cache gültig, bis Sie explizit für ungültig erklärt bleibt.</span><span class="sxs-lookup"><span data-stu-id="9a80d-141">Setting this property to **0** causes the cache to remain valid until explicitly invalidated.</span></span>

## <a name="cacheexpirationpolicy-property"></a><span data-ttu-id="9a80d-142">CacheExpirationPolicy-Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="9a80d-142">CacheExpirationPolicy Property</span></span>

<span data-ttu-id="9a80d-143">Die CacheExpirationPolicy-Eigenschaft kann festgelegt werden entweder **Absolute** oder **gleitend**.</span><span class="sxs-lookup"><span data-stu-id="9a80d-143">The CacheExpirationPolicy property can be set to either **Absolute** or **Sliding**.</span></span> <span data-ttu-id="9a80d-144">Festlegen auf Absolute bedeutet, die die maximale Zeitspanne, die die Daten zwischengespeichert werden, werden die Anzahl der Sekunden, die durch das CacheDuration-Eigenschaft angegeben ist.</span><span class="sxs-lookup"><span data-stu-id="9a80d-144">Setting it to Absolute means that the maximum amount of time that the data will be cached is the number of seconds specified by the CacheDuration property.</span></span> <span data-ttu-id="9a80d-145">Die Ablaufzeit wird durch Festlegung auf gleitend, zurückgesetzt, wenn jeder Vorgang ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="9a80d-145">By setting it to Sliding, the expiration time is reset when each operation is performed.</span></span>

## <a name="cachekeydependency-property"></a><span data-ttu-id="9a80d-146">CacheKeyDependency-Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="9a80d-146">CacheKeyDependency Property</span></span>

<span data-ttu-id="9a80d-147">Wenn ein Zeichenfolgenwert für die CacheKeyDependency-Eigenschaft angegeben wird, wird eine neue, für diese Zeichenfolge basierende Cacheabhängigkeit ASP.NET einrichten.</span><span class="sxs-lookup"><span data-stu-id="9a80d-147">If a string value is specified for the CacheKeyDependency property, ASP.NET will set up a new cache dependency based on that string.</span></span> <span data-ttu-id="9a80d-148">Dadurch können Sie explizit den Cache ungültig gemacht werden, indem einfach ändern oder Entfernen der CacheKeyDependency.</span><span class="sxs-lookup"><span data-stu-id="9a80d-148">This allows you to explicitly invalidate the cache by simply changing or removing the CacheKeyDependency.</span></span>

<span data-ttu-id="9a80d-149">**Wichtige**: Wenn Identitätswechsel aktiviert ist und der Zugriff auf die Datenquelle und/oder der Inhalt der Daten beruht auf der Identität des Clients, es wird empfohlen, dass die Zwischenspeicherung deaktiviert werden, indem EnableCaching auf "false" festlegen.</span><span class="sxs-lookup"><span data-stu-id="9a80d-149">**Important**: If impersonation is enabled and access to the data source and/or content of data are based upon client identity, it is recommended that caching be disabled by setting EnableCaching to False.</span></span> <span data-ttu-id="9a80d-150">Wenn das Zwischenspeichern ist in diesem Szenario aktiviert, und ein anderen Benutzer als der Benutzer, der die Daten ursprünglich angefordert hat, eine Anforderung gibt, wird die Autorisierung mit der Datenquelle nicht erzwungen.</span><span class="sxs-lookup"><span data-stu-id="9a80d-150">If caching is enabled in this scenario and a user other than the user who originally requested the data issues a request, authorization to the data source is not enforced.</span></span> <span data-ttu-id="9a80d-151">Die Daten werden einfach aus dem Cache bedient werden.</span><span class="sxs-lookup"><span data-stu-id="9a80d-151">The data will simply be served from cache.</span></span>

## <a name="the-sqldatasource-control"></a><span data-ttu-id="9a80d-152">Dem SqlDataSource-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="9a80d-152">The SqlDataSource Control</span></span>

<span data-ttu-id="9a80d-153">Das SqlDataSource-Steuerelement kann ein Entwickler in einer relationalen Datenbank, die ADO.NET unterstützt gespeicherten Daten zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="9a80d-153">The SqlDataSource control allows a developer to access data stored in any relational database that supports ADO.NET.</span></span> <span data-ttu-id="9a80d-154">Sie können den Anbieter "System.Data.SqlClient" verwenden, SQL Server-Datenbank, den Anbieter "System.Data.OleDb", der System.Data.Odbc-Anbieter oder der Anbieter System.Data.OracleClient Oracle den Zugriff auf den Zugriff auf.</span><span class="sxs-lookup"><span data-stu-id="9a80d-154">It can use the System.Data.SqlClient provider to access a SQL Server database, the System.Data.OleDb provider, the System.Data.Odbc provider, or the System.Data.OracleClient provider to access Oracle.</span></span> <span data-ttu-id="9a80d-155">Aus diesem Grund wird dem SqlDataSource-Steuerelement sicherlich nicht nur verwendet für den Zugriff auf Daten in einer SQL Server-Datenbank.</span><span class="sxs-lookup"><span data-stu-id="9a80d-155">Therefore, the SqlDataSource is certainly not only used for accessing data in a SQL Server database.</span></span>

<span data-ttu-id="9a80d-156">Um dem SqlDataSource-Steuerelement verwenden möchten, und indem Sie einfach Geben Sie einen Wert für die ConnectionString-Eigenschaft, geben Sie einen SQL-Befehl oder gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="9a80d-156">In order to use the SqlDataSource, you simply provide a value for the ConnectionString property and specify a SQL command or stored procedure.</span></span> <span data-ttu-id="9a80d-157">Das SqlDataSource-Steuerelement übernimmt der Arbeit mit der zugrunde liegenden Architektur von ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="9a80d-157">The SqlDataSource control takes care of working with the underlying ADO.NET architecture.</span></span> <span data-ttu-id="9a80d-158">Öffnet die Verbindung, fragt die Datenquelle oder führt die gespeicherte Prozedur, die Daten zurückgegeben werden, und schließt dann die Verbindung für Sie.</span><span class="sxs-lookup"><span data-stu-id="9a80d-158">It opens the connection, queries the data source or executes the stored procedure, returns the data, and then closes the connection for you.</span></span>

> [!NOTE]
> <span data-ttu-id="9a80d-159">Da die DataSourceControl-Klasse automatisch die Verbindung geschlossen wird, sollten sie die Anzahl der Anrufe von Kunden durch den Verlust von Verbindungen mit der Datenbank generiert reduzieren.</span><span class="sxs-lookup"><span data-stu-id="9a80d-159">Because the DataSourceControl class automatically closes the connection for you, it should reduce the number of customer calls generated by leaking database connections.</span></span>


<span data-ttu-id="9a80d-160">Der folgende Codeausschnitt bindet ein DropDownList-Steuerelement an ein SqlDataSource-Steuerelement, das mithilfe der Verbindungszeichenfolge, die in der Konfigurationsdatei wie oben gezeigt gespeichert sind.</span><span class="sxs-lookup"><span data-stu-id="9a80d-160">The code snippet below binds a DropDownList control to a SqlDataSource control using the connection string that is stored in the configuration file as shown above.</span></span>

[!code-aspx[Main](data-source-controls/samples/sample3.aspx)]

<span data-ttu-id="9a80d-161">Wie oben gezeigt wurde, gibt der Datenreader, der dem SqlDataSource-Steuerelement den Modus für die Datenquelle an.</span><span class="sxs-lookup"><span data-stu-id="9a80d-161">As illustrated above, the DataSourceMode property of the SqlDataSource specifies the mode for the data source.</span></span> <span data-ttu-id="9a80d-162">Im obigen Beispiel wird die DataSourceMode auf DataReader festgelegt.</span><span class="sxs-lookup"><span data-stu-id="9a80d-162">In the example above, the DataSourceMode is set to DataReader.</span></span> <span data-ttu-id="9a80d-163">In diesem Fall wird dem SqlDataSource-Steuerelement ein IDataReader-Objekt, das mit einem Vorwärtscursor und schreibgeschützte Cursor zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="9a80d-163">In that case, the SqlDataSource will return an IDataReader object using a forward-only and read-only cursor.</span></span> <span data-ttu-id="9a80d-164">Der angegebene Typ des Objekts, das zurückgegeben wird, wird vom Anbieter gesteuert, die verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="9a80d-164">The specified type of object that is returned is controlled by the provider that is used.</span></span> <span data-ttu-id="9a80d-165">In diesem Fall verwende ich den Anbieter "System.Data.SqlClient" gemäß der &lt;ConnectionStrings&gt; -Abschnitt der Datei "Web.config".</span><span class="sxs-lookup"><span data-stu-id="9a80d-165">In this case, I'm using the System.Data.SqlClient provider as specified in the &lt;connectionStrings&gt; section of the web.config file.</span></span> <span data-ttu-id="9a80d-166">Aus diesem Grund wird das Objekt, das zurückgegeben wird, vom Typ SqlDataReader sein.</span><span class="sxs-lookup"><span data-stu-id="9a80d-166">Therefore, the object that is returned will be of type SqlDataReader.</span></span> <span data-ttu-id="9a80d-167">Durch Angabe des Werts DataSourceMode DataSet, können die Daten in einem DataSet auf dem Server gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="9a80d-167">By specifying a DataSourceMode value of DataSet, the data can be stored in a DataSet on the server.</span></span> <span data-ttu-id="9a80d-168">In diesem Modus können Sie Funktionen wie sortieren, Paging usw. hinzufügen. Wenn ich die Datenbindung wurde dem SqlDataSource-Steuerelement zu einem GridView-Steuerelement, würde ausgewählt den DataSet-Modus.</span><span class="sxs-lookup"><span data-stu-id="9a80d-168">This mode allows you to add features such as sorting, paging, etc. If I had been data-binding the SqlDataSource to a GridView control, I would have chosen the DataSet mode.</span></span> <span data-ttu-id="9a80d-169">Im Fall von einem DropDownList-Steuerelement ist der DataReader-Modus jedoch die richtige Wahl.</span><span class="sxs-lookup"><span data-stu-id="9a80d-169">However, in the case of a DropDownList, the DataReader mode is the correct choice.</span></span>

> [!NOTE]
> <span data-ttu-id="9a80d-170">Beim Zwischenspeichern von einem SqlDataSource-Steuerelement oder einem AccessDataSource, muss der Datenreader DataSet festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="9a80d-170">When caching a SqlDataSource or an AccessDataSource, the DataSourceMode property must be set to DataSet.</span></span> <span data-ttu-id="9a80d-171">Es wird eine Ausnahme ausgelöst, wenn mit einem DataReader DataSourceMode der Zwischenspeicherung aktiviert.</span><span class="sxs-lookup"><span data-stu-id="9a80d-171">An exception will occur if you enable caching with a DataSourceMode of DataReader.</span></span>


## <a name="sqldatasource-properties"></a><span data-ttu-id="9a80d-172">SqlDataSource-Eigenschaften</span><span class="sxs-lookup"><span data-stu-id="9a80d-172">SqlDataSource Properties</span></span>

<span data-ttu-id="9a80d-173">Im folgenden werden einige der Eigenschaften des dem SqlDataSource-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="9a80d-173">The following are some of the properties of the SqlDataSource control.</span></span>

### <a name="cancelselectonnullparameter"></a><span data-ttu-id="9a80d-174">CancelSelectOnNullParameter</span><span class="sxs-lookup"><span data-stu-id="9a80d-174">CancelSelectOnNullParameter</span></span>

<span data-ttu-id="9a80d-175">Ein boolescher Wert, der angibt, ob ein select-Befehl abgebrochen wird, wenn einer der Parameter null ist.</span><span class="sxs-lookup"><span data-stu-id="9a80d-175">A Boolean value that specifies whether a select command is canceled if one of the parameters is null.</span></span> <span data-ttu-id="9a80d-176">Standardmäßig "true".</span><span class="sxs-lookup"><span data-stu-id="9a80d-176">True by default.</span></span>

### <a name="conflictdetection"></a><span data-ttu-id="9a80d-177">ConflictDetection</span><span class="sxs-lookup"><span data-stu-id="9a80d-177">ConflictDetection</span></span>

<span data-ttu-id="9a80d-178">In einer Situation, in denen mehrere Benutzer eine Datenquelle zur gleichen Zeit aktualisieren werden können, bestimmt die ConflictDetection-Eigenschaft das Verhalten von dem SqlDataSource-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="9a80d-178">In a situation where multiple users may be updating a data source at the same time, the ConflictDetection property determines the behavior of the SqlDataSource control.</span></span> <span data-ttu-id="9a80d-179">Diese Eigenschaft wird zu einer der Werte der Enumeration ConflictOptions ausgewertet.</span><span class="sxs-lookup"><span data-stu-id="9a80d-179">This property evaluates to one of the values of the ConflictOptions enumeration.</span></span> <span data-ttu-id="9a80d-180">Diese Werte sind **CompareAllValues** und **OverwriteChanges**.</span><span class="sxs-lookup"><span data-stu-id="9a80d-180">Those values are **CompareAllValues** and **OverwriteChanges**.</span></span> <span data-ttu-id="9a80d-181">Wenn auf OverwriteChanges, letzten Person, die Daten in der Datenquelle zu schreiben, alle vorherigen Änderungen überschreibt.</span><span class="sxs-lookup"><span data-stu-id="9a80d-181">If set to OverwriteChanges, the last person to write data to the data source overwrites any previous changes.</span></span> <span data-ttu-id="9a80d-182">Wenn die ConflictDetection-Eigenschaft auf CompareAllValues festgelegt ist, Parameter für die von SelectCommand zurückgegebenen Spalten erstellt und Parameter werden auch zum Speichern der ursprünglichen Werte in jeder dieser Spalten, die dem SqlDataSource-Steuerelement, sodass erstellt Bestimmen Sie, und zwar unabhängig davon, ob die Werte geändert haben, da SelectCommand ausgeführt wurde.</span><span class="sxs-lookup"><span data-stu-id="9a80d-182">However, if the ConflictDetection property is set to CompareAllValues, parameters get created for the columns returned by the SelectCommand and parameters are also created to hold the original values in each of those columns allowing the SqlDataSource to determine whether or not the values have changed since the SelectCommand was executed.</span></span>

### <a name="deletecommand"></a><span data-ttu-id="9a80d-183">DeleteCommand</span><span class="sxs-lookup"><span data-stu-id="9a80d-183">DeleteCommand</span></span>

<span data-ttu-id="9a80d-184">Legt fest oder ruft die SQL-Zeichenfolge, die beim Löschen von Zeilen aus der Datenbank verwendet.</span><span class="sxs-lookup"><span data-stu-id="9a80d-184">Sets or gets the SQL string used when deleting rows from the database.</span></span> <span data-ttu-id="9a80d-185">Dies kann entweder eine SQL-Abfrage oder der Name einer gespeicherten Prozedur sein.</span><span class="sxs-lookup"><span data-stu-id="9a80d-185">This can either be a SQL query or a stored procedure name.</span></span>

### <a name="deletecommandtype"></a><span data-ttu-id="9a80d-186">DeleteCommandType</span><span class="sxs-lookup"><span data-stu-id="9a80d-186">DeleteCommandType</span></span>

<span data-ttu-id="9a80d-187">Legt fest oder ruft dem Typ der Delete-Befehl, entweder eine SQL-Abfrage (Text) oder eine gespeicherte Prozedur (StoredProcedure).</span><span class="sxs-lookup"><span data-stu-id="9a80d-187">Sets or gets the type of delete command, either a SQL query (Text) or a stored procedure (StoredProcedure).</span></span>

### <a name="deleteparameters"></a><span data-ttu-id="9a80d-188">DeleteParameters</span><span class="sxs-lookup"><span data-stu-id="9a80d-188">DeleteParameters</span></span>

<span data-ttu-id="9a80d-189">Gibt die Parameter zurück, die durch die DeleteCommand des Objekts mit dem SqlDataSource-Steuerelement verknüpfte SqlDataSourceView verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="9a80d-189">Returns the parameters that are used by the DeleteCommand of the SqlDataSourceView object associated with the SqlDataSource control.</span></span>

### <a name="oldvaluesparameterformatstring"></a><span data-ttu-id="9a80d-190">OldValuesParameterFormatString</span><span class="sxs-lookup"><span data-stu-id="9a80d-190">OldValuesParameterFormatString</span></span>

<span data-ttu-id="9a80d-191">Diese Eigenschaft wird verwendet, um das Format der Parameter mit den ursprünglichen Werten in Fällen anzugeben, in denen die ConflictDetection-Eigenschaft auf CompareAllValues festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="9a80d-191">This property is used to specify the format of the original value parameters in cases where the ConflictDetection property is set to CompareAllValues.</span></span> <span data-ttu-id="9a80d-192">Der Standardwert ist {0} was bedeutet, dass die ursprüngliche Wertparameter den gleichen Namen wie der ursprüngliche Parameter dauert.</span><span class="sxs-lookup"><span data-stu-id="9a80d-192">The default is {0} which means that original value parameters will take the same name as the original parameter.</span></span> <span data-ttu-id="9a80d-193">Das heißt, ist der Name des Felds "EmployeeID", der ursprünglichen Value-Parameter wäre @EmployeeID.</span><span class="sxs-lookup"><span data-stu-id="9a80d-193">In other words, if the field name is EmployeeID, the original value parameter would be @EmployeeID.</span></span>

### <a name="selectcommand"></a><span data-ttu-id="9a80d-194">SelectCommand</span><span class="sxs-lookup"><span data-stu-id="9a80d-194">SelectCommand</span></span>

<span data-ttu-id="9a80d-195">Legt fest oder ruft die SQL-Zeichenfolge, die zum Abrufen von Daten aus der Datenbank verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="9a80d-195">Sets or gets the SQL string that is used to retrieve data from the database.</span></span> <span data-ttu-id="9a80d-196">Dies kann entweder eine SQL-Abfrage oder der Name einer gespeicherten Prozedur sein.</span><span class="sxs-lookup"><span data-stu-id="9a80d-196">This can either be a SQL query or a stored procedure name.</span></span>

### <a name="selectcommandtype"></a><span data-ttu-id="9a80d-197">SelectCommandType</span><span class="sxs-lookup"><span data-stu-id="9a80d-197">SelectCommandType</span></span>

<span data-ttu-id="9a80d-198">Legt fest oder ruft dem Typ der select-Befehl, entweder eine SQL-Abfrage (Text) oder eine gespeicherte Prozedur (StoredProcedure).</span><span class="sxs-lookup"><span data-stu-id="9a80d-198">Sets or gets the type of select command, either a SQL query (Text) or a stored procedure (StoredProcedure).</span></span>

### <a name="selectparameters"></a><span data-ttu-id="9a80d-199">SelectParameters</span><span class="sxs-lookup"><span data-stu-id="9a80d-199">SelectParameters</span></span>

<span data-ttu-id="9a80d-200">Gibt zurück, die Parameter, die von SelectCommand des Objekts mit dem SqlDataSource-Steuerelement verknüpfte SqlDataSourceView verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="9a80d-200">Returns the parameters that are used by the SelectCommand of the SqlDataSourceView object associated with the SqlDataSource control.</span></span>

### <a name="sortparametername"></a><span data-ttu-id="9a80d-201">SortParameterName</span><span class="sxs-lookup"><span data-stu-id="9a80d-201">SortParameterName</span></span>

<span data-ttu-id="9a80d-202">Übernimmt oder bestimmt den Namen der Parameter einer gespeicherten Prozedur, der beim Abrufen von Sortieren von Daten mit den Datenquellen-Steuerelement verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="9a80d-202">Gets or sets the name of a stored procedure parameter that is used when sorting data retrieved by the data source control.</span></span> <span data-ttu-id="9a80d-203">Nur gültig, wenn SelectCommandType auf StoredProcedure festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="9a80d-203">Valid only when SelectCommandType is set to StoredProcedure.</span></span>

### <a name="sqlcachedependency"></a><span data-ttu-id="9a80d-204">SqlCacheDependency</span><span class="sxs-lookup"><span data-stu-id="9a80d-204">SqlCacheDependency</span></span>

<span data-ttu-id="9a80d-205">Eine durch Semikolons getrennte Zeichenfolge, die die Datenbanken und Tabellen in einer SQL Server-Cacheabhängigkeit verwendet angibt.</span><span class="sxs-lookup"><span data-stu-id="9a80d-205">A semi-colon delimited string specifying the databases and tables used in a SQL Server cache dependency.</span></span> <span data-ttu-id="9a80d-206">(SQL-cacheabhängigkeiten werden in einem Modul weiter unten erläutert.)</span><span class="sxs-lookup"><span data-stu-id="9a80d-206">(SQL cache dependencies will be discussed in a later module.)</span></span>

### <a name="updatecommand"></a><span data-ttu-id="9a80d-207">UpdateCommand</span><span class="sxs-lookup"><span data-stu-id="9a80d-207">UpdateCommand</span></span>

<span data-ttu-id="9a80d-208">Legt fest oder ruft die SQL-Zeichenfolge, die beim Aktualisieren von Daten in der Datenbank verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="9a80d-208">Sets or gets the SQL string that is used when updating data in the database.</span></span> <span data-ttu-id="9a80d-209">Dies kann entweder eine SQL-Abfrage oder der Name einer gespeicherten Prozedur sein.</span><span class="sxs-lookup"><span data-stu-id="9a80d-209">This can either be a SQL query or a stored procedure name.</span></span>

### <a name="updatecommandtype"></a><span data-ttu-id="9a80d-210">UpdateCommandType</span><span class="sxs-lookup"><span data-stu-id="9a80d-210">UpdateCommandType</span></span>

<span data-ttu-id="9a80d-211">Legt fest oder ruft dem Typ des updatebefehls, entweder eine SQL-Abfrage (Text) oder eine gespeicherte Prozedur (StoredProcedure).</span><span class="sxs-lookup"><span data-stu-id="9a80d-211">Sets or gets the type of update command, either a SQL query (Text) or a stored procedure (StoredProcedure).</span></span>

### <a name="updateparameters"></a><span data-ttu-id="9a80d-212">UpdateParameters</span><span class="sxs-lookup"><span data-stu-id="9a80d-212">UpdateParameters</span></span>

<span data-ttu-id="9a80d-213">Gibt die Parameter zurück, die durch die UpdateCommand für das SqlDataSourceView-Objekt, das mit dem SqlDataSource-Steuerelement verknüpfte verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="9a80d-213">Returns the parameters that are used by the UpdateCommand of the SqlDataSourceView object associated with the SqlDataSource control.</span></span>

## <a name="the-accessdatasource-control"></a><span data-ttu-id="9a80d-214">AccessDataSource-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="9a80d-214">The AccessDataSource Control</span></span>

<span data-ttu-id="9a80d-215">AccessDataSource-Steuerelement von der SqlDataSource-Klasse abgeleitet ist und wird verwendet, um Daten in einer Microsoft Access-Datenbank gebunden werden soll.</span><span class="sxs-lookup"><span data-stu-id="9a80d-215">The AccessDataSource control derives from the SqlDataSource class and is used to data-bind to a Microsoft Access database.</span></span> <span data-ttu-id="9a80d-216">Die ConnectionString-Eigenschaft für das AccessDataSource-Steuerelement ist eine schreibgeschützte Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="9a80d-216">The ConnectionString property for the AccessDataSource control is a read-only property.</span></span> <span data-ttu-id="9a80d-217">Anstatt die ConnectionString-Eigenschaft, wird die Datendatei-Eigenschaft verwendet, um auf die Access-Datenbank zu verweisen, wie unten dargestellt.</span><span class="sxs-lookup"><span data-stu-id="9a80d-217">Instead of using the ConnectionString property, the DataFile property is used to point to the Access Database as shown below.</span></span>

[!code-aspx[Main](data-source-controls/samples/sample4.aspx)]

<span data-ttu-id="9a80d-218">Die AccessDataSource der "ProviderName", der dem Basis-SqlDataSource-Steuerelement wird immer auf "System.Data.OleDb" festgelegt und eine Verbindung mit der Datenbank mithilfe von Microsoft.Jet.OLEDB.4.0 OLE DB-Anbieters.</span><span class="sxs-lookup"><span data-stu-id="9a80d-218">The AccessDataSource will always set the ProviderName of the base SqlDataSource to System.Data.OleDb and connects to the database using the Microsoft.Jet.OLEDB.4.0 OLE DB provider.</span></span> <span data-ttu-id="9a80d-219">AccessDataSource-Steuerelement können keine Verbindung mit einer Access-Datenbank ein Kennwort geschützt.</span><span class="sxs-lookup"><span data-stu-id="9a80d-219">You cannot use the AccessDataSource control to connect to a password-protected Access database.</span></span> <span data-ttu-id="9a80d-220">Wenn Sie für die Verbindung mit einer Datenbank ein Kennwort geschützt haben, sollten Sie das SqlDataSource-Steuerelement verwenden.</span><span class="sxs-lookup"><span data-stu-id="9a80d-220">If you have to connect to a password protected database, you should use the SqlDataSource control.</span></span>

> [!NOTE]
> <span data-ttu-id="9a80d-221">Access-Datenbanken, die innerhalb der Website gespeicherten platziert werden soll, in der App\_Verzeichnis "Data".</span><span class="sxs-lookup"><span data-stu-id="9a80d-221">Access databases stored within the Web site should be placed in the App\_Data directory.</span></span> <span data-ttu-id="9a80d-222">ASP.NET lässt sich nicht auf Dateien in diesem Verzeichnis zu durchsuchenden aus.</span><span class="sxs-lookup"><span data-stu-id="9a80d-222">ASP.NET does not allow files in this directory to be browsed.</span></span> <span data-ttu-id="9a80d-223">Sie müssen das Prozesskonto lesen und Schreiben der App Berechtigungen zu erteilen\_Verzeichnis "Data" bei Verwendung von Access-Datenbanken.</span><span class="sxs-lookup"><span data-stu-id="9a80d-223">You will need to grant the process account Read and Write permissions to the App\_Data directory when using Access databases.</span></span>


## <a name="the-xmldatasource-control"></a><span data-ttu-id="9a80d-224">XmlDataSource-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="9a80d-224">The XmlDataSource Control</span></span>

<span data-ttu-id="9a80d-225">Die XmlDataSource wird verwendet, um eine XML-Daten zu datengebundenen Steuerelementen Datenbindung.</span><span class="sxs-lookup"><span data-stu-id="9a80d-225">The XmlDataSource is used to data-bind XML data to data-bound controls.</span></span> <span data-ttu-id="9a80d-226">Können Sie an eine XML-Datei mit der Datendatei Eigenschaft binden, oder kann an eine XML-Zeichenfolge, die mithilfe der Data-Eigenschaft gebunden.</span><span class="sxs-lookup"><span data-stu-id="9a80d-226">You can bind to an XML file using the DataFile property or you can bind to an XML string using the Data property.</span></span> <span data-ttu-id="9a80d-227">Die XmlDataSource stellt XML-Attribute als bindbar Felder.</span><span class="sxs-lookup"><span data-stu-id="9a80d-227">The XmlDataSource exposes XML attributes as bindable fields.</span></span> <span data-ttu-id="9a80d-228">In Fällen, in dem Sie zur Bindung an Werte, die nicht als Attribute dargestellt werden müssen, müssen Sie eine XSL-Transformation verwenden.</span><span class="sxs-lookup"><span data-stu-id="9a80d-228">In cases where you need to bind to values that are not represented as attributes, you will need to use an XSL transform.</span></span> <span data-ttu-id="9a80d-229">Sie können auch die XPath-Ausdrücke zum Filtern von XML-Daten verwenden.</span><span class="sxs-lookup"><span data-stu-id="9a80d-229">You can also use XPath expressions to filter XML data.</span></span>

<span data-ttu-id="9a80d-230">Beachten Sie die folgende XML-Datei ein:</span><span class="sxs-lookup"><span data-stu-id="9a80d-230">Consider the following XML file:</span></span>

[!code-xml[Main](data-source-controls/samples/sample5.xml)]

<span data-ttu-id="9a80d-231">Beachten Sie, dass die XmlDataSource eine XPath-Eigenschaft verwendet *Menschen/* um Filtern nur die &lt;Person&gt; Knoten.</span><span class="sxs-lookup"><span data-stu-id="9a80d-231">Notice that the XmlDataSource uses an XPath property of *People/Person* in order to filter on just the &lt;Person&gt; nodes.</span></span> <span data-ttu-id="9a80d-232">Die DropDownList-Datenbindung klicken Sie dann auf das LastName-Attribut, das mithilfe der DataTextField-Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="9a80d-232">The DropDownList then data-binds to the LastName attribute using the DataTextField property.</span></span>

<span data-ttu-id="9a80d-233">Während der XmlDataSource-Steuerelement an Daten auf nur-Lese XML-Daten gebunden werden soll in erster Linie verwendet wird, ist es möglich, die XML-Datendatei zu bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="9a80d-233">While the XmlDataSource control is primarily used to data-bind to read-only XML data, it is possible to edit the XML data file.</span></span> <span data-ttu-id="9a80d-234">Beachten Sie, dass in diesen Fällen Automatisches Einfügen, aktualisieren und Löschen von Informationen in der XML-Datei erfolgt kein automatisches wie bei anderen Datenquellen-Steuerelemente.</span><span class="sxs-lookup"><span data-stu-id="9a80d-234">Note that in such cases, automatic insertion, updating, and deletion of information in the XML file does not happen automatically as it does with other data source controls.</span></span> <span data-ttu-id="9a80d-235">Stattdessen müssen Sie Code schreiben, um die Daten mithilfe der folgenden Methoden der XmlDataSource-Steuerelement manuell zu bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="9a80d-235">Instead, you will have to write code to manually edit the data using the following methods of the XmlDataSource control.</span></span>

### <a name="getxmldocument"></a><span data-ttu-id="9a80d-236">GetXmlDocument</span><span class="sxs-lookup"><span data-stu-id="9a80d-236">GetXmlDocument</span></span>

<span data-ttu-id="9a80d-237">Ruft ein XmlDocument-Objekt, das mit dem XML-Code abgerufen, indem die XmlDataSource ab.</span><span class="sxs-lookup"><span data-stu-id="9a80d-237">Retrieves an XmlDocument object containing the XML code retrieved by the XmlDataSource.</span></span>

### <a name="save"></a><span data-ttu-id="9a80d-238">Speichern</span><span class="sxs-lookup"><span data-stu-id="9a80d-238">Save</span></span>

<span data-ttu-id="9a80d-239">Speichert das XML-Dokument im Arbeitsspeicher in der Datenquelle an.</span><span class="sxs-lookup"><span data-stu-id="9a80d-239">Saves the in-memory XmlDocument back to the data source.</span></span>

<span data-ttu-id="9a80d-240">Es ist wichtig zu wissen, dass die Save-Methode funktioniert nur, wenn die beiden folgenden Bedingungen erfüllt sind:</span><span class="sxs-lookup"><span data-stu-id="9a80d-240">It's important to realize that the Save method will only work when the following two conditions are met:</span></span>

1. <span data-ttu-id="9a80d-241">Die XmlDataSource verwendet die DataFile-Eigenschaft, um an eine XML-Datei anstelle der Daten-Eigenschaft zu binden, zum Binden an XML-Daten im Arbeitsspeicher.</span><span class="sxs-lookup"><span data-stu-id="9a80d-241">The XmlDataSource is using the DataFile property to bind to an XML file instead of the Data property to bind to in-memory XML data.</span></span>
2. <span data-ttu-id="9a80d-242">Es ist keine Transformation über die Transformation oder TransformFile-Eigenschaft angegeben.</span><span class="sxs-lookup"><span data-stu-id="9a80d-242">No transformation is specified via the Transform or TransformFile property.</span></span>

<span data-ttu-id="9a80d-243">Beachten Sie, dass die Save-Methode zu unerwarteten Ergebnissen bei der von mehreren Benutzern gleichzeitig aufgerufen führen kann.</span><span class="sxs-lookup"><span data-stu-id="9a80d-243">Note also that the Save method can yield unexpected results when called by multiple users concurrently.</span></span>

## <a name="the-objectdatasource-control"></a><span data-ttu-id="9a80d-244">Das ObjectDataSource-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="9a80d-244">The ObjectDataSource Control</span></span>

<span data-ttu-id="9a80d-245">Die Datenquellen-Steuerelemente, die wir bis zu diesem Zeitpunkt abgedeckt haben sind eine ausgezeichnete Wahl für Anwendungen mit zwei Ebenen, wobei das Datenquellen-Steuerelement direkt mit dem Datenspeicher kommuniziert.</span><span class="sxs-lookup"><span data-stu-id="9a80d-245">The data source controls that we have covered up to this point are excellent choices for two-tier applications where the data source control communicates directly to the data store.</span></span> <span data-ttu-id="9a80d-246">Allerdings sind viele reale Anwendungen Anwendungen mit mehreren Ebenen, in denen möglicherweise ein Datenquellen-Steuerelement für die Kommunikation mit einem Geschäftsobjekt, das wiederum mit der Datenschicht kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="9a80d-246">However, many real-world applications are multi-tier applications where a data source control might need to communicate to a business object which, in turn, communicates with the data layer.</span></span> <span data-ttu-id="9a80d-247">In diesen Fällen werden mit dem ObjectDataSource-Steuerelement die Rechnung gut füllt.</span><span class="sxs-lookup"><span data-stu-id="9a80d-247">In these situations, the ObjectDataSource fills the bill nicely.</span></span> <span data-ttu-id="9a80d-248">Dem ObjectDataSource-Steuerelement funktioniert in Verbindung mit einem Quellobjekt.</span><span class="sxs-lookup"><span data-stu-id="9a80d-248">The ObjectDataSource works in conjunction with a source object.</span></span> <span data-ttu-id="9a80d-249">Das ObjectDataSource-Steuerelement wird eine Instanz der Source-Objekt, rufen Sie die angegebene Methode und Dispose der Objektinstanz alle innerhalb des Bereichs einer einzelnen Anforderung erstellt, verfügt das Objekt Instanzmethoden anstelle von statischen Methoden (Shared in Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="9a80d-249">The ObjectDataSource control will create an instance of the source object, call the specified method, and dispose of the object instance all within the scope of a single request, if your object has instance methods instead of static methods (Shared in Visual Basic).</span></span> <span data-ttu-id="9a80d-250">Aus diesem Grund muss Ihr Objekt zustandslos sein.</span><span class="sxs-lookup"><span data-stu-id="9a80d-250">Therefore, your object must be stateless.</span></span> <span data-ttu-id="9a80d-251">Also sollte das Objekt abrufen und alle erforderlichen Ressourcen innerhalb der Spanne einer einzelnen Anforderung freigeben.</span><span class="sxs-lookup"><span data-stu-id="9a80d-251">That is, your object should acquire and release all required resources within the span of a single request.</span></span> <span data-ttu-id="9a80d-252">Sie können steuern, wie das Quellobjekt durch Behandeln des Ereignisses ObjectCreating des ObjectDataSource-Steuerelement erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="9a80d-252">You can control how the source object is created by handling the ObjectCreating event of the ObjectDataSource control.</span></span> <span data-ttu-id="9a80d-253">Sie können erstellen Sie eine Instanz des Quellobjekts, und legen Sie dann die ObjectInstance-Eigenschaft der ObjectDataSourceEventArgs-Klasse, die dieser Instanz.</span><span class="sxs-lookup"><span data-stu-id="9a80d-253">You can create an instance of the source object, and then set the ObjectInstance property of the ObjectDataSourceEventArgs class to that instance.</span></span> <span data-ttu-id="9a80d-254">Das ObjectDataSource-Steuerelement verwendet die Instanz, die im Ereignis ObjectCreating statt Sie selbst eine Instanz erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="9a80d-254">The ObjectDataSource control will use the instance that is created in the ObjectCreating event instead of creating an instance on its own.</span></span>

<span data-ttu-id="9a80d-255">Wenn das Quellobjekt für ein ObjectDataSource-Steuerelement öffentliche statische Methoden (Shared in Visual Basic) verfügbar, die zum Abrufen und Ändern von Daten aufgerufen werden kann macht, wird ein ObjectDataSource-Steuerelement diese Methoden direkt aufrufen.</span><span class="sxs-lookup"><span data-stu-id="9a80d-255">If the source object for an ObjectDataSource control exposes public static methods (Shared in Visual Basic) that can be called to retrieve and modify data, an ObjectDataSource control will call those methods directly.</span></span> <span data-ttu-id="9a80d-256">Wenn ein ObjectDataSource-Steuerelement eine Instanz des Quellobjekts erstellen muss, um Methodenaufrufe zu machen, muss das Objekt einen öffentlichen Konstruktor enthalten, der keine Parameter akzeptiert.</span><span class="sxs-lookup"><span data-stu-id="9a80d-256">If an ObjectDataSource control must create an instance of the source object in order to make method calls, the object must include a public constructor that takes no parameters.</span></span> <span data-ttu-id="9a80d-257">Das ObjectDataSource-Steuerelement ruft diesen Konstruktor, wenn es sich um eine neue Instanz der dem Quellobjekt erstellt.</span><span class="sxs-lookup"><span data-stu-id="9a80d-257">The ObjectDataSource control will call this constructor when it creates a new instance of the source object.</span></span>

<span data-ttu-id="9a80d-258">Wenn das Quellobjekt nicht über einen öffentlichen Konstruktor ohne Parameter enthält, können Sie eine Instanz des Quellobjekts erstellen, die durch das ObjectDataSource-Steuerelement im Ereignis ObjectCreating verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="9a80d-258">If the source object does not contain a public constructor without parameters, you can create an instance of the source object that will be used by the ObjectDataSource control in the ObjectCreating event.</span></span>

## <a name="specifying-object-methods"></a><span data-ttu-id="9a80d-259">Angeben von Objektmethoden</span><span class="sxs-lookup"><span data-stu-id="9a80d-259">Specifying Object Methods</span></span>

<span data-ttu-id="9a80d-260">Das Quellobjekt für ein ObjectDataSource-Steuerelement kann enthalten eine beliebige Anzahl von Methoden, die verwendet werden, um auswählen, einfügen, aktualisieren oder Löschen von Daten.</span><span class="sxs-lookup"><span data-stu-id="9a80d-260">The source object for an ObjectDataSource control can contain any number of methods that are used to select, insert, update, or delete data.</span></span> <span data-ttu-id="9a80d-261">Diese Methoden werden durch das ObjectDataSource-Steuerelement, das basierend auf den Namen der Methode aufgerufen, wie mithilfe der SelectMethod, InsertMethod, UpdateMethod bzw. DeleteMethod-Eigenschaft des ObjectDataSource-Steuerelement identifiziert.</span><span class="sxs-lookup"><span data-stu-id="9a80d-261">These methods are called by the ObjectDataSource control based on the name of the method, as identified by using either the SelectMethod, InsertMethod, UpdateMethod, or DeleteMethod property of the ObjectDataSource control.</span></span> <span data-ttu-id="9a80d-262">Das Quellobjekt zählen auch eine optionale SelectCount-Methode, die identifiziert wird, indem Sie das ObjectDataSource-Steuerelement, das mithilfe der SelectCountMethod-Eigenschaft, die die Anzahl der Gesamtzahl von Objekten in der Datenquelle zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="9a80d-262">The source object can also include an optional SelectCount method, which is identified by the ObjectDataSource control using the SelectCountMethod property, that returns the count of the total number of objects at the data source.</span></span> <span data-ttu-id="9a80d-263">Das ObjectDataSource-Steuerelement ruft die SelectCount-Methode, nach eine Select-Methode aufgerufen wurde, um die Gesamtzahl der Datensätze in der Datenquelle für die Verwendung abzurufen, wenn paging.</span><span class="sxs-lookup"><span data-stu-id="9a80d-263">The ObjectDataSource control will call the SelectCount method after a Select method has been called to retrieve the total number of records at the data source for use when paging.</span></span>

## <a name="lab-using-data-source-controls"></a><span data-ttu-id="9a80d-264">Lab mithilfe des Datenquellen-Steuerelemente</span><span class="sxs-lookup"><span data-stu-id="9a80d-264">Lab Using Data Source Controls</span></span>

## <a name="exercise-1---displaying-data-with-the-sqldatasource-control"></a><span data-ttu-id="9a80d-265">Übung 1: Anzeigen von Daten mit dem SqlDataSource-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="9a80d-265">Exercise 1 - Displaying Data with the SqlDataSource Control</span></span>

<span data-ttu-id="9a80d-266">In der folgenden Übung wird das SqlDataSource-Steuerelement für die Verbindung zur Northwind-Datenbank verwendet.</span><span class="sxs-lookup"><span data-stu-id="9a80d-266">The following exercise uses the SqlDataSource control to connect to the Northwind database.</span></span> <span data-ttu-id="9a80d-267">Es wird davon ausgegangen, dass Sie Zugriff auf die Northwind-Datenbank auf einer SQL Server 2000-Instanz verfügen.</span><span class="sxs-lookup"><span data-stu-id="9a80d-267">It assumes that you have access to the Northwind database on a SQL Server 2000 instance.</span></span>

1. <span data-ttu-id="9a80d-268">Erstellen Sie eine neue ASP.NET-Website.</span><span class="sxs-lookup"><span data-stu-id="9a80d-268">Create a new ASP.NET Web site.</span></span>
2. <span data-ttu-id="9a80d-269">Fügen Sie eine neue Datei "Web.config"-Datei hinzu.</span><span class="sxs-lookup"><span data-stu-id="9a80d-269">Add a new web.config file.</span></span>

    1. <span data-ttu-id="9a80d-270">Mit der rechten Maustaste auf das Projekt im Projektmappen-Explorer, und klicken Sie auf Neues Element hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="9a80d-270">Right-click on the project in Solution Explorer and click Add New Item.</span></span>
    2. <span data-ttu-id="9a80d-271">Wählen Sie die Webkonfigurationsdatei aus der Liste der Vorlagen aus, und klicken Sie auf Hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="9a80d-271">Choose Web Configuration File from the list of templates and click Add.</span></span>
3. <span data-ttu-id="9a80d-272">Bearbeiten der &lt;ConnectionStrings&gt; wie folgt:</span><span class="sxs-lookup"><span data-stu-id="9a80d-272">Edit the &lt;connectionStrings&gt; section as follows:</span></span> 

    [!code-aspx[Main](data-source-controls/samples/sample6.aspx)]
4. <span data-ttu-id="9a80d-273">Wechseln Sie zur Codeansicht und fügen Sie ein ConnectionString-Attribut und einem SelectCommand-Attribut, um die &lt;Asp: SqlDataSource&gt; steuern, wie folgt:</span><span class="sxs-lookup"><span data-stu-id="9a80d-273">Switch to Code view and add a ConnectionString attribute and a SelectCommand attribute to the &lt;asp:SqlDataSource&gt; control as follows:</span></span> 

    [!code-aspx[Main](data-source-controls/samples/sample7.aspx)]
5. <span data-ttu-id="9a80d-274">Fügen Sie ein neues GridView-Steuerelement hinzu, von der Entwurfsansicht.</span><span class="sxs-lookup"><span data-stu-id="9a80d-274">From Design view, add a new GridView control.</span></span>
6. <span data-ttu-id="9a80d-275">Wählen Sie aus der Dropdownliste "Datenquelle auswählen" im GridView-Aufgaben SqlDataSource1.</span><span class="sxs-lookup"><span data-stu-id="9a80d-275">From the Choose Data Source dropdown in the GridView Tasks menu, choose SqlDataSource1.</span></span>
7. <span data-ttu-id="9a80d-276">Mit der rechten Maustaste auf Default.aspx, und wählen Sie die im Browser anzeigen.</span><span class="sxs-lookup"><span data-stu-id="9a80d-276">Right-click on Default.aspx and choose View in Browser from the menu.</span></span> <span data-ttu-id="9a80d-277">Klicken Sie auf Ja, wenn Sie aufgefordert werden, um zu speichern.</span><span class="sxs-lookup"><span data-stu-id="9a80d-277">Click Yes when prompted to save.</span></span>
8. <span data-ttu-id="9a80d-278">Das GridView zeigt die Daten aus der Tabelle Products.</span><span class="sxs-lookup"><span data-stu-id="9a80d-278">The GridView displays the data from the Products table.</span></span>

## <a name="exercise-2---editing-data-with-the-sqldatasource-control"></a><span data-ttu-id="9a80d-279">Übung 2: Bearbeiten von Daten mit dem SqlDataSource-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="9a80d-279">Exercise 2 - Editing Data with the SqlDataSource Control</span></span>

<span data-ttu-id="9a80d-280">In der folgenden Übung zeigt, wie zur Datenbindung eine DropDownList steuern, mit der deklarativen Syntax und können Sie die Daten aus der DropDownList-Steuerelement zu bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="9a80d-280">The following exercise demonstrates how to data bind a DropDownList control using the declarative syntax and allows you to edit the data presented in the DropDownList control.</span></span>

1. <span data-ttu-id="9a80d-281">Löschen Sie in der Entwurfsansicht das GridView-Steuerelement aus "default.aspx" ein.</span><span class="sxs-lookup"><span data-stu-id="9a80d-281">In Design view, delete the GridView control from Default.aspx.</span></span> 

    <span data-ttu-id="9a80d-282">**Wichtige**: das SqlDataSource-Steuerelement auf der Seite zu verlassen.</span><span class="sxs-lookup"><span data-stu-id="9a80d-282">**Important**: Leave the SqlDataSource control on the page.</span></span>
2. <span data-ttu-id="9a80d-283">Fügen Sie ein DropDownList-Steuerelement an "default.aspx" ein.</span><span class="sxs-lookup"><span data-stu-id="9a80d-283">Add a DropDownList control to Default.aspx.</span></span>
3. <span data-ttu-id="9a80d-284">Wechseln Sie zur Quellansicht.</span><span class="sxs-lookup"><span data-stu-id="9a80d-284">Switch to Source view.</span></span>
4. <span data-ttu-id="9a80d-285">Hinzufügen ein Attributs DataSourceId DataTextField und DataValueField zur Verwendung der &lt;Asp: DropDownList&gt; steuern, wie folgt:</span><span class="sxs-lookup"><span data-stu-id="9a80d-285">Add a DataSourceId, DataTextField, and DataValueField attribute to the &lt;asp:DropDownList&gt; control as follows:</span></span> 

    [!code-aspx[Main](data-source-controls/samples/sample8.aspx)]
5. <span data-ttu-id="9a80d-286">Speichern Sie "default.aspx", und zeigen Sie ihn im Browser an.</span><span class="sxs-lookup"><span data-stu-id="9a80d-286">Save Default.aspx and view it in the browser.</span></span> <span data-ttu-id="9a80d-287">Beachten Sie, dass die DropDownList alle Produkte aus der Datenbank Northwind enthält.</span><span class="sxs-lookup"><span data-stu-id="9a80d-287">Note that the DropDownList contains all of the products from the Northwind database.</span></span>
6. <span data-ttu-id="9a80d-288">Schließen Sie den Browser.</span><span class="sxs-lookup"><span data-stu-id="9a80d-288">Close the browser.</span></span>
7. <span data-ttu-id="9a80d-289">Fügen Sie ein neues Textfeldsteuerelement unter das DropDownList-Steuerelement in der Quellansicht "default.aspx" hinzu.</span><span class="sxs-lookup"><span data-stu-id="9a80d-289">In Source view of Default.aspx, add a new TextBox control below the DropDownList control.</span></span> <span data-ttu-id="9a80d-290">Ändern Sie die ID-Eigenschaft des Textfelds in TxtProductName an.</span><span class="sxs-lookup"><span data-stu-id="9a80d-290">Change the ID property of the TextBox to txtProductName.</span></span>
8. <span data-ttu-id="9a80d-291">Fügen Sie eine neue Schaltflächen-Steuerelement hinzu, unter dem TextBox-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="9a80d-291">Under the TextBox control, add a new Button control.</span></span> <span data-ttu-id="9a80d-292">Ändern Sie die ID-Eigenschaft der Schaltfläche in BtnUpdate und der Text-Eigenschaft **Update Product Name**.</span><span class="sxs-lookup"><span data-stu-id="9a80d-292">Change the ID property of the Button to btnUpdate and the Text property to **Update Product Name**.</span></span>
9. <span data-ttu-id="9a80d-293">Fügen Sie das UpdateCommand-Eigenschaft und zwei neue UpdateParameters in der Quellansicht "default.aspx" wie folgt dem SqlDataSource-Steuerelement-Tag an:</span><span class="sxs-lookup"><span data-stu-id="9a80d-293">In Source view of Default.aspx, add an UpdateCommand property and two new UpdateParameters to the SqlDataSource tag as follows:</span></span> 

    [!code-aspx[Main](data-source-controls/samples/sample9.aspx)]

    > [!NOTE]
    > <span data-ttu-id="9a80d-294">Beachten Sie, dass es, dass zwei Parameter ("ProductName" und "ProductID") hinzugefügt, die in diesem Code aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="9a80d-294">Note that there are two update parameters (ProductName and ProductID) added in this code.</span></span> <span data-ttu-id="9a80d-295">Diese Parameter werden der Text-Eigenschaft der TxtProductName Textfeld und die SelectedValue-Eigenschaft der DropDownList DdlProducts zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="9a80d-295">These parameters are mapped to the Text property of the txtProductName TextBox and the SelectedValue property of the ddlProducts DropDownList.</span></span>
10. <span data-ttu-id="9a80d-296">Wechseln Sie zur Entwurfsansicht, und doppelklicken Sie auf das Schaltflächen-Steuerelement einen Ereignishandler hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="9a80d-296">Switch to Design view and double-click on the Button control to add an event handler.</span></span>
11. <span data-ttu-id="9a80d-297">Fügen Sie den folgenden Code, um die BtnUpdate\_klicken Sie auf Code:</span><span class="sxs-lookup"><span data-stu-id="9a80d-297">Add the following code to the btnUpdate\_Click code:</span></span> 

    [!code-csharp[Main](data-source-controls/samples/sample10.cs)]
12. <span data-ttu-id="9a80d-298">Mit der rechten Maustaste auf Default.aspx, und wählen sie im Browser anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="9a80d-298">Right-click on Default.aspx and choose to view it in the browser.</span></span> <span data-ttu-id="9a80d-299">Klicken Sie auf Ja, wenn Sie aufgefordert werden, um alle Änderungen zu speichern.</span><span class="sxs-lookup"><span data-stu-id="9a80d-299">Click Yes when prompted to save all changes.</span></span>
13. <span data-ttu-id="9a80d-300">ASP.NET 2.0 bei partiellen Klassen kann für die Kompilierung zur Laufzeit.</span><span class="sxs-lookup"><span data-stu-id="9a80d-300">ASP.NET 2.0 partial classes allow for compilation at runtime.</span></span> <span data-ttu-id="9a80d-301">Es ist nicht erforderlich, zum Erstellen einer Anwendung, um codeänderungen wirksam werden.</span><span class="sxs-lookup"><span data-stu-id="9a80d-301">It is not necessary to build an application in order to see code changes take effect.</span></span>
14. <span data-ttu-id="9a80d-302">Wählen Sie ein Produkt aus der Dropdownliste aus.</span><span class="sxs-lookup"><span data-stu-id="9a80d-302">Select a product from the DropDownList.</span></span>
15. <span data-ttu-id="9a80d-303">Geben Sie einen neuen Namen für das ausgewählte Produkt in das Textfeld ein, und klicken Sie dann auf die Schaltfläche "Aktualisieren".</span><span class="sxs-lookup"><span data-stu-id="9a80d-303">Enter a new name for the selected product in the TextBox and then click the Update button.</span></span>
16. <span data-ttu-id="9a80d-304">Der Name des Produkts wird in der Datenbank aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="9a80d-304">The product name is updated in the database.</span></span>

## <a name="exercise-3-using-the-objectdatasource-control"></a><span data-ttu-id="9a80d-305">Übung 3: verwenden das ObjectDataSource-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="9a80d-305">Exercise 3 Using the ObjectDataSource Control</span></span>

<span data-ttu-id="9a80d-306">In dieser Übung wird das ObjectDataSource-Steuerelement und ein Quellobjekt verwenden, um die Interaktion mit der Northwind-Datenbank veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="9a80d-306">This exercise will demonstrate how to use the ObjectDataSource control and a source object to interact with the Northwind database.</span></span>

1. <span data-ttu-id="9a80d-307">Mit der rechten Maustaste auf das Projekt im Projektmappen-Explorer, und klicken Sie auf Neues Element hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="9a80d-307">Right-click on the project in Solution Explorer and click on Add New Item.</span></span>
2. <span data-ttu-id="9a80d-308">Wählen Sie in der Vorlagenliste Web Form.</span><span class="sxs-lookup"><span data-stu-id="9a80d-308">Select Web Form in the templates list.</span></span> <span data-ttu-id="9a80d-309">Ändern Sie den Namen in object.aspx, und klicken Sie auf Hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="9a80d-309">Change the name to object.aspx and click Add.</span></span>
3. <span data-ttu-id="9a80d-310">Mit der rechten Maustaste auf das Projekt im Projektmappen-Explorer, und klicken Sie auf Neues Element hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="9a80d-310">Right-click on the project in Solution Explorer and click on Add New Item.</span></span>
4. <span data-ttu-id="9a80d-311">Wählen Sie in der Vorlagenliste Klasse.</span><span class="sxs-lookup"><span data-stu-id="9a80d-311">Select Class in the templates list.</span></span> <span data-ttu-id="9a80d-312">Ändern Sie den Namen der Klasse zu NorthwindData.cs, und klicken Sie auf Hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="9a80d-312">Change the name of the class to NorthwindData.cs and click Add.</span></span>
5. <span data-ttu-id="9a80d-313">Klicken Sie auf "Ja", wenn Sie aufgefordert werden, die Klasse der App hinzufügen\_Ordner "Code".</span><span class="sxs-lookup"><span data-stu-id="9a80d-313">Click Yes when prompted to add the class to the App\_Code folder.</span></span>
6. <span data-ttu-id="9a80d-314">Fügen Sie der NorthwindData.cs-Datei den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="9a80d-314">Add the following code to the NorthwindData.cs file:</span></span> 

    [!code-csharp[Main](data-source-controls/samples/sample11.cs)]
7. <span data-ttu-id="9a80d-315">Fügen Sie den folgenden Code zur Quellansicht des object.aspx:</span><span class="sxs-lookup"><span data-stu-id="9a80d-315">Add the following code to the Source view of object.aspx:</span></span> 

    [!code-aspx[Main](data-source-controls/samples/sample12.aspx)]
8. <span data-ttu-id="9a80d-316">Speichern Sie alle Dateien, und navigieren Sie object.aspx.</span><span class="sxs-lookup"><span data-stu-id="9a80d-316">Save all files and browse object.aspx.</span></span>
9. <span data-ttu-id="9a80d-317">Interagieren Sie mit der Schnittstelle, indem Sie Details anzeigen, bearbeiten die Mitarbeiter, Mitarbeiter hinzufügen und Löschen von Mitarbeitern.</span><span class="sxs-lookup"><span data-stu-id="9a80d-317">Interact with the interface by viewing details, editing employees, adding employees, and deleting employees.</span></span>
