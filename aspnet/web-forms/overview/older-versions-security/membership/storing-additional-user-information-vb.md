---
uid: web-forms/overview/older-versions-security/membership/storing-additional-user-information-vb
title: "Speichern von zusätzliche Benutzerinformationen (VB) | Microsoft Docs"
author: rick-anderson
description: "In diesem Lernprogramm werden wir diese Frage beantworten, durch das Erstellen einer Anwendung sehr rudimentär Gästebuch. In diesem Fall werden wir verschiedene Optionen für Modeli betrachten..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 01/18/2008
ms.topic: article
ms.assetid: ee4b924e-8002-4dc3-819f-695fca1ff867
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-security/membership/storing-additional-user-information-vb
msc.type: authoredcontent
ms.openlocfilehash: 8db63cb42fb04343150d2175a9d6fad1d5287a9b
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/10/2017
---
<a name="storing-additional-user-information-vb"></a><span data-ttu-id="fd7c5-104">Das Speichern von zusätzliche Benutzerinformationen (VB)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-104">Storing Additional User Information (VB)</span></span>
====================
<span data-ttu-id="fd7c5-105">durch [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="fd7c5-106">[Herunterladen von Code](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_08_VB.zip) oder [PDF herunterladen](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial08_ExtraUserInfo_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-106">[Download Code](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_08_VB.zip) or [Download PDF](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial08_ExtraUserInfo_vb.pdf)</span></span>

> <span data-ttu-id="fd7c5-107">In diesem Lernprogramm werden wir diese Frage beantworten, durch das Erstellen einer Anwendung sehr rudimentär Gästebuch.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-107">In this tutorial we will answer this question by building a very rudimentary guestbook application.</span></span> <span data-ttu-id="fd7c5-108">In diesem Fall werden wir sehen uns unterschiedliche Optionen für die Modellierung von Benutzerinformationen in einer Datenbank und klicken Sie dann Informationen, die Benutzerkonten, die vom Framework Mitgliedschaft erstellt diese Daten zugeordnet werden soll.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-108">In doing so, we will look at different options for modeling user information in a database, and then see how to associate this data with the user accounts created by the Membership framework.</span></span>


## <a name="introduction"></a><span data-ttu-id="fd7c5-109">Einführung</span><span class="sxs-lookup"><span data-stu-id="fd7c5-109">Introduction</span></span>

<span data-ttu-id="fd7c5-110">ASP IST. NET Mitgliedschaft Framework bietet eine flexible Benutzeroberfläche zum Verwalten von Benutzern.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-110">ASP.NET's Membership framework offers a flexible interface for managing users.</span></span> <span data-ttu-id="fd7c5-111">Die Mitgliedschaft-API umfasst Methoden für die Anmeldeinformationen überprüft, Abrufen von Informationen zu den derzeit angemeldeten Benutzer, ein neues Benutzerkonto erstellen und Löschen eines Benutzerkontos, unter anderem.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-111">The Membership API includes methods for validating credentials, retrieving information about the currently logged on user, creating a new user account, and deleting a user account, among others.</span></span> <span data-ttu-id="fd7c5-112">Jedes Benutzerkonto in Mitgliedschaft Framework enthält nur die Eigenschaften, die für die Überprüfung von Anmeldeinformationen und wichtige kontobezogene Benutzeraufgaben Ausführen benötigt.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-112">Each user account in the Membership framework contains only the properties needed for validating credentials and performing essential user account-related tasks.</span></span> <span data-ttu-id="fd7c5-113">Dies wird durch die Methoden und Eigenschaften der entspricht der [ `MembershipUser` Klasse](https://msdn.microsoft.com/en-us/library/system.web.security.membershipuser.aspx), das ein Benutzerkonto in das Framework Mitgliedschaft modelliert.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-113">This is evidenced by the methods and properties of the [`MembershipUser` class](https://msdn.microsoft.com/en-us/library/system.web.security.membershipuser.aspx), which models a user account in the Membership framework.</span></span> <span data-ttu-id="fd7c5-114">Diese Klasse verfügt über Eigenschaften, z. B. [ `UserName` ](https://msdn.microsoft.com/en-us/library/system.web.security.membershipuser.username.aspx), [ `Email` ](https://msdn.microsoft.com/en-us/library/system.web.security.membershipuser.email.aspx), und [ `IsLockedOut` ](https://msdn.microsoft.com/en-us/library/system.web.security.membershipuser.islockedout.aspx), und Methoden wie [ `GetPassword` ](https://msdn.microsoft.com/en-us/library/system.web.security.membershipuser.getpassword.aspx) und [ `UnlockUser` ](https://msdn.microsoft.com/en-us/library/system.web.security.membershipuser.unlockuser.aspx).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-114">This class has properties like [`UserName`](https://msdn.microsoft.com/en-us/library/system.web.security.membershipuser.username.aspx), [`Email`](https://msdn.microsoft.com/en-us/library/system.web.security.membershipuser.email.aspx), and [`IsLockedOut`](https://msdn.microsoft.com/en-us/library/system.web.security.membershipuser.islockedout.aspx), and methods like [`GetPassword`](https://msdn.microsoft.com/en-us/library/system.web.security.membershipuser.getpassword.aspx) and [`UnlockUser`](https://msdn.microsoft.com/en-us/library/system.web.security.membershipuser.unlockuser.aspx).</span></span>

<span data-ttu-id="fd7c5-115">Anwendungen müssen häufig, nicht in die Mitgliedschaft Framework enthalten zusätzliche Benutzerinformationen zu speichern.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-115">Oftentimes, applications need to store additional user information not included in the Membership framework.</span></span> <span data-ttu-id="fd7c5-116">Beispielsweise kann ein müssen kann jeder Benutzer speichern ihre Liefer-und Rechnungsadresse, die Zahlungsinformationen, die Einstellungen für die Übermittlung "und" Kontakt Telefonnummer.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-116">For example, an online retailer might need to let each user store her shipping and billing addresses, payment information, delivery preferences, and contact phone number.</span></span> <span data-ttu-id="fd7c5-117">Darüber hinaus ist jede Bestellung in das System mit einem bestimmten Benutzerkonto verknüpft.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-117">Furthermore, each order in the system is associated with a particular user account.</span></span>

<span data-ttu-id="fd7c5-118">Die `MembershipUser` Klasse enthält keine Eigenschaften, z. B. `PhoneNumber` oder `DeliveryPreferences` oder `PastOrders`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-118">The `MembershipUser` class does not include properties like `PhoneNumber` or `DeliveryPreferences` or `PastOrders`.</span></span> <span data-ttu-id="fd7c5-119">Wie wir überwachen die Benutzerinformationen von der Anwendung benötigt werden und mit Mitgliedschaft Framework integrieren lassen?</span><span class="sxs-lookup"><span data-stu-id="fd7c5-119">So how do we track the user information needed by the application and have it integrate with the Membership framework?</span></span> <span data-ttu-id="fd7c5-120">In diesem Lernprogramm werden wir diese Frage beantworten, durch das Erstellen einer Anwendung sehr rudimentär Gästebuch.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-120">In this tutorial we will answer this question by building a very rudimentary guestbook application.</span></span> <span data-ttu-id="fd7c5-121">In diesem Fall werden wir sehen uns unterschiedliche Optionen für die Modellierung von Benutzerinformationen in einer Datenbank und klicken Sie dann Informationen, die Benutzerkonten, die vom Framework Mitgliedschaft erstellt diese Daten zugeordnet werden soll.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-121">In doing so, we will look at different options for modeling user information in a database, and then see how to associate this data with the user accounts created by the Membership framework.</span></span> <span data-ttu-id="fd7c5-122">Fangen wir an!</span><span class="sxs-lookup"><span data-stu-id="fd7c5-122">Let's get started!</span></span>

## <a name="step-1-creating-the-guestbook-applications-data-model"></a><span data-ttu-id="fd7c5-123">Schritt 1: Erstellen der Anwendung Gästebuch Datenmodell</span><span class="sxs-lookup"><span data-stu-id="fd7c5-123">Step 1: Creating the Guestbook Application's Data Model</span></span>

<span data-ttu-id="fd7c5-124">Es gibt eine Vielzahl von Techniken, die zum Erfassen von Benutzerinformationen in einer Datenbank und die Benutzerkonten, die vom Framework Mitgliedschaft erstellt zuordnen verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-124">There are a variety of techniques that can be employed to capture user information in a database and associate it with the user accounts created by the Membership framework.</span></span> <span data-ttu-id="fd7c5-125">Um diese Verfahren zu veranschaulichen, müssen wir die Lernprogramm Web-Anwendung zu erweitern, damit sie irgendeine der benutzerspezifischen Daten erfasst.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-125">In order to illustrate these techniques, we will need to augment the tutorial web application so that it captures some sort of user-related data.</span></span> <span data-ttu-id="fd7c5-126">(Derzeit Datenmodell für die Anwendung enthält, nur die Anwendungsdienste Tabellen erforderlich sind, indem Sie die `SqlMembershipProvider`.)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-126">(Currently, the application's data model contains only the application services tables needed by the `SqlMembershipProvider`.)</span></span>

<span data-ttu-id="fd7c5-127">Erstellen wir eine sehr einfache Gästebuch-Anwendung, in dem ein authentifizierter Benutzer einen Kommentar abzugeben kann.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-127">Let's create a very simple guestbook application where an authenticated user can leave a comment.</span></span> <span data-ttu-id="fd7c5-128">Zusätzlich zum Speichern von Gästebuchkommentaren, ermöglichen Sie wir jedem Benutzer seine home Stadt, die Startseite und die Signatur zu speichern.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-128">In addition to storing guestbook comments, let's allow each user to store his home town, homepage, and signature.</span></span> <span data-ttu-id="fd7c5-129">Wenn angegeben, home Stadt des Benutzers, wird zur Startseite und Signatur für jede Nachricht angezeigt, die er angezeigten verlassen hat.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-129">If provided, the user's home town, homepage, and signature will appear on each message he has left in the guestbook.</span></span>

### <a name="adding-theguestbookcommentstable"></a><span data-ttu-id="fd7c5-130">Hinzufügen der`GuestbookComments`Tabelle</span><span class="sxs-lookup"><span data-stu-id="fd7c5-130">Adding the`GuestbookComments`Table</span></span>

<span data-ttu-id="fd7c5-131">Um die Gästebuchkommentaren erfassen möchten, müssen wir eine Datenbanktabelle mit dem Namen können `GuestbookComments` Spalten wie dessen `CommentId`, `Subject`, `Body`, und `CommentDate`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-131">In order to capture the guestbook comments, we need to create a database table named `GuestbookComments` that has columns like `CommentId`, `Subject`, `Body`, and `CommentDate`.</span></span> <span data-ttu-id="fd7c5-132">Außerdem müssen wir jeden Datensatz der `GuestbookComments` Tabelle Verweis der Benutzer, den Kommentar zu verlassen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-132">We also need to have each record in the `GuestbookComments` table reference the user who left the comment.</span></span>

<span data-ttu-id="fd7c5-133">Um die Datenbank in dieser Tabelle hinzugefügt haben, fahren Sie mit der Datenbank-Explorer in Visual Studio und Drilldown in die `SecurityTutorials` Datenbank.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-133">To add this table to our database, go to the Database Explorer in Visual Studio and drill down into the `SecurityTutorials` database.</span></span> <span data-ttu-id="fd7c5-134">Mit der rechten Maustaste auf den Ordner Tabellen, und wählen Sie die neue Tabelle hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-134">Right-click on the Tables folder and choose Add New Table.</span></span> <span data-ttu-id="fd7c5-135">Daraufhin wird eine Schnittstelle, die zum Definieren der Spalten für die neue Tabelle ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-135">This brings up an interface that allows us to define the columns for the new table.</span></span>


<span data-ttu-id="fd7c5-136">[![Hinzufügen einer neuen Tabelle in der Datenbank SecurityTutorials](storing-additional-user-information-vb/_static/image2.png)](storing-additional-user-information-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-136">[![Add a New Table to the SecurityTutorials Database](storing-additional-user-information-vb/_static/image2.png)](storing-additional-user-information-vb/_static/image1.png)</span></span>

<span data-ttu-id="fd7c5-137">**Abbildung 1**: Hinzufügen einer neuen Tabelle an die `SecurityTutorials` Datenbank ([klicken Sie hier, um das Bild in voller Größe angezeigt](storing-additional-user-information-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="fd7c5-137">**Figure 1**: Add a New Table to the `SecurityTutorials` Database  ([Click to view full-size image](storing-additional-user-information-vb/_static/image3.png))</span></span>


<span data-ttu-id="fd7c5-138">Als Nächstes definieren Sie die `GuestbookComments`Spalten.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-138">Next, define the `GuestbookComments`'s columns.</span></span> <span data-ttu-id="fd7c5-139">Starten Sie durch Hinzufügen einer Spalte mit dem Namen `CommentId` vom Typ `uniqueidentifier`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-139">Start by adding a column named `CommentId` of type `uniqueidentifier`.</span></span> <span data-ttu-id="fd7c5-140">Diese Spalte wird eindeutig identifizieren jede Kommentar im angezeigten, also zu unterbinden `NULL` s und kennzeichnen Sie es als Primärschlüssel der Tabelle.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-140">This column will uniquely identify each comment in the guestbook, so disallow `NULL` s and mark it as the table's primary key.</span></span> <span data-ttu-id="fd7c5-141">Anstatt bereitzustellen, das einen Wert für die `CommentId` für jedes Feld `INSERT`, es kann darauf hinweisen, die ein neues `uniqueidentifier` -Wert sollte automatisch generiert für dieses Feld auf `INSERT` durch Festlegen der Standardwert der Spalte auf `NEWID()`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-141">Rather than providing a value for the `CommentId` field on each `INSERT`, we can indicate that a new `uniqueidentifier` value should be automatically generated for this field on `INSERT` by setting the column's default value to `NEWID()`.</span></span> <span data-ttu-id="fd7c5-142">Nach dem Hinzufügen dieses ersten Feld, markieren es als die primary key- und die Einstellungen für den Standardwert sollte der Bildschirm in Abbildung 2 dargestellte Screenshot ähneln.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-142">After adding this first field, marking it as the primary key, and settings its default value, your screen should look similar to the screen shot shown in Figure 2.</span></span>


<span data-ttu-id="fd7c5-143">[![Fügen Sie eine Primärschlüsselspalte mit dem Namen CommentId hinzu.](storing-additional-user-information-vb/_static/image5.png)](storing-additional-user-information-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-143">[![Add a Primary Column Named CommentId](storing-additional-user-information-vb/_static/image5.png)](storing-additional-user-information-vb/_static/image4.png)</span></span>

<span data-ttu-id="fd7c5-144">**Abbildung 2**: Hinzufügen einer primären Spalte mit dem Namen `CommentId` ([klicken Sie hier, um das Bild in voller Größe angezeigt](storing-additional-user-information-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="fd7c5-144">**Figure 2**: Add a Primary Column Named `CommentId` ([Click to view full-size image](storing-additional-user-information-vb/_static/image6.png))</span></span>


<span data-ttu-id="fd7c5-145">Fügen Sie eine Spalte mit dem Namen `Subject` des Typs `nvarchar(50)` und eine Spalte mit dem Namen `Body` des Typs `nvarchar(MAX)`, Deaktivierung `NULL` s in beide Spalten.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-145">Next, add a column named `Subject` of type `nvarchar(50)` and a column named `Body` of type `nvarchar(MAX)`, disallowing `NULL` s in both columns.</span></span> <span data-ttu-id="fd7c5-146">Danach fügen Sie eine Spalte mit dem Namen `CommentDate` vom Typ `datetime`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-146">Following that, add a column named `CommentDate` of type `datetime`.</span></span> <span data-ttu-id="fd7c5-147">Unterbinden `NULL` s und legen die `CommentDate` Standardwert der Spalte `getdate()`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-147">Disallow `NULL` s and set the `CommentDate` column's default value to `getdate()`.</span></span>

<span data-ttu-id="fd7c5-148">Übrig bleibt, eine Spalte hinzuzufügen, die ein Benutzerkonto mit jeder Gästebuch Kommentar zuordnet.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-148">All that remains is to add a column that associates a user account with each guestbook comment.</span></span> <span data-ttu-id="fd7c5-149">Eine Option zum Hinzufügen einer Spalte mit dem Namen wäre `UserName` vom Typ `nvarchar(256)`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-149">One option would be to add a column named `UserName` of type `nvarchar(256)`.</span></span> <span data-ttu-id="fd7c5-150">Dies ist angemessen, wenn mithilfe von einem Mitgliedschaftsanbieter außer der `SqlMembershipProvider`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-150">This is a suitable choice when using a Membership provider other than the `SqlMembershipProvider`.</span></span> <span data-ttu-id="fd7c5-151">Aber bei Verwendung der `SqlMembershipProvider`, wie in diesem Lernprogramm Reihe werden die `UserName` Spalte in der `aspnet_Users` Tabelle ist nicht unbedingt eindeutig.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-151">But when using the `SqlMembershipProvider`, as we are in this tutorial series, the `UserName` column in the `aspnet_Users` table is not guaranteed to be unique.</span></span> <span data-ttu-id="fd7c5-152">Die `aspnet_Users` ist der Primärschlüssel der Tabelle `UserId` und Typ `uniqueidentifier`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-152">The `aspnet_Users` table's primary key is `UserId` and is of type `uniqueidentifier`.</span></span> <span data-ttu-id="fd7c5-153">Aus diesem Grund die `GuestbookComments` Tabelle benötigt eine Spalte mit dem Namen `UserId` des Typs `uniqueidentifier` (untersagen `NULL` Werte).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-153">Therefore, the `GuestbookComments` table needs a column named `UserId` of type `uniqueidentifier` (disallowing `NULL` values).</span></span> <span data-ttu-id="fd7c5-154">Fahren Sie fort, und fügen Sie diese Spalte hinzu.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-154">Go ahead and add this column.</span></span>

> [!NOTE]
> <span data-ttu-id="fd7c5-155">Wie in erläutert die [ *erstellen das Schema für die Mitgliedschaft in SQL Server* ](creating-the-membership-schema-in-sql-server-vb.md) Lernprogramm, das Mitgliedschaft Framework wurde entworfen, um mehrere Webanwendungen unterschiedliche Benutzerkonten, die denselben zu aktivieren Benutzerspeicher.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-155">As we discussed in the [*Creating the Membership Schema in SQL Server*](creating-the-membership-schema-in-sql-server-vb.md) tutorial, the Membership framework is designed to enable multiple web applications with different user accounts to share the same user store.</span></span> <span data-ttu-id="fd7c5-156">Dies geschieht durch das Partitionieren von Benutzerkonten in verschiedenen Anwendungen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-156">It does this by partitioning user accounts into different applications.</span></span> <span data-ttu-id="fd7c5-157">Und zwar alle Benutzernamen innerhalb einer Anwendung eindeutig ist unbedingt, kann der gleiche Benutzername in anderen Anwendungen, die mit den gleichen Speicher des Benutzers verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-157">And while each username is guaranteed to be unique within an application, the same username may be used in different applications using the same user store.</span></span> <span data-ttu-id="fd7c5-158">Es ist ein zusammengesetzter `UNIQUE` -Einschränkung in der `aspnet_Users` -Tabelle auf die `UserName` und `ApplicationId` Felder, aber keiner auf nur die `UserName` Feld.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-158">There is a composite `UNIQUE` constraint in the `aspnet_Users` table on the `UserName` and `ApplicationId` fields, but not one on just the `UserName` field.</span></span> <span data-ttu-id="fd7c5-159">Daher ist es möglich, dass das Aspnet\_Tabelle haben Sie zwei (oder mehr) Datensätze mit dem gleichen Benutzer `UserName` Wert.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-159">Consequently, it is possible for the aspnet\_Users table to have two (or more) records with the same `UserName` value.</span></span> <span data-ttu-id="fd7c5-160">Vorhanden ist, jedoch eine `UNIQUE` -Einschränkung für die `aspnet_Users` tabellenspezifischen `UserId` Feld (da es sich um den Primärschlüssel handelt).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-160">There is, however, a `UNIQUE` constraint on the `aspnet_Users` table's `UserId` field (since it is the primary key).</span></span> <span data-ttu-id="fd7c5-161">Ein `UNIQUE` Einschränkung ist wichtig, da ohne wir eine foreign Key-Einschränkung zwischen herstellen kann die `GuestbookComments` und `aspnet_Users` Tabellen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-161">A `UNIQUE` constraint is important because without it we cannot establish a foreign key constraint between the `GuestbookComments` and `aspnet_Users` tables.</span></span>


<span data-ttu-id="fd7c5-162">Nach dem Hinzufügen der `UserId` Spalte Speichern der Tabelle durch Klicken auf das Symbol "Speichern" in der Symbolleiste.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-162">After adding the `UserId` column, save the table by clicking on the Save icon in the Toolbar.</span></span> <span data-ttu-id="fd7c5-163">Benennen Sie die neue Tabelle `GuestbookComments`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-163">Name the new table `GuestbookComments`.</span></span>

<span data-ttu-id="fd7c5-164">Wir haben eine letzte Problem teilnehmen, mit der `GuestbookComments` Tabelle: Wir erstellen müssen eine [foreign Key-Einschränkung](https://msdn.microsoft.com/en-us/library/ms175464.aspx) zwischen der `GuestbookComments.UserId` Spalte und die `aspnet_Users.UserId` Spalte.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-164">We have one last issue to attend to with the `GuestbookComments` table: we need to create a [foreign key constraint](https://msdn.microsoft.com/en-us/library/ms175464.aspx) between the `GuestbookComments.UserId` column and the `aspnet_Users.UserId` column.</span></span> <span data-ttu-id="fd7c5-165">Um dies zu erreichen, klicken Sie auf das Symbol "Beziehung" in der Symbolleiste, um das Dialogfeld Foreign Key Relationships aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-165">To achieve this, click the Relationship icon in the Toolbar to launch the Foreign Key Relationships dialog box.</span></span> <span data-ttu-id="fd7c5-166">(Alternativ können Sie dieses Dialogfeld starten, indem im Begriff, das Menü Tabellen-Designer und Beziehungen auswählen.)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-166">(Alternatively, you can launch this dialog box by going to the Table Designer menu and choosing Relationships.)</span></span>

<span data-ttu-id="fd7c5-167">Klicken Sie auf die Schaltfläche "hinzufügen" in der unteren linken Ecke des Dialogfelds Foreign Key Relationships.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-167">Click the Add button in the lower left corner of the Foreign Key Relationships dialog box.</span></span> <span data-ttu-id="fd7c5-168">Dadurch wird eine neue foreign Key-Einschränkung, hinzugefügt, obwohl wir noch benötigen, definieren Sie die Tabellen, die einbezogen, in der Beziehung.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-168">This will add a new foreign key constraint, although we still need to define the tables that participate in the relationship.</span></span>


<span data-ttu-id="fd7c5-169">[![Verwenden Sie das Dialogfeld Fremdschlüssel-Beziehungen, um eine Tabelle Foreign Key-Einschränkungen zu verwalten](storing-additional-user-information-vb/_static/image8.png)](storing-additional-user-information-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-169">[![Use the Foreign Key Relationships Dialog Box to Manage a Table's Foreign Key Constraints](storing-additional-user-information-vb/_static/image8.png)](storing-additional-user-information-vb/_static/image7.png)</span></span>

<span data-ttu-id="fd7c5-170">**Abbildung 3**: Verwenden Sie das Dialogfeld Foreign Key-Beziehungen zum Verwalten einer Tabelle Foreign Key-Einschränkungen ([klicken Sie hier, um das Bild in voller Größe angezeigt](storing-additional-user-information-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="fd7c5-170">**Figure 3**: Use the Foreign Key Relationships Dialog Box to Manage a Table's Foreign Key Constraints  ([Click to view full-size image](storing-additional-user-information-vb/_static/image9.png))</span></span>


<span data-ttu-id="fd7c5-171">Klicken Sie dann auf das Symbol "Ellipse" in der Zeile "Tabelle und Spaltenspezifikation" auf der rechten Seite.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-171">Next, click the ellipses icon in the "Table and Columns Specifications" row on the right.</span></span> <span data-ttu-id="fd7c5-172">Hierdurch wird das Dialogfeld Tabellen und Spalten, aus dem können wir an der Primärschlüsseltabelle und die Spalte und die Fremdschlüsselspalte aus der `GuestbookComments` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-172">This will launch the Tables and Columns dialog box, from which we can specify the primary key table and column and the foreign key column from the `GuestbookComments` table.</span></span> <span data-ttu-id="fd7c5-173">Wählen Sie insbesondere `aspnet_Users` und `UserId` als die Primärschlüsseltabelle und die Spalte, und `UserId` aus der `GuestbookComments` Tabelle als Fremdschlüsselspalte (siehe Abbildung 4).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-173">In particular, select `aspnet_Users` and `UserId` as the primary key table and column, and `UserId` from the `GuestbookComments` table as the foreign key column (see Figure 4).</span></span> <span data-ttu-id="fd7c5-174">Nach dem Definieren der Primär- und Fremdschlüssel Key Tabellen und Spalten, klicken Sie auf OK, um das Dialogfeld Foreign Key Relationships zurückzukehren.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-174">After defining the primary and foreign key tables and columns, click OK to return to the Foreign Key Relationships dialog box.</span></span>


<span data-ttu-id="fd7c5-175">[![Richten Sie eine Foreign Key-Einschränkung zwischen der Aspnet_Users und GuesbookComments Tabellen](storing-additional-user-information-vb/_static/image11.png)](storing-additional-user-information-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-175">[![Establish a Foreign Key Constraint Between the aspnet_Users and GuesbookComments Tables](storing-additional-user-information-vb/_static/image11.png)](storing-additional-user-information-vb/_static/image10.png)</span></span>

<span data-ttu-id="fd7c5-176">**Abbildung 4**: Einrichten einer Foreign Key-Einschränkung zwischen den `aspnet_Users` und `GuesbookComments` Tabellen ([klicken Sie hier, um das Bild in voller Größe angezeigt](storing-additional-user-information-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="fd7c5-176">**Figure 4**: Establish a Foreign Key Constraint Between the `aspnet_Users` and `GuesbookComments` Tables  ([Click to view full-size image](storing-additional-user-information-vb/_static/image12.png))</span></span>


<span data-ttu-id="fd7c5-177">An diesem Punkt hat die foreign Key-Einschränkung eingerichtet wurde.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-177">At this point the foreign key constraint has been established.</span></span> <span data-ttu-id="fd7c5-178">Das Vorhandensein dieser Einschränkung wird sichergestellt, dass [relationale Integrität](http://en.wikipedia.org/wiki/Referential_integrity) zwischen den beiden Tabellen und garantiert ist, dass es nie ein Gästebuch-Eintrag verweist auf ein nicht vorhandenes Benutzerkonto an.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-178">The presence of this constraint ensures [relational integrity](http://en.wikipedia.org/wiki/Referential_integrity) between the two tables by guaranteeing that there will never be a guestbook entry referring to a non-existent user account.</span></span> <span data-ttu-id="fd7c5-179">Eine foreign Key-Einschränkung wird standardmäßig einen übergeordneter Datensatz gelöscht werden soll, wenn der entsprechende untergeordnete Datensätze unterbinden.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-179">By default, a foreign key constraint will disallow a parent record to be deleted if there are corresponding child records.</span></span> <span data-ttu-id="fd7c5-180">Also wird ein Benutzer ändert eine oder mehrere Gästebuchkommentaren, und klicken Sie dann versuchen, dieses Benutzerkonto löschen, der Löschvorgang fehl, wenn seine Gästebuchkommentaren zuerst gelöscht werden.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-180">That is, if a user makes one or more guestbook comments, and then we attempt to delete that user account, the delete will fail unless his guestbook comments are deleted first.</span></span>

<span data-ttu-id="fd7c5-181">Foreign Key-Einschränkungen können konfiguriert werden, um die zugehörigen untergeordneten Datensätze automatisch zu löschen, wenn ein übergeordneter Datensatz gelöscht wird.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-181">Foreign key constraints can be configured to automatically delete the associated child records when a parent record is deleted.</span></span> <span data-ttu-id="fd7c5-182">Das heißt, können wir diese foreign Key-Einschränkung einrichten, damit ein Benutzer Gästebuch Einträge automatisch gelöscht werden, wenn ihr Benutzerkonto gelöscht wird.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-182">In other words, we can setup this foreign key constraint so that a user's guestbook entries are automatically deleted when her user account is deleted.</span></span> <span data-ttu-id="fd7c5-183">Um dies zu erreichen, erweitern Sie den Abschnitt "INSERT und UPDATE-Spezifikation", und legen Sie die Eigenschaft "Regel löschen", um Cascade.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-183">To accomplish this, expand the "INSERT And UPDATE Specification" section and set the "Delete Rule" property to Cascade.</span></span>


<span data-ttu-id="fd7c5-184">[![Konfigurieren Sie die Foreign Key-Einschränkung auf kaskadierte Löschvorgänge](storing-additional-user-information-vb/_static/image14.png)](storing-additional-user-information-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-184">[![Configure the Foreign Key Constraint to Cascade Deletes](storing-additional-user-information-vb/_static/image14.png)](storing-additional-user-information-vb/_static/image13.png)</span></span>

<span data-ttu-id="fd7c5-185">**Abbildung 5**: Konfigurieren der Foreign Key-Einschränkung auf Löschweitergaben ([klicken Sie hier, um das Bild in voller Größe angezeigt](storing-additional-user-information-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="fd7c5-185">**Figure 5**: Configure the Foreign Key Constraint to Cascade Deletes  ([Click to view full-size image](storing-additional-user-information-vb/_static/image15.png))</span></span>


<span data-ttu-id="fd7c5-186">Um die foreign Key-Einschränkung zu speichern, klicken Sie auf die Schaltfläche "Schließen", um die Foreign Key Relationships zu beenden.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-186">To save the foreign key constraint, click the Close button to exit out of the Foreign Key Relationships.</span></span> <span data-ttu-id="fd7c5-187">Klicken Sie dann auf das Symbol "Speichern" in der Symbolleiste, um die Tabelle und der this speichern Beziehung.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-187">Then click the Save icon in the Toolbar to save the table and the this relationship.</span></span>

### <a name="storing-the-users-home-town-homepage-and-signature"></a><span data-ttu-id="fd7c5-188">Speichern des Benutzers Home Örtlichkeit Homepage und Signatur</span><span class="sxs-lookup"><span data-stu-id="fd7c5-188">Storing the User's Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="fd7c5-189">Die `GuestbookComments` Tabelle veranschaulicht, wie zum Speichern von Informationen, die eine 1: n-Beziehung und Benutzerkonten gemeinsam verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-189">The `GuestbookComments` table illustrates how to store information that shares a one-to-many relationship with user accounts.</span></span> <span data-ttu-id="fd7c5-190">Da jedes Benutzerkonto kann eine beliebige Anzahl von zugehörigen Kommentare muss, wird diese Beziehung modelliert, durch das Erstellen einer Tabelle zum Speichern von des Satz von Kommentaren, der eine Spalte enthält, dass jeder Kommentar zurück auf einen bestimmten Benutzer verweist.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-190">Since each user account may have an arbitrary number of associated comments, this relationship is modeled by creating a table to hold the set of comments that includes a column that links back each comment to a particular user.</span></span> <span data-ttu-id="fd7c5-191">Bei Verwendung der `SqlMembershipProvider`, diesen Link wird am besten durch Erstellen einer Spalte mit dem Namen eingerichtet `UserId` des Typs `uniqueidentifier` und zwischen dieser Spalte einer foreign Key-Einschränkung und `aspnet_Users.UserId`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-191">When using the `SqlMembershipProvider`, this link is best established by creating a column named `UserId` of type `uniqueidentifier` and a foreign key constraint between this column and `aspnet_Users.UserId`.</span></span>

<span data-ttu-id="fd7c5-192">Jetzt müssen wir jedes Benutzerkonto zum Speichern des Benutzers home Örtlichkeit Homepage und Signatur, die in seinem Gästebuchkommentaren angezeigt werden drei Spalten zuordnen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-192">We now need to associate three columns with each user account to store the user's home town, homepage, and signature, which will appear in his guestbook comments.</span></span> <span data-ttu-id="fd7c5-193">Es gibt Anzahl von Möglichkeiten, dies zu erreichen:</span><span class="sxs-lookup"><span data-stu-id="fd7c5-193">There are number of different ways to accomplish this:</span></span>

- <span data-ttu-id="fd7c5-194">**Hinzufügen von neuen Spalten mit den ***`aspnet_Users`*** oder ***`aspnet_Membership`*** Tabellen.**</span><span class="sxs-lookup"><span data-stu-id="fd7c5-194">**Add new columns to the****`aspnet_Users`****or****`aspnet_Membership`****tables.**</span></span> <span data-ttu-id="fd7c5-195">Ich würde dieser Ansatz nicht empfohlen, da es sich um das von verwendete Schema ändert die `SqlMembershipProvider`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-195">I would not recommend this approach because it modifies the schema used by the `SqlMembershipProvider`.</span></span> <span data-ttu-id="fd7c5-196">Diese Entscheidung kann zurückkehren, um Sie dem Weg zu entsorgen werden.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-196">This decision may come back to haunt you down the road.</span></span> <span data-ttu-id="fd7c5-197">Was geschieht, wenn eine zukünftige Version von ASP.NET ein anderes verwendet beispielsweise `SqlMembershipProvider` Schema.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-197">For example, what if a future version of ASP.NET uses a different `SqlMembershipProvider` schema.</span></span> <span data-ttu-id="fd7c5-198">Microsoft ist eventuell ein Tool zum Migrieren von ASP.NET 2.0 `SqlMembershipProvider` Daten auf das neue Schema, aber wenn Sie die ASP.NET 2.0 vorgenommenen `SqlMembershipProvider` Schema, eine solche Konvertierung möglicherweise nicht möglich.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-198">Microsoft may include a tool to migrate the ASP.NET 2.0 `SqlMembershipProvider` data to the new schema, but if you have modified the ASP.NET 2.0 `SqlMembershipProvider` schema, such a conversion may not be possible.</span></span>

- <span data-ttu-id="fd7c5-199">**Verwenden von ASP. NET Profil Framework eine Profileigenschaft für home Örtlichkeit, Homepage und Signatur definieren.**</span><span class="sxs-lookup"><span data-stu-id="fd7c5-199">**Use ASP.NET's Profile framework, defining a profile property for the home town, homepage, and signature.**</span></span> <span data-ttu-id="fd7c5-200">ASP.NET umfasst ein Profil-Framework, das entworfen wurde, um zusätzliche benutzerspezifische Daten zu speichern.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-200">ASP.NET includes a Profile framework that is designed to store additional user-specific data.</span></span> <span data-ttu-id="fd7c5-201">Wie das Framework Mitgliedschaft wird das Profil Framework Anbietermodell erstellt.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-201">Like the Membership framework, the Profile framework is built atop the provider model.</span></span> <span data-ttu-id="fd7c5-202">Lieferumfang von .NET Framework eine `SqlProfileProvider` , speichert Daten in einer SQL Server-Datenbank ein Profil erstellen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-202">The .NET Framework ships with a `SqlProfileProvider` that stores profile data in a SQL Server database.</span></span> <span data-ttu-id="fd7c5-203">Tatsächlich verwendet die Datenbank bereits die verwendete Tabelle der `SqlProfileProvider` (`aspnet_Profile`), wie er hinzugefügt wurde, wenn wir hinzugefügt, sichern die Anwendungsdienste der [ *erstellen das Schema für die Mitgliedschaft in SQL Server* ](creating-the-membership-schema-in-sql-server-vb.md)Lernprogramm.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-203">In fact, our database already has the table used by the `SqlProfileProvider` (`aspnet_Profile`), as it was added when we added the application services back in the [*Creating the Membership Schema in SQL Server*](creating-the-membership-schema-in-sql-server-vb.md) tutorial.</span></span>   
 <span data-ttu-id="fd7c5-204">Der wichtigste Vorteil von der Profil-Framework ist, dass es Entwicklern, definieren Sie die Profileigenschaften in zulässt `Web.config` – kein Code geschrieben werden, um die Profildaten in und aus den zugrunde liegenden Datenspeicher serialisieren muss.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-204">The main benefit of the Profile framework is that it allows for developers to define the profile properties in `Web.config` – no code needs to be written to serialize the profile data to and from the underlying data store.</span></span> <span data-ttu-id="fd7c5-205">Kurz gesagt, ist es äußerst einfach, eine Reihe von Profileigenschaften definieren und im Code arbeiten.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-205">In short, it is incredibly easy to define a set of profile properties and to work with them in code.</span></span> <span data-ttu-id="fd7c5-206">Das Profilsystem hinterlässt jedoch viel wünschenswert sein, bei der versionsverwaltung verwendet, wenn Sie verfügen über eine Anwendung, in denen Sie erwarten, dass neue benutzerspezifische Eigenschaften hinzugefügt werden, bei einem späteren Zeitpunkt oder vorhandene entfernt oder geändert werden, und klicken Sie dann die Profil-Framework möglicherweise nicht, die  beste Option.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-206">However, the Profile system leaves a lot to be desired when it comes to versioning, so if you have an application where you expect new user-specific properties to be added at a later time, or existing ones to be removed or modified, then the Profile framework may not be the best option.</span></span> <span data-ttu-id="fd7c5-207">Darüber hinaus die `SqlProfileProvider` speichert die Profileigenschaften in einer hochgradig denormalisierten Weise, somit unmöglich zum Ausführen von Abfragen direkt gegen die Profildaten (z. B. wie viele Benutzer eine home Örtlichkeit von New York haben).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-207">Moreover, the `SqlProfileProvider` stores the profile properties in a highly denormalized fashion, making it next to impossible to run queries directly against the profile data (such as, how many users have a home town of New York).</span></span>   
 <span data-ttu-id="fd7c5-208">Weitere Informationen über das Profil-Framework finden Sie im Abschnitt "Weitere Messwerte" am Ende dieses Lernprogramms.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-208">For more information on the Profile framework, consult the "Further Readings" section at the end of this tutorial.</span></span>

- <span data-ttu-id="fd7c5-209">**Fügen Sie diese drei Spalten in eine neue Tabelle in der Datenbank und eine 1: 1 Beziehung zwischen dieser Tabelle herstellen und ***`aspnet_Users`***.**</span><span class="sxs-lookup"><span data-stu-id="fd7c5-209">**Add these three columns to a new table in the database and establish a one-to-one relationship between this table and****`aspnet_Users`****.**</span></span> <span data-ttu-id="fd7c5-210">Dieser Ansatz umfasst mehr als arbeiten mit dem Profil-Framework, jedoch bietet maximale Flexibilität wie die zusätzlichen Eigenschaften in der Datenbank erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-210">This approach involves a bit more work than with the Profile framework, but offers maximum flexibility in how the additional user properties are modeled in the database.</span></span> <span data-ttu-id="fd7c5-211">Dies ist die Option, die in diesem Lernprogramm verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-211">This is the option we will use in this tutorial.</span></span>

<span data-ttu-id="fd7c5-212">Wir erstellen eine neue Tabelle namens `UserProfiles` home Örtlichkeit, Homepage und Signatur für jeden Benutzer gespeichert.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-212">We will create a new table called `UserProfiles` to save the home town, homepage, and signature for each user.</span></span> <span data-ttu-id="fd7c5-213">Mit der rechten Maustaste auf den Ordner Tabellen im Datenbank-Explorer-Fenster, und wählen Sie eine neue Tabelle erstellen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-213">Right-click on the Tables folder in the Database Explorer window and choose to create a new table.</span></span> <span data-ttu-id="fd7c5-214">Den Namen der ersten Spalte `UserId` und legen Sie deren Typ auf `uniqueidentifier`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-214">Name the first column `UserId` and set its type to `uniqueidentifier`.</span></span> <span data-ttu-id="fd7c5-215">Unterbinden `NULL` Werte und die Spalte als Primärschlüssel kennzeichnen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-215">Disallow `NULL` values and mark the column as a primary key.</span></span> <span data-ttu-id="fd7c5-216">Als Nächstes fügen Sie Spalten mit dem Namen: `HomeTown` des Typs `nvarchar(50)`; `HomepageUrl` des Typs `nvarchar(100)`; und die Signatur des Typs `nvarchar(500)`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-216">Next, add columns named: `HomeTown` of type `nvarchar(50)`; `HomepageUrl` of type `nvarchar(100)`; and Signature of type `nvarchar(500)`.</span></span> <span data-ttu-id="fd7c5-217">Jede dieser drei Spalten lässt eine `NULL` Wert.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-217">Each of these three columns can accept a `NULL` value.</span></span>


<span data-ttu-id="fd7c5-218">[![Erstellen Sie die Tabelle %Benutzerprofile%](storing-additional-user-information-vb/_static/image17.png)](storing-additional-user-information-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-218">[![Create the UserProfiles Table](storing-additional-user-information-vb/_static/image17.png)](storing-additional-user-information-vb/_static/image16.png)</span></span>

<span data-ttu-id="fd7c5-219">**Abbildung 6**: Erstellen der `UserProfiles` Tabelle ([klicken Sie hier, um das Bild in voller Größe angezeigt](storing-additional-user-information-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="fd7c5-219">**Figure 6**: Create the `UserProfiles` Table  ([Click to view full-size image](storing-additional-user-information-vb/_static/image18.png))</span></span>


<span data-ttu-id="fd7c5-220">Speichern Sie die Tabelle, und nennen Sie sie `UserProfiles`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-220">Save the table and name it `UserProfiles`.</span></span> <span data-ttu-id="fd7c5-221">Schließlich einrichten eine foreign Key-Einschränkung zwischen den `UserProfiles` tabellenspezifischen `UserId` Feld und die `aspnet_Users.UserId` Feld.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-221">Lastly, establish a foreign key constraint between the `UserProfiles` table's `UserId` field and the `aspnet_Users.UserId` field.</span></span> <span data-ttu-id="fd7c5-222">Wie wir mit der foreign Key-Einschränkung zwischen den `GuestbookComments` und `aspnet_Users` Tabellen vorhanden sind, diese Einschränkung kaskadiert werden gelöscht.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-222">As we did with the foreign key constraint between the `GuestbookComments` and `aspnet_Users` tables, have this constraint cascade deletes.</span></span> <span data-ttu-id="fd7c5-223">Da die `UserId` Feld `UserProfiles` ist der primäre Schlüssel, dadurch wird sichergestellt, dass sich nicht mehr als einen Datensatz in der `UserProfiles` Tabelle für jedes Benutzerkonto.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-223">Since the `UserId` field in `UserProfiles` is the primary key, this ensures that there will be no more than one record in the `UserProfiles` table for each user account.</span></span> <span data-ttu-id="fd7c5-224">Diese Art von Beziehung wird als 1: 1 bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-224">This type of relationship is referred to as one-to-one.</span></span>

<span data-ttu-id="fd7c5-225">Nachdem wir das Datenmodell erstellt haben, können wir, ihn zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-225">Now that we have the data model created, we are ready to use it.</span></span> <span data-ttu-id="fd7c5-226">In den Schritten 2 und 3 betrachten wir wie der derzeit angemeldete Benutzer anzeigen und ihre home Örtlichkeit Homepage und Signatur-Informationen bearbeiten kann.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-226">In Steps 2 and 3 we will look at how the currently logged on user can view and edit their home town, homepage, and signature information.</span></span> <span data-ttu-id="fd7c5-227">In Schritt 4 wird die Schnittstelle für den authentifizierten Benutzern das Senden neue Kommentare an angezeigten und zeigen die vorhandenen erstellt.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-227">In Step 4 we will create the interface for authenticated users to submit new comments to the guestbook and view the existing ones.</span></span>

## <a name="step-2-displaying-the-users-home-town-homepage-and-signature"></a><span data-ttu-id="fd7c5-228">Schritt 2: Anzeigen des Benutzers Home Örtlichkeit Homepage und Signatur</span><span class="sxs-lookup"><span data-stu-id="fd7c5-228">Step 2: Displaying the User's Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="fd7c5-229">Es gibt eine Vielzahl von Möglichkeiten zum Zulassen des derzeit angemeldeten Benutzers zum Anzeigen und bearbeiten seine home Örtlichkeit Homepage und Signatur-Informationen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-229">There are a variety of ways to allow the currently logged on user to view and edit his home town, homepage, and signature information.</span></span> <span data-ttu-id="fd7c5-230">Es konnte die Benutzeroberfläche manuell erstellt, mit dem Textfeld, und Bezeichnungsfeld-Steuerelementen oder es konnte Datentyps Web Controls, z. B. DetailsView-Steuerelement verwenden.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-230">We could manually create the user interface with TextBox and Label controls or we could use one of the data Web controls, such as the DetailsView control.</span></span> <span data-ttu-id="fd7c5-231">Um die Datenbank ausführen `SELECT` und `UPDATE` Anweisungen geschrieben werden, um ADO.NET code in unserer Seite Code-Behind-Klasse, oder alternativ einen deklarativen Ansatz, mit dem SqlDataSource einsetzen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-231">To perform the database `SELECT` and `UPDATE` statements we could write ADO.NET code in our page's code-behind class or, alternatively, employ a declarative approach with the SqlDataSource.</span></span> <span data-ttu-id="fd7c5-232">Im Idealfall würde die Anwendung eine mehrstufige Architektur enthalten, die wir von der Seite Code-Behind-Klasse oder deklarativ über das ObjectDataSource-Steuerelement programmgesteuert entweder aufrufen kann.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-232">Ideally our application would contain a tiered architecture, which we could either invoke programmatically from the page's code-behind class or declaratively via the ObjectDataSource control.</span></span>

<span data-ttu-id="fd7c5-233">Da diese Reihe von Lernprogrammen auf formularbasierte Authentifizierung, Autorisierung, Benutzerkonten und Rollen konzentriert, wird es nicht mehr eine ausführliche Beschreibung dieser Zugriffsoptionen unterschiedliche Daten oder warum eine mehrstufige Architektur bevorzugt wird, über das Ausführen von SQL-Anweisungen direkt von der ASP.NET-Seite.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-233">Since this tutorial series focuses on forms authentication, authorization, user accounts, and roles, there will not be a thorough discussion of these different data access options or why a tiered architecture is preferred over executing SQL statements directly from the ASP.NET page.</span></span> <span data-ttu-id="fd7c5-234">Ich werde exemplarisch erklärt, mit einem DetailsView und SqlDataSource – die schnellste und einfachste Option – erörterten Konzepte können jedoch sicherlich angewendet werden, alternative Zugriffslogik für die Steuerelemente und die von Web.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-234">I am going to walk through using a DetailsView and SqlDataSource – the quickest and easiest option – but the concepts discussed can certainly be applied to alternative Web controls and data access logic.</span></span> <span data-ttu-id="fd7c5-235">Weitere Informationen zum Arbeiten mit Daten in ASP.NET finden Sie in meinem  *[arbeiten mit Daten in ASP.NET 2.0](../../data-access/index.md)*  Reihe von Lernprogrammen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-235">For more information on working with data in ASP.NET, refer to my *[Working with Data in ASP.NET 2.0](../../data-access/index.md)* tutorial series.</span></span>

<span data-ttu-id="fd7c5-236">Öffnen der `AdditionalUserInfo.aspx` auf der Seite der `Membership` Ordner und Hinzufügen eines DetailsView-Steuerelements zum Festlegen der ID-Eigenschafts auf der Seite `UserProfile` und gelöscht wird, dessen `Width` und `Height` Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-236">Open the `AdditionalUserInfo.aspx` page in the `Membership` folder and add a DetailsView control to the page, setting its ID property to `UserProfile` and clearing out its `Width` and `Height` properties.</span></span> <span data-ttu-id="fd7c5-237">Erweitern Sie die DetailsView Smarttag, und binden Sie es an eine neue Datenquellen-Steuerelements.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-237">Expand the DetailsView's Smart Tag and choose to bind it to a new data source control.</span></span> <span data-ttu-id="fd7c5-238">Hierdurch wird der DataSource-Konfigurations-Assistent (siehe Abbildung 7).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-238">This will launch the DataSource Configuration Wizard (see Figure 7).</span></span> <span data-ttu-id="fd7c5-239">Der erste Schritt aufgefordert, den Datenquellentyp angeben.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-239">The first step asks you to specify the data source type.</span></span> <span data-ttu-id="fd7c5-240">Da wir werden direkt an die Verbindung der `SecurityTutorials` Datenbank, wählen Sie das Datenbanksymbol angeben der `ID` als `UserProfileDataSource`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-240">Since we are going to connect directly to the `SecurityTutorials` database, choose the Database icon, specifying the `ID` as `UserProfileDataSource`.</span></span>


<span data-ttu-id="fd7c5-241">[![Fügen Sie ein neues SqlDataSource-Steuerelement mit dem Namen UserProfileDataSource hinzu.](storing-additional-user-information-vb/_static/image20.png)](storing-additional-user-information-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-241">[![Add a New SqlDataSource Control Named UserProfileDataSource](storing-additional-user-information-vb/_static/image20.png)](storing-additional-user-information-vb/_static/image19.png)</span></span>

<span data-ttu-id="fd7c5-242">**Abbildung 7**: Hinzufügen einer neuen SqlDataSource-Steuerelement mit dem Namen `UserProfileDataSource` ([klicken Sie hier, um das Bild in voller Größe angezeigt](storing-additional-user-information-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="fd7c5-242">**Figure 7**: Add a New SqlDataSource Control Named `UserProfileDataSource` ([Click to view full-size image](storing-additional-user-information-vb/_static/image21.png))</span></span>


<span data-ttu-id="fd7c5-243">Der nächste Bildschirm fordert für die Datenbank verwendet.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-243">The next screen prompts for the database to use.</span></span> <span data-ttu-id="fd7c5-244">Wir haben bereits eine Verbindungszeichenfolge im definiert `Web.config` für die `SecurityTutorials` Datenbank.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-244">We have already defined a connection string in `Web.config` for the `SecurityTutorials` database.</span></span> <span data-ttu-id="fd7c5-245">Diese Verbindungszeichenfolgenname – `SecurityTutorialsConnectionString` – sollte sich in der Dropdown-Liste.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-245">This connection string name – `SecurityTutorialsConnectionString` – should be in the drop-down list.</span></span> <span data-ttu-id="fd7c5-246">Wählen Sie diese Option aus, und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-246">Select this option and click Next.</span></span>


<span data-ttu-id="fd7c5-247">[![Wählen Sie SecurityTutorialsConnectionString aus der Dropdown Liste](storing-additional-user-information-vb/_static/image23.png)](storing-additional-user-information-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-247">[![Choose SecurityTutorialsConnectionString from the Drop-Down List](storing-additional-user-information-vb/_static/image23.png)](storing-additional-user-information-vb/_static/image22.png)</span></span>

<span data-ttu-id="fd7c5-248">**Abbildung 8**: Wählen Sie `SecurityTutorialsConnectionString` aus der Dropdown-Liste ([klicken Sie hier, um das Bild in voller Größe angezeigt](storing-additional-user-information-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="fd7c5-248">**Figure 8**: Choose `SecurityTutorialsConnectionString` from the Drop-Down List  ([Click to view full-size image](storing-additional-user-information-vb/_static/image24.png))</span></span>


<span data-ttu-id="fd7c5-249">Im folgenden Bildschirm werden Sie gefragt, geben Sie die Tabelle und die Spalten aus, die Abfrage.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-249">The subsequent screen asks us to specify the table and columns to query.</span></span> <span data-ttu-id="fd7c5-250">Wählen Sie die `UserProfiles` Tabelle aus der Dropdown-Liste, und überprüfen Sie alle Spalten.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-250">Choose the `UserProfiles` table from the drop-down list and check all of the columns.</span></span>


<span data-ttu-id="fd7c5-251">[![Schalten Sie alle Spalten aus der Tabelle %Benutzerprofile% sichern](storing-additional-user-information-vb/_static/image26.png)](storing-additional-user-information-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-251">[![Bring Back All of the Columns from the UserProfiles Table](storing-additional-user-information-vb/_static/image26.png)](storing-additional-user-information-vb/_static/image25.png)</span></span>

<span data-ttu-id="fd7c5-252">**Abbildung 9**: Schalten Sie wieder alle Spalten aus der `UserProfiles` Tabelle ([klicken Sie hier, um das Bild in voller Größe angezeigt](storing-additional-user-information-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="fd7c5-252">**Figure 9**: Bring Back All of the Columns from the `UserProfiles` Table  ([Click to view full-size image](storing-additional-user-information-vb/_static/image27.png))</span></span>


<span data-ttu-id="fd7c5-253">Der aktuellen Abfrage in Abbildung 9 gibt *alle* Datensätze in `UserProfiles`, aber wir nur der derzeit angemeldete Benutzer Datensatz interessiert sind.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-253">The current query in Figure 9 returns *all* of the records in `UserProfiles`, but we are only interested in the currently logged on user's record.</span></span> <span data-ttu-id="fd7c5-254">Hinzufügen einer `WHERE` -Klausel, klicken Sie auf die `WHERE` Schaltfläche, um das Hinzufügen `WHERE` Klausel Dialogfeld (siehe Abbildung 10).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-254">To add a `WHERE` clause, click the `WHERE` button to bring up the Add `WHERE` Clause dialog box (see Figure 10).</span></span> <span data-ttu-id="fd7c5-255">Hier können Sie die Spalte, nach dem gefiltert, den Operator und die Quelle des Parameters Filter auswählen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-255">Here you can select the column to filter on, the operator, and the source of the filter parameter.</span></span> <span data-ttu-id="fd7c5-256">Wählen Sie `UserId` als Spalte und den Operator "=".</span><span class="sxs-lookup"><span data-stu-id="fd7c5-256">Select `UserId` as the column and "=" as the Operator.</span></span>

<span data-ttu-id="fd7c5-257">Leider besteht keine integrierte Parameterquelle zurückzugebenden des aktuell angemeldeten Benutzers `UserId` Wert.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-257">Unfortunately there is no built-in parameter source to return the currently logged on user's `UserId` value.</span></span> <span data-ttu-id="fd7c5-258">Wir müssen diesen Wert programmgesteuert zu ziehen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-258">We will need to grab this value programmatically.</span></span> <span data-ttu-id="fd7c5-259">Deshalb Festlegen der Quellliste Dropdown-Menü aus auf "Keine" auf Hinzufügen Schaltfläche, um die Parameter hinzuzufügen, und klicken Sie dann auf OK.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-259">Therefore, set the Source drop-down list to "None," click the Add button to add the parameter, and then click OK.</span></span>


<span data-ttu-id="fd7c5-260">[![Fügen Sie einen Filterparameter für die Benutzer-ID-Spalte](storing-additional-user-information-vb/_static/image29.png)](storing-additional-user-information-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-260">[![Add a Filter Parameter on the UserId Column](storing-additional-user-information-vb/_static/image29.png)](storing-additional-user-information-vb/_static/image28.png)</span></span>

<span data-ttu-id="fd7c5-261">**Abbildung 10**: Fügen Sie einen Filter-Parameter auf die `UserId` Spalte ([klicken Sie hier, um das Bild in voller Größe angezeigt](storing-additional-user-information-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="fd7c5-261">**Figure 10**: Add a Filter Parameter on the `UserId` Column  ([Click to view full-size image](storing-additional-user-information-vb/_static/image30.png))</span></span>


<span data-ttu-id="fd7c5-262">Nach dem Klicken auf OK werden Sie auf dem Bildschirm in Abbildung 9 gezeigt zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-262">After clicking OK you will be returned to the screen shown in Figure 9.</span></span> <span data-ttu-id="fd7c5-263">Dieses Mal jedoch die SQL-Abfrage am unteren Rand des Bildschirms sollte enthalten eine `WHERE` Klausel.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-263">This time, however, the SQL query at the bottom of the screen should include a `WHERE` clause.</span></span> <span data-ttu-id="fd7c5-264">Klicken Sie auf "Weiter", um zum Bildschirm "Testabfrage" zu navigieren, auf.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-264">Click Next to move on to the "Test Query" screen.</span></span> <span data-ttu-id="fd7c5-265">Hier können Sie die Abfrage ausführen und die Ergebnisse anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-265">Here you can run the query and see the results.</span></span> <span data-ttu-id="fd7c5-266">Klicken Sie auf ' Fertig stellen ', um den Assistenten abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-266">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="fd7c5-267">Nach Abschluss der DataSource-Konfigurations-Assistent, erstellt Visual Studio die SqlDataSource-Steuerelement, das basierend auf den im Assistenten angegebenen Einstellungen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-267">Upon completing the DataSource Configuration Wizard, Visual Studio creates the SqlDataSource control based on the settings specified in the wizard.</span></span> <span data-ttu-id="fd7c5-268">Darüber hinaus führt es manuell fügt BoundFields, DetailsView für jede Spalte, die der SqlDataSource zurückgegebenes `SelectCommand`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-268">Moreover, it manually adds BoundFields to the DetailsView for each column returned by the SqlDataSource's `SelectCommand`.</span></span> <span data-ttu-id="fd7c5-269">Besteht keine Notwendigkeit zum Anzeigen der `UserId` Feld, DetailsView, da der Benutzer nicht wissen, dieser Wert muss.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-269">There's no need to show the `UserId` field in the DetailsView, since the user does not need to know this value.</span></span> <span data-ttu-id="fd7c5-270">Sie können dieses Feld direkt von DetailsView-Steuerelement deklarativem Markup entfernen oder durch Klicken auf "Felder bearbeiten" aus seinem Smarttag.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-270">You can remove this field directly from the DetailsView control's declarative markup or by clicking the "Edit Fields" link from its Smart Tag.</span></span>

<span data-ttu-id="fd7c5-271">An diesem Punkt sollte deklarativem Markup Ihrer Seite etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="fd7c5-271">At this point your page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample1.aspx)]

<span data-ttu-id="fd7c5-272">Wir müssen die SqlDataSource-Steuerelement programmgesteuert festlegen `UserId` Parameter für des aktuell angemeldeten Benutzers `UserId` bevor die Daten ausgewählt werden.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-272">We need to programmatically set the SqlDataSource control's `UserId` parameter to the currently logged in user's `UserId` before the data is selected.</span></span> <span data-ttu-id="fd7c5-273">Dies geschieht durch Erstellen eines ereignishandlers für die ': SqlDataSource `Selecting` Ereignis und das folgende Codebeispiel gibt es:</span><span class="sxs-lookup"><span data-stu-id="fd7c5-273">This can be accomplished by creating an event handler for the SqlDataSource's `Selecting` event and adding the following code there:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample2.vb)]

<span data-ttu-id="fd7c5-274">Der obige Code gestartet wird, erhalten Sie einen Verweis auf den derzeit angemeldeten Benutzer durch Aufrufen der `Membership` Klasse `GetUser` Methode.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-274">The above code starts by obtaining a reference to the currently logged on user by calling the `Membership` class's `GetUser` method.</span></span> <span data-ttu-id="fd7c5-275">Dies gibt eine `MembershipUser` Objekt, dessen `ProviderUserKey` Eigenschaft enthält die `UserId`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-275">This returns a `MembershipUser` object, whose `ProviderUserKey` property contains the `UserId`.</span></span> <span data-ttu-id="fd7c5-276">Die `UserId` Wert wird anschließend der SqlDataSource zugewiesen `@UserId` Parameter.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-276">The `UserId` value is then assigned to the SqlDataSource's `@UserId` parameter.</span></span>

> [!NOTE]
> <span data-ttu-id="fd7c5-277">Die `Membership.GetUser()` Methode gibt Informationen zu den derzeit angemeldeten Benutzer zurück.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-277">The `Membership.GetUser()` method returns information about the currently logged on user.</span></span> <span data-ttu-id="fd7c5-278">Wenn ein anonymer Benutzer die Seite besucht, wird zurückgegeben, der Wert `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-278">If an anonymous user is visiting the page, it will return a value of `Nothing`.</span></span> <span data-ttu-id="fd7c5-279">In diesem Fall führt dies zu einer `NullReferenceException` in der folgenden Zeile des Codes beim Lesen der `ProviderUserKey` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-279">In such a case, this will lead to a `NullReferenceException` on the following line of code when attempting to read the `ProviderUserKey` property.</span></span> <span data-ttu-id="fd7c5-280">Natürlich wir kümmern brauchen `Membership.GetUser()` zurückgeben "Nothing" in der `AdditionalUserInfo.aspx` Seite, da wir URL-Autorisierung in einem vorherigen Lernprogramm so konfiguriert, dass nur authentifizierte Benutzer die ASP.NET-Ressourcen in diesen Ordner zugreifen konnten.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-280">Of course, we don't have to worry about `Membership.GetUser()` returning Nothing in the `AdditionalUserInfo.aspx` page because we configured URL authorization in a previous tutorial so that only authenticated users could access the ASP.NET resources in this folder.</span></span> <span data-ttu-id="fd7c5-281">Wenn Sie müssen Informationen zu den derzeit angemeldeten Benutzer auf einer Seite zugreifen, wo anonymer Zugriff erlaubt ist, müssen Sie überprüfen, ob die `MembershipUser` Objekt, das von der `GetUser()` Methode ist nicht ' Nothing ' vor dem verweisen auf seine Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-281">If you need to access information about the currently logged on user in a page where anonymous access is permitted, make sure to check that the `MembershipUser` object returned from the `GetUser()` method is not Nothing before referencing its properties.</span></span>


<span data-ttu-id="fd7c5-282">Wenn Sie besuchen die `AdditionalUserInfo.aspx` Seite über einen Browser werden Sie eine leere Seite angezeigt, da wir noch, der alle Zeilen hinzugefügt haben die `UserProfiles` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-282">If you visit the `AdditionalUserInfo.aspx` page through a browser you will see a blank page because we have yet to add any rows to the `UserProfiles` table.</span></span> <span data-ttu-id="fd7c5-283">In Schritt 6 betrachten wir zum Anpassen der CreateUserWizard-Steuerelement, um automatisch eine neue Zeile hinzufügen der `UserProfiles` Tabelle, wenn ein neues Benutzerkonto erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-283">In Step 6 we will look at how to customize the CreateUserWizard control to automatically add a new row to the `UserProfiles` table when a new user account is created.</span></span> <span data-ttu-id="fd7c5-284">Jetzt jedoch müssen wir einen Datensatz in der Tabelle manuell erstellen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-284">For now, however, we will need to manually create a record in the table.</span></span>

<span data-ttu-id="fd7c5-285">Navigieren Sie zu der Datenbank-Explorer in Visual Studio, und erweitern Sie den Ordner Tabellen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-285">Navigate to the Database Explorer in Visual Studio and expand the Tables folder.</span></span> <span data-ttu-id="fd7c5-286">Mit der rechten Maustaste auf die `aspnet_Users` Tabelle und wählen Sie "Tabellendaten anzeigen", um die Datensätze in der Tabelle anzuzeigen, führen Sie dieselben Schritte für die `UserProfiles` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-286">Right-click on the `aspnet_Users` table and choose "Show Table Data" to see the records in the table; do the same thing for the `UserProfiles` table.</span></span> <span data-ttu-id="fd7c5-287">Abbildung 11 zeigt diese Ergebnisse, wenn vertikal angeordnet.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-287">Figure 11 shows these results when tiled vertically.</span></span> <span data-ttu-id="fd7c5-288">In der Datenbank zur Zeit bestehen `aspnet_Users` Datensätze für Bruce Fred und Tito, aber keine Datensätze in der `UserProfiles` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-288">In my database there are currently `aspnet_Users` records for Bruce, Fred, and Tito, but no records in the `UserProfiles` table.</span></span>


<span data-ttu-id="fd7c5-289">[![Der Inhalt der Aspnet_Users und %Benutzerprofile% Tabellen werden angezeigt.](storing-additional-user-information-vb/_static/image32.png)](storing-additional-user-information-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-289">[![The Contents of the aspnet_Users and UserProfiles Tables are Displayed](storing-additional-user-information-vb/_static/image32.png)](storing-additional-user-information-vb/_static/image31.png)</span></span>

<span data-ttu-id="fd7c5-290">**Abbildung 11**: der Inhalt der `aspnet_Users` und `UserProfiles` Tabellen angezeigt werden ([klicken Sie hier, um das Bild in voller Größe angezeigt](storing-additional-user-information-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="fd7c5-290">**Figure 11**: The Contents of the `aspnet_Users` and `UserProfiles` Tables are Displayed  ([Click to view full-size image](storing-additional-user-information-vb/_static/image33.png))</span></span>


<span data-ttu-id="fd7c5-291">Fügen Sie einen neuen Datensatz zu den `UserProfiles` Tabelle manuell eingeben von Werten für die `HomeTown`, `HomepageUrl`, und `Signature` Felder.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-291">Add a new record to the `UserProfiles` table by manually typing in values for the `HomeTown`, `HomepageUrl`, and `Signature` fields.</span></span> <span data-ttu-id="fd7c5-292">Die einfachste Möglichkeit, eine gültige get `UserId` Wert in der neuen `UserProfiles` Datensatz ist, wählen Sie die `UserId` Feld aus einem bestimmten Benutzerkonto in der `aspnet_Users` Tabelle kopieren und fügen Sie ihn in die `UserId` Feld `UserProfiles`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-292">The easiest way to get a valid `UserId` value in the new `UserProfiles` record is to select the `UserId` field from a particular user account in the `aspnet_Users` table and copy and paste it into the `UserId` field in `UserProfiles`.</span></span> <span data-ttu-id="fd7c5-293">Abbildung 12 zeigt die `UserProfiles` Tabelle, nachdem Sie ein neuer Datensatz für Bruce hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-293">Figure 12 shows the `UserProfiles` table after a new record has been added for Bruce.</span></span>


<span data-ttu-id="fd7c5-294">[![Ein Datensatz wurde auf %Benutzerprofile% für Bruce hinzugefügt.](storing-additional-user-information-vb/_static/image35.png)](storing-additional-user-information-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-294">[![A Record was Added to UserProfiles for Bruce](storing-additional-user-information-vb/_static/image35.png)](storing-additional-user-information-vb/_static/image34.png)</span></span>

<span data-ttu-id="fd7c5-295">**Abbildung 12**: A-Eintrag wurde hinzugefügt, um `UserProfiles` für Bruce ([klicken Sie hier, um das Bild in voller Größe angezeigt](storing-additional-user-information-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="fd7c5-295">**Figure 12**: A Record was Added to `UserProfiles` for Bruce  ([Click to view full-size image](storing-additional-user-information-vb/_static/image36.png))</span></span>


<span data-ttu-id="fd7c5-296">Zurück zu den `AdditionalUserInfo.aspx page`, als Bruce angemeldet.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-296">Return to the `AdditionalUserInfo.aspx page`, logged in as Bruce.</span></span> <span data-ttu-id="fd7c5-297">Wie in Abbildung 13 gezeigt, werden die Einstellungen des Bruce angezeigt.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-297">As Figure 13 shows, Bruce's settings are displayed.</span></span>


<span data-ttu-id="fd7c5-298">[![Die zurzeit Zugriff auf Benutzer wird gezeigt, seiner Einstellungen](storing-additional-user-information-vb/_static/image38.png)](storing-additional-user-information-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-298">[![The Currently Visiting User is Shown His Settings](storing-additional-user-information-vb/_static/image38.png)](storing-additional-user-information-vb/_static/image37.png)</span></span>

<span data-ttu-id="fd7c5-299">**Abbildung 13**: die zurzeit Zugriff auf Benutzer wird gezeigt, seiner Einstellungen ([klicken Sie hier, um das Bild in voller Größe angezeigt](storing-additional-user-information-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="fd7c5-299">**Figure 13**: The Currently Visiting User is Shown His Settings  ([Click to view full-size image](storing-additional-user-information-vb/_static/image39.png))</span></span>


> [!NOTE]
> <span data-ttu-id="fd7c5-300">Wechseln Sie im voraus und manuell hinzufügen Datensätze in der `UserProfiles` Tabelle für jeden Mitgliedschaftsbenutzer.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-300">Go ahead and manually add records in the `UserProfiles` table for each Membership user.</span></span> <span data-ttu-id="fd7c5-301">In Schritt 6 betrachten wir zum Anpassen der CreateUserWizard-Steuerelement, um automatisch eine neue Zeile hinzufügen der `UserProfiles` Tabelle, wenn ein neues Benutzerkonto erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-301">In Step 6 we will look at how to customize the CreateUserWizard control to automatically add a new row to the `UserProfiles` table when a new user account is created.</span></span>


## <a name="step-3-allowing-the-user-to-edit-his-home-town-homepage-and-signature"></a><span data-ttu-id="fd7c5-302">Schritt 3: Ermöglicht die Benutzer, seinen Home Örtlichkeit Homepage und Signatur bearbeiten</span><span class="sxs-lookup"><span data-stu-id="fd7c5-302">Step 3: Allowing the User to Edit His Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="fd7c5-303">An diesem Punkt den aktuell angemeldeten Benutzers anzeigen kann, ihre Startseite Örtlichkeit Homepage und Signatur-Einstellung, aber sie nicht noch geändert werden können.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-303">At this point the currently logged in user can view their home town, homepage, and signature setting, but they cannot yet modify them.</span></span> <span data-ttu-id="fd7c5-304">Wir aktualisieren DetailsView-Steuerelement, damit die Daten bearbeitet werden können.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-304">Let's update the DetailsView control so that the data can be edited.</span></span>

<span data-ttu-id="fd7c5-305">Im ersten Schritt erforderlich ist, Hinzufügen einer `UpdateCommand` für die ': SqlDataSource angeben der `UPDATE` auszuführende Anweisung und die entsprechenden Parameter.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-305">The first thing we need to do is add an `UpdateCommand` for the SqlDataSource, specifying the `UPDATE` statement to execute and its corresponding parameters.</span></span> <span data-ttu-id="fd7c5-306">Wählen Sie die SqlDataSource und im Eigenschaftenfenster klicken Sie auf die Schaltfläche mit den Auslassungszeichen neben der UpdateQuery-Eigenschaft, um das Dialogfeld Befehls- und Parameter-Editor zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-306">Select the SqlDataSource and, from the Properties window, click on the ellipses next to the UpdateQuery property to bring up the Command and Parameter Editor dialog box.</span></span> <span data-ttu-id="fd7c5-307">Geben Sie den folgenden `UPDATE` Anweisung in das Textfeld ein:</span><span class="sxs-lookup"><span data-stu-id="fd7c5-307">Enter the following `UPDATE` statement into the textbox:</span></span>

[!code-sql[Main](storing-additional-user-information-vb/samples/sample3.sql)]

<span data-ttu-id="fd7c5-308">Klicken Sie anschließend auf die Schaltfläche "Parameter aktualisieren", die einen Parameter in der SqlDataSource-Steuerelement erstellt werden `UpdateParameters` Auflistung für jeden der Parameter in der `UPDATE` Anweisung.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-308">Next, click the "Refresh Parameters" button, which will create a parameter in the SqlDataSource control's `UpdateParameters` collection for each of the parameters in the `UPDATE` statement.</span></span> <span data-ttu-id="fd7c5-309">Lassen Sie die Quelle für alle festgelegten Parameter auf None, und klicken Sie auf die Schaltfläche "OK", um das Dialogfeld zu schließen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-309">Leave the source for all of the parameters set to None and click the OK button to complete the dialog box.</span></span>


<span data-ttu-id="fd7c5-310">[![Geben Sie der SqlDataSource UpdateCommand und UpdateParameters](storing-additional-user-information-vb/_static/image41.png)](storing-additional-user-information-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-310">[![Specify the SqlDataSource's UpdateCommand and UpdateParameters](storing-additional-user-information-vb/_static/image41.png)](storing-additional-user-information-vb/_static/image40.png)</span></span>

<span data-ttu-id="fd7c5-311">**Abbildung 14**: Geben Sie der SqlDataSource `UpdateCommand` und `UpdateParameters` ([klicken Sie hier, um das Bild in voller Größe angezeigt](storing-additional-user-information-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="fd7c5-311">**Figure 14**: Specify the SqlDataSource's `UpdateCommand` and `UpdateParameters` ([Click to view full-size image](storing-additional-user-information-vb/_static/image42.png))</span></span>


<span data-ttu-id="fd7c5-312">Aufgrund von Virtual Machine Additions wurde auf SqlDataSource-Steuerelement, DetailsView Steuerelement jetzt bearbeiten unterstützen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-312">Due to the additions we made to the SqlDataSource control, the DetailsView control can now support editing.</span></span> <span data-ttu-id="fd7c5-313">Aus der DetailsView Smart Tag das Kontrollkästchen Sie "Bearbeiten aktivieren".</span><span class="sxs-lookup"><span data-stu-id="fd7c5-313">From the DetailsView's Smart Tag, check the "Enable Editing" checkbox.</span></span> <span data-ttu-id="fd7c5-314">Dadurch wird des Steuerelements eine CommandField hinzugefügt `Fields` Auflistung mit seiner `ShowEditButton` -Eigenschaft auf "true" festgelegt.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-314">This adds a CommandField to the control's `Fields` collection with its `ShowEditButton` property set to True.</span></span> <span data-ttu-id="fd7c5-315">Dies rendert eine Schaltfläche "Bearbeiten", wenn DetailsView im Nur-Lese-Modus und Update angezeigt wird und Schaltflächen "Abbrechen", bei der Anzeige im Bearbeitungsmodus befindet.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-315">This renders an Edit button when the DetailsView is displayed in read-only mode and Update and Cancel buttons when displayed in edit mode.</span></span> <span data-ttu-id="fd7c5-316">Anstatt dass der Benutzer "Bearbeiten" klicken, jedoch können schon dem DetailsView Rendern im Zustand "immer bearbeitbaren" durch Festlegen des DetailsView-Steuerelements [ `DefaultMode` Eigenschaft](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.detailsview.defaultmode.aspx) auf `Edit`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-316">Rather than requiring the user to click Edit, though, we can have the DetailsView render in an "always editable" state by setting the DetailsView control's [`DefaultMode` property](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.detailsview.defaultmode.aspx) to `Edit`.</span></span>

<span data-ttu-id="fd7c5-317">Mit diesen Änderungen sollte deklarativem Markup des Steuerelements DetailsView etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="fd7c5-317">With these changes, your DetailsView control's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample4.aspx)]

<span data-ttu-id="fd7c5-318">Beachten Sie das Hinzufügen der CommandField und die `DefaultMode` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-318">Note the addition of the CommandField and the `DefaultMode` property.</span></span>

<span data-ttu-id="fd7c5-319">Fahren Sie fort, und Testen Sie diese Seite über einen Browser.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-319">Go ahead and test this page through a browser.</span></span> <span data-ttu-id="fd7c5-320">Wenn Sie mit einem Benutzer besuchen, die einen entsprechenden Datensatz in `UserProfiles`, Einstellungen des Benutzers werden in einer bearbeitbaren Schnittstelle angezeigt.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-320">When visiting with a user that has a corresponding record in `UserProfiles`, the user's settings are displayed in an editable interface.</span></span>


<span data-ttu-id="fd7c5-321">[![DetailsView rendert eine bearbeitbare-Schnittstelle](storing-additional-user-information-vb/_static/image44.png)](storing-additional-user-information-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-321">[![The DetailsView Renders an Editable Interface](storing-additional-user-information-vb/_static/image44.png)](storing-additional-user-information-vb/_static/image43.png)</span></span>

<span data-ttu-id="fd7c5-322">**Abbildung 15**: DetailsView rendert eine bearbeitbare Schnittstelle ([klicken Sie hier, um das Bild in voller Größe angezeigt](storing-additional-user-information-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="fd7c5-322">**Figure 15**: The DetailsView Renders an Editable Interface  ([Click to view full-size image](storing-additional-user-information-vb/_static/image45.png))</span></span>


<span data-ttu-id="fd7c5-323">Wiederholen Sie dann die Werte ändern, und klicken Sie auf die Schaltfläche "Aktualisieren".</span><span class="sxs-lookup"><span data-stu-id="fd7c5-323">Try changing the values and clicking the Update button.</span></span> <span data-ttu-id="fd7c5-324">Es wird angezeigt, als ob nichts geschieht.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-324">It appears as if nothing happens.</span></span> <span data-ttu-id="fd7c5-325">Es wird ein Postback und die Werte in der Datenbank gespeichert sind, aber es existiert keine visuelle Bestätigung, die der Speichervorgang aufgetreten sind.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-325">There is a postback and the values are saved to the database, but there's no visual feedback that the save occurred.</span></span>

<span data-ttu-id="fd7c5-326">Zur Behebung des Problems, zurück zu Visual Studio, und fügen Sie ein Bezeichnungsfeld-Steuerelement oben DetailsView hinzu.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-326">To remedy this, return to Visual Studio and add a Label control above the DetailsView.</span></span> <span data-ttu-id="fd7c5-327">Festlegen seiner `ID` auf `SettingsUpdatedMessage`, dessen `Text` Eigenschaft "haben die Einstellungen aktualisiert wurden," und die zugehörige `Visible` und `EnableViewState` Eigenschaften `False`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-327">Set its `ID` to `SettingsUpdatedMessage`, its `Text` property to "Your settings have been updated," and its `Visible` and `EnableViewState` properties to `False`.</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample5.aspx)]

<span data-ttu-id="fd7c5-328">Wir müssen zum Anzeigen der `SettingsUpdatedMessage` bezeichnen, sobald die DetailsView aktualisiert wird.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-328">We need to display the `SettingsUpdatedMessage` Label whenever the DetailsView is updated.</span></span> <span data-ttu-id="fd7c5-329">Um dies zu erreichen, erstellen Sie einen Ereignishandler für die DetailsView `ItemUpdated` Ereignis und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="fd7c5-329">To accomplish this, create an event handler for the DetailsView's `ItemUpdated` event and add the following code:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample6.vb)]

<span data-ttu-id="fd7c5-330">Zurück zu den `AdditionalUserInfo.aspx` Seite über einen Browser, und aktualisieren Sie die Daten.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-330">Return to the `AdditionalUserInfo.aspx` page through a browser and update the data.</span></span> <span data-ttu-id="fd7c5-331">Diesmal ist eine hilfreiche Statusmeldung angezeigt.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-331">This time, a helpful status message is displayed.</span></span>


<span data-ttu-id="fd7c5-332">[![Eine kurze Nachricht wird angezeigt, wenn die Einstellungen werden aktualisiert.](storing-additional-user-information-vb/_static/image47.png)](storing-additional-user-information-vb/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-332">[![A Short Message is Displayed When the Settings are Updated](storing-additional-user-information-vb/_static/image47.png)](storing-additional-user-information-vb/_static/image46.png)</span></span>

<span data-ttu-id="fd7c5-333">**Abbildung 16**: eine kurze Nachricht wird angezeigt, wenn die Einstellungen aktualisiert werden ([klicken Sie hier, um das Bild in voller Größe angezeigt](storing-additional-user-information-vb/_static/image48.png))</span><span class="sxs-lookup"><span data-stu-id="fd7c5-333">**Figure 16**: A Short Message is Displayed When the Settings are Updated  ([Click to view full-size image](storing-additional-user-information-vb/_static/image48.png))</span></span>


> [!NOTE]
> <span data-ttu-id="fd7c5-334">DetailsView-Steuerelement des Schnittstelle bewirkt, dass viel zu wünschen übrig bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-334">The DetailsView control's editing interface leaves a lot to be desired.</span></span> <span data-ttu-id="fd7c5-335">Standardgröße Textfelder verwendet, aber das Signaturfeld muss wahrscheinlich ein mehrzeiliges Textfeld.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-335">It uses standard-sized textboxes, but the Signature field should probably be a multi-line textbox.</span></span> <span data-ttu-id="fd7c5-336">Ein RegularExpressionValidator sollte verwendet werden, um sicherzustellen, dass die URL zur Startseite Wenn eingegeben haben, mit "http://" oder "https://" beginnt.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-336">A RegularExpressionValidator should be used to ensure that the homepage URL, if entered, starts with "http://" or "https://".</span></span> <span data-ttu-id="fd7c5-337">Darüber hinaus seit DetailsView-Steuerelement seine `DefaultMode` -Eigenschaftensatz auf `Edit`, die Schaltfläche "Abbrechen" ist keine Aktion ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-337">Moreover, since the DetailsView control has its `DefaultMode` property set to `Edit`, the Cancel button does not do anything.</span></span> <span data-ttu-id="fd7c5-338">Es sollten entweder entfernt oder, wenn angeklickt, leiten Sie den Benutzer zu einigen anderen Seite (z. B. `~/Default.aspx`).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-338">It should either be removed or, when clicked, redirect the user to some other page (such as `~/Default.aspx`).</span></span> <span data-ttu-id="fd7c5-339">Ich lassen diese Verbesserungen als Übung für den Leser.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-339">I leave these enhancements as an exercise for the reader.</span></span>


### <a name="adding-a-link-to-theadditionaluserinfoaspxpage-in-the-master-page"></a><span data-ttu-id="fd7c5-340">Beim Hinzufügen einer Verknüpfung auf der`AdditionalUserInfo.aspx`Seite im Master</span><span class="sxs-lookup"><span data-stu-id="fd7c5-340">Adding a Link to the`AdditionalUserInfo.aspx`Page in the Master Page</span></span>

<span data-ttu-id="fd7c5-341">Die Website bietet derzeit keine Links zu den `AdditionalUserInfo.aspx` Seite.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-341">Currently, the website does not provide any links to the `AdditionalUserInfo.aspx` page.</span></span> <span data-ttu-id="fd7c5-342">Die einzige Möglichkeit, die es erreicht ist, geben Sie die Seiten-URL direkt in die Adressleiste des Browsers angezeigt.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-342">The only way to reach it is to enter the page's URL directly into the browser's Address bar.</span></span> <span data-ttu-id="fd7c5-343">Fügen Sie einen Link zu dieser Seite in der `Site.master` Masterseite.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-343">Let's add a link to this page in the `Site.master` master page.</span></span>

<span data-ttu-id="fd7c5-344">Beachten Sie, dass die Gestaltungsvorlage ein LoginView-Websteuerelement in enthält die `LoginContent` ContentPlaceHolder, in dem anderes Markup authentifiziert und anonym Besuchern angezeigt.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-344">Recall that the master page contains a LoginView Web control in its `LoginContent` ContentPlaceHolder that displays different markup for authenticated and anonymous visitors.</span></span> <span data-ttu-id="fd7c5-345">Aktualisieren Sie des LoginView-Steuerelements `LoggedInTemplate` enthalten einen Link zu der `AdditionalUserInfo.aspx` Seite.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-345">Update the LoginView control's `LoggedInTemplate` to include a link to the `AdditionalUserInfo.aspx` page.</span></span> <span data-ttu-id="fd7c5-346">Nach diesen Änderungen die LoginView sollte deklarativem Markup des Steuerelements etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="fd7c5-346">After making these changes the LoginView control's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample7.aspx)]

<span data-ttu-id="fd7c5-347">Beachten Sie das Hinzufügen der `lnkUpdateSettings` Linksteuerelement auf die `LoggedInTemplate`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-347">Note the addition of the `lnkUpdateSettings` HyperLink control to the `LoggedInTemplate`.</span></span> <span data-ttu-id="fd7c5-348">Mit diesem Link erfüllt können schnell authentifizierte Benutzern springen, zur Seite, um ihren Heim-Örtlichkeit Homepage und Signatur-Einstellungen anzeigen und ändern.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-348">With this link in place, authenticated users can quickly jump to the page to view and modify their home town, homepage, and signature settings.</span></span>

## <a name="step-4-adding-new-guestbook-comments"></a><span data-ttu-id="fd7c5-349">Schritt 4: Hinzufügen von neuen Gästebuchkommentaren</span><span class="sxs-lookup"><span data-stu-id="fd7c5-349">Step 4: Adding New Guestbook Comments</span></span>

<span data-ttu-id="fd7c5-350">Die `Guestbook.aspx` Seite ist, auf dem authentifizierten Benutzer angezeigten anzeigen und einen Kommentar können.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-350">The `Guestbook.aspx` page is where authenticated users can view the guestbook and leave a comment.</span></span> <span data-ttu-id="fd7c5-351">Beginnen Sie mit dem Erstellen der Schnittstelle, um neue Gästebuchkommentaren hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-351">Let's start with creating the interface to add new guestbook comments.</span></span>

<span data-ttu-id="fd7c5-352">Öffnen der `Guestbook.aspx` Seite in Visual Studio und erstellen Sie eine neue Benutzeroberfläche besteht aus zwei TextBox-Steuerelemente enthalten, von denen eine für den neuen Kommentar Betreff und eine für Text.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-352">Open the `Guestbook.aspx` page in Visual Studio and construct a user interface consisting of two TextBox controls, one for the new comment's subject and one for its body.</span></span> <span data-ttu-id="fd7c5-353">Legen Sie des ersten Textfeld-Steuerelements `ID` Eigenschaft, um `Subject` und seine `Columns` -Eigenschaft auf 40; legen Sekunde `ID` auf `Body`, dessen `TextMode` auf `MultiLine`, und die zugehörige `Width` und `Rows` Eigenschaften, die "95 %" und 8 bzw.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-353">Set the first TextBox control's `ID` property to `Subject` and its `Columns` property to 40; set second's `ID` to `Body`, its `TextMode` to `MultiLine`, and its `Width` and `Rows` properties to "95%" and 8, respectively.</span></span> <span data-ttu-id="fd7c5-354">Um die Benutzeroberfläche zu abzuschließen, fügen Sie eine Schaltfläche-Websteuerelement, der mit dem Namen `PostCommentButton` und legen Sie dessen `Text` -Eigenschaft auf "Your Comment" Post".</span><span class="sxs-lookup"><span data-stu-id="fd7c5-354">To complete the user interface, add a Button Web control named `PostCommentButton` and set its `Text` property to "Post Your Comment".</span></span>

<span data-ttu-id="fd7c5-355">Da jeder Gästebuch Kommentar Betreff und den Nachrichtentext erforderlich ist, fügen Sie einen RequiredFieldValidator für jede der Textfelder hinzu.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-355">Since each guestbook comment requires a subject and body, add a RequiredFieldValidator for each of the TextBoxes.</span></span> <span data-ttu-id="fd7c5-356">Festlegen der `ValidationGroup` Eigenschaft von diesen Steuerelementen "EnterComment"; ebenso festlegen, die `PostCommentButton` des Steuerelements `ValidationGroup` -Eigenschaft auf "EnterComment".</span><span class="sxs-lookup"><span data-stu-id="fd7c5-356">Set the `ValidationGroup` property of these controls to "EnterComment"; likewise, set the `PostCommentButton` control's `ValidationGroup` property to "EnterComment".</span></span> <span data-ttu-id="fd7c5-357">Weitere Informationen zu ASP. NET Validierungssteuerelemente, Auschecken [Formularvalidierung in ASP.NET](http://www.4guysfromrolla.com/webtech/090200-1.shtml), [unterzogen, wodurch der Validierungssteuerelemente in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx), und die [Überprüfung Server Steuerelemente Lernprogramm](http://www.w3schools.com/aspnet/aspnet_refvalidationcontrols.asp) auf [W3Schools](http://www.w3schools.com/).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-357">For more information on ASP.NET's validation controls, check out [Form Validation in ASP.NET](http://www.4guysfromrolla.com/webtech/090200-1.shtml), [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx), and the [Validation Server Controls Tutorial](http://www.w3schools.com/aspnet/aspnet_refvalidationcontrols.asp) on [W3Schools](http://www.w3schools.com/).</span></span>

<span data-ttu-id="fd7c5-358">Deklaratives Markup Ihrer Seite sollte etwa wie folgt aussehen, nach dem Erstellen der Benutzeroberfläche:</span><span class="sxs-lookup"><span data-stu-id="fd7c5-358">After crafting the user interface your page's declarative markup should look something like the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample8.aspx)]

<span data-ttu-id="fd7c5-359">Mit der vollständigen Benutzeroberfläche ist unsere nächste Aufgabe zum Einfügen eines neuen Datensatzes in die `GuestbookComments` bei Verwendung der `PostCommentButton` geklickt wird.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-359">With the user interface complete, our next task is to insert a new record into the `GuestbookComments` table when the `PostCommentButton` is clicked.</span></span> <span data-ttu-id="fd7c5-360">Dies kann auf vielfältige Weise erreicht werden: können Sie die Schaltfläche ADO.NET-Code schreiben `Click` Ereignishandler; wir können die Seite ein SqlDataSource-Steuerelement hinzugefügt haben, konfigurieren Sie seine `InsertCommand`, und rufen Sie dann seine `Insert` Methode aus der `Click` Ereignis Handler. oder wir erstellen eine mittlere Ebene, die zum Einfügen von neuen Gästebuchkommentaren verantwortlich war, und rufen Sie diese Funktion von der `Click` -Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-360">This can be accomplished in a number of ways: we can write ADO.NET code in the Button's `Click` event handler; we can add a SqlDataSource control to the page, configure its `InsertCommand`, and then call its `Insert` method from the `Click` event handler; or we could build a middle tier that was responsible for inserting new guestbook comments, and invoke this functionality from the `Click` event handler.</span></span> <span data-ttu-id="fd7c5-361">Da erläutert, mit einem SqlDataSource in Schritt 3, verwenden Sie ADO.NET-Code sehen wir hier.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-361">Since we looked at using a SqlDataSource in Step 3, let's use ADO.NET code here.</span></span>

> [!NOTE]
> <span data-ttu-id="fd7c5-362">Die programmgesteuerte Zugriff auf Daten aus einer Microsoft SQL Server-Datenbank verwendeten ADO.NET-Klassen befinden sich in der `System.Data.SqlClient` Namespace.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-362">The ADO.NET classes used to programmatically access data from a Microsoft SQL Server database are located in the `System.Data.SqlClient` namespace.</span></span> <span data-ttu-id="fd7c5-363">Möglicherweise müssen Sie diesen Namespace in der Seite Code-Behind-Klasse zu importieren (d. h. `Imports System.Data.SqlClient`).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-363">You may need to import this namespace into your page's code-behind class (i.e., `Imports System.Data.SqlClient`).</span></span>


<span data-ttu-id="fd7c5-364">Erstellen Sie einen Ereignishandler für das `PostCommentButton`des `Click` Ereignis und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="fd7c5-364">Create an event handler for the `PostCommentButton`'s `Click` event and add the following code:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample9.vb)]

<span data-ttu-id="fd7c5-365">Die `Click` Ereignishandler gestartet wird, indem Sie überprüfen, dass die vom Benutzer bereitgestellten Daten gültig ist.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-365">The `Click` event handler starts by checking that the user-supplied data is valid.</span></span> <span data-ttu-id="fd7c5-366">Wenn sie nicht der Fall ist, wird der Ereignishandler vor dem Einfügen eines Datensatzes beendet.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-366">If it is not, the event handler exits before inserting a record.</span></span> <span data-ttu-id="fd7c5-367">Sofern die bereitgestellten Daten sind gültig, des aktuell angemeldeten Benutzers `UserId` Wert abgerufen und gespeichert, der `currentUserId` lokale Variable.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-367">Assuming the supplied data is valid, the currently logged on user's `UserId` value is retrieved and stored in the `currentUserId` local variable.</span></span> <span data-ttu-id="fd7c5-368">Dieser Wert ist erforderlich, da wir angeben, muss ein `UserId` Wert, der beim Einfügen eines Datensatzes in `GuestbookComments`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-368">This value is needed because we must supply a `UserId` value when inserting a record into `GuestbookComments`.</span></span>

<span data-ttu-id="fd7c5-369">Nach, dass die Verbindungszeichenfolge für die `SecurityTutorials` Datenbank entnommen `Web.config` und `INSERT` SQL-Anweisung angegeben ist.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-369">Following that, the connection string for the `SecurityTutorials` database is retrieved from `Web.config` and the `INSERT` SQL statement is specified.</span></span> <span data-ttu-id="fd7c5-370">Ein `SqlConnection` Objekt dann erstellt und geöffnet.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-370">A `SqlConnection` object is then created and opened.</span></span> <span data-ttu-id="fd7c5-371">Als Nächstes wird ein `SqlCommand` -Objekt erstellt wird und die Werte für die Parameter verwendet, der `INSERT` zugewiesen sind.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-371">Next, a `SqlCommand` object is constructed and the values for the parameters used in the `INSERT` query are assigned.</span></span> <span data-ttu-id="fd7c5-372">Die `INSERT` Anweisung anschließend ausgeführt wird und die Verbindung geschlossen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-372">The `INSERT` statement is then executed and the connection closed.</span></span> <span data-ttu-id="fd7c5-373">Am Ende der Ereignishandler die `Subject` und `Body` Textfelder `Text` Eigenschaften werden gelöscht, sodass der Benutzer Werte für das Postback nicht beibehalten werden.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-373">At the end of the event handler, the `Subject` and `Body` TextBoxes' `Text` properties are cleared out so that the user's values are not persisted across the postback.</span></span>

<span data-ttu-id="fd7c5-374">Fahren Sie fort, und Testen Sie diese Seite in einem Browser.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-374">Go ahead and test out this page in a browser.</span></span> <span data-ttu-id="fd7c5-375">Da sich diese Seite in der `Membership` Ordner ist nicht verfügbar für anonyme Besucher.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-375">Since this page is in the `Membership` folder it is not accessible to anonymous visitors.</span></span> <span data-ttu-id="fd7c5-376">Aus diesem Grund müssen Sie zuerst melden Sie sich (falls Sie noch nicht getan haben).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-376">Therefore, you will need to first log on (if you have not already).</span></span> <span data-ttu-id="fd7c5-377">Geben Sie einen Wert in der `Subject` und `Body` Textfelder ein, und klicken Sie auf die `PostCommentButton` Schaltfläche.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-377">Enter a value into the `Subject` and `Body` TextBoxes and click the `PostCommentButton` button.</span></span> <span data-ttu-id="fd7c5-378">Dadurch wird einen neuen Datensatz hinzuzufügende `GuestbookComments`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-378">This will cause a new record to be added to `GuestbookComments`.</span></span> <span data-ttu-id="fd7c5-379">Beim Postback werden die Betreffzeile und dem Textkörper der eingegebene in die Textfelder ein zurückgesetzt.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-379">On postback, the subject and body you provided are wiped from the TextBoxes.</span></span>

<span data-ttu-id="fd7c5-380">Nach dem Klicken auf die `PostCommentButton` Schaltfläche es existiert keine visuelle Bestätigung, die der Kommentar angezeigten hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-380">After clicking the `PostCommentButton` button there is no visual feedback that the comment was added to the guestbook.</span></span> <span data-ttu-id="fd7c5-381">Wir müssen noch aktualisieren diese Seite, um es geschieht in Schritt 5 werden die vorhandenen Gästebuchkommentaren anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-381">We still need to update this page to display the existing guestbook comments, which we will do in Step 5.</span></span> <span data-ttu-id="fd7c5-382">Sobald wir, die zu erreichen, erscheint der gerade hinzugefügten Kommentar in der Liste von Kommentaren, ausreichend visuelles Feedback bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-382">Once we accomplish that, the just-added comment will appear in the list of comments, providing adequate visual feedback.</span></span> <span data-ttu-id="fd7c5-383">Jetzt bestätigen, dass Ihr Gästebuch Kommentar gespeichert wurde, durch Untersuchen des Inhalts der `GuestbookComments` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-383">For now, confirm that your guestbook comment was saved by examining the contents of the `GuestbookComments` table.</span></span>

<span data-ttu-id="fd7c5-384">Abbildung 17 zeigt den Inhalt der `GuestbookComments` Tabelle nach zwei Kommentare geblieben sind.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-384">Figure 17 shows the contents of the `GuestbookComments` table after two comments have been left.</span></span>


<span data-ttu-id="fd7c5-385">[![Sie können die Gästebuchkommentaren in der Tabelle GuestbookComments sehen.](storing-additional-user-information-vb/_static/image50.png)](storing-additional-user-information-vb/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-385">[![You Can See the Guestbook Comments in the GuestbookComments Table](storing-additional-user-information-vb/_static/image50.png)](storing-additional-user-information-vb/_static/image49.png)</span></span>

<span data-ttu-id="fd7c5-386">**Abbildung 17**: sehen Sie die Gästebuchkommentaren in der `GuestbookComments` Tabelle ([klicken Sie hier, um das Bild in voller Größe angezeigt](storing-additional-user-information-vb/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="fd7c5-386">**Figure 17**: You Can See the Guestbook Comments in the `GuestbookComments` Table  ([Click to view full-size image](storing-additional-user-information-vb/_static/image51.png))</span></span>


> [!NOTE]
> <span data-ttu-id="fd7c5-387">Gefährliche Markup – z. B. HTML – ASP.NET wird ausgelöst, wenn ein Benutzer versucht, einen Gästebuch Kommentar einfügen, die potenziell enthält eine `HttpRequestValidationException`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-387">If a user attempts to insert a guestbook comment that contains potentially dangerous markup – such as HTML – ASP.NET will throw an `HttpRequestValidationException`.</span></span> <span data-ttu-id="fd7c5-388">Weitere Informationen finden Sie Informationen zu dieser Ausnahme, warum es ausgelöst wird, und wie Benutzer zum Übermitteln von potenziell gefährlichen Werte zulässt, finden Sie in der [anfordern Überprüfung Whitepaper](../../../../whitepapers/request-validation.md).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-388">To learn more about this exception, why it's thrown, and how to permit users to submit potentially dangerous values, consult the [Request Validation Whitepaper](../../../../whitepapers/request-validation.md).</span></span>


## <a name="step-5-listing-the-existing-guestbook-comments"></a><span data-ttu-id="fd7c5-389">Schritt 5: Auflisten von vorhandenen Gästebuchkommentaren</span><span class="sxs-lookup"><span data-stu-id="fd7c5-389">Step 5: Listing the Existing Guestbook Comments</span></span>

<span data-ttu-id="fd7c5-390">Zusätzlich zu verlassen Kommentare, die ein Benutzer Zugriff auf die `Guestbook.aspx` Seite sollte auch in der Lage, vorhandene Kommentare des angezeigten anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-390">In addition to leaving comments, a user visiting the `Guestbook.aspx` page should also be able to view the guestbook's existing comments.</span></span> <span data-ttu-id="fd7c5-391">Um dies zu erreichen, fügen Sie einem ListView-Steuerelement mit dem Namen `CommentList` zum unteren Rand der Seite.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-391">To accomplish this, add a ListView control named `CommentList` to the bottom of the page.</span></span>

> [!NOTE]
> <span data-ttu-id="fd7c5-392">ListView-Steuerelement ist neu in ASP.NET Version 3.5.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-392">The ListView control is new to ASP.NET version 3.5.</span></span> <span data-ttu-id="fd7c5-393">Es dient zum Anzeigen einer Liste von Elementen in einem Layout sehr anpassbar und flexible noch immer noch bieten integrierte bearbeiten, einfügen, löschen, paging und Sortieren von Funktionen wie die GridView.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-393">It is designed to display a list of items in a very customizable and flexible layout, yet still offer built-in editing, inserting, deleting, paging, and sorting functionality like the GridView.</span></span> <span data-ttu-id="fd7c5-394">Wenn Sie ASP.NET 2.0 verwenden, müssen Sie stattdessen das DataList oder Wiederholungsmodul-Steuerelement verwenden.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-394">If you are using ASP.NET 2.0, you will need to use the DataList or Repeater control instead.</span></span> <span data-ttu-id="fd7c5-395">Weitere Informationen finden Sie unter der ListView, finden Sie unter [Scott Guthrie](https://weblogs.asp.net/scottgu/)des Blogeintrag [die Asp: ListView-Steuerelement](https://weblogs.asp.net/scottgu/archive/2007/08/10/the-asp-listview-control-part-1-building-a-product-listing-page-with-clean-css-ui.aspx), und Meine Artikel [Anzeigen von Daten mit dem ListView-Steuerelement](http://aspnet.4guysfromrolla.com/articles/122607-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-395">For more information on using the ListView, see [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog entry, [The asp:ListView Control](https://weblogs.asp.net/scottgu/archive/2007/08/10/the-asp-listview-control-part-1-building-a-product-listing-page-with-clean-css-ui.aspx), and my article, [Displaying Data with the ListView Control](http://aspnet.4guysfromrolla.com/articles/122607-1.aspx).</span></span>


<span data-ttu-id="fd7c5-396">Öffnen Sie das ListView-Smarttag und aus der Datenquelle auswählen Dropdown-Liste binden Sie das Steuerelement an eine neue Datenquelle.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-396">Open the ListView's Smart Tag and, from the Choose Data Source drop-down list, bind the control to a new data source.</span></span> <span data-ttu-id="fd7c5-397">Wie in Schritt2 veranschaulichte Filtermenü, wird hierdurch der Konfigurations-Assistent gestartet.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-397">As we saw in Step 2, this will launch the Data Source Configuration Wizard.</span></span> <span data-ttu-id="fd7c5-398">Wählen Sie das Symbol "Datenbank" aus, nennen Sie die resultierende SqlDataSource `CommentsDataSource`, und klicken Sie auf OK.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-398">Select the Database icon, name the resulting SqlDataSource `CommentsDataSource`, and click OK.</span></span> <span data-ttu-id="fd7c5-399">Wählen Sie als Nächstes die `SecurityTutorialsConnectionString` Verbindung die Zeichenfolge, aus der Dropdown Liste, und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-399">Next, select the `SecurityTutorialsConnectionString` connection string from the drop-down list and click Next.</span></span>

<span data-ttu-id="fd7c5-400">An diesem Punkt in Schritt2 angegebenen die Daten in der Abfrage durch Entnahme der `UserProfiles` Tabelle aus der Dropdown-Liste, und wählen Sie die Spalten zurückgegeben (siehe Abbildung 9).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-400">At this point in Step 2 we specified the data to query by picking the `UserProfiles` table from the drop-down list and selecting the columns to return (refer back to Figure 9).</span></span> <span data-ttu-id="fd7c5-401">Diesmal allerdings wir auf Wunsch eine SQL-Anweisung zu erstellen, die nicht nur die Datensätze aus sichern Synchronisierungsmodul `GuestbookComments`, aber auch die eingeblendet home Örtlichkeit, Startseite, Signatur und Benutzername.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-401">This time, however, we want to craft a SQL statement that pulls back not only the records from `GuestbookComments`, but also the commenter's home town, homepage, signature, and username.</span></span> <span data-ttu-id="fd7c5-402">Daher wählen Sie das Optionsfeld "Geben Sie eine benutzerdefinierte SQL-Anweisung oder gespeicherte Prozedur", und klicken Sie auf Weiter.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-402">Therefore, select the "Specify a custom SQL statement or stored procedure" radio button and click Next.</span></span>

<span data-ttu-id="fd7c5-403">Hierdurch wird der Bildschirm "Definieren Sie benutzerdefinierte Anweisungen oder gespeicherten Prozeduren" angezeigt.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-403">This will bring up the "Define Custom Statements or Stored Procedures" screen.</span></span> <span data-ttu-id="fd7c5-404">Klicken Sie auf die Schaltfläche Abfrage-Generator, um die Abfrage grafisch zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-404">Click the Query Builder button to graphically build the query.</span></span> <span data-ttu-id="fd7c5-405">Abfrage-Generator startet, indem Sie aufgefordert, die Tabellen angeben, die abgefragt werden soll.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-405">The Query Builder starts by prompting us to specify the tables we want to query from.</span></span> <span data-ttu-id="fd7c5-406">Wählen Sie die `GuestbookComments`, `UserProfiles`, und `aspnet_Users` Tabellen aus, und klicken Sie auf OK.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-406">Select the `GuestbookComments`, `UserProfiles`, and `aspnet_Users` tables and click OK.</span></span> <span data-ttu-id="fd7c5-407">Dadurch werden alle drei Tabellen, die der Entwurfsoberfläche hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-407">This will add all three tables to the design surface.</span></span> <span data-ttu-id="fd7c5-408">Da es sich um foreign Key-Einschränkungen bei der `GuestbookComments`, `UserProfiles`, und `aspnet_Users` Tabellen, den Abfrage-Generator automatisch `JOIN` s Diese Tabellen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-408">Since there are foreign key constraints amongst the `GuestbookComments`, `UserProfiles`, and `aspnet_Users` tables, the Query Builder automatically `JOIN` s these tables.</span></span>

<span data-ttu-id="fd7c5-409">Alle bleibt ist die Angabe der Spalten zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-409">All that remains is to specify the columns to return.</span></span> <span data-ttu-id="fd7c5-410">Aus der `GuestbookComments` Tabelle die `Subject`, `Body`, und `CommentDate` Spalten; zurückgeben der `HomeTown`, `HomepageUrl`, und `Signature` Spalten aus der `UserProfiles` Tabelle; und zurückgeben `UserName` aus `aspnet_Users`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-410">From the `GuestbookComments` table select the `Subject`, `Body`, and `CommentDate` columns; return the `HomeTown`, `HomepageUrl`, and `Signature` columns from the `UserProfiles` table; and return `UserName` from `aspnet_Users`.</span></span> <span data-ttu-id="fd7c5-411">Darüber hinaus hinzufügen "`ORDER BY CommentDate DESC`" am Ende der `SELECT` abzufragen, damit die neuesten Beiträge zuerst zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-411">Also, add "`ORDER BY CommentDate DESC`" to the end of the `SELECT` query so that the most recent posts are returned first.</span></span> <span data-ttu-id="fd7c5-412">Nachdem Sie die Auswahl vornehmen, sollte Ihre Abfrage-Generator-Schnittstelle im Screenshot in Abbildung 18 ähneln.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-412">After making these selections, your Query Builder interface should look similar to the screen shot in Figure 18.</span></span>


<span data-ttu-id="fd7c5-413">[![Die Abfrage erstellt verknüpft werden soll, die GuestbookComments %Benutzerprofile% und Aspnet_Users Tabellen](storing-additional-user-information-vb/_static/image53.png)](storing-additional-user-information-vb/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-413">[![The Constructed Query JOINs the GuestbookComments, UserProfiles, and aspnet_Users Tables](storing-additional-user-information-vb/_static/image53.png)](storing-additional-user-information-vb/_static/image52.png)</span></span>

<span data-ttu-id="fd7c5-414">**Abbildung 18**: die erstellte Abfrage `JOIN` s der `GuestbookComments`, `UserProfiles`, und `aspnet_Users` Tabellen ([klicken Sie hier, um das Bild in voller Größe angezeigt](storing-additional-user-information-vb/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="fd7c5-414">**Figure 18**: The Constructed Query `JOIN` s the `GuestbookComments`, `UserProfiles`, and `aspnet_Users` Tables  ([Click to view full-size image](storing-additional-user-information-vb/_static/image54.png))</span></span>


<span data-ttu-id="fd7c5-415">Klicken Sie auf OK, um das Abfrage-Generator-Fenster zu schließen und auf dem Bildschirm "Definieren Sie benutzerdefinierte Anweisungen oder gespeicherten Prozeduren" zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-415">Click OK to close the Query Builder window and return to the "Define Custom Statements or Stored Procedures" screen.</span></span> <span data-ttu-id="fd7c5-416">Klicken Sie auf Weiter, um zum Bildschirm "Testabfrage", in dem Sie die Ergebnisse der Abfrage anzeigen können, indem Sie auf die Schaltfläche "Testabfrage".</span><span class="sxs-lookup"><span data-stu-id="fd7c5-416">Click Next to advance to the "Test Query" screen, where you may view the query results by clicking the Test Query button.</span></span> <span data-ttu-id="fd7c5-417">Wenn Sie bereit sind, klicken Sie auf "Fertig stellen", um die Datenquelle konfigurieren-Assistenten zu beenden.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-417">When you're ready, click Finish to complete the Configure Data Source wizard.</span></span>

<span data-ttu-id="fd7c5-418">Wenn wir das Konfigurieren von Datenquellen-Assistenten in Schritt2, DetailsView zugeordneten Steuerelements des abgeschlossen `Fields` Auflistung wurde aktualisiert, damit ein BoundField für jede Spalte zurückgegebene enthalten die `SelectCommand`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-418">When we completed the Configure Data Source wizard in Step 2, the associated DetailsView control's `Fields` collection was updated to include a BoundField for each column returned by the `SelectCommand`.</span></span> <span data-ttu-id="fd7c5-419">ListView, bleibt jedoch unverändert. Wir müssen noch das zugehörige Layout zu definieren.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-419">The ListView, however, remains unchanged; we still need to define its layout.</span></span> <span data-ttu-id="fd7c5-420">Das Layout der ListView kann manuell über seine deklarativem Markup oder die Option "ListView konfigurieren" in seinem Smarttag erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-420">The ListView's layout can be constructed manually through its declarative markup or from the "Configure ListView" option in its Smart Tag.</span></span> <span data-ttu-id="fd7c5-421">Ich in der Regel bevorzugen das Markup manuell definieren, aber verwenden die geeignete Methode für Sie am häufigsten natürliche ist.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-421">I usually prefer defining the markup by hand, but use whatever method is most natural to you.</span></span>

<span data-ttu-id="fd7c5-422">Ich sah mithilfe des folgenden `LayoutTemplate`, `ItemTemplate`, und `ItemSeparatorTemplate` für ListView-Steuerelement:</span><span class="sxs-lookup"><span data-stu-id="fd7c5-422">I ended up using the following `LayoutTemplate`, `ItemTemplate`, and `ItemSeparatorTemplate` for my ListView control:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample10.aspx)]

<span data-ttu-id="fd7c5-423">Die `LayoutTemplate` definiert das Markup dagegen vom Steuerelement ausgegeben, die `ItemTemplate` rendert jedes Element der SqlDataSource zurückgegebenes.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-423">The `LayoutTemplate` defines the markup emitted by the control, while the `ItemTemplate` renders each item returned by the SqlDataSource.</span></span> <span data-ttu-id="fd7c5-424">Die `ItemTemplate`des resultierenden Markup befindet sich der `LayoutTemplate`des `itemPlaceholder` Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-424">The `ItemTemplate`'s resulting markup is placed in the `LayoutTemplate`'s `itemPlaceholder` control.</span></span> <span data-ttu-id="fd7c5-425">Zusätzlich zu den `itemPlaceholder`, die `LayoutTemplate` enthält ein DataPager-Steuerelement, das ListView mit 10 Gästebuchkommentaren pro Seite (Standard) beschränkt und rendert eine Auslagerungsdatei-Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-425">In addition to the `itemPlaceholder`, the `LayoutTemplate` includes a DataPager control, which limits the ListView to showing just 10 guestbook comments per page (the default) and renders a paging interface.</span></span>

<span data-ttu-id="fd7c5-426">Meine `ItemTemplate` zeigt jeder Gästebuch Kommentar Betreff in ein `<h4>` Element mit dem Text unterhalb der Antragsteller.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-426">My `ItemTemplate` displays each guestbook comment's subject in an `<h4>` element with the body situated below the subject.</span></span> <span data-ttu-id="fd7c5-427">Beachten Sie, dass diese Syntax für das Anzeigen von Text verwendet die zurückgegebene Daten akzeptiert die `Eval("Body")` Databinding-Anweisung in eine Zeichenfolge konvertiert und Zeilenumbrüche mit ersetzt die `<br />` Element.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-427">Note that that syntax used for displaying the body takes the data returned by the `Eval("Body")` databinding statement, converts it to a string, and replaces line breaks with the `<br />` element.</span></span> <span data-ttu-id="fd7c5-428">Diese Konvertierung ist erforderlich, um die Zeilenumbrüche eingegeben, wenn den Kommentar zu senden, da Leerzeichen von HTML ignoriert wird angezeigt.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-428">This conversion is needed in order to show the line breaks entered when submitting the comment since whitespace is ignored by HTML.</span></span> <span data-ttu-id="fd7c5-429">Der Benutzer-Signatur wird unterhalb der Text kursiv, gefolgt von der Startseite des Benutzers Örtlichkeit, die einen Link zu seiner Startseite, das Datum und Uhrzeit der Kommentar erstellt wurde und der Benutzername der Person, die den Kommentar links angezeigt.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-429">The user's signature is displayed beneath the body in italics, followed by the user's home town, a link to his homepage, the date and time the comment was made, and the username of the person who left the comment.</span></span>

<span data-ttu-id="fd7c5-430">Nehmen Sie einen Moment Zeit, um die Seite über einen Browser anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-430">Take a moment to view the page through a browser.</span></span> <span data-ttu-id="fd7c5-431">Die Kommentare, die Sie in Schritt 5, die hier angezeigten angezeigten hinzugefügt haben, sollte angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-431">You should see the comments that you added to the guestbook in Step 5 displayed here.</span></span>


<span data-ttu-id="fd7c5-432">[![GuestBook.aspx jetzt zeigt des angezeigten Kommentare an.](storing-additional-user-information-vb/_static/image56.png)](storing-additional-user-information-vb/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-432">[![Guestbook.aspx Now Displays the Guestbook's Comments](storing-additional-user-information-vb/_static/image56.png)](storing-additional-user-information-vb/_static/image55.png)</span></span>

<span data-ttu-id="fd7c5-433">**Abbildung 19**: `Guestbook.aspx` zeigt jetzt angezeigtens Kommentare ([klicken Sie hier, um das Bild in voller Größe angezeigt](storing-additional-user-information-vb/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="fd7c5-433">**Figure 19**: `Guestbook.aspx` Now Displays the Guestbook's Comments  ([Click to view full-size image](storing-additional-user-information-vb/_static/image57.png))</span></span>


<span data-ttu-id="fd7c5-434">Wiederholen Sie den angezeigten einen neuen Kommentar hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-434">Try adding a new comment to the guestbook.</span></span> <span data-ttu-id="fd7c5-435">Wenn Sie auf die `PostCommentButton` Schaltfläche Seite sendet zurück und der Kommentar wird in der Datenbank hinzugefügt, aber das ListView-Steuerelement ist nicht aktualisiert, um den neuen Kommentar anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-435">Upon clicking the `PostCommentButton` button the page posts back and the comment is added to the database, but the ListView control is not updated to show the new comment.</span></span> <span data-ttu-id="fd7c5-436">Dies kann entweder durch korrigiert werden:</span><span class="sxs-lookup"><span data-stu-id="fd7c5-436">This can be fixed by either:</span></span>

- <span data-ttu-id="fd7c5-437">Aktualisieren der `PostCommentButton` Schaltfläche `Click` Ereignishandler so, dass die It des ListView-Steuerelements ruft `DataBind()` Methode auf, nachdem der neue Kommentar wird in der Datenbank eingefügt oder</span><span class="sxs-lookup"><span data-stu-id="fd7c5-437">Updating the `PostCommentButton` button's `Click` event handler so that it invokes the ListView control's `DataBind()` method after inserting the new comment into the database, or</span></span>
- <span data-ttu-id="fd7c5-438">Festlegen der ListView-Steuerelement `EnableViewState` Eigenschaft `False`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-438">Setting the ListView control's `EnableViewState` property to `False`.</span></span> <span data-ttu-id="fd7c5-439">Dieser Ansatz funktioniert, da durch das Deaktivieren Ansichtszustand des Steuerelements, der zugrunde liegenden Daten für jedes Postback binden müssen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-439">This approach works because by disabling the control's view state, it must rebind to the underlying data on every postback.</span></span>

<span data-ttu-id="fd7c5-440">Die Tutorial Website herunterladbaren aus diesem Lernprogramm werden beide Verfahren veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-440">The tutorial website downloadable from this tutorial illustrates both techniques.</span></span> <span data-ttu-id="fd7c5-441">ListView-Steuerelement `EnableViewState` Eigenschaft `False` und der Code erforderlich, um die Daten in der Listenansicht programmgesteuert binden ist vorhanden, in der `Click` Ereignishandler, d. h. jedoch auskommentiert ist.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-441">The ListView control's `EnableViewState` property to `False` and the code needed to programmatically rebind the data to the ListView is present in the `Click` event handler, but is commented out.</span></span>

> [!NOTE]
> <span data-ttu-id="fd7c5-442">Derzeit die `AdditionalUserInfo.aspx` ermöglicht es dem Benutzer anzeigen und bearbeiten ihre home Örtlichkeit Homepage und Signatur-Einstellungen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-442">Currently the `AdditionalUserInfo.aspx` page allows the user to view and edit their home town, homepage, and signature settings.</span></span> <span data-ttu-id="fd7c5-443">Ist es möglicherweise aktualisieren nice `AdditionalUserInfo.aspx` anzuzeigenden des angemeldeten Benutzers Gästebuchkommentaren.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-443">It might be nice to update `AdditionalUserInfo.aspx` to display the logged in user's guestbook comments.</span></span> <span data-ttu-id="fd7c5-444">D. h. zusätzlich zu untersuchen, und ändern ihre Informationen können Benutzer besuchen der `AdditionalUserInfo.aspx` Bild, um anzuzeigen, welche Gästebuch Kommentare in der Vergangenheit getroffen wird.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-444">That is, in addition to examining and modifying her information, a user can visit the `AdditionalUserInfo.aspx` page to see what guestbook comments she's made in the past.</span></span> <span data-ttu-id="fd7c5-445">Ich lassen Sie dieses als Übung für die gewünschten Reader.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-445">I leave this as an exercise for the interested reader.</span></span>


## <a name="step-6-customizing-the-createuserwizard-control-to-include-an-interface-for-the-home-town-homepage-and-signature"></a><span data-ttu-id="fd7c5-446">Schritt 6: Anpassen des Steuerelements CreateUserWizard, um eine Schnittstelle für die Startseite Örtlichkeit, Homepage und Signatur enthalten.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-446">Step 6: Customizing the CreateUserWizard Control to Include an Interface for the Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="fd7c5-447">Die `SELECT` von verwendeten Abfrage der `Guestbook.aspx` Seite verwendet ein `INNER JOIN` kombiniert die verknüpften Datensätzen unter der `GuestbookComments`, `UserProfiles`, und `aspnet_Users` Tabellen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-447">The `SELECT` query used by the `Guestbook.aspx` page uses an `INNER JOIN` to combine the related records amongst the `GuestbookComments`, `UserProfiles`, and `aspnet_Users` tables.</span></span> <span data-ttu-id="fd7c5-448">Wenn ein Benutzer, die kein Datensatz in `UserProfiles` macht eine Gästebuch Kommentar, der Kommentar wird nicht in der Listenansicht angezeigt werden, da die `INNER JOIN` wird nur zurückgegeben `GuestbookComments` Datensätze bei übereinstimmenden Datensätze in `UserProfiles` und `aspnet_Users`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-448">If a user that has no record in `UserProfiles` makes a guestbook comment, the comment won't be displayed in the ListView because the `INNER JOIN` only returns `GuestbookComments` records when there are matching records in `UserProfiles` and `aspnet_Users`.</span></span> <span data-ttu-id="fd7c5-449">Und wie in Schritt 3 veranschaulichte Filtermenü verfügt ein Benutzer keinen Datensatz `UserProfiles` sie nicht anzeigen oder bearbeiten Sie ihre Einstellungen in der `AdditionalUserInfo.aspx` Seite.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-449">And as we saw in Step 3, if a user does not have a record in `UserProfiles` she cannot view or edit her settings in the `AdditionalUserInfo.aspx` page.</span></span>

<span data-ttu-id="fd7c5-450">Selbstverständlich aufgrund unserer Entwurf Entscheidungen, die es ist wichtig, dass jedem Benutzerkonto in das Mitgliedschaftssystem einen übereinstimmenden haben zeichnen Sie in der `UserProfiles` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-450">Needless to say, due to our design decisions it is important that every user account in the Membership system have a matching record in the `UserProfiles` table.</span></span> <span data-ttu-id="fd7c5-451">Das Ziel ist für einen entsprechenden Eintrag hinzugefügt werden `UserProfiles` sobald ein neues Mitgliedskonto für Benutzer über die CreateUserWizard erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-451">What we want is for a corresponding record to be added to `UserProfiles` whenever a new Membership user account is created through the CreateUserWizard.</span></span>

<span data-ttu-id="fd7c5-452">Wie in beschrieben die [ *Erstellen von Benutzerkonten* ](creating-user-accounts-vb.md) löst Lernprogramm, nachdem das neue Benutzerkonto von Mitgliedschaft CreateUserWizard-Steuerelement erstellt wird seine [ `CreatedUser` Ereignis](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-452">As discussed in the [*Creating User Accounts*](creating-user-accounts-vb.md) tutorial, after the new Membership user account is created the CreateUserWizard control raises its [`CreatedUser` event](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx).</span></span> <span data-ttu-id="fd7c5-453">Wir können einen Ereignishandler für dieses Ereignis erstellen, erhalten die Benutzer-ID für den gerade erstellten Benutzer und dann fügen Sie einen Datensatz in der `UserProfiles` Tabelle mit Standardwerten für die `HomeTown`, `HomepageUrl`, und `Signature` Spalten.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-453">We can create an event handler for this event, get the UserId for the just-created user, and then insert a record into the `UserProfiles` table with default values for the `HomeTown`, `HomepageUrl`, and `Signature` columns.</span></span> <span data-ttu-id="fd7c5-454">Dazu ist es möglich, die den Benutzer für diese Werte aufgefordert werden, durch das Anpassen des Steuerelements CreateUserWizard-Schnittstelle, um zusätzliche Textfelder einschließen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-454">What's more, it is possible to prompt the user for these values by customizing the CreateUserWizard control's interface to include additional TextBoxes.</span></span>

<span data-ttu-id="fd7c5-455">Sehen wir uns zunächst an, wie eine neue Zeile hinzufügen der `UserProfiles` -Tabelle in der `CreatedUser` -Ereignishandler mit Standardwerten.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-455">Let's first look at how to add a new row to the `UserProfiles` table in the `CreatedUser` event handler with default values.</span></span> <span data-ttu-id="fd7c5-456">Danach sehen wir zum Anpassen des Steuerelements CreateUserWizard Benutzeroberfläche Einbeziehung zusätzlicher Formularfelder, um des neuen Benutzers home Örtlichkeit Homepage und Signatur zu sammeln.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-456">Following that, we will see how to customize the CreateUserWizard control's user interface to include additional form fields to collect the new user's home town, homepage, and signature.</span></span>

### <a name="adding-a-default-row-touserprofiles"></a><span data-ttu-id="fd7c5-457">Hinzufügen einer Standard-Zeile auf`UserProfiles`</span><span class="sxs-lookup"><span data-stu-id="fd7c5-457">Adding a Default Row to`UserProfiles`</span></span>

<span data-ttu-id="fd7c5-458">In der [ *Erstellen von Benutzerkonten* ](creating-user-accounts-vb.md) Lernprogramm, die wir, ein Steuerelement CreateUserWizard hinzugefügt der `CreatingUserAccounts.aspx` auf der Seite der `Membership` Ordner.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-458">In the [*Creating User Accounts*](creating-user-accounts-vb.md) tutorial we added a CreateUserWizard control to the `CreatingUserAccounts.aspx` page in the `Membership` folder.</span></span> <span data-ttu-id="fd7c5-459">Um die CreateUserWizard haben Steuerelement einen Datensatz hinzufügen `UserProfiles` Tabelle nach Benutzerkonto erstellen, müssen wir die CreateUserWizard Funktionalität des Steuerelements zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-459">In order to have the CreateUserWizard control add a record to `UserProfiles` table upon user account creation, we need to update the CreateUserWizard control's functionality.</span></span> <span data-ttu-id="fd7c5-460">Statt diesen Änderungen an der `CreatingUserAccounts.aspx` Seite, fügen Sie ein neues CreateUserWizard-Steuerelement, um stattdessen `EnhancedCreateUserWizard.aspx` Seite, und nehmen Sie die Änderungen für dieses Lernprogramm vorhanden.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-460">Rather than making these changes to the `CreatingUserAccounts.aspx` page, let's instead add a new CreateUserWizard control to `EnhancedCreateUserWizard.aspx` page and make the modifications for this tutorial there.</span></span>

<span data-ttu-id="fd7c5-461">Öffnen der `EnhancedCreateUserWizard.aspx` Seite in Visual Studio, und ziehen Sie ein CreateUserWizard-Steuerelement aus der Toolbox auf die Seite.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-461">Open the `EnhancedCreateUserWizard.aspx` page in Visual Studio and drag a CreateUserWizard control from the Toolbox onto the page.</span></span> <span data-ttu-id="fd7c5-462">Legen Sie die CreateUserWizard `ID` Eigenschaft `NewUserWizard`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-462">Set the CreateUserWizard control's `ID` property to `NewUserWizard`.</span></span> <span data-ttu-id="fd7c5-463">Wie in erläutert die [ *Erstellen von Benutzerkonten* ](creating-user-accounts-vb.md) Lernprogramm, das CreateUserWizard Standardbenutzeroberfläche fordert den Besucher für die erforderlichen Informationen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-463">As we discussed in the [*Creating User Accounts*](creating-user-accounts-vb.md) tutorial, the CreateUserWizard's default user interface prompts the visitor for the necessary information.</span></span> <span data-ttu-id="fd7c5-464">Sobald diese Informationen angegeben wurden, erstellt das Steuerelement ein neues Benutzerkonto intern im Framework Mitgliedschaft ohne uns eine einzige Codezeile schreiben müssen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-464">Once this information has been supplied, the control internally creates a new user account in the Membership framework, all without us having to write a single line of code.</span></span>

<span data-ttu-id="fd7c5-465">Das Steuerelement CreateUserWizard löst eine Anzahl von Ereignissen während des Workflows aus.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-465">The CreateUserWizard control raises a number of events during its workflow.</span></span> <span data-ttu-id="fd7c5-466">Nachdem ein Besucher die Anforderungsinformationen bereitstellt und das Formular übermittelt, das Steuerelement CreateUserWizard anfänglich ausgelöst wird seine [ `CreatingUser` Ereignis](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.createuserwizard.creatinguser.aspx).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-466">After a visitor supplies the request information and submits the form, the CreateUserWizard control initially fires its [`CreatingUser` event](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.createuserwizard.creatinguser.aspx).</span></span> <span data-ttu-id="fd7c5-467">Wenn es ein Problem während des Erstellungsvorgangs liegt der [ `CreateUserError` Ereignis](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.createuserwizard.createusererror.aspx) ausgelöst wird; jedoch, wenn der Benutzer erfolgreich erstellt wurde, wird das [ `CreatedUser` Ereignis](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx) ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-467">If there is a problem during the create process, the [`CreateUserError` event](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.createuserwizard.createusererror.aspx) is fired; however, if the user is successfully created, then the [`CreatedUser` event](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx) is raised.</span></span> <span data-ttu-id="fd7c5-468">In der [ *Erstellen von Benutzerkonten* ](creating-user-accounts-vb.md) Lernprogramm wir einen Ereignishandler für erstellt das `CreatingUser` Ereignis, um sicherzustellen, dass alle führenden oder nachgestellten Leerzeichen und der angegebene Benutzernamen nicht enthalten hat die der Benutzername wurde nicht an einer beliebigen Stelle im Kennwort angezeigt.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-468">In the [*Creating User Accounts*](creating-user-accounts-vb.md) tutorial we created an event handler for the `CreatingUser` event to ensure that the supplied username did not contain any leading or trailing spaces, and that the username did not appear anywhere in the password.</span></span>

<span data-ttu-id="fd7c5-469">Zum Hinzufügen einer Zeile in der `UserProfiles` Tabelle für den gerade erstellten Benutzer müssen wir erstellen Sie einen Ereignishandler für das `CreatedUser` Ereignis.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-469">In order to add a row in the `UserProfiles` table for the just-created user, we need to create an event handler for the `CreatedUser` event.</span></span> <span data-ttu-id="fd7c5-470">Nach der Dauer der `CreatedUser` Ereignis ausgelöst wurde, das Benutzerkonto wurde bereits in Mitgliedschaft Framework, aktivieren uns um das Konto UserId Wert abzurufen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-470">By the time the `CreatedUser` event has fired, the user account has already been created in the Membership framework, enabling us to retrieve the account's UserId value.</span></span>

<span data-ttu-id="fd7c5-471">Erstellen Sie einen Ereignishandler für das `NewUserWizard`des `CreatedUser` Ereignis und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="fd7c5-471">Create an event handler for the `NewUserWizard`'s `CreatedUser` event and add the following code:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample11.vb)]

<span data-ttu-id="fd7c5-472">Der obige Code Menschen durch Abrufen der Benutzer-ID für das gerade hinzugefügte Benutzerkonto.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-472">The above code beings by retrieving the UserId of the just-added user account.</span></span> <span data-ttu-id="fd7c5-473">Dies erfolgt mithilfe der `Membership.GetUser(username)` Methode zum Zurückgeben von Informationen über einen bestimmten Benutzer, und klicken Sie dann mit der `ProviderUserKey` Eigenschaft, für ihre Benutzer-ID abgerufen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-473">This is accomplished by using the `Membership.GetUser(username)` method to return information about a particular user, and then using the `ProviderUserKey` property to retrieve their UserId.</span></span> <span data-ttu-id="fd7c5-474">Der vom Benutzer im Steuerelement CreateUserWizard eingegebene Benutzername ist über seine [ `UserName` Eigenschaft](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.createuserwizard.username.aspx).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-474">The username entered by the user in the CreateUserWizard control is available via its [`UserName` property](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.createuserwizard.username.aspx).</span></span>

<span data-ttu-id="fd7c5-475">Als Nächstes wird die Verbindungszeichenfolge abgerufen, von `Web.config` und `INSERT` -Anweisung angegeben.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-475">Next, the connection string is retrieved from `Web.config` and the `INSERT` statement is specified.</span></span> <span data-ttu-id="fd7c5-476">ADO.NET-Objekte instanziiert werden, und der Befehl ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-476">The necessary ADO.NET objects are instantiated and the command executed.</span></span> <span data-ttu-id="fd7c5-477">Weist der Code eine [ `DBNull` ](https://msdn.microsoft.com/en-us/library/system.dbnull.aspx) -Instanz, auf die `@HomeTown`, `@HomepageUrl`, und `@Signature` -Parameter, die Datenbank einfügen, hat `NULL` Werte für die `HomeTown`, `HomepageUrl`, und `Signature` Felder.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-477">The code assigns a [`DBNull`](https://msdn.microsoft.com/en-us/library/system.dbnull.aspx) instance to the `@HomeTown`, `@HomepageUrl`, and `@Signature` parameters, which has the effect of inserting database `NULL` values for the `HomeTown`, `HomepageUrl`, and `Signature` fields.</span></span>

<span data-ttu-id="fd7c5-478">Besuchen Sie die `EnhancedCreateUserWizard.aspx` Seite über einen Browser, und erstellen Sie ein neues Benutzerkonto.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-478">Visit the `EnhancedCreateUserWizard.aspx` page through a browser and create a new user account.</span></span> <span data-ttu-id="fd7c5-479">Nach der Anmeldung zurück zu Visual Studio, und Untersuchen des Inhalts der `aspnet_Users` und `UserProfiles` Tabellen (wie in Abbildung 12).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-479">After doing so, return to Visual Studio and examine the contents of the `aspnet_Users` and `UserProfiles` tables (like we did back in Figure 12).</span></span> <span data-ttu-id="fd7c5-480">Daraufhin sollte das neue Benutzerkonto in `aspnet_Users` und einer entsprechenden `UserProfiles` Zeile (mit `NULL` Werte für `HomeTown`, `HomepageUrl`, und `Signature`).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-480">You should see the new user account in `aspnet_Users` and a corresponding `UserProfiles` row (with `NULL` values for `HomeTown`, `HomepageUrl`, and `Signature`).</span></span>


<span data-ttu-id="fd7c5-481">[![Ein neues Benutzerkonto und %Benutzerprofile% Datensatz wurden hinzugefügt](storing-additional-user-information-vb/_static/image59.png)](storing-additional-user-information-vb/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-481">[![A New User Account and UserProfiles Record Have Been Added](storing-additional-user-information-vb/_static/image59.png)](storing-additional-user-information-vb/_static/image58.png)</span></span>

<span data-ttu-id="fd7c5-482">**Abbildung 20**: ein neues Benutzerkonto und `UserProfiles` Datensatz hinzugefügt wurden ([klicken Sie hier, um das Bild in voller Größe angezeigt](storing-additional-user-information-vb/_static/image60.png))</span><span class="sxs-lookup"><span data-stu-id="fd7c5-482">**Figure 20**: A New User Account and `UserProfiles` Record Have Been Added  ([Click to view full-size image](storing-additional-user-information-vb/_static/image60.png))</span></span>


<span data-ttu-id="fd7c5-483">Nachdem der Besucher seinen neuen Kontoinformationen angegeben und auf die Schaltfläche "Benutzer erstellen" geklickt hat, das Benutzerkonto erstellt wird und eine Zeile hinzugefügt, die `UserProfiles` Tabelle.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-483">After the visitor has supplied his new account information and clicked the "Create User" button, the user account is created and a row added to the `UserProfiles` table.</span></span> <span data-ttu-id="fd7c5-484">Zeigt die CreateUserWizard dann seine `CompleteWizardStep`, woraufhin eine Erfolgsmeldung und eine Schaltfläche "Weiter".</span><span class="sxs-lookup"><span data-stu-id="fd7c5-484">The CreateUserWizard then displays its `CompleteWizardStep`, which displays a success message and a Continue button.</span></span> <span data-ttu-id="fd7c5-485">Klicken auf die Schaltfläche "Weiter" bewirkt, dass ein Postback handeln, jedoch wird keine Aktion ausgeführt, verlässt des Benutzers auf hängen die `EnhancedCreateUserWizard.aspx` Seite.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-485">Clicking the Continue button causes a postback, but no action is taken, leaving the user stuck on the `EnhancedCreateUserWizard.aspx` page.</span></span>

<span data-ttu-id="fd7c5-486">Wir können Geben Sie eine URL zum Senden des Benutzers, wenn die Schaltfläche "Weiter", über des CreateUserWizard Steuerelements geklickt wird [ `ContinueDestinationPageUrl` Eigenschaft](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-486">We can specify a URL to send the user to when the Continue button is clicked via the CreateUserWizard control's [`ContinueDestinationPageUrl` property](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx).</span></span> <span data-ttu-id="fd7c5-487">Legen Sie die `ContinueDestinationPageUrl` -Eigenschaft auf "~ / Membership/AdditionalUserInfo.aspx".</span><span class="sxs-lookup"><span data-stu-id="fd7c5-487">Set the `ContinueDestinationPageUrl` property to "~/Membership/AdditionalUserInfo.aspx".</span></span> <span data-ttu-id="fd7c5-488">Dies hat den neuen Benutzer zu `AdditionalUserInfo.aspx`, wobei sie können anzeigen und aktualisieren Sie ihre Einstellungen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-488">This takes the new user to `AdditionalUserInfo.aspx`, where they can view and update their settings.</span></span>

### <a name="customizing-the-createuserwizards-interface-to-prompt-for-the-new-users-home-town-homepage-and-signature"></a><span data-ttu-id="fd7c5-489">Anpassen der CreateUserWizard-Schnittstelle, um nach des neuen Benutzers Home-Stadt, Homepage und Signatur</span><span class="sxs-lookup"><span data-stu-id="fd7c5-489">Customizing the CreateUserWizard's Interface to Prompt for the New User's Home Town, Homepage, and Signature</span></span>

<span data-ttu-id="fd7c5-490">Standardschnittstelle CreateUserWizard-Steuerelement ist ausreichend, einfach Erstellung Szenarien, in denen nur Core Benutzerkontoinformationen wie Benutzername, Kennwort und e-Mail-gesammelt werden muss.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-490">The CreateUserWizard control's default interface is sufficient for simple account creation scenarios where only core user account information like username, password, and email need be collected.</span></span> <span data-ttu-id="fd7c5-491">Aber was geschieht, wenn die Besucher ihrer home Örtlichkeit Homepage und Signatur geben beim Erstellen von ihrem Konto aufgefordert werden sollten?</span><span class="sxs-lookup"><span data-stu-id="fd7c5-491">But what if we wanted to prompt the visitor to enter her home town, homepage, and signature while creating her account?</span></span> <span data-ttu-id="fd7c5-492">Es ist möglich, Anpassen des Steuerelements CreateUserWizard-Schnittstelle, um zusätzliche Informationen bei der Registrierung zu sammeln und diese Informationen kann verwendet werden, der `CreatedUser` -Ereignishandler, um zusätzliche Datensätze in der zugrunde liegenden Datenbank einzufügen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-492">It is possible to customize the CreateUserWizard control's interface to collect additional information at signup, and this information may be used in the `CreatedUser` event handler to insert additional records into the underlying database.</span></span>

<span data-ttu-id="fd7c5-493">Das Steuerelement CreateUserWizard erweitert das ASP.NET Assistenten-Steuerelement, das ein Steuerelement der Entwickler einer Seite zum Definieren einer Reihe von geordneten ermöglicht `WizardSteps`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-493">The CreateUserWizard control extends the ASP.NET Wizard control, which is a control that allows a page developer to define a series of ordered `WizardSteps`.</span></span> <span data-ttu-id="fd7c5-494">Das Assistenten-Steuerelement rendert aktiven Schritt und bietet eine Navigationsschnittstelle, die den Besucher so verschieben Sie diese Schritte aus, ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-494">The Wizard control renders the active step and provides a navigation interface that allows the visitor to move through these steps.</span></span> <span data-ttu-id="fd7c5-495">Das Assistenten-Steuerelement ist ideal für einen langen Task in mehrere kurze Schritte unterteilen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-495">The Wizard control is ideal for breaking down a long task into several short steps.</span></span> <span data-ttu-id="fd7c5-496">Weitere Informationen im Assistenten zum Steuerelement finden Sie unter [erstellen eine schrittweise Anleitung-Benutzeroberfläche mit dem Assistenten-Steuerelement in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/061406-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-496">For more information on the Wizard control, see [Creating a Step-by-Step User Interface with the ASP.NET 2.0 Wizard Control](http://aspnet.4guysfromrolla.com/articles/061406-1.aspx).</span></span>

<span data-ttu-id="fd7c5-497">Die CreateUserWizard Steuerelementmarkup Standard definiert zwei `WizardSteps`: `CreateUserWizardStep` und `CompleteWizardStep`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-497">The CreateUserWizard control's default markup defines two `WizardSteps`: `CreateUserWizardStep` and `CompleteWizardStep`.</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample12.aspx)]

<span data-ttu-id="fd7c5-498">Die erste `WizardStep`, `CreateUserWizardStep`, rendert die Schnittstelle, die der Benutzername, Kennwort, e-Mail usw. dazu aufgefordert werden.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-498">The first `WizardStep`, `CreateUserWizardStep`, renders the interface that prompts for the username, password, email, and so on.</span></span> <span data-ttu-id="fd7c5-499">Nachdem der Besucher diese Informationen werden bereitgestellt, und klickt auf "Create User", wird sie angezeigt der `CompleteWizardStep`, es zeigt bestätigungsmeldung und eine Schaltfläche "Weiter".</span><span class="sxs-lookup"><span data-stu-id="fd7c5-499">After the visitor supplies this information and clicks "Create User", she is shown the `CompleteWizardStep`, which shows the success message and a Continue button.</span></span>

<span data-ttu-id="fd7c5-500">Zum Anpassen des Steuerelements CreateUserWizard-Schnittstelle, um zusätzliche Felder enthalten, können wir folgende Aktionen ausführen:</span><span class="sxs-lookup"><span data-stu-id="fd7c5-500">To customize the CreateUserWizard control's interface to include additional form fields, we can:</span></span>

- <span data-ttu-id="fd7c5-501">**Erstellen Sie eine oder mehrere neue ***`WizardStep`*** s, um die zusätzlichen Benutzeroberflächenelemente enthalten**.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-501">**Create one or more new****`WizardStep`****s to contain the additional user interface elements**.</span></span> <span data-ttu-id="fd7c5-502">Zum Hinzufügen einer neuen `WizardStep` die CreateUserWizard, klicken Sie auf der "hinzufügen/entfernen `WizardStep` s" Verknüpfung von Smart Tag zum Starten der `WizardStep` Auflistungs-Editor.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-502">To add a new `WizardStep` to the CreateUserWizard, click the "Add/Remove `WizardStep` s" link from its Smart Tag to launch the `WizardStep` Collection Editor.</span></span> <span data-ttu-id="fd7c5-503">Von dort aus können Sie hinzufügen, entfernen oder Neuanordnen von Schritten im Assistenten.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-503">From there you can add, remove, or reorder the steps in the wizard.</span></span> <span data-ttu-id="fd7c5-504">Dies ist die Vorgehensweise, die für dieses Lernprogramm verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-504">This is the approach we will use for this tutorial.</span></span>

- <span data-ttu-id="fd7c5-505">**Konvertieren der ***`CreateUserWizardStep`*** in einer bearbeitbaren ***`WizardStep`***.**</span><span class="sxs-lookup"><span data-stu-id="fd7c5-505">**Convert the****`CreateUserWizardStep`****into an editable****`WizardStep`****.**</span></span> <span data-ttu-id="fd7c5-506">Dies ersetzt die `CreateUserWizardStep` durch ein Äquivalent `WizardStep` , deren Markups definiert eine Benutzeroberfläche, die entspricht der `CreateUserWizardStep`"s.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-506">This replaces the `CreateUserWizardStep` with an equivalent `WizardStep` whose markup defines a user interface that matches the `CreateUserWizardStep`'s.</span></span> <span data-ttu-id="fd7c5-507">Durch Konvertieren der `CreateUserWizardStep` in einem `WizardStep` können wir die Steuerelemente neu positionieren oder fügen Sie zusätzliche Elemente der Benutzeroberfläche für diesen Schritt.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-507">By converting the `CreateUserWizardStep` into a `WizardStep` we can reposition the controls or add additional user interface elements to this step.</span></span> <span data-ttu-id="fd7c5-508">Konvertiert die `CreateUserWizardStep` oder `CompleteWizardStep` in einer bearbeitbaren `WizardStep`, klicken Sie auf die "Benutzer anpassen-erstellen-Schritt" oder "Schritts anpassen" aus dem Smarttag des Steuerelements zu verknüpfen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-508">To convert the `CreateUserWizardStep` or `CompleteWizardStep` into an editable `WizardStep`, click the "Customize Create User Step" or "Customize Complete Step" link from the control's Smart Tag.</span></span>

- <span data-ttu-id="fd7c5-509">**Verwenden Sie eine besondere Kombination der oben genannten beiden Optionen.**</span><span class="sxs-lookup"><span data-stu-id="fd7c5-509">**Use some combination of the above two options.**</span></span>

<span data-ttu-id="fd7c5-510">Wichtig zu bedenken ist, dass Steuerelement CreateUserWizard Erstellungsprozess seine Benutzer-Konto ausgeführt wird, wenn die Schaltfläche "Benutzer erstellen", innerhalb geklickt wird dessen `CreateUserWizardStep`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-510">One important thing to keep in mind is that the CreateUserWizard control executes its user account creation process when the "Create User" button is clicked from within its `CreateUserWizardStep`.</span></span> <span data-ttu-id="fd7c5-511">Es spielt keine Rolle, wenn zusätzliche `WizardStep` s nach der `CreateUserWizardStep` oder nicht.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-511">It doesn't matter if there are additional `WizardStep` s after the `CreateUserWizardStep` or not.</span></span>

<span data-ttu-id="fd7c5-512">Beim Hinzufügen eines benutzerdefinierten `WizardStep` an das Steuerelement CreateUserWizard zusätzliche Benutzereingaben, die benutzerdefinierte erfassen `WizardStep` platziert werden kann, vor oder nach der `CreateUserWizardStep`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-512">When adding a custom `WizardStep` to the CreateUserWizard control to collect additional user input, the custom `WizardStep` can be placed before or after the `CreateUserWizardStep`.</span></span> <span data-ttu-id="fd7c5-513">Wenn es vorangeht der `CreateUserWizardStep` dann die zusätzliche Benutzereingabe gesammelt, aus dem benutzerdefinierten `WizardStep` steht für die `CreatedUser` -Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-513">If it comes before the `CreateUserWizardStep` then the additional user input collected from the custom `WizardStep` is available for the `CreatedUser` event handler.</span></span> <span data-ttu-id="fd7c5-514">Jedoch wenn die benutzerdefinierte `WizardStep` kommt nach `CreateUserWizardStep` dann nach der Zeit die benutzerdefinierte `WizardStep` wird angezeigt, das neue Benutzerkonto wurde bereits erstellt und die `CreatedUser` Ereignis bereits ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-514">However, if the custom `WizardStep` comes after `CreateUserWizardStep` then by the time the custom `WizardStep` is displayed the new user account has already been created and the `CreatedUser` event has already fired.</span></span>

<span data-ttu-id="fd7c5-515">Abbildung 21 zeigt den Workflow bei der hinzugefügten `WizardStep` steht vor der `CreateUserWizardStep`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-515">Figure 21 shows the workflow when the added `WizardStep` precedes the `CreateUserWizardStep`.</span></span> <span data-ttu-id="fd7c5-516">Seit dem Zeitpunkt die weiteren Benutzerinformationen gesammelt wurden die `CreatedUser` Ereignis ausgelöst wird, müssen wir tun Update ist die `CreatedUser` -Ereignishandler, um diese Eingaben abrufen und verwenden Sie diese für die `INSERT` Parameterwerte-Anweisung (statt `DBNull.Value`).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-516">Since the additional user information has been collected by the time the `CreatedUser` event fires, all we have to do is update the `CreatedUser` event handler to retrieve these inputs and use those for the `INSERT` statement's parameter values (rather than `DBNull.Value`).</span></span>


<span data-ttu-id="fd7c5-517">[![Die CreateUserWizard-Workflow, wenn eine zusätzliche WizardStep der CreateUserWizardStep vorangestellt ist.](storing-additional-user-information-vb/_static/image62.png)](storing-additional-user-information-vb/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-517">[![The CreateUserWizard Workflow When an Additional WizardStep Precedes the CreateUserWizardStep](storing-additional-user-information-vb/_static/image62.png)](storing-additional-user-information-vb/_static/image61.png)</span></span>

<span data-ttu-id="fd7c5-518">**Abbildung 21**: die CreateUserWizard Workflow bei einer zusätzlichen `WizardStep` Precedes der `CreateUserWizardStep` ([klicken Sie hier, um das Bild in voller Größe angezeigt](storing-additional-user-information-vb/_static/image63.png))</span><span class="sxs-lookup"><span data-stu-id="fd7c5-518">**Figure 21**: The CreateUserWizard Workflow When an Additional `WizardStep` Precedes the `CreateUserWizardStep` ([Click to view full-size image](storing-additional-user-information-vb/_static/image63.png))</span></span>


<span data-ttu-id="fd7c5-519">Wenn die benutzerdefinierte `WizardStep` befindet *nach* der `CreateUserWizardStep`, allerdings den Prozess zum Erstellen eines Benutzers Konto tritt auf, bevor der Benutzer eine Möglichkeit, ihre Startseite Örtlichkeit, Startseite oder Signatur eingeben hatte.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-519">If the custom `WizardStep` is placed *after* the `CreateUserWizardStep`, however, the create user account process occurs before the user has had a chance to enter her home town, homepage, or signature.</span></span> <span data-ttu-id="fd7c5-520">In diesem Fall muss diese zusätzlichen Informationen in die Datenbank eingefügt werden, nachdem das Benutzerkonto erstellt wurde, wie in Abbildung 22 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-520">In such a case, this additional information needs to be inserted into the database after the user account has been created, as Figure 22 illustrates.</span></span>


<span data-ttu-id="fd7c5-521">[![Die CreateUserWizard-Workflow, wenn eine zusätzliche WizardStep nach der CreateUserWizardStep kommt](storing-additional-user-information-vb/_static/image65.png)](storing-additional-user-information-vb/_static/image64.png)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-521">[![The CreateUserWizard Workflow When an Additional WizardStep Comes After the CreateUserWizardStep](storing-additional-user-information-vb/_static/image65.png)](storing-additional-user-information-vb/_static/image64.png)</span></span>

<span data-ttu-id="fd7c5-522">**Abbildung 22**: die CreateUserWizard Workflow bei einer zusätzlichen `WizardStep` stammt nach der `CreateUserWizardStep` ([klicken Sie hier, um das Bild in voller Größe angezeigt](storing-additional-user-information-vb/_static/image66.png))</span><span class="sxs-lookup"><span data-stu-id="fd7c5-522">**Figure 22**: The CreateUserWizard Workflow When an Additional `WizardStep` Comes After the `CreateUserWizardStep` ([Click to view full-size image](storing-additional-user-information-vb/_static/image66.png))</span></span>


<span data-ttu-id="fd7c5-523">Mit dem Einfügen eines Datensatzes in der Abbildung 22 Workflow wartet, die `UserProfiles` Tabelle erst nach Abschluss von Schritt2.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-523">The workflow shown in Figure 22 waits to insert a record into the `UserProfiles` table until after Step 2 completes.</span></span> <span data-ttu-id="fd7c5-524">Wenn Besucher ihrer Browser nach Schritt 1 geschlossen wurde, allerdings haben wir haben erreicht einen Status, in dem ein Benutzerkonto erstellt wurde, aber kein Datensatz wurde hinzugefügt, um `UserProfiles`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-524">If the visitor closes her browser after step 1, however, we will have reached a state where a user account was created, but no record was added to `UserProfiles`.</span></span> <span data-ttu-id="fd7c5-525">Eine Lösung besteht darin, einen Datensatz mit `NULL` oder Standardwerte eingefügt `UserProfiles` in die `CreatedUser` Ereignishandler (nach Schritt 1 ausgelöst wird), und aktualisieren Sie dann diese nach Abschluss von Schritt 2 erfassen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-525">One workaround is to have a record with `NULL` or default values inserted into `UserProfiles` in the `CreatedUser` event handler (which fires after step 1), and then update this record after step 2 completes.</span></span> <span data-ttu-id="fd7c5-526">Dadurch wird sichergestellt, dass eine `UserProfiles` Datensatz wird für das Benutzerkonto hinzugefügt werden, selbst wenn der Benutzer die Registrierung Prozess genau über beendet.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-526">This ensures that a `UserProfiles` record will be added for the user account even if the user quits the registration process midway through.</span></span>

<span data-ttu-id="fd7c5-527">Für dieses Lernprogramm erstellen Sie nun ein neues `WizardStep` Vorgang, der nach der `CreateUserWizardStep` aber vor der `CompleteWizardStep`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-527">For this tutorial let's create a new `WizardStep` that occurs after the `CreateUserWizardStep` but before the `CompleteWizardStep`.</span></span> <span data-ttu-id="fd7c5-528">Wir sehen rufen Sie zuerst die WizardStep in platzieren und konfiguriert aus, und klicken Sie dann wir uns den Code.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-528">Let's first get the WizardStep in place and configured and then we'll look at the code.</span></span>

<span data-ttu-id="fd7c5-529">Smart Tag CreateUserWizard-Steuerelement, wählen Sie in der "hinzufügen/entfernen `WizardStep` s", die bringt die `WizardStep` Auflistungs-Editor-Dialogfeld.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-529">From the CreateUserWizard control's Smart Tag, select the "Add/Remove `WizardStep` s", which brings up the `WizardStep` Collection Editor dialog.</span></span> <span data-ttu-id="fd7c5-530">Fügen Sie einen neuen `WizardStep`wird durch das Festlegen der `ID` auf `UserSettings`, dessen `Title` auf "Ihre Einstellungen" und die zugehörige `StepType` auf `Step`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-530">Add a new `WizardStep`, setting its `ID` to `UserSettings`, its `Title` to "Your Settings" and its `StepType` to `Step`.</span></span> <span data-ttu-id="fd7c5-531">Positionieren Sie es so, dass es nach geht die `CreateUserWizardStep` ("Registrieren für Ihr neues Konto") und vor der `CompleteWizardStep` ("abgeschlossen"), wie in Abbildung 23 dargestellt.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-531">Then position it so that it comes after the `CreateUserWizardStep` ("Sign Up for Your New Account") and before the `CompleteWizardStep` ("Complete"), as shown in Figure 23.</span></span>


<span data-ttu-id="fd7c5-532">[![Hinzufügen einer neuen WizardStep an das Steuerelement CreateUserWizard](storing-additional-user-information-vb/_static/image68.png)](storing-additional-user-information-vb/_static/image67.png)</span><span class="sxs-lookup"><span data-stu-id="fd7c5-532">[![Add a New WizardStep to the CreateUserWizard Control](storing-additional-user-information-vb/_static/image68.png)](storing-additional-user-information-vb/_static/image67.png)</span></span>

<span data-ttu-id="fd7c5-533">**Abbildung 23**: Hinzufügen ein neuen `WizardStep` an das Steuerelement CreateUserWizard ([klicken Sie hier, um das Bild in voller Größe angezeigt](storing-additional-user-information-vb/_static/image69.png))</span><span class="sxs-lookup"><span data-stu-id="fd7c5-533">**Figure 23**: Add a New `WizardStep` to the CreateUserWizard Control  ([Click to view full-size image](storing-additional-user-information-vb/_static/image69.png))</span></span>


<span data-ttu-id="fd7c5-534">Klicken Sie auf OK, um das Schließen der `WizardStep` Auflistungs-Editor-Dialogfeld.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-534">Click OK to close the `WizardStep` Collection Editor dialog.</span></span> <span data-ttu-id="fd7c5-535">Die neue `WizardStep` wird durch das CreateUserWizard Steuerelement aktualisierte deklarativem Markup gezeigt:</span><span class="sxs-lookup"><span data-stu-id="fd7c5-535">The new `WizardStep` is evidenced by the CreateUserWizard control's updated declarative markup:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample13.aspx)]

<span data-ttu-id="fd7c5-536">Beachten Sie die neue `<asp:WizardStep>` Element.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-536">Note the new `<asp:WizardStep>` element.</span></span> <span data-ttu-id="fd7c5-537">Wir müssen die Benutzeroberfläche zum Erfassen des neuen Benutzers home Örtlichkeit, Homepage und Signatur hier hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-537">We need to add the user interface to collect the new user's home town, homepage, and signature here.</span></span> <span data-ttu-id="fd7c5-538">Sie können diesen Inhalt in die deklarative Syntax oder mithilfe des Designers eingeben.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-538">You can enter this content in the declarative syntax or through the Designer.</span></span> <span data-ttu-id="fd7c5-539">Um den Designer zu verwenden, wählen Sie im Schritt "Ihre Einstellungen" aus der Dropdown-Liste in das Smarttag, um den Schritt im Designer finden Sie unter.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-539">To use the Designer, select the "Your Settings" step from the drop-down list in the Smart Tag to see the step in the Designer.</span></span>

> [!NOTE]
> <span data-ttu-id="fd7c5-540">Eine schrittweise durchlaufen das Smarttag-Dropdownliste auswählen des Steuerelements CreateUserWizard aktualisiert [ `ActiveStepIndex` Eigenschaft](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.createuserwizard.activestepindex.aspx), gibt den Index des ersten Schritts an.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-540">Selecting a step through the Smart Tag's drop-down list updates the CreateUserWizard control's [`ActiveStepIndex` property](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.createuserwizard.activestepindex.aspx), which specifies the index of the starting step.</span></span> <span data-ttu-id="fd7c5-541">Wenn Sie dieses Dropdown-Liste verwenden, um den Schritt "Ihre Einstellungen" im Designer bearbeiten, werden daher sicher, dass es wieder auf "Anmelden für Ihr neues Konto" festlegen, so, dass dieser Schritt, beim ersten Besuch angezeigt wird der `EnhancedCreateUserWizard.aspx` Seite.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-541">Therefore, if you use this drop-down list to edit the "Your Settings" step in the Designer, be sure to set it back to "Sign Up for Your New Account" so that this step is shown when users first visit the `EnhancedCreateUserWizard.aspx` page.</span></span>


<span data-ttu-id="fd7c5-542">Erstellen einer Benutzeroberfläche innerhalb der Schritt "Ihre Einstellungen", die drei TextBox-Steuerelemente, die mit dem Namen enthält `HomeTown`, `HomepageUrl`, und `Signature`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-542">Create a user interface within the "Your Settings" step that contains three TextBox controls named `HomeTown`, `HomepageUrl`, and `Signature`.</span></span> <span data-ttu-id="fd7c5-543">Nach dem Erstellen dieser Schnittstelle, sollte die CreateUserWizard deklarative Markup etwa wie folgt aussehen:</span><span class="sxs-lookup"><span data-stu-id="fd7c5-543">After constructing this interface, the CreateUserWizard's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](storing-additional-user-information-vb/samples/sample14.aspx)]

<span data-ttu-id="fd7c5-544">Fahren Sie fort, und finden Sie auf dieser Seite über einen Browser, und erstellen Sie ein neues Benutzerkonto, und geben Sie Werte für den home Örtlichkeit Homepage und Signatur angeben.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-544">Go ahead and visit this page through a browser and create a new user account, specifying values for the home town, homepage, and signature.</span></span> <span data-ttu-id="fd7c5-545">Nach Abschluss der `CreateUserWizardStep` ist das Benutzerkonto, das in die Mitgliedschaft-Framework erstellt und die `CreatedUser` -Ereignishandler ausgeführt, das eine neue Zeile hinzufügt `UserProfiles`, jedoch mit einer Datenbank `NULL` Wert für `HomeTown`, `HomepageUrl`, und `Signature`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-545">After completing the `CreateUserWizardStep` the user account is created in the Membership framework and the `CreatedUser` event handler runs, which adds a new row to `UserProfiles`, but with a database `NULL` value for `HomeTown`, `HomepageUrl`, and `Signature`.</span></span> <span data-ttu-id="fd7c5-546">Die eingegebenen Werte für die home-Stadt, Homepage und Signatur werden nie verwendet.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-546">The values entered for the home town, homepage, and signature are never used.</span></span> <span data-ttu-id="fd7c5-547">Das Ergebnis ist ein neues Benutzerkonto mit einem `UserProfiles` aufzeichnen, deren `HomeTown`, `HomepageUrl`, und `Signature` Felder besitzen noch angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-547">The net result is a new user account with a `UserProfiles` record whose `HomeTown`, `HomepageUrl`, and `Signature` fields have yet to be specified.</span></span>

<span data-ttu-id="fd7c5-548">Wir müssen zum Ausführen von Code nach dem Schritt "Ihre Einstellungen", die nimmt die home Örtlichkeit Honepage und Signatur Werte, die vom Benutzer eingegeben und aktualisiert den entsprechenden `UserProfiles` Datensatz.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-548">We need to execute code after the "Your Settings" step that takes the home town, honepage, and signature values entered by the user and updates the appropriate `UserProfiles` record.</span></span> <span data-ttu-id="fd7c5-549">Jedes Mal, die der Benutzer wechselt zwischen den Schritten des Assistenten zu steuern, des Assistenten [ `ActiveStepChanged` Ereignis](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.wizard.activestepchanged.aspx) ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-549">Each time the user moves between steps in a Wizard control, the Wizard's [`ActiveStepChanged` event](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.wizard.activestepchanged.aspx) fires.</span></span> <span data-ttu-id="fd7c5-550">Wir können erstellen Sie einen Ereignishandler für dieses Ereignis und das Update der `UserProfiles` Tabelle, wenn der Schritt "Ihre Einstellungen" abgeschlossen wurde.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-550">We can create an event handler for this event and update the `UserProfiles` table when the "Your Settings" step has completed.</span></span>

<span data-ttu-id="fd7c5-551">Fügen Sie einen Ereignishandler für das CreateUserWizard `ActiveStepChanged` Ereignis und fügen Sie den folgenden Code hinzu:</span><span class="sxs-lookup"><span data-stu-id="fd7c5-551">Add an event handler for the CreateUserWizard's `ActiveStepChanged` event and add the following code:</span></span>

[!code-vb[Main](storing-additional-user-information-vb/samples/sample15.vb)]

<span data-ttu-id="fd7c5-552">Der obige Code beginnt mit bestimmen, ob wir einfach den Schritt "Vollständig" erreicht haben.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-552">The above code starts by determining if we have just reached the "Complete" step.</span></span> <span data-ttu-id="fd7c5-553">Da der Schritt "Vollständig" unmittelbar nach dem Schritt "Ihre Einstellungen" auftritt, erreicht der Besucher Schritt klicken Sie dann "Abgeschlossen", das bedeutet, dass sie nur den Schritt "Ihre Einstellungen" abgeschlossen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-553">Since the "Complete" step occurs immediately after the "Your Settings" step, then when the visitor reaches "Complete" step that means she just finished the "Your Settings" step.</span></span>

<span data-ttu-id="fd7c5-554">In einem solchen Fall muss innerhalb der TextBox-Steuerelemente programmgesteuert verweisen die `UserSettings WizardStep`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-554">In such a case, we need to programmatically reference the TextBox controls within the `UserSettings WizardStep`.</span></span> <span data-ttu-id="fd7c5-555">Dies wird erreicht, indem Sie zuerst die `FindControl` Methode, um programmgesteuert verweisen auf die `UserSettings WizardStep`, und dann erneut aus, um die Textfelder ein heraus verweisen die `WizardStep`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-555">This is accomplished by first using the `FindControl` method to programmatically referencing the `UserSettings WizardStep`, and then again to reference the TextBoxes from within the `WizardStep`.</span></span> <span data-ttu-id="fd7c5-556">Nachdem die Textfelder ein verwiesen wurde, können wir bereit zur Ausführung der `UPDATE` Anweisung.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-556">Once the TextBoxes have been referenced, we're ready to execute the `UPDATE` statement.</span></span> <span data-ttu-id="fd7c5-557">Die `UPDATE` Anweisung verfügt über die gleiche Anzahl von Parametern wie der `INSERT` -Anweisung in der `CreatedUser` Ereignishandler, d. h. jedoch hier verwenden wir die home Örtlichkeit Homepage und Signatur Werte, die vom Benutzer bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-557">The `UPDATE` statement has the same number of parameters as the `INSERT` statement in the `CreatedUser` event handler, but here we use the home town, homepage, and signature values supplied by the user.</span></span>

<span data-ttu-id="fd7c5-558">Mit diesem Ereignishandler vorhanden, besuchen Sie die `EnhancedCreateUserWizard.aspx` Seite über einen Browser, und erstellen Sie ein neues Benutzerkonto mit dem Sie Werte für den home Örtlichkeit Homepage und Signatur angeben.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-558">With this event handler in place, visit the `EnhancedCreateUserWizard.aspx` page through a browser and create a new user account specifying values for the home town, homepage, and signature.</span></span> <span data-ttu-id="fd7c5-559">Nach der Erstellung des neuen Kontos sollten Sie umgeleitet die `AdditionalUserInfo.aspx` Seite, in dem die gerade eingegebenen home Örtlichkeit Homepage und Signatur Informationen werden angezeigt.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-559">After creating the new account you should be redirected to the `AdditionalUserInfo.aspx` page, where the just-entered home town, homepage, and signature information is displayed.</span></span>

> [!NOTE]
> <span data-ttu-id="fd7c5-560">Unserer Website verfügt derzeit über zwei Seiten, die von dem Besucher ein neues Konto erstellen kann: `CreatingUserAccounts.aspx` und `EnhancedCreateUserWizard.aspx`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-560">Our website currently has two pages from which a visitor can create a new account: `CreatingUserAccounts.aspx` and `EnhancedCreateUserWizard.aspx`.</span></span> <span data-ttu-id="fd7c5-561">Website Sitemap und Anmeldeseite zeigen Sie auf die `CreatingUserAccounts.aspx` Seite, aber die `CreatingUserAccounts.aspx` Seite fordert ihre Startseite Örtlichkeit Homepage und Signatur-Informationen vom Benutzer nicht und werden nicht zu eine entsprechende Zeile hinzugefügt `UserProfiles`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-561">The website's sitemap and login page point to the `CreatingUserAccounts.aspx` page, but the `CreatingUserAccounts.aspx` page does not prompt the user for their home town, homepage, and signature information and does not add a corresponding row to `UserProfiles`.</span></span> <span data-ttu-id="fd7c5-562">Aktualisieren Sie daher entweder die `CreatingUserAccounts.aspx` Seite, damit er diese Funktionalität bietet, oder die Seite Sitemap und melden Sie sich auf "Aktualisieren" `EnhancedCreateUserWizard.aspx` anstelle von `CreatingUserAccounts.aspx`.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-562">Therefore, either update the `CreatingUserAccounts.aspx` page so that it offers this functionality or update the sitemap and login page to reference `EnhancedCreateUserWizard.aspx` instead of `CreatingUserAccounts.aspx`.</span></span> <span data-ttu-id="fd7c5-563">Wenn Sie letztere Option auswählen, müssen Sie beim Aktualisieren der `Membership` des Ordners `Web.config` Datei, um anonymen Benutzern Zugriff auf die `EnhancedCreateUserWizard.aspx` Seite.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-563">If you choose the latter option, be sure to update the `Membership` folder's `Web.config` file so as to allow anonymous users access to the `EnhancedCreateUserWizard.aspx` page.</span></span>


## <a name="summary"></a><span data-ttu-id="fd7c5-564">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="fd7c5-564">Summary</span></span>

<span data-ttu-id="fd7c5-565">In diesem Lernprogramm wurde Techniken zum Modellieren von Daten, die auf Benutzerkonten innerhalb des Frameworks Mitgliedschaft bezieht.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-565">In this tutorial we looked at techniques for modeling data that is related to user accounts within the Membership framework.</span></span> <span data-ttu-id="fd7c5-566">Insbesondere erläutert wir Modellieren von Entitäten, die gemeinsam eine 1: n-Beziehung mit Benutzerkonten als auch Daten, die eine direkte Beziehung gemeinsam nutzen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-566">In particular, we looked at modeling entities that share a one-to-many relationship with user accounts as well as data that shares a one-to-one relationship.</span></span> <span data-ttu-id="fd7c5-567">Darüber hinaus wurde erläutert, wie diese Informationen kann angezeigt, eingefügt und aktualisiert werden, mit einigen Beispielen SqlDataSource-Steuerelement und andere Beziehung ADO.NET-Code verwenden.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-567">Furthermore, we saw how this related information could be displayed, inserted, and updated, with some examples using the SqlDataSource control and others using ADO.NET code.</span></span>

<span data-ttu-id="fd7c5-568">Dieses Lernprogramm ist unsere Betrachtung der Benutzerkonten abgeschlossen.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-568">This tutorial completes our look at user accounts.</span></span> <span data-ttu-id="fd7c5-569">Beginnend mit den nächsten Lernprogrammen wird unsere Aufmerksamkeit Rollen aktivieren.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-569">Starting with the next tutorial we will turn our attention to roles.</span></span> <span data-ttu-id="fd7c5-570">Über den nächsten mehrere Lernprogramme, betrachten wir das Framework Rollen, finden Sie unter Vorgehensweise: Erstellen Sie neue Rollen an Benutzer, Rollen zuweisen, wie um zu bestimmen, welche Rollen ein Benutzer angehört, und wie rollenbasierte Autorisierung anzuwenden.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-570">Over the next several tutorials we will look at the Roles framework, see how to create new roles, how to assign roles to users, how to determine what roles a user belongs to, and how to apply role-based authorization.</span></span>

<span data-ttu-id="fd7c5-571">Viel Spaß beim Programmieren!</span><span class="sxs-lookup"><span data-stu-id="fd7c5-571">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="fd7c5-572">Weiterführende Themen</span><span class="sxs-lookup"><span data-stu-id="fd7c5-572">Further Reading</span></span>

<span data-ttu-id="fd7c5-573">Weitere Informationen zu den Themen in diesem Lernprogramm erläutert finden Sie in den folgenden Ressourcen:</span><span class="sxs-lookup"><span data-stu-id="fd7c5-573">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="fd7c5-574">Zugreifen auf und Aktualisieren von Daten in ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="fd7c5-574">Accessing and Updating Data in ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/011106-1.aspx)
- [<span data-ttu-id="fd7c5-575">ASP.NET 2.0-Assistent-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="fd7c5-575">ASP.NET 2.0 Wizard Control</span></span>](https://weblogs.asp.net/scottgu/archive/2006/02/21/438732.aspx)
- [<span data-ttu-id="fd7c5-576">Erstellen eine schrittweise Benutzeroberfläche mit dem ASP.NET 2.0-Assistent-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="fd7c5-576">Creating a Step-by-Step User Interface with the ASP.NET 2.0 Wizard Control</span></span>](http://aspnet.4guysfromrolla.com/articles/061406-1.aspx)
- [<span data-ttu-id="fd7c5-577">Erstellen von benutzerdefinierten DataSource Steuerelementparameter</span><span class="sxs-lookup"><span data-stu-id="fd7c5-577">Creating Custom DataSource Control Parameters</span></span>](http://aspnet.4guysfromrolla.com/articles/110106-1.aspx)
- [<span data-ttu-id="fd7c5-578">Anpassen des Steuerelements CreateUserWizard</span><span class="sxs-lookup"><span data-stu-id="fd7c5-578">Customizing the CreateUserWizard Control</span></span>](http://aspnet.4guysfromrolla.com/articles/070506-1.aspx)
- [<span data-ttu-id="fd7c5-579">Schnellstarts DetailsView-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="fd7c5-579">DetailsView Control QuickStarts</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/data/detailsview.aspx)
- [<span data-ttu-id="fd7c5-580">Anzeigen von Daten mit dem ListView-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="fd7c5-580">Displaying Data with the ListView Control</span></span>](http://aspnet.4guysfromrolla.com/articles/122607-1.aspx)
- [<span data-ttu-id="fd7c5-581">Unterzogen, wodurch die Validierungssteuerelemente in ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="fd7c5-581">Dissecting the Validation Controls in ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)
- [<span data-ttu-id="fd7c5-582">Bearbeiten von einfügen und Löschen von Daten</span><span class="sxs-lookup"><span data-stu-id="fd7c5-582">Editing Insert and Deleting Data</span></span>](../../data-access/editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md)
- [<span data-ttu-id="fd7c5-583">Formularvalidierung in ASP.NET</span><span class="sxs-lookup"><span data-stu-id="fd7c5-583">Form Validation in ASP.NET</span></span>](http://www.4guysfromrolla.com/webtech/090200-1.shtml)
- [<span data-ttu-id="fd7c5-584">Sammeln von benutzerdefinierten-Registrierungsinformationen</span><span class="sxs-lookup"><span data-stu-id="fd7c5-584">Gathering Custom User Registration Information</span></span>](https://weblogs.asp.net/scottgu/archive/2006/07/05/Tip_2F00_Trick_3A00_-Gathering-Custom-User-Registration-Information.aspx)
- [<span data-ttu-id="fd7c5-585">Profile in ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="fd7c5-585">Profiles in ASP.NET 2.0</span></span>](http://www.odetocode.com/Articles/440.aspx)
- [<span data-ttu-id="fd7c5-586">Die Asp: ListView-Steuerelement</span><span class="sxs-lookup"><span data-stu-id="fd7c5-586">The asp:ListView Control</span></span>](https://weblogs.asp.net/scottgu/archive/2007/08/10/the-asp-listview-control-part-1-building-a-product-listing-page-with-clean-css-ui.aspx)
- [<span data-ttu-id="fd7c5-587">User Profile Schnellstart</span><span class="sxs-lookup"><span data-stu-id="fd7c5-587">User Profiles QuickStart</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/profile/default.aspx)

### <a name="about-the-author"></a><span data-ttu-id="fd7c5-588">Informationen zum Autor</span><span class="sxs-lookup"><span data-stu-id="fd7c5-588">About the Author</span></span>

<span data-ttu-id="fd7c5-589">Scott Mitchell, Autor von mehreren ASP/ASP.NET-Büchern und Gründer von 4GuysFromRolla.com, bereits seit 1998 mit Microsoft-Web-Technologien gearbeitet.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-589">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="fd7c5-590">Scott fungiert als ein unabhängiger Berater, Trainer und Writer.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-590">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="fd7c5-591">Sein neueste Buch wird  *[Sams Schulen selbst ASP.NET 2.0 in 24 Stunden](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-591">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="fd7c5-592">Scott erreicht werden kann, zur [ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com) oder über seinen Blog unter [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-592">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="fd7c5-593">Besonderen Dank an...</span><span class="sxs-lookup"><span data-stu-id="fd7c5-593">Special Thanks To…</span></span>

<span data-ttu-id="fd7c5-594">Diese Reihe von Lernprogrammen wurde durch viele nützliche Bearbeiter überprüft.</span><span class="sxs-lookup"><span data-stu-id="fd7c5-594">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="fd7c5-595">Meine bevorstehende MSDN-Artikel Überprüfen von Interesse?</span><span class="sxs-lookup"><span data-stu-id="fd7c5-595">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="fd7c5-596">Wenn dies der Fall ist, löschen Sie mich zeilenweise [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com).</span><span class="sxs-lookup"><span data-stu-id="fd7c5-596">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

>[!div class="step-by-step"]
[<span data-ttu-id="fd7c5-597">Zurück</span><span class="sxs-lookup"><span data-stu-id="fd7c5-597">Previous</span></span>](user-based-authorization-vb.md)
